var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,n)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__spreadValues=(e,t)=>{for(var n in t||(t={}))__hasOwnProp.call(t,n)&&__defNormalProp(e,n,t[n]);if(__getOwnPropSymbols)for(var n of __getOwnPropSymbols(t))__propIsEnum.call(t,n)&&__defNormalProp(e,n,t[n]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t)),UniverPreactTs=function(e){"use strict";var t,n;(n=t||(t={}))[n.OBSERVER_ACTION=1]="OBSERVER_ACTION",n[n.SERVER_ACTION=2]="SERVER_ACTION",n[n.UNDO_ACTION=3]="UNDO_ACTION",n[n.EXTENSION_ACTION=4]="EXTENSION_ACTION",n[n.DEFAULT_ACTION=7]="DEFAULT_ACTION";class r{constructor(e,t){this._doActionData=e,this._observers=t,this._operation=1}getDoActionData(){return this._doActionData}getOldActionData(){return this._oldActionData}hasOperation(e){return(this._operation&e)===e}addOperation(e){this._operation|=e}removeOperation(e){this._operation&=~e}}class s{constructor(e=!1){this.isStopPropagation=!1,this.initialize(e)}initialize(e=!1){return this.skipNextObservers=e,this}stopPropagation(){this.isStopPropagation=!0}}class o{constructor(e){this.callback=e,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1}}class i{constructor(e){this._observers=new Array,this._eventState=new s,e&&(this._onObserverAdded=e)}get observers(){return this._observers}add(e,t=!1,n=!1){if(!e)return null;const r=new o(e);return r.unregisterOnNextCall=n,t?this._observers.unshift(r):this._observers.push(r),this._onObserverAdded&&this._onObserverAdded(r),r}addOnce(e){return this.add(e,void 0,!0)}remove(e){if(!e)return!1;return-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0)}removeCallback(e){for(let t=0;t<this._observers.length;t++){const n=this._observers[t];if(!n._willBeUnregistered&&n.callback===e)return this._deferUnregister(n),!0}return!1}makeObserverTopPriority(e){this._remove(e),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e),this._observers.push(e)}notifyObservers(e){if(!this._observers.length)return null;const t=this._eventState;t.skipNextObservers=!1,t.lastReturnValue=e,t.isStopPropagation=!1;let n=!1;for(let r=0;r<this._observers.length;r++){const s=this._observers[r];if(!s._willBeUnregistered&&(t.lastReturnValue=s.callback(e,t),s.unregisterOnNextCall&&this._deferUnregister(s),t.isStopPropagation&&(n=!0),t.skipNextObservers))return{lastReturnValue:t.lastReturnValue,stopPropagation:n}}return{lastReturnValue:t.lastReturnValue,stopPropagation:n}}notifyObserversWithPromise(e){let t=Promise.resolve(e);if(!this._observers.length)return t;const n=this._eventState;n.skipNextObservers=!1;for(let r=0;r<this._observers.length;r++){const s=this._observers[r];n.skipNextObservers||(s._willBeUnregistered||(t=t.then((()=>s.callback(e,n))),s.unregisterOnNextCall&&this._deferUnregister(s)))}return t.then((()=>e))}notifyObserver(e,t){if(e._willBeUnregistered)return;const n=this._eventState;return n.skipNextObservers=!1,e.callback(t,n),e.unregisterOnNextCall&&this._deferUnregister(e),{lastReturnValue:n.lastReturnValue,stopPropagation:n.isStopPropagation}}hasObservers(){return this._observers.length>0}clear(){this._observers=new Array,this._onObserverAdded=null}clone(){const e=new i;return e._observers=this._observers.slice(0),e}_deferUnregister(e){e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout((()=>{this._remove(e)}),0)}_remove(e){if(!e)return!1;const t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)}}class l{constructor(e,t){this.name=e,this.observableHooks=t}}class a{constructor(){this._observableHooksArray=new Array}addHooks(e,t){this._observableHooksArray.push(new l(e,t))}getHooks(e){const t=this._observableHooksArray.find((t=>t.name===e));return t?t.observableHooks:null}}function c(e,t){let n=0,r=e.length-1;for(;n<=r;){let s=Math.floor((r+n)/2);if(t<e[s]&&(0===s||t>=e[s-1]))return s;if(t>=e[s])n=s+1;else{if(!(t<e[s]))return-1;r=s-1}}return-1}function h(e,t){let n=0,r=0,s=0,o=-1,i=e.length-1;for(;n<e.length&&i>=0&&i>=n;){if(r=e[i],s=0===i?0:e[i-1],t>=s&&t<r){o=i;break}if(r=e[n],s=0===n?0:e[n-1],t>=s&&t<r){o=n;break}n++,i--}return o}function u(e,t){let n=e.length-1;return n=e.length<40||t<=e[20]||t>=e[n-20]?h(e,t):c(e,t),n}const d=e=>null!=e,g=e=>{let t=Object.keys(e),n=/^\d+$/,r=0;for(let s=0;s<t.length;s++){let e=t[s];if(!n.test(e))return-1;let o=parseInt(e)+1;o>r&&(r=o)}return r};class f{constructor(...e){switch(e.length){case 0:return this._array={},void(this._length=0);case 1:{if("number"==typeof e[0])return this._array={},void(this._length=e[0]);const t=g(e[0]);if(t>-1)return this._array=e[0],void(this._length=t);throw new Error(`create object array error ${JSON.stringify(e[0])}`)}case 2:if(g(e[0])>-1)return this._array=e[0],void(this._length=e[1]);throw new Error(`create object array error ${JSON.stringify(e[0])}`)}}static objectKeys(e){if(e){const t=Object.keys(e),n=t.indexOf("length");return n>-1&&t.splice(n,1),t}return[]}static getMaxLength(e){if(e){if(e.length)return e.length;const t=f.objectKeys(e);if(t.length)return Math.max(...t)+1}return 0}obtain(e,t){var n;return null!=(n=this._array[e])?n:t}getKeys(){return f.objectKeys(this._array)}get(e){return this._array[e]}set(e,t){if(d(t)){const n=this._length;this._array[e]=t,e>=n&&(this._length=e+1)}}pop(){const e=this._length,t=this._array;if(e>0){const n=e-1,r=t[n];return n>0&&(delete t[n],this._length--),r}return null}push(e){if(d(e)){let t=this._length;this._array[t++]=e,this._length=t}}first(){return this._array[0]}last(){const e=this._length-1;return this._array[e]}shift(){const e=this._length;if(e>0){const t=this._array[0],n=e-1;let r;for(let e=0;e<n;e++)r=this._array[e+1],d(r)&&(this._array[e]=r);return this._length--,delete this._array[n],t}return null}unshift(e){if(d(e)){const t=this._length,n=this._array,r=t+1;let s=n[0];for(let e=1;e<r;e++){const t=this._array[e];d(s)&&(n[e]=s),s=t}n[0]=e,this._length=r}}clear(){this._array={},this._length=0}getLength(){return this._length}getSizeOf(){const e=this._array;return Object.keys(e).length}toJSON(){return this._array}toArray(){const e=new Array,t=this._array,n=Object.keys(t),r=n.length;for(let s=0;s<r;s++){const r=+n[s];e[r]=t[r]}return e}forEach(e){const t=this._array,n=Object.keys(t),r=n.length;for(let s=0;s<r;s++){const r=+n[s];if(!1===e(r,t[r]))return this}return this}clone(e){const t=new f;return e?this.forEach(((n,r)=>{t.set(n,e(r))})):this.forEach(((e,n)=>{t.set(e,n)})),t}isEmpty(){const e=this._array;return 0===Object.keys(e).length}delete(e){this.splice(e,1)}includes(e){const t=this._array,n=Object.keys(t),r=n.length;for(let s=0;s<r;s++){if(t[+n[s]]===e)return!0}return!1}slice(e,t){const n=this._array;if(this._length>0){const r={};let s=0;for(let o=e;o<t;o++){const e=n[o];d(e)&&(r[s]=n[o],s++)}return new f(r,s)}return new f}concat(e){const t=this._array,n=Object.keys(t),r=n.length,s=e._array,o=Object.keys(s),i=o.length,l=new f(r+i),a=l._array;let c=0;for(let h=0;h<r;h++,c++){const e=n[h];a[c]=t[e]}for(let h=0;h<i;h++,c++){const e=o[h];a[c]=s[e]}return l}find(e){const t=this._array,n=Object.keys(t),r=n.length;for(let s=0;s<r;s++){const r=+n[s],o=t[r];if(!0===e(r,o))return o}return null}splice(e,t){const n=this._length;if(n>0){const r=e+t,s=this._array;let o=0;const i={};for(let t=e;t<r;t++){const e=s[t];d(e)&&(delete s[t],i[o]=e,o++)}const l=r-e,a=n;if(this._length-=l,this._length<=0)this._array={},this._length=0;else for(let e=r;e<a;e++){const t=s[e];d(t)&&(s[e-l]=s[e],delete s[e])}return new f(i,o)}return new f}findIndex(e){const t=this._array,n=Object.keys(t),r=n.length;for(let s=0;s<r;s++){const r=+n[s];if(!0===e(r,t[r]))return s}return-1}map(e){const t=this._array,n=Object.keys(t),r=n.length,s={};for(let o=0;o<r;o++){const r=t[+n[o]];s[o]=e(r)}return new f(s)}filter(e){const t=this._array,n=Object.keys(t),r=n.length,s={};let o=0;for(let i=0;i<r;i++){const r=+n[i],l=t[r];e(r,l)&&(s[o]=l,o++)}return new f(s,o)}insert(e,t){const n=this._length,r=this._array;for(let s=n-1;s>=e;s--)r[s+1]=r[s];return r[e]=t,this._length=n+1,this}inserts(e,t){const n=t._array,r=t._length,s=this._array;for(let o=this._length-1;o>=e;o--){const e=s[o];d(e)&&(delete s[o],s[o+r]=e)}for(let o=0;o<r;o++){const t=n[o];d(t)&&(s[o+e]=n[o])}return this._length+=r,this}[Symbol.iterator](){return new m(this)}}class m{constructor(e){this._array=e,this._keys=e.getKeys(),this._cursor=0}next(){const e=this._array,t=this._keys,n=this._cursor;if(n<t.length){const r=t[n],s=e.get(+r);return this._cursor++,{value:s,done:!1}}return{value:null,done:!0}}[Symbol.iterator](){return new m(this._array)}}class p{constructor(e={}){this._matrix=e,this._option=new f(e)}static MakeObjectMatrixSize(e){return new p({[e-1]:{}})}getMatrix(){return this._matrix}forEach(e){const t=this._option.getKeys();for(let n=0;n<t.length;n++){const r=+t[n];if(!1===e(r,this.getRow(r)))return this}return this}forValue(e){const t=this._option.getKeys();for(let n=0;n<t.length;n++){const r=+t[n],s=this.getRow(r),o=s.getKeys(),i=o.length;for(let t=0;t<i;t++){const n=+o[t];if(!1===e(r,n,s.get(n)))return this}}return this}swapRow(e,t){const n=this._option.get(e),r=this._option.get(t);this._option.set(t,n),this._option.set(e,r)}getRow(e){let t=this._option.get(e);if(t)return new f(t)}getRowOrCreate(e){let t=this.getRow(e);if(null==t){let t={};return this._option.set(e,t),new f(t)}return t}reset(){this._matrix={}}hasValue(){const e=this._option;for(const t of e)if(!new f(t).isEmpty())return!0;return!1}getValue(e,t){const n=this.getRow(e);return n?n.get(t):null}setValue(e,t,n){this.getRowOrCreate(e).set(t,n)}deleteValue(e,t){const n=this.getRow(e);n&&n.delete(t)}spliceRows(e,t){const n=this._option.splice(e,t);return new p(n.toJSON())}pushRow(e){this._option.push(e.toJSON())}insertRow(e,t){this._option.insert(e,t.toJSON())}insertRows(e,t){this._option.inserts(e,t._option),console.dir(this._option)}spliceColumns(e,t){const n=new p;return this._option.forEach(((r,s)=>{for(let i=e;i<e+t;i++)n.setValue(r,i-e,this.getValue(r,i));let o=this._option.get(r);o&&new f(o).splice(e,t)})),n}insertColumns(e,t){let n=0;t.forEach((e=>{const r=t.getRow(e);if(r)return n=r.getLength(),!1})),this.forEach(((r,s)=>{var o,i;for(let l=e;l<e+n;l++)null==(o=t.getRow(r))||o.get(l-e),s.insert(l,null==(i=t.getRow(r))?void 0:i.get(l-e))}))}getFragments(e,t,n,r){const s=new p;for(let o=e;o<=t;o++){const e=new f;for(let t=n;t<=r;t++){const n=this.getValue(o,t);e.push(n)}s.pushRow(e)}return s}getSizeOf(){return this._option.getSizeOf()}getLength(){return this._option.getLength()}getRange(){const e=this.getSizeOf();let t=0;const n=this.getLength();for(let r=0;r<n;r++){const e=this.getRow(r);if(e){const n=e.getSizeOf();e.getSizeOf()>t&&(t=n-1)}}return{startRow:0,startColumn:0,endRow:e,endColumn:t}}toArray(){return this._option.toArray().map((e=>new f(e).toArray()))}toJSON(){return this._matrix}getData(){const e=JSON.stringify(this);return JSON.parse(e)}getArrayData(){let e=0,t=0,n=!1,r=!1;const s=new p;return this.forEach(((o,i)=>{n||(n=!0,e=o),i.forEach(((n,i)=>{r?n<t&&(t=n):(r=!0,t=n);const l=this.getValue(o,n);s.setValue(o-e,n-t,l)}))})),s.getData()}getDataRange(){let e=0,t=0,n=0,r=!1,s=!1;this.forEach(((o,i)=>{r||(r=!0,e=o);const l=i.getLength()-1;l>n&&(n=l),i.forEach(((e,n)=>{s?e<t&&(t=e):(s=!0,t=e)}))}));const o=e+this.getSizeOf()-1;return{startRow:e,startColumn:t,endRow:o,endColumn:n}}}const b=/^-ms-/,_=/-([a-z])/g,v=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];class C{static stringAt(e){let t="",n=e;for(;n>=v.length;)n/=v.length,n-=1,t+=v[n%v.length];return t+=v[e%v.length],t}static getEnvironment(){const{appVersion:e}=navigator,t=this.getSystemType();return{app_version:e,os:t,os_version:t,device_id:"",platform:"web"}}static indexAt(e){let t=0;for(let n=0;n<e.length-1;n+=1){const r=e.charCodeAt(n)-65,s=e.length-1-n;t+=v.length**s+v.length*r}return t+=e.charCodeAt(e.length-1)-65,t}static deleteBlank(e){return C.isString(e)?e.replace(/\s/g,""):e}static getSystemType(){const e=navigator.userAgent,t="Win32"===navigator.platform||"Windows"===navigator.platform,n="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform;if(n)return"Mac";if("X11"===navigator.platform&&!t&&!n)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(t){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Windows 2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"Windows XP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Windows 2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"Windows Vista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Windows 7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Windows 10";if(e.indexOf("Windows NT 11")>-1||e.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const e=navigator.userAgent,t=e.indexOf("Opera")>-1,n=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!t,r=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,s=e.indexOf("Edge")>-1,o=e.indexOf("Firefox")>-1,i=e.indexOf("Safari")>-1&&-1===e.indexOf("Chrome"),l=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(n){new RegExp("MSIE (\\d+\\.\\d+);").test(e);const t=parseFloat(RegExp.$1);return 7===t?"IE7":8===t?"IE8":9===t?"IE9":10===t?"IE10":"0"}return o?"FF":t?"Opera":i?"Safari":l?"Chrome":s?"Edge":r?"IE11":"Unknown browser"}static generateRandomId(e=21){return((e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),""))(e)}static getClassName(e){return e.constructor.name}static deepMerge(e,...t){function n(e,t){e.forEach(((e,s)=>{var o,i;if(C.isArray(e)){const r=null!=(o=t[s])?o:[];return t[s]=r,void n(e,r)}if(C.isObject(e)){const n=null!=(i=t[s])?i:{};return t[s]=n,void r(e,n)}t[s]=e}))}function r(e,t){Object.keys(e).forEach((s=>{var o,i;const l=e[s];if(C.isObject(l)){const e=null!=(o=t[s])?o:{};return t[s]=e,void r(l,e)}if(C.isArray(l)){const e=null!=(i=t[s])?i:[];return t[s]=e,void n(l,e)}t[s]=l}))}return t.forEach((t=>t&&function(t){Object.keys(t).forEach((s=>{var o,i;const l=t[s];if(C.isArray(l)){const t=null!=(o=e[s])?o:[];return e[s]=t,void n(l,t)}if(C.isObject(l)){const t=null!=(i=e[s])?i:{};return e[s]=t,void r(l,t)}e[s]=l}))}(t))),e}static numberFixed(e,t){return Number(Number(e).toFixed(t))}static diffValue(e,t){function n(r,s){return C.getValueType(r)===C.getValueType(s)&&(C.isArray(r)?function(r,s){if(e.length!==t.length)return!1;for(let e=0,t=r.length;e<t;e++){if(!n(r[e],s[e]))return!1}return!0}(r,s):C.isObject(r)?function(e,t){const r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(const o of r){if(!s.includes(o))return!1;if(!n(e[o],t[o]))return!1}return!0}(r,s):C.isDate(r)?r.getTime()===s.getTime():C.isRegExp(r)?r.toString()===s.toString():r===s)}return n(e,t)}static deepClone(e){if(!this.isDefine(e))return e;if(this.isRegExp(e))return new RegExp(e);if(this.isDate(e))return new Date(e);if(this.isArray(e)){const t=[];return e.forEach(((e,n)=>{t[n]=C.deepClone(e)})),t}if(this.isObject(e)){const t={};return Object.keys(e).forEach((n=>{const r=e[n];t[n]=C.deepClone(r)})),Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}return e}static getLanguage(){const e="en-US";return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||e}static getValueType(e){return Object.prototype.toString.apply(e)}static isDefine(e){return null!=e}static isBlank(e){return!this.isDefine(e)||!!this.isString(e)&&""===e.trim()}static isAssignableFrom(e,t){return e instanceof t}static isBoolean(e){return"[object Boolean]"===this.getValueType(e)}static isPlainObject(e){return!!this.isDefine(e)&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}static isFunction(e){return"[object Function]"===this.getValueType(e)}static isDate(e){return"[object Date]"===this.getValueType(e)}static isRegExp(e){return"[object RegExp]"===this.getValueType(e)}static isArray(e){return"[object Array]"===this.getValueType(e)}static isString(e){return"[object String]"===this.getValueType(e)}static isNumber(e){return"[object Number]"===this.getValueType(e)}static isStringNumber(e){return!isNaN(parseFloat(e))&&isFinite(e)}static isObject(e){return"[object Object]"===this.getValueType(e)}static isEmptyObject(e){for(const t in e)return!1;return!0}static isMobile(){let e=0,t=0;return document.body.clientWidth&&(e=document.body.clientWidth),document.body.clientHeight&&(t=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||e<350&&t<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){const e=navigator.userAgent.toLowerCase();return"micromessenger"===String(e.match(/MicroMessenger/i))}static isAndroid(){const e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isIEBrowser(){return this.getBrowserType().startsWith("IE")}static itCount(e){return t=>{for(let n=0;n<e;n++)t&&t()}}static hasLength(e,t){return!!C.isDefine(e)&&(C.isDefine(t)?e.length===t:e.length>0)}static capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}static fCamelCase(e,t){return t.toUpperCase()}static camelCase(e){return e.replace(b,"ms-").replace(_,this.fCamelCase)}static removeNull(e){if(this.isObject(e)){const t={};return Object.keys(e).forEach((t=>{const n=e[t];null==n?delete e[t]:C.removeNull(n)})),t}return e}static fillTwoDimensionalArray(e,t,n){return new Array(e).fill(n).map((e=>new Array(t).fill(n)))}static fillObjectMatrix(e,t,n){const r=new p;for(let s=0;s<e;s++)for(let e=0;e<t;e++)r.setValue(s,e,n);return r.getData()}static numToWord(e){let t="";for(;e>0;){let n=e%26;n=0===n?n=26:n,t=String.fromCharCode(96+n)+t,e=(e-n)/26}return t.toLocaleUpperCase()}static ABCatNum(e){if(null==e||0===e.length)return NaN;const t=e.toLowerCase().split(""),n=t.length;let r=0,s=0;for(let o=0;o<n;o++)s=t[o].charCodeAt(0)-96,r+=s*26**(n-o-1);return 0===r?NaN:r-1}static chatAtABC(e){const t="a".charCodeAt(0),n="z".charCodeAt(0)-t+1;let r="";for(;e>=0;)r=String.fromCharCode(e%n+t)+r,e=Math.floor(e/n)-1;return r.toUpperCase()}static randSort(e){for(let t=0,n=e.length;t<n;t++){const r=parseInt((Math.random()*n).toString()),s=e[r];e[r]=e[t],e[t]=s}return e}static commonExtend(e,t){let n={};for(let r in e)n[r]=e[r];for(let r in t)null!=t[r]&&(n[r]=t[r]);return n}static commonExtend1(e,t){for(let n in e)null==t[n]&&(t[n]=e[n]);return t}static arrayToObject(e){const t={};return e.forEach(((e,n)=>{t[n]={},e.forEach(((e,r)=>{t[n][r]=e}))})),t}}var T,w,y,S,E,R,I,A,x,O,M,N,k,L,D,P,B,H,F,z,U,W,V,j,Y,G,X,$,Q,K,Z,q,J,ee,te,ne,re,se,oe,ie,le,ae,ce,he,ue,de,ge,fe,me,pe,be,_e,ve,Ce,Te,we,ye,Se,Ee,Re,Ie,Ae,xe,Oe,Me,Ne,ke,Le,De,Pe,Be,He,Fe,ze,Ue,We,Ve,je,Ye,Ge,Xe,$e,Qe,Ke,Ze,qe,Je,et,tt,nt,rt,st,ot,it,lt,at,ct,ht,ut,dt,gt,ft,mt,pt,bt,_t,vt,Ct,Tt,wt,yt,St,Et,Rt,It,At;(w=T||(T={}))[w.TAB=0]="TAB",w[w.SPACE=1]="SPACE",w[w.NOTHING=2]="NOTHING",(S=y||(y={}))[S.GLYPH_TYPE_UNSPECIFIED=0]="GLYPH_TYPE_UNSPECIFIED",S[S.NONE=1]="NONE",S[S.DECIMAL=2]="DECIMAL",S[S.ZERO_DECIMAL=3]="ZERO_DECIMAL",S[S.UPPER_ALPHA=4]="UPPER_ALPHA",S[S.ALPHA=5]="ALPHA",S[S.UPPER_ROMAN=6]="UPPER_ROMAN",S[S.ROMAN=7]="ROMAN",(R=E||(E={}))[R.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",R[R.START=1]="START",R[R.CENTER=2]="CENTER",R[R.END=3]="END",(A=I||(I={}))[A.PARAGRAPH=0]="PARAGRAPH",A[A.TABLE=1]="TABLE",A[A.SECTION_BREAK=2]="SECTION_BREAK",A[A.CUSTOM=3]="CUSTOM",(O=x||(x={}))[O.DEFAULT=0]="DEFAULT",O[O.LINES=1]="LINES",O[O.LINES_AND_CHARS=2]="LINES_AND_CHARS",O[O.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",(N=M||(M={}))[N.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",N[N.CONTINUOUS=1]="CONTINUOUS",N[N.NEXT_PAGE=2]="NEXT_PAGE",N[N.EVEN_PAGE=3]="EVEN_PAGE",N[N.ODD_PAGE=4]="ODD_PAGE",(L=k||(k={}))[L.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",L[L.NONE=1]="NONE",L[L.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",(P=D||(D={}))[P.NORMAL=0]="NORMAL",P[P.TBRL=1]="TBRL",P[P.LRTBV=2]="LRTBV",(H=B||(B={}))[H.TEXT_RUN=0]="TEXT_RUN",H[H.AUTO_TEXT=1]="AUTO_TEXT",H[H.PAGE_BREAK=2]="PAGE_BREAK",H[H.COLUMN_BREAK=3]="COLUMN_BREAK",H[H.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",H[H.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",H[H.EQUATION=6]="EQUATION",H[H.DRAWING=7]="DRAWING",H[H.PERSON=8]="PERSON",H[H.RICH_LINK=9]="RICH_LINK",(z=F||(F={}))[z.BOTH_SIDES=0]="BOTH_SIDES",z[z.LEFT=1]="LEFT",z[z.RIGHT=2]="RIGHT",z[z.LARGEST=3]="LARGEST",(W=U||(U={}))[W.INLINE=0]="INLINE",W[W.WRAP_NONE=1]="WRAP_NONE",W[W.WRAP_POLYGON=2]="WRAP_POLYGON",W[W.WRAP_SQUARE=3]="WRAP_SQUARE",W[W.WRAP_THROUGH=4]="WRAP_THROUGH",W[W.WRAP_TIGHT=5]="WRAP_TIGHT",W[W.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",(j=V||(V={}))[j.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",j[j.NORMAL_TEXT=1]="NORMAL_TEXT",j[j.TITLE=2]="TITLE",j[j.SUBTITLE=3]="SUBTITLE",j[j.HEADING_1=4]="HEADING_1",j[j.HEADING_2=5]="HEADING_2",j[j.HEADING_3=6]="HEADING_3",j[j.HEADING_4=7]="HEADING_4",j[j.HEADING_5=8]="HEADING_5",j[j.HEADING_6=9]="HEADING_6",(G=Y||(Y={}))[G.AUTO=0]="AUTO",G[G.AT_LEAST=1]="AT_LEAST",G[G.EXACT=2]="EXACT",($=X||(X={}))[$.DASH_STYLE_UNSPECIFIED=0]="DASH_STYLE_UNSPECIFIED",$[$.SOLID=1]="SOLID",$[$.DOT=2]="DOT",$[$.DASH=3]="DASH",(K=Q||(Q={}))[K.TAB_STOP_ALIGNMENT_UNSPECIFIED=0]="TAB_STOP_ALIGNMENT_UNSPECIFIED",K[K.START=1]="START",K[K.CENTER=2]="CENTER",K[K.END=3]="END",(q=Z||(Z={})).EVENLY_DISTRIBUTED="0",q.FIXED_WIDTH="1",(ee=J||(J={}))[ee.CONTENT_ALIGNMENT_UNSPECIFIED=0]="CONTENT_ALIGNMENT_UNSPECIFIED",ee[ee.CONTENT_ALIGNMENT_UNSUPPORTED=1]="CONTENT_ALIGNMENT_UNSUPPORTED",ee[ee.TOP=2]="TOP",ee[ee.MIDDLE=3]="MIDDLE",ee[ee.BOTTOM=4]="BOTTOM",(ne=te||(te={})).NORMAL="normal",ne.BOLD="bold",ne.ITALIC="italic",(se=re||(re={}))[se.CHARACTER=0]="CHARACTER",se[se.COLUMN=1]="COLUMN",se[se.INSIDE_MARGIN=2]="INSIDE_MARGIN",se[se.LEFT_MARGIN=3]="LEFT_MARGIN",se[se.MARGIN=4]="MARGIN",se[se.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",se[se.PAGE=6]="PAGE",se[se.RIGHT_MARGIN=7]="RIGHT_MARGIN",(ie=oe||(oe={}))[ie.BOTTOM_MARGIN=0]="BOTTOM_MARGIN",ie[ie.INSIDE_MARGIN=1]="INSIDE_MARGIN",ie[ie.LINE=2]="LINE",ie[ie.MARGIN=3]="MARGIN",ie[ie.OUTSIDE_MARGIN=4]="OUTSIDE_MARGIN",ie[ie.PAGE=5]="PAGE",ie[ie.PARAGRAPH=6]="PARAGRAPH",ie[ie.TOP_MARGIN=7]="TOP_MARGIN",(ae=le||(le={}))[ae.POINT=0]="POINT",ae[ae.LINE=1]="LINE",ae[ae.CHARACTER=2]="CHARACTER",(he=ce||(ce={}))[he.CENTER=0]="CENTER",he[he.INSIDE=1]="INSIDE",he[he.LEFT=2]="LEFT",he[he.OUTSIDE=3]="OUTSIDE",he[he.RIGHT=4]="RIGHT",(de=ue||(ue={}))[de.BOTTOM=0]="BOTTOM",de[de.CENTER=1]="CENTER",de[de.INSIDE=2]="INSIDE",de[de.OUTSIDE=3]="OUTSIDE",de[de.TOP=4]="TOP",(fe=ge||(ge={}))[fe.compressPunctuation=0]="compressPunctuation",fe[fe.compressPunctuationAndJapaneseKana=1]="compressPunctuationAndJapaneseKana",fe[fe.doNotCompress=2]="doNotCompress",(pe=me||(me={}))[pe.PORTRAIT=0]="PORTRAIT",pe[pe.LANDSCAPE=1]="LANDSCAPE",(_e=be||(be={})).INSERT_ROW_DATA_ACTION="InsertRowDataAction",_e.REMOVE_ROW_DATA_ACTION="RemoveRowDataAction",_e.INSERT_ROW_ACTION="InsertRowAction",_e.REMOVE_ROW_ACTION="RemoveRowAction",_e.SET_RANGE_STYLE_ACTION="SetRangeStyleAction",_e.SET_SELECTION_ACTION="SetSelectionActivateAction",_e.SET_RANGE_DATA_ACTION="SetRangeDataAction",_e.SET_RANGE_FORMATTED_VALUE_ACTION="SetRangeFormattedValueAction",_e.SET_RANGE_NOTE_ACTION="SetRangeNoteAction",_e.DELETE_RANGE_ACTION="DeleteRangeAction",_e.INSERT_SHEET_ACTION="InsertSheetAction",_e.REMOVE_SHEET_ACTION="RemoveSheetAction",_e.CLEAR_RANGE_ACTION="ClearRangeAction",_e.INSERT_RANGE_ACTION="InsertRangeAction",_e.SET_TAB_COLOR_ACTION="SetTabColorAction",_e.HIDE_SHEET_ACTION="SetWorkSheetHideAction",_e.SET_WORKSHEET_ACTIVATE_ACTION="SetWorkSheetActivateAction",_e.INSERT_COLUMN_ACTION="InsertColumnAction",_e.INSERT_COLUMN_DATA_ACTION="InsertColumnDataAction",_e.REMOVE_COLUMN_ACTION="RemoveColumnAction",_e.REMOVE_COLUMN_DATA_ACTION="RemoveColumnDataAction",_e.SET_HIDE_ROW_ACTION="SetRowHideAction",_e.SET_HIDE_COLUMN_ACTION="SetColumnHideAction",_e.SET_SHOW_ROW_ACTION="SetRowShowAction",_e.SET_SHOW_COLUMN_ACTION="SetColumnShowAction",_e.ADD_MERGE_ACTION="AddMergeAction",_e.REMOVE_MERGE_ACTION="RemoveMergeAction",_e.SET_WORKSHEET_NAME_ACTION="SetWorkSheetNameAction",_e.SET_WORKSHEET_STATUS_ACTION="SetWorkSheetStatusAction",_e.SET_BORDER_ACTION="SetBorderAction",_e.SET_COLUMN_WIDTH_ACTION="SetColumnWidthAction",_e.SET_ROW_HEIGHT_ACTION="SetRowHeightAction",_e.SET_HIDDEN_GRIDLINES_ACTION="SetHiddenGridlinesAction",_e.SET_RIGHT_TO_LEFT_ACTION="SetRightToLeftAction",_e.DELETE_BANDING_ACTION="DeleteBandingAction",_e.SET_BANDING_ACTION="SetBandingAction",_e.ADD_BANDING_ACTION="AddBandingAction",_e.DELETE_NAMED_RANGE_ACTION="DeleteNamedRangeAction",_e.SET_NAMED_RANGE_ACTION="SetNamedRangeAction",_e.ADD_NAMED_RANGE_ACTION="AddNamedRangeAction",_e.SET_SHEET_ORDER_ACTION="SetSheetOrderAction",_e.SET_ZOOM_RATIO_ACTION="SetZoomRatioAction",_e.SET_FROZEN_COLUMNS_ACTION="SetFrozenColumnsAction",_e.SET_FROZEN_ROWS_ACTION="SetFrozenRowsAction",(Ce=ve||(ve={}))[Ce.DEFAULT_SERIES=0]="DEFAULT_SERIES",Ce[Ce.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",(we=Te||(Te={})).CELL_EMPTY="CELL_EMPTY",we.CELL_NOT_EMPTY="CELL_NOT_EMPTY",we.DATE_AFTER="DATE_AFTER",we.DATE_BEFORE="DATE_BEFORE",we.DATE_EQUAL_TO="DATE_EQUAL_TO",we.DATE_NOT_EQUAL_TO="DATE_NOT_EQUAL_TO",we.DATE_AFTER_RELATIVE="DATE_AFTER_RELATIVE",we.DATE_BEFORE_RELATIVE="DATE_BEFORE_RELATIVE",we.DATE_EQUAL_TO_RELATIVE="DATE_EQUAL_TO_RELATIVE",we.NUMBER_BETWEEN="NUMBER_BETWEEN",we.NUMBER_EQUAL_TO="NUMBER_EQUAL_TO",we.NUMBER_GREATER_THAN="NUMBER_GREATER_THAN",we.NUMBER_GREATER_THAN_OR_EQUAL_TO="NUMBER_GREATER_THAN_OR_EQUAL_TO",we.NUMBER_LESS_THAN="NUMBER_LESS_THAN",we.NUMBER_LESS_THAN_OR_EQUAL_TO="NUMBER_LESS_THAN_OR_EQUAL_TO",we.NUMBER_NOT_BETWEEN="NUMBER_NOT_BETWEEN",we.NUMBER_NOT_EQUAL_TO="NUMBER_NOT_EQUAL_TO",we.TEXT_CONTAINS="TEXT_CONTAINS",we.TEXT_DOES_NOT_CONTAIN="TEXT_DOES_NOT_CONTAIN",we.TEXT_EQUAL_TO="TEXT_EQUAL_TO",we.TEXT_NOT_EQUAL_TO="TEXT_NOT_EQUAL_TO",we.TEXT_STARTS_WITH="TEXT_STARTS_WITH",we.TEXT_ENDS_WITH="TEXT_ENDS_WITH",we.CUSTOM_FORMULA="CUSTOM_FORMULA",(Se=ye||(ye={}))[Se.NONE=0]="NONE",Se[Se.THIN=1]="THIN",Se[Se.HAIR=2]="HAIR",Se[Se.DOTTED=3]="DOTTED",Se[Se.DASHED=4]="DASHED",Se[Se.DASH_DOT=5]="DASH_DOT",Se[Se.DASH_DOT_DOT=6]="DASH_DOT_DOT",Se[Se.DOUBLE=7]="DOUBLE",Se[Se.MEDIUM=8]="MEDIUM",Se[Se.MEDIUM_DASHED=9]="MEDIUM_DASHED",Se[Se.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",Se[Se.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",Se[Se.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",Se[Se.THICK=13]="THICK",(Re=Ee||(Ee={})).TOP="top",Re.BOTTOM="bottom",Re.LEFT="left",Re.RIGHT="right",Re.NONE="none",Re.ALL="all",Re.OUTSIDE="outside",Re.INSIDE="inside",Re.HORIZONTAL="horizontal",Re.VERTICAL="vertical",(Ae=Ie||(Ie={}))[Ae.UNSUPPORTED=0]="UNSUPPORTED",Ae[Ae.RGB=1]="RGB",Ae[Ae.HEX=2]="HEX",Ae[Ae.THEME=3]="THEME",(Oe=xe||(xe={}))[Oe.ON=0]="ON",Oe[Oe.OFF=1]="OFF",(Ne=Me||(Me={}))[Ne.CONDITION_TYPE_UNSPECIFIED=0]="CONDITION_TYPE_UNSPECIFIED",Ne[Ne.NUMNUMBER_BETWEENR_GREATER=1]="NUMNUMBER_BETWEENR_GREATER",Ne[Ne.NUMBER_GREATER_THAN_EQ=2]="NUMBER_GREATER_THAN_EQ",Ne[Ne.NUMBER_LESS=3]="NUMBER_LESS",Ne[Ne.NUMBER_LESS_THAN_EQ=4]="NUMBER_LESS_THAN_EQ",Ne[Ne.NUMBER_EQ=5]="NUMBER_EQ",Ne[Ne.NUMBER_NOT_EQ=6]="NUMBER_NOT_EQ",Ne[Ne.NUMBER_BETWEEN=7]="NUMBER_BETWEEN",Ne[Ne.NUMBER_NOT_BETWEEN=8]="NUMBER_NOT_BETWEEN",Ne[Ne.TEXT_CONTAINS=9]="TEXT_CONTAINS",Ne[Ne.TEXT_NOT_CONTAINS=10]="TEXT_NOT_CONTAINS",Ne[Ne.TEXT_STARTS_WITH=11]="TEXT_STARTS_WITH",Ne[Ne.TEXT_ENDS_WITH=12]="TEXT_ENDS_WITH",Ne[Ne.TEXT_EQ=13]="TEXT_EQ",Ne[Ne.TEXT_IS_EMAIL=14]="TEXT_IS_EMAIL",Ne[Ne.TEXT_IS_URL=15]="TEXT_IS_URL",Ne[Ne.DATE_EQ=16]="DATE_EQ",Ne[Ne.DATE_BEFORE=17]="DATE_BEFORE",Ne[Ne.DATE_AFTER=18]="DATE_AFTER",Ne[Ne.DATE_ON_OR_BEFORE=19]="DATE_ON_OR_BEFORE",Ne[Ne.DATE_ON_OR_AFTER=20]="DATE_ON_OR_AFTER",Ne[Ne.DATE_BETWEEN=21]="DATE_BETWEEN",Ne[Ne.DATE_NOT_BETWEEN=22]="DATE_NOT_BETWEEN",Ne[Ne.DATE_IS_VALID=23]="DATE_IS_VALID",Ne[Ne.ONE_OF_RANGE=24]="ONE_OF_RANGE",Ne[Ne.ONE_OF_LIST=25]="ONE_OF_LIST",Ne[Ne.BLANK=26]="BLANK",Ne[Ne.NOT_BLANK=27]="NOT_BLANK",Ne[Ne.CUSTOM_FORMULA=28]="CUSTOM_FORMULA",Ne[Ne.BOOLEAN=29]="BOOLEAN",Ne[Ne.TEXT_NOT_EQ=30]="TEXT_NOT_EQ",Ne[Ne.DATE_NOT_EQ=31]="DATE_NOT_EQ",(Le=ke||(ke={}))[Le.PASTE_NORMAL=0]="PASTE_NORMAL",Le[Le.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",Le[Le.PASTE_FORMAT=2]="PASTE_FORMAT",Le[Le.PASTE_FORMULA=3]="PASTE_FORMULA",Le[Le.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",Le[Le.PASTE_VALUES=5]="PASTE_VALUES",Le[Le.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",Le[Le.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",(Pe=De||(De={}))[Pe.DOCUMENT=0]="DOCUMENT",Pe[Pe.PROJECT=1]="PROJECT",(He=Be||(Be={}))[He.COLUMNS=0]="COLUMNS",He[He.ROWS=1]="ROWS",(ze=Fe||(Fe={}))[ze.LEFT=0]="LEFT",ze[ze.RIGHT=1]="RIGHT",ze[ze.TOP=2]="TOP",ze[ze.BOTTOM=3]="BOTTOM",(We=Ue||(Ue={}))[We.NUMBER_FORMAT_TYPE_UNSPECIFIED=0]="NUMBER_FORMAT_TYPE_UNSPECIFIED",We[We.TEXT=1]="TEXT",We[We.NUMBER=2]="NUMBER",We[We.PERCENT=3]="PERCENT",We[We.CURRENCY=4]="CURRENCY",We[We.DATE=5]="DATE",We[We.TIME=6]="TIME",We[We.DATE_TIME=7]="DATE_TIME",We[We.SCIENTIFIC=8]="SCIENTIFIC",(je=Ve||(Ve={}))[je.INTERPOLATION_POINT_TYPE_UNSPECIFIED=0]="INTERPOLATION_POINT_TYPE_UNSPECIFIED",je[je.MIN=1]="MIN",je[je.MAX=2]="MAX",je[je.NUMBER=3]="NUMBER",je[je.PERCENT=4]="PERCENT",je[je.PERCENTILE=5]="PERCENTILE",(Ge=Ye||(Ye={}))[Ge.BACKSPACE=8]="BACKSPACE",Ge[Ge.TAB=9]="TAB",Ge[Ge.ENTER=13]="ENTER",Ge[Ge.SHIFT=16]="SHIFT",Ge[Ge.CTRL=17]="CTRL",Ge[Ge.PAUSE=19]="PAUSE",Ge[Ge.CAPS_LOCK=20]="CAPS_LOCK",Ge[Ge.ESC=27]="ESC",Ge[Ge.SPACE=33]="SPACE",Ge[Ge.PAGE_UP=33]="PAGE_UP",Ge[Ge.PAGE_DOWN=34]="PAGE_DOWN",Ge[Ge.END=35]="END",Ge[Ge.HOME=36]="HOME",Ge[Ge.LEFT=37]="LEFT",Ge[Ge.UP=38]="UP",Ge[Ge.RIGHT=39]="RIGHT",Ge[Ge.DOWN=40]="DOWN",Ge[Ge.INSERT=45]="INSERT",Ge[Ge.DELETE=46]="DELETE",Ge[Ge.WIN=91]="WIN",Ge[Ge.WIN_R=92]="WIN_R",Ge[Ge.MENU=93]="MENU",Ge[Ge.F1=112]="F1",Ge[Ge.F2=113]="F2",Ge[Ge.F3=114]="F3",Ge[Ge.F4=115]="F4",Ge[Ge.F5=116]="F5",Ge[Ge.F6=117]="F6",Ge[Ge.F7=118]="F7",Ge[Ge.F8=119]="F8",Ge[Ge.F9=120]="F9",Ge[Ge.F10=121]="F10",Ge[Ge.F11=122]="F11",Ge[Ge.F12=123]="F12",Ge[Ge.NUM_LOCK=144]="NUM_LOCK",Ge[Ge.SCROLL_LOCK=145]="SCROLL_LOCK",($e=Xe||(Xe={})).backspace="Backspace",$e.delete="Delete",(Ke=Qe||(Qe={})).EN="en",Ke.ZH="zh",(qe=Ze||(Ze={}))[qe.RANGE=0]="RANGE",qe[qe.SHEET=1]="SHEET",(et=Je||(Je={}))[et.RELATIVE_DATE_UNSPECIFIED=0]="RELATIVE_DATE_UNSPECIFIED",et[et.PAST_YEAR=1]="PAST_YEAR",et[et.PAST_MONTH=2]="PAST_MONTH",et[et.PAST_WEEK=3]="PAST_WEEK",et[et.YESTERDAY=4]="YESTERDAY",et[et.TODAY=5]="TODAY",et[et.TOMORROW=6]="TOMORROW",(nt=tt||(tt={}))[nt.GRID=0]="GRID",nt[nt.KANBAN=1]="KANBAN",nt[nt.GANTT=2]="GANTT",(st=rt||(rt={}))[st.UNSPECIFIED=0]="UNSPECIFIED",st[st.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",st[st.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",(it=ot||(ot={}))[it.DASH=0]="DASH",it[it.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",it[it.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",it[it.DASHED_HEAVY=3]="DASHED_HEAVY",it[it.DASH_LONG=4]="DASH_LONG",it[it.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",it[it.DOT_DASH=6]="DOT_DASH",it[it.DOT_DOT_DASH=7]="DOT_DOT_DASH",it[it.DOTTED=8]="DOTTED",it[it.DOTTED_HEAVY=9]="DOTTED_HEAVY",it[it.DOUBLE=10]="DOUBLE",it[it.NONE=11]="NONE",it[it.SINGLE=12]="SINGLE",it[it.THICK=13]="THICK",it[it.WAVE=14]="WAVE",it[it.WAVY_DOUBLE=15]="WAVY_DOUBLE",it[it.WAVY_HEAVY=16]="WAVY_HEAVY",it[it.WORDS=17]="WORDS",(at=lt||(lt={}))[at.UNSPECIFIED=0]="UNSPECIFIED",at[at.LEFT=1]="LEFT",at[at.CENTER=2]="CENTER",at[at.RIGHT=3]="RIGHT",at[at.JUSTIFIED=4]="JUSTIFIED",(ht=ct||(ct={}))[ht.UNSPECIFIED=0]="UNSPECIFIED",ht[ht.TOP=1]="TOP",ht[ht.MIDDLE=2]="MIDDLE",ht[ht.BOTTOM=3]="BOTTOM",(dt=ut||(ut={}))[dt.UNSPECIFIED=0]="UNSPECIFIED",dt[dt.OVERFLOW=1]="OVERFLOW",dt[dt.CLIP=2]="CLIP",dt[dt.WRAP=3]="WRAP",(ft=gt||(gt={}))[ft.NORMAL=0]="NORMAL",ft[ft.ITALIC=1]="ITALIC",(pt=mt||(mt={}))[pt.NORMAL=0]="NORMAL",pt[pt.BOLD=1]="BOLD",(_t=bt||(bt={}))[_t.NORMAL=0]="NORMAL",_t[_t.SUBSCRIPT=1]="SUBSCRIPT",_t[_t.SUPERSCRIPT=2]="SUPERSCRIPT",(Ct=vt||(vt={}))[Ct.FALSE=0]="FALSE",Ct[Ct.TRUE=1]="TRUE",(wt=Tt||(Tt={}))[wt.STRING=0]="STRING",wt[wt.NUMBER=1]="NUMBER",wt[wt.BOOLEAN=2]="BOOLEAN",wt[wt.FORCE_STRING=3]="FORCE_STRING",(St=yt||(yt={}))[St.DARK1=0]="DARK1",St[St.LIGHT1=1]="LIGHT1",St[St.DARK2=2]="DARK2",St[St.LIGHT2=3]="LIGHT2",St[St.ACCENT1=4]="ACCENT1",St[St.ACCENT2=5]="ACCENT2",St[St.ACCENT3=6]="ACCENT3",St[St.ACCENT4=7]="ACCENT4",St[St.ACCENT5=8]="ACCENT5",St[St.ACCENT6=9]="ACCENT6",St[St.HYPERLINK=10]="HYPERLINK",St[St.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",(Rt=Et||(Et={})).OFFICE="Office",Rt.OFFICE_2007_2010="Office 2007-2010",Rt.GRAYSCALE="Grayscale",Rt.BLUE_WARM="Blue Warm",Rt.BLUE="Blue",Rt.BLUE_II="Blue II",Rt.BLUE_GREEN="Blue Green",Rt.GREEN="Green",Rt.GREEN_YELLOW="Green Yellow",Rt.YELLOW="Yellow",Rt.YELLOW_ORANGE="Yellow Orange",Rt.ORANGE="Orange",Rt.ORANGE_RED="Orange Red",Rt.RED_ORANGE="Red Orange",Rt.RED="Red",Rt.RED_VIOLET="Red Violet",Rt.VIOLET="Violet",Rt.VIOLET_II="Violet II",Rt.MEDIAN="Median",Rt.PAPER="Paper",Rt.MARQUEE="Marquee",Rt.SLIPSTREAM="Slipstream",Rt.Aspect="Aspect",(At=It||(It={}))[At.TYPE_UNSPECIFIED=0]="TYPE_UNSPECIFIED",At[At.TEXT_BOX=1]="TEXT_BOX",At[At.RECTANGLE=2]="RECTANGLE",At[At.ROUND_RECTANGLE=3]="ROUND_RECTANGLE",At[At.ELLIPSE=4]="ELLIPSE",At[At.ARC=5]="ARC",At[At.BENT_ARROW=6]="BENT_ARROW",At[At.BENT_UP_ARROW=7]="BENT_UP_ARROW",At[At.BEVEL=8]="BEVEL",At[At.BLOCK_ARC=9]="BLOCK_ARC",At[At.BRACE_PAIR=10]="BRACE_PAIR",At[At.BRACKET_PAIR=11]="BRACKET_PAIR",At[At.CAN=12]="CAN",At[At.CHEVRON=13]="CHEVRON",At[At.CHORD=14]="CHORD",At[At.CLOUD=15]="CLOUD",At[At.CORNER=16]="CORNER",At[At.CUBE=17]="CUBE",At[At.CURVED_DOWN_ARROW=18]="CURVED_DOWN_ARROW",At[At.CURVED_LEFT_ARROW=19]="CURVED_LEFT_ARROW",At[At.CURVED_RIGHT_ARROW=20]="CURVED_RIGHT_ARROW",At[At.CURVED_UP_ARROW=21]="CURVED_UP_ARROW",At[At.DECAGON=22]="DECAGON",At[At.DIAGONAL_STRIPE=23]="DIAGONAL_STRIPE",At[At.DIAMOND=24]="DIAMOND",At[At.DODECAGON=25]="DODECAGON",At[At.DONUT=26]="DONUT",At[At.DOUBLE_WAVE=27]="DOUBLE_WAVE",At[At.DOWN_ARROW=28]="DOWN_ARROW",At[At.DOWN_ARROW_CALLOUT=29]="DOWN_ARROW_CALLOUT",At[At.FOLDED_CORNER=30]="FOLDED_CORNER",At[At.FRAME=31]="FRAME",At[At.HALF_FRAME=32]="HALF_FRAME",At[At.HEART=33]="HEART",At[At.HEPTAGON=34]="HEPTAGON",At[At.HEXAGON=35]="HEXAGON",At[At.HOME_PLATE=36]="HOME_PLATE",At[At.HORIZONTAL_SCROLL=37]="HORIZONTAL_SCROLL",At[At.IRREGULAR_SEAL_1=38]="IRREGULAR_SEAL_1",At[At.IRREGULAR_SEAL_2=39]="IRREGULAR_SEAL_2",At[At.LEFT_ARROW=40]="LEFT_ARROW",At[At.LEFT_ARROW_CALLOUT=41]="LEFT_ARROW_CALLOUT",At[At.LEFT_BRACE=42]="LEFT_BRACE",At[At.LEFT_BRACKET=43]="LEFT_BRACKET",At[At.LEFT_RIGHT_ARROW=44]="LEFT_RIGHT_ARROW",At[At.LEFT_RIGHT_ARROW_CALLOUT=45]="LEFT_RIGHT_ARROW_CALLOUT",At[At.LEFT_RIGHT_UP_ARROW=46]="LEFT_RIGHT_UP_ARROW",At[At.LEFT_UP_ARROW=47]="LEFT_UP_ARROW",At[At.LIGHTNING_BOLT=48]="LIGHTNING_BOLT",At[At.MATH_DIVIDE=49]="MATH_DIVIDE",At[At.MATH_EQUAL=50]="MATH_EQUAL",At[At.MATH_MINUS=51]="MATH_MINUS",At[At.MATH_MULTIPLY=52]="MATH_MULTIPLY",At[At.MATH_NOT_EQUAL=53]="MATH_NOT_EQUAL",At[At.MATH_PLUS=54]="MATH_PLUS",At[At.MOON=55]="MOON",At[At.NO_SMOKING=56]="NO_SMOKING",At[At.NOTCHED_RIGHT_ARROW=57]="NOTCHED_RIGHT_ARROW",At[At.OCTAGON=58]="OCTAGON",At[At.PARALLELOGRAM=59]="PARALLELOGRAM",At[At.PENTAGON=60]="PENTAGON",At[At.PIE=61]="PIE",At[At.PLAQUE=62]="PLAQUE",At[At.PLUS=63]="PLUS",At[At.QUAD_ARROW=64]="QUAD_ARROW",At[At.QUAD_ARROW_CALLOUT=65]="QUAD_ARROW_CALLOUT",At[At.RIBBON=66]="RIBBON",At[At.RIBBON_2=67]="RIBBON_2",At[At.RIGHT_ARROW=68]="RIGHT_ARROW",At[At.RIGHT_ARROW_CALLOUT=69]="RIGHT_ARROW_CALLOUT",At[At.RIGHT_BRACE=70]="RIGHT_BRACE",At[At.RIGHT_BRACKET=71]="RIGHT_BRACKET",At[At.ROUND_1_RECTANGLE=72]="ROUND_1_RECTANGLE",At[At.ROUND_2_DIAGONAL_RECTANGLE=73]="ROUND_2_DIAGONAL_RECTANGLE",At[At.ROUND_2_SAME_RECTANGLE=74]="ROUND_2_SAME_RECTANGLE",At[At.RIGHT_TRIANGLE=75]="RIGHT_TRIANGLE",At[At.SMILEY_FACE=76]="SMILEY_FACE",At[At.SNIP_1_RECTANGLE=77]="SNIP_1_RECTANGLE",At[At.SNIP_2_DIAGONAL_RECTANGLE=78]="SNIP_2_DIAGONAL_RECTANGLE",At[At.SNIP_2_SAME_RECTANGLE=79]="SNIP_2_SAME_RECTANGLE",At[At.SNIP_ROUND_RECTANGLE=80]="SNIP_ROUND_RECTANGLE",At[At.STAR_10=81]="STAR_10",At[At.STAR_12=82]="STAR_12",At[At.STAR_16=83]="STAR_16",At[At.STAR_24=84]="STAR_24",At[At.STAR_32=85]="STAR_32",At[At.STAR_4=86]="STAR_4",At[At.STAR_5=87]="STAR_5",At[At.STAR_6=88]="STAR_6",At[At.STAR_7=89]="STAR_7",At[At.STAR_8=90]="STAR_8",At[At.STRIPED_RIGHT_ARROW=91]="STRIPED_RIGHT_ARROW",At[At.SUN=92]="SUN",At[At.TRAPEZOID=93]="TRAPEZOID",At[At.TRIANGLE=94]="TRIANGLE",At[At.UP_ARROW=95]="UP_ARROW",At[At.UP_ARROW_CALLOUT=96]="UP_ARROW_CALLOUT",At[At.UP_DOWN_ARROW=97]="UP_DOWN_ARROW",At[At.UTURN_ARROW=98]="UTURN_ARROW",At[At.VERTICAL_SCROLL=99]="VERTICAL_SCROLL",At[At.WAVE=100]="WAVE",At[At.WEDGE_ELLIPSE_CALLOUT=101]="WEDGE_ELLIPSE_CALLOUT",At[At.WEDGE_RECTANGLE_CALLOUT=102]="WEDGE_RECTANGLE_CALLOUT",At[At.WEDGE_ROUND_RECTANGLE_CALLOUT=103]="WEDGE_ROUND_RECTANGLE_CALLOUT",At[At.FLOW_CHART_ALTERNATE_PROCESS=104]="FLOW_CHART_ALTERNATE_PROCESS",At[At.FLOW_CHART_COLLATE=105]="FLOW_CHART_COLLATE",At[At.FLOW_CHART_CONNECTOR=106]="FLOW_CHART_CONNECTOR",At[At.FLOW_CHART_DECISION=107]="FLOW_CHART_DECISION",At[At.FLOW_CHART_DELAY=108]="FLOW_CHART_DELAY",At[At.FLOW_CHART_DISPLAY=109]="FLOW_CHART_DISPLAY",At[At.FLOW_CHART_DOCUMENT=110]="FLOW_CHART_DOCUMENT",At[At.FLOW_CHART_EXTRACT=111]="FLOW_CHART_EXTRACT",At[At.FLOW_CHART_INPUT_OUTPUT=112]="FLOW_CHART_INPUT_OUTPUT",At[At.FLOW_CHART_INTERNAL_STORAGE=113]="FLOW_CHART_INTERNAL_STORAGE",At[At.FLOW_CHART_MAGNETIC_DISK=114]="FLOW_CHART_MAGNETIC_DISK",At[At.FLOW_CHART_MAGNETIC_DRUM=115]="FLOW_CHART_MAGNETIC_DRUM",At[At.FLOW_CHART_MAGNETIC_TAPE=116]="FLOW_CHART_MAGNETIC_TAPE",At[At.FLOW_CHART_MANUAL_INPUT=117]="FLOW_CHART_MANUAL_INPUT",At[At.FLOW_CHART_MANUAL_OPERATION=118]="FLOW_CHART_MANUAL_OPERATION",At[At.FLOW_CHART_MERGE=119]="FLOW_CHART_MERGE",At[At.FLOW_CHART_MULTIDOCUMENT=120]="FLOW_CHART_MULTIDOCUMENT",At[At.FLOW_CHART_OFFLINE_STORAGE=121]="FLOW_CHART_OFFLINE_STORAGE",At[At.FLOW_CHART_OFFPAGE_CONNECTOR=122]="FLOW_CHART_OFFPAGE_CONNECTOR",At[At.FLOW_CHART_ONLINE_STORAGE=123]="FLOW_CHART_ONLINE_STORAGE",At[At.FLOW_CHART_OR=124]="FLOW_CHART_OR",At[At.FLOW_CHART_PREDEFINED_PROCESS=125]="FLOW_CHART_PREDEFINED_PROCESS",At[At.FLOW_CHART_PREPARATION=126]="FLOW_CHART_PREPARATION",At[At.FLOW_CHART_PROCESS=127]="FLOW_CHART_PROCESS",At[At.FLOW_CHART_PUNCHED_CARD=128]="FLOW_CHART_PUNCHED_CARD",At[At.FLOW_CHART_PUNCHED_TAPE=129]="FLOW_CHART_PUNCHED_TAPE",At[At.FLOW_CHART_SORT=130]="FLOW_CHART_SORT",At[At.FLOW_CHART_SUMMING_JUNCTION=131]="FLOW_CHART_SUMMING_JUNCTION",At[At.FLOW_CHART_TERMINATOR=132]="FLOW_CHART_TERMINATOR",At[At.ARROW_EAST=133]="ARROW_EAST",At[At.ARROW_NORTH_EAST=134]="ARROW_NORTH_EAST",At[At.ARROW_NORTH=135]="ARROW_NORTH",At[At.SPEECH=136]="SPEECH",At[At.STARBURST=137]="STARBURST",At[At.TEARDROP=138]="TEARDROP",At[At.ELLIPSE_RIBBON=139]="ELLIPSE_RIBBON",At[At.ELLIPSE_RIBBON_2=140]="ELLIPSE_RIBBON_2",At[At.CLOUD_CALLOUT=141]="CLOUD_CALLOUT",At[At.CUSTOM=142]="CUSTOM";const xt={sheetId:"",rangeData:{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}},Ot={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1},Mt={startRow:0,startColumn:0,endRow:0,endColumn:0},Nt={row:0,column:0},kt={extensions:[],id:"",sheetOrder:[],socketEnable:vt.FALSE,socketUrl:"",name:"",timeZone:"",appVersion:"",theme:"",skin:"",locale:Qe.EN,creator:"",styles:{},sheets:{},lastModifiedBy:"",createdTime:"",modifiedTime:"",pluginMeta:{},namedRanges:[]},Lt={type:tt.GRID,name:"Sheet1",id:"sheet-01",tabColor:"",hidden:vt.FALSE,freezeColumn:-1,rowCount:1e3,columnCount:100,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:73,defaultRowHeight:19,mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},status:vt.FALSE,showGridlines:vt.TRUE,rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A1"],rightToLeft:vt.FALSE,pluginMeta:{}},Dt={ff:"Times New Roman",fs:14,it:vt.FALSE,bl:vt.FALSE,ul:{s:vt.FALSE},st:{s:vt.FALSE},ol:{s:vt.FALSE},tr:{a:0,v:vt.FALSE},td:rt.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:lt.UNSPECIFIED,vt:ct.UNSPECIFIED,tb:ut.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0}},Pt={id:"default_doc",documentStyle:{}},Bt={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}};var Ht,Ft;(Ft=Ht||(Ht={})).ARRAY_CONVERTOR="ARRAY_CONVERTOR",Ft.MATRIX_CONVERTOR="MATRIX_CONVERTOR";const zt={modifier:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock"],legacyModifier:["Hyper","Super"],whiteSpace:["Enter","Tab"],navigation:["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp"],editing:["Backspace","Clear","Copy","CrSel","Cut","Delete","EraseEof","ExSel","Insert","Paste","Redo","Undo"],ui:["Accept","Again","Attn","Cancel","ContextMenu","Escape","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut"],device:["BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp"],imeCompositionKeys:["AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate"],koreanSpecific:["HangulMode","HanjaMode","JunjaMode"],japaneseSpecific:["Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku"],commonFunction:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4"],multimedia:["ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck"],multimediaNumpad:["Key11","Key12"],audio:["AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute"],speech:["SpeechCorrectionList","SpeechInputToggle"],application:["LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor"],browser:["BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop"],mobilePhone:["AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial"],tv:["TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer"],mediaControls:["AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle"]};var Ut,Wt;(Wt=Ut||(Ut={})).BASE_COMPONENT="baseComponent",Wt.BASE_RENDER="renderEngine",Wt.SPREADSHEET="spreadsheet",Wt.DOCUMENT="document",Wt.SLIDE="slide";const Vt={[Et.OFFICE]:{[yt.ACCENT1]:"#4472C4",[yt.ACCENT2]:"#ED7D31",[yt.ACCENT3]:"#A5A5A5",[yt.ACCENT4]:"#70AD47",[yt.ACCENT5]:"#5B9BD5",[yt.ACCENT6]:"#70AD47",[yt.DARK1]:"#000000",[yt.DARK2]:"#44546A",[yt.LIGHT1]:"#FFFFFF",[yt.LIGHT2]:"#E7E6E6",[yt.HYPERLINK]:"#0563C1",[yt.FOLLOWED_HYPERLINK]:"#954F72"}},jt={namedRangeId:"named-range-01",name:"namedRange01",range:{sheetId:"sheet-01",rangeData:Mt}};var Yt,Gt,Xt,$t,Qt,Kt;(Gt=Yt||(Yt={}))[Gt.SLIDE=0]="SLIDE",Gt[Gt.MASTER=1]="MASTER",Gt[Gt.LAYOUT=2]="LAYOUT",Gt[Gt.HANDOUT_MASTER=3]="HANDOUT_MASTER",Gt[Gt.NOTES_MASTER=4]="NOTES_MASTER",($t=Xt||(Xt={}))[$t.SHAPE=0]="SHAPE",$t[$t.IMAGE=1]="IMAGE",$t[$t.TEXT=2]="TEXT",$t[$t.SPREADSHEET=3]="SPREADSHEET",$t[$t.DOCUMENT=4]="DOCUMENT",$t[$t.SLIDE=5]="SLIDE",(Kt=Qt||(Qt={}))[Kt.RELATIVE_SLIDE_LINK_UNSPECIFIED=0]="RELATIVE_SLIDE_LINK_UNSPECIFIED",Kt[Kt.NEXT_SLIDE=1]="NEXT_SLIDE",Kt[Kt.PREVIOUS_SLIDE=2]="PREVIOUS_SLIDE",Kt[Kt.FIRST_SLIDE=3]="FIRST_SLIDE",Kt[Kt.LAST_SLIDE=4]="LAST_SLIDE";class Zt{constructor(){this._colorType=Ie.UNSUPPORTED,this._themeColors=Et.OFFICE,this._themeTint=0}asRgbColor(){return new tn(this._rgbValue,this)}asThemeColor(){return new rn(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case Ie.THEME:return this.asThemeColor();case Ie.RGB:return this.asRgbColor();case Ie.UNSUPPORTED:throw Error("unsupported color type")}}setRgbColor(e){return this._colorType=Ie.RGB,this._rgbValue=e,this}setThemeColors(e){this._colorType=Ie.THEME,this._themeColors=e}setThemeTint(e){this._colorType=Ie.THEME,this._themeTint=e}setThemeColor(e){return this._colorType=Ie.THEME,this._themeValue=e,this}getColorType(){return this._colorType}}class qt{constructor(e){this._builder=e}static rgbColorToHexValue(e){return`#${((1<<24)+(e.getRed()<<16)+(e.getGreen()<<8)+e.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(e){e?e.indexOf("#")>-1&&(e=e.substring(1)):e="#000000";let t=+`0x${e[0]}${e[1]}`,n=+`0x${e[2]}${e[3]}`,r=+`0x${e[4]}${e[5]}`;return(new Zt).setRgbColor(`rgb(${t},${n},${r})`).asRgbColor()}static hexToRgbString(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((e,t,n,r)=>t+t+n+n+r+r));const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);let n=null;if(t){n=`rgba(${parseInt(t[1],16)},${parseInt(t[2],16)},${parseInt(t[3],16)})`}return n}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new qt(this._builder)}equals(e){return!1}}class Jt{constructor(e){const t=e.getRed()/255,n=e.getGreen()/255,r=e.getBlue()/255,s=e.getAlpha()/255,o=Math.min(t,Math.min(n,r)),i=Math.max(t,Math.max(n,r)),l=i-o;if(i===o)return this._hue=0,this._saturation=0,void(this._lightness=i);this._lightness=(o+i)/2,this._lightness<.5?this._saturation=l/(i+o):this._saturation=l/(2-i-o),t===i&&(this._hue=(n-r)/l),n===i&&(this._hue=2+(r-t)/l),r===i&&(this._hue=4+(t-n)/l),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=s}asRgbColor(){const e=new Zt;if(0===this._saturation)return e.setRgbColor(`rgba(${255*this._lightness},${255*this._lightness},${255*this._lightness},${255*this._alpha})`),e.asRgbColor();let t;t=this._lightness<.5?this._lightness*(1+this._saturation):this._lightness+this._saturation-this._lightness*this._saturation;const n=2*this._lightness-t,r=this._hue/360,s=r+1/3,o=this.setColor(t,n,s),i=this.setColor(t,n,r),l=r-1/3,a=this.setColor(t,n,l);return e.setRgbColor(`rgba(${Math.round(255*o)},${Math.round(255*i)},${Math.round(255*a)},${255*this._alpha})`),e.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(e,t,n){let r;return n<0&&(n+=1),n>1&&(n-=1),r=6*n<1?t+6*(e-t)*n:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t,r}setLightness(e){this._lightness=e}}const en=class extends qt{constructor(e,t){super(t);let n=e.match(en.RGBA_EXTRACT);if(n){const t=+n[1],r=+n[2],s=+n[3],o=+n[4];return this._cssString=e,this._red=t,this._green=r,this._blue=s,void(this._alpha=o)}if(n=e.match(en.RGB_EXTRACT),n){const t=+n[1],r=+n[2],s=+n[3];return this._cssString=e,this._red=t,this._green=r,this._blue=s,void(this._alpha=1)}throw new Error("Invalid rgba or rgb color")}asHexString(){return qt.rgbColorToHexValue(this)}getRed(){let e=this._red+en.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getGreen(){let e=this._green+en.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getBlue(){let e=this._blue+en.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getAlpha(){return this._alpha}getColorType(){return Ie.RGB}clone(){return new en(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(e){return e instanceof en&&(e._red===this._red&&e._blue===this._blue&&e._green===this._green&&e._alpha===this._alpha)}getCssString(){return this._cssString}};let tn=en;tn.RGB_COLOR_AMT=0,tn.RGBA_EXTRACT=new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*"),tn.RGB_EXTRACT=new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*");const nn=class extends qt{constructor(e,t,n,r){super(r),this._themeColorType=e,this._themeTint=t,this._themeColors=n}lumValue(e,t){if(null==e)return t;let n;return n=e<0?t*(1+e):t*(1-e)+(255-255*(1-e)),n}asRgbColor(){const e=Vt[this._themeColors];if(null==e)throw new Error("not find themeColors type");const t=e.get(this._themeColorType);if(null==t)throw new Error("not find themeColors value");let n;if(nn._cacheThemeColor.has(this._themeColors)){if(n=nn._cacheThemeColor.get(this._themeColors),n.has(this._themeColorType))return n.get(this._themeColorType)}else n=new Map,nn._cacheThemeColor.set(this._themeColors,n);const r=new Jt(qt.hexValueToRgbColor(t));r.setLightness(this.lumValue(this._themeTint,255*r.getLightness())/255);const s=r.asRgbColor();return n.set(this._themeColorType,s),s}clone(){return new nn(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(e){return e instanceof nn&&e._themeColorType===this._themeColorType}getColorType(){return Ie.THEME}getThemeColorType(){return this._themeColorType}};let rn=nn;rn._cacheThemeColor=new Map;class sn{constructor(e,t){this._workSheet=e,this._columnData=new f(t)}getColumnData(){return this._columnData}getColumnDatas(e,t){const n=new f;for(let r=e;r<e+t;r++){const e=this.getColumnOrCreate(r);n.push(e)}return n}getSize(){return this._columnData.getLength()}getColumnWidth(...e){const{_workSheet:t}=this,{_columnData:n}=this,r=t.getConfig();let s=0;if(1===e.length){s=n.obtain(e[0],{hd:vt.FALSE,w:r.defaultColumnWidth}).w}else if(2===e.length)for(let o=e[0];o<e[0]+e[1];o++){s+=n.obtain(o,{hd:vt.FALSE,w:r.defaultColumnWidth}).w}return s}setColumnWidth(e,t){const n=this._workSheet.getContext(),r=this._workSheet.getCommandManager(),s={sheetId:this._workSheet.getSheetId(),actionName:be.SET_COLUMN_WIDTH_ACTION,columnIndex:e,columnWidth:t},o=new Wr({WorkBookUnit:n.getWorkBook()},s);r.invoke(o)}getColumn(e){const t=this._columnData.get(e);if(t)return t}getColumnOrCreate(e){const{_workSheet:t}=this,{_columnData:n}=this,r=t.getConfig(),s=n.get(e);if(s)return s;const o={w:r.defaultColumnWidth,hd:vt.FALSE};return this._columnData.set(e,o),o}}class on{constructor(e,t){this._worksheet=e,this._rectangleList=t,zr.getCommandObservers().add((({actions:t})=>{if(!t||0===t.length)return;const n=t[0];if(e.getContext().getWorkBook().getUnitId()!==n.getWorkBook().getUnitId())return;let r=t.find((e=>e instanceof eo)),s=t.find((e=>e instanceof qs)),o=t.find((e=>e instanceof io)),i=t.find((e=>e instanceof ro)),l=t.find((e=>e instanceof Zs));if(r){const e=r.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()){const t=C.deepClone(this._rectangleList);for(let n=0;n<t.length;n++){const r=t[n],s=e.rowCount;e.rowIndex>r.endRow||(e.rowIndex>=r.startRow&&e.rowIndex<=r.endRow||(r.startRow+=s),r.endRow+=s)}this.modifyMerge(this._rectangleList,t)}}if(s){const e=s.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()){const t=C.deepClone(this._rectangleList);for(let n=0;n<t.length;n++){const r=t[n],s=e.columnCount;e.columnIndex>r.endColumn||(e.columnIndex>=r.startColumn&&e.columnIndex<=r.endColumn||(r.startColumn+=s),r.endColumn+=s)}this.modifyMerge(this._rectangleList,t)}}if(o){const e=o.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()){const t=C.deepClone(this._rectangleList);for(let n=0;n<t.length;n++){const r=t[n],s=e.rowCount;e.rowIndex>r.endRow||(e.rowIndex>=r.startRow&&e.rowIndex<=r.endRow||(r.startRow-=s),r.endRow-=s)}this.modifyMerge(this._rectangleList,t)}}if(i){const e=i.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()){const t=C.deepClone(this._rectangleList);for(let n=0;n<t.length;n++){const r=t[n],s=e.columnCount;e.columnIndex>r.endColumn||(e.columnIndex>=r.startColumn&&e.columnIndex<=r.endColumn||(r.startColumn-=s),r.endColumn-=s)}this.modifyMerge(this._rectangleList,t)}}if(l){const e=l.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()){const t=C.deepClone(this._rectangleList),n=this.getByRowColumn(e.rangeData.startRow,e.rangeData.endRow,e.rangeData.startColumn,e.rangeData.endColumn);if(n&&n.forEach((e=>{const n=new br(e);for(let r=0;r<t.length;r++){const e=t[r];n.intersects(new br(e))&&t.splice(r,1)}})),e.shiftDimension)for(let r=0;r<t.length;r++){const n=t[r];if(n.endRow>=e.rangeData.startRow){if(n.endColumn<e.rangeData.startColumn)continue;if(n.startColumn>e.rangeData.endColumn)continue;if(!(n.startColumn>=e.rangeData.startColumn&&n.endColumn<=e.rangeData.endColumn))return;{const t=e.rangeData.endRow-e.rangeData.startRow;n.startRow-=t,n.endRow-=t}}}else for(let r=0;r<t.length;r++){const n=t[r];if(n.startColumn>e.rangeData.endColumn){if(n.endRow<e.rangeData.startRow)continue;if(n.startRow>e.rangeData.endRow)continue;if(!(n.startRow>=e.rangeData.startRow&&n.endRow<=e.rangeData.endRow))return;{const t=e.rangeData.endColumn-e.rangeData.startColumn;n.startColumn-=t,n.endColumn-=t}}}this.modifyMerge(this._rectangleList,t)}}}))}getMergeData(){return this._rectangleList}getByRowColumn(...e){const{_rectangleList:t}=this;let n;Mr.checkup(e,Mr.NUMBER_TYPE,Mr.NUMBER_TYPE,Mr.NUMBER_TYPE,Mr.NUMBER_TYPE)?n=new br(e[0],e[2],e[1],e[3]):Mr.checkup(e,Mr.NUMBER_TYPE,Mr.NUMBER_TYPE)&&(n=new br(e[0],e[1],e[0],e[1]));const r=[];for(let s=0;s<t.length;s++){const e=t[s];n.intersects(new br(e))&&r.push(e)}return r.length?r:null}remove(e){let t=this._worksheet.getCommandManager(),n=this._worksheet.getContext(),r={actionName:oo.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[e]},s=new Wr({WorkBookUnit:n.getWorkBook()},r);t.invoke(s)}size(){return this._rectangleList.length}add(e){let t=this._worksheet.getCommandManager(),n=this._worksheet.getContext(),r={actionName:oo.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[e]},s={actionName:Us.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[e]},o=new Wr({WorkBookUnit:n.getWorkBook()},r,s);t.invoke(o)}union(e){const{_rectangleList:t}=this,{length:n}=t;let r=new br(e);for(let s=0;s<n;s++){const e=t[s];r=r.union(new br(e))}return r.getData()}getMergedRanges(e){const{_rectangleList:t}=this,{length:n}=t,r=[];for(let s=0;s<n;s++){const n=t[s];new br(e).intersects(new br(n))&&r.push(n)}return r}modifyMerge(e,t){let n=this._worksheet.getCommandManager(),r=this._worksheet.getContext(),s={actionName:oo.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[...e]},o={actionName:Us.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[...t]},i=new Wr({WorkBookUnit:r.getWorkBook()},s,o);n.invoke(i)}}var ln="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function an(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var cn={exports:{}};cn.exports=function(){var e=1e3,t=6e4,n=36e5,r="millisecond",s="second",o="minute",i="hour",l="day",a="week",c="month",h="quarter",u="year",d="date",g="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},b=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},_={s:b,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),s=n%60;return(t<=0?"+":"-")+b(r,2,"0")+":"+b(s,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),s=t.clone().add(r,c),o=n-s<0,i=t.clone().add(r+(o?-1:1),c);return+(-(r+(n-s)/(o?s-i:i-s))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:u,w:a,d:l,D:d,h:i,m:o,s:s,ms:r,Q:h}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},v="en",C={};C[v]=p;var T=function(e){return e instanceof E},w=function e(t,n,r){var s;if(!t)return v;if("string"==typeof t){var o=t.toLowerCase();C[o]&&(s=o),n&&(C[o]=n,s=o);var i=t.split("-");if(!s&&i.length>1)return e(i[0])}else{var l=t.name;C[l]=t,s=l}return!r&&s&&(v=s),s||!r&&v},y=function(e,t){if(T(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new E(n)},S=_;S.l=w,S.i=T,S.w=function(e,t){return y(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var E=function(){function p(e){this.$L=w(e.locale,null,!0),this.parse(e)}var b=p.prototype;return b.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(S.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(f);if(r){var s=r[2]-1||0,o=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],s,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],s,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},b.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},b.$utils=function(){return S},b.isValid=function(){return!(this.$d.toString()===g)},b.isSame=function(e,t){var n=y(e);return this.startOf(t)<=n&&n<=this.endOf(t)},b.isAfter=function(e,t){return y(e)<this.startOf(t)},b.isBefore=function(e,t){return this.endOf(t)<y(e)},b.$g=function(e,t,n){return S.u(e)?this[t]:this.set(n,e)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(e,t){var n=this,r=!!S.u(t)||t,h=S.p(e),g=function(e,t){var s=S.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?s:s.endOf(l)},f=function(e,t){return S.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},m=this.$W,p=this.$M,b=this.$D,_="set"+(this.$u?"UTC":"");switch(h){case u:return r?g(1,0):g(31,11);case c:return r?g(1,p):g(0,p+1);case a:var v=this.$locale().weekStart||0,C=(m<v?m+7:m)-v;return g(r?b-C:b+(6-C),p);case l:case d:return f(_+"Hours",0);case i:return f(_+"Minutes",1);case o:return f(_+"Seconds",2);case s:return f(_+"Milliseconds",3);default:return this.clone()}},b.endOf=function(e){return this.startOf(e,!1)},b.$set=function(e,t){var n,a=S.p(e),h="set"+(this.$u?"UTC":""),g=(n={},n[l]=h+"Date",n[d]=h+"Date",n[c]=h+"Month",n[u]=h+"FullYear",n[i]=h+"Hours",n[o]=h+"Minutes",n[s]=h+"Seconds",n[r]=h+"Milliseconds",n)[a],f=a===l?this.$D+(t-this.$W):t;if(a===c||a===u){var m=this.clone().set(d,1);m.$d[g](f),m.init(),this.$d=m.set(d,Math.min(this.$D,m.daysInMonth())).$d}else g&&this.$d[g](f);return this.init(),this},b.set=function(e,t){return this.clone().$set(e,t)},b.get=function(e){return this[S.p(e)]()},b.add=function(r,h){var d,g=this;r=Number(r);var f=S.p(h),m=function(e){var t=y(g);return S.w(t.date(t.date()+Math.round(e*r)),g)};if(f===c)return this.set(c,this.$M+r);if(f===u)return this.set(u,this.$y+r);if(f===l)return m(1);if(f===a)return m(7);var p=(d={},d[o]=t,d[i]=n,d[s]=e,d)[f]||1,b=this.$d.getTime()+r*p;return S.w(b,this)},b.subtract=function(e,t){return this.add(-1*e,t)},b.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||g;var r=e||"YYYY-MM-DDTHH:mm:ssZ",s=S.z(this),o=this.$H,i=this.$m,l=this.$M,a=n.weekdays,c=n.months,h=function(e,n,s,o){return e&&(e[n]||e(t,r))||s[n].slice(0,o)},u=function(e){return S.s(o%12||12,e,"0")},d=n.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},f={YY:String(this.$y).slice(-2),YYYY:this.$y,M:l+1,MM:S.s(l+1,2,"0"),MMM:h(n.monthsShort,l,c,3),MMMM:h(c,l),D:this.$D,DD:S.s(this.$D,2,"0"),d:String(this.$W),dd:h(n.weekdaysMin,this.$W,a,2),ddd:h(n.weekdaysShort,this.$W,a,3),dddd:a[this.$W],H:String(o),HH:S.s(o,2,"0"),h:u(1),hh:u(2),a:d(o,i,!0),A:d(o,i,!1),m:String(i),mm:S.s(i,2,"0"),s:String(this.$s),ss:S.s(this.$s,2,"0"),SSS:S.s(this.$ms,3,"0"),Z:s};return r.replace(m,(function(e,t){return t||f[e]||s.replace(":","")}))},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(r,d,g){var f,m=S.p(d),p=y(r),b=(p.utcOffset()-this.utcOffset())*t,_=this-p,v=S.m(this,p);return v=(f={},f[u]=v/12,f[c]=v,f[h]=v/3,f[a]=(_-b)/6048e5,f[l]=(_-b)/864e5,f[i]=_/n,f[o]=_/t,f[s]=_/e,f)[m]||_,g?v:S.a(v)},b.daysInMonth=function(){return this.endOf(c).$D},b.$locale=function(){return C[this.$L]},b.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=w(e,t,!0);return r&&(n.$L=r),n},b.clone=function(){return S.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},p}(),R=E.prototype;return y.prototype=R,[["$ms",r],["$s",s],["$m",o],["$H",i],["$W",l],["$M",c],["$y",u],["$D",d]].forEach((function(e){R[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),y.extend=function(e,t){return e.$i||(e(t,E,y),e.$i=!0),y},y.locale=w,y.isDayjs=T,y.unix=function(e){return y(1e3*e)},y.en=C[v],y.Ls=C,y.p={},y}();var hn=cn.exports,un={exports:{}};
/*! @preserve
   * numeral.js
   * version : 2.0.6
   * author : Adam Draper
   * license : MIT
   * http://adamwdraper.github.com/Numeral-js/
   */
!function(e){var t,n;t=ln,n=function(){var e,t,n,r,s,o={},i={},l={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},a={currentLocale:l.currentLocale,zeroFormat:l.zeroFormat,nullFormat:l.nullFormat,defaultFormat:l.defaultFormat,scalePercentBy100:l.scalePercentBy100};function c(e,t){this._input=e,this._value=t}return(e=function(n){var r,s,i,l;if(e.isNumeral(n))r=n.value();else if(0===n||void 0===n)r=0;else if(null===n||t.isNaN(n))r=null;else if("string"==typeof n)if(a.zeroFormat&&n===a.zeroFormat)r=0;else if(a.nullFormat&&n===a.nullFormat||!n.replace(/[^0-9]+/g,"").length)r=null;else{for(s in o)if((l="function"==typeof o[s].regexps.unformat?o[s].regexps.unformat():o[s].regexps.unformat)&&n.match(l)){i=o[s].unformat;break}r=(i=i||e._.stringToNumber)(n)}else r=Number(n)||null;return new c(n,r)}).version="2.0.6",e.isNumeral=function(e){return e instanceof c},e._=t={numberToFormat:function(t,n,r){var s,o,l,a,c,h,u,d,g=i[e.options.currentLocale],f=!1,m=!1,p="",b=1e12,_=1e9,v=1e6,C="",T=!1;if(t=t||0,l=Math.abs(t),e._.includes(n,"(")?(f=!0,n=n.replace(/[\(|\)]/g,"")):(e._.includes(n,"+")||e._.includes(n,"-"))&&(h=e._.includes(n,"+")?n.indexOf("+"):t<0?n.indexOf("-"):-1,n=n.replace(/[\+|\-]/g,"")),e._.includes(n,"a")&&(o=!!(o=n.match(/a(k|m|b|t)?/))&&o[1],e._.includes(n," a")&&(p=" "),n=n.replace(new RegExp(p+"a[kmbt]?"),""),l>=b&&!o||"t"===o?(p+=g.abbreviations.trillion,t/=b):l<b&&l>=_&&!o||"b"===o?(p+=g.abbreviations.billion,t/=_):l<_&&l>=v&&!o||"m"===o?(p+=g.abbreviations.million,t/=v):(l<v&&l>=1e3&&!o||"k"===o)&&(p+=g.abbreviations.thousand,t/=1e3)),e._.includes(n,"[.]")&&(m=!0,n=n.replace("[.]",".")),a=t.toString().split(".")[0],c=n.split(".")[1],u=n.indexOf(","),s=(n.split(".")[0].split(",")[0].match(/0/g)||[]).length,c?(e._.includes(c,"[")?(c=(c=c.replace("]","")).split("["),C=e._.toFixed(t,c[0].length+c[1].length,r,c[1].length)):C=e._.toFixed(t,c.length,r),a=C.split(".")[0],C=e._.includes(C,".")?g.delimiters.decimal+C.split(".")[1]:"",m&&0===Number(C.slice(1))&&(C="")):a=e._.toFixed(t,0,r),p&&!o&&Number(a)>=1e3&&p!==g.abbreviations.trillion)switch(a=String(Number(a)/1e3),p){case g.abbreviations.thousand:p=g.abbreviations.million;break;case g.abbreviations.million:p=g.abbreviations.billion;break;case g.abbreviations.billion:p=g.abbreviations.trillion}if(e._.includes(a,"-")&&(a=a.slice(1),T=!0),a.length<s)for(var w=s-a.length;w>0;w--)a="0"+a;return u>-1&&(a=a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+g.delimiters.thousands)),0===n.indexOf(".")&&(a=""),d=a+C+(p||""),f?d=(f&&T?"(":"")+d+(f&&T?")":""):h>=0?d=0===h?(T?"-":"+")+d:d+(T?"-":"+"):T&&(d="-"+d),d},stringToNumber:function(e){var t,n,r,s=i[a.currentLocale],o=e,l={thousand:3,million:6,billion:9,trillion:12};if(a.zeroFormat&&e===a.zeroFormat)n=0;else if(a.nullFormat&&e===a.nullFormat||!e.replace(/[^0-9]+/g,"").length)n=null;else{for(t in n=1,"."!==s.delimiters.decimal&&(e=e.replace(/\./g,"").replace(s.delimiters.decimal,".")),l)if(r=new RegExp("[^a-zA-Z]"+s.abbreviations[t]+"(?:\\)|(\\"+s.currency.symbol+")?(?:\\))?)?$"),o.match(r)){n*=Math.pow(10,l[t]);break}n*=(e.split("-").length+Math.min(e.split("(").length-1,e.split(")").length-1))%2?1:-1,e=e.replace(/[^0-9\.]+/g,""),n*=Number(e)}return n},isNaN:function(e){return"number"==typeof e&&isNaN(e)},includes:function(e,t){return-1!==e.indexOf(t)},insert:function(e,t,n){return e.slice(0,n)+t+e.slice(n)},reduce:function(e,t){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var n,r=Object(e),s=r.length>>>0,o=0;if(3===arguments.length)n=arguments[2];else{for(;o<s&&!(o in r);)o++;if(o>=s)throw new TypeError("Reduce of empty array with no initial value");n=r[o++]}for(;o<s;o++)o in r&&(n=t(n,r[o],o,r));return n},multiplier:function(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)},correctionFactor:function(){var e=Array.prototype.slice.call(arguments);return e.reduce((function(e,n){var r=t.multiplier(n);return e>r?e:r}),1)},toFixed:function(e,t,n,r){var s,o,i,l,a=e.toString().split("."),c=t-(r||0);return s=2===a.length?Math.min(Math.max(a[1].length,c),t):c,i=Math.pow(10,s),l=(n(e+"e+"+s)/i).toFixed(s),r>t-s&&(o=new RegExp("\\.?0{1,"+(r-(t-s))+"}$"),l=l.replace(o,"")),l}},e.options=a,e.formats=o,e.locales=i,e.locale=function(e){return e&&(a.currentLocale=e.toLowerCase()),a.currentLocale},e.localeData=function(e){if(!e)return i[a.currentLocale];if(e=e.toLowerCase(),!i[e])throw new Error("Unknown locale : "+e);return i[e]},e.reset=function(){for(var e in l)a[e]=l[e]},e.zeroFormat=function(e){a.zeroFormat="string"==typeof e?e:null},e.nullFormat=function(e){a.nullFormat="string"==typeof e?e:null},e.defaultFormat=function(e){a.defaultFormat="string"==typeof e?e:"0.0"},e.register=function(e,t,n){if(t=t.toLowerCase(),this[e+"s"][t])throw new TypeError(t+" "+e+" already registered.");return this[e+"s"][t]=n,n},e.validate=function(t,n){var r,s,o,i,l,a,c,h;if("string"!=typeof t&&(t+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",t)),(t=t.trim()).match(/^\d+$/))return!0;if(""===t)return!1;try{c=e.localeData(n)}catch(u){c=e.localeData(e.locale())}return o=c.currency.symbol,l=c.abbreviations,r=c.delimiters.decimal,s="."===c.delimiters.thousands?"\\.":c.delimiters.thousands,!(null!==(h=t.match(/^[^\d]+/))&&(t=t.substr(1),h[0]!==o)||null!==(h=t.match(/[^\d]+$/))&&(t=t.slice(0,-1),h[0]!==l.thousand&&h[0]!==l.million&&h[0]!==l.billion&&h[0]!==l.trillion)||(a=new RegExp(s+"{2}"),t.match(/[^\d.,]/g)||(i=t.split(r)).length>2||(i.length<2?!i[0].match(/^\d+.*\d$/)||i[0].match(a):1===i[0].length?!i[0].match(/^\d+$/)||i[0].match(a)||!i[1].match(/^\d+$/):!i[0].match(/^\d+.*\d$/)||i[0].match(a)||!i[1].match(/^\d+$/))))},e.fn=c.prototype={clone:function(){return e(this)},format:function(t,n){var r,s,i,l=this._value,c=t||a.defaultFormat;if(n=n||Math.round,0===l&&null!==a.zeroFormat)s=a.zeroFormat;else if(null===l&&null!==a.nullFormat)s=a.nullFormat;else{for(r in o)if(c.match(o[r].regexps.format)){i=o[r].format;break}s=(i=i||e._.numberToFormat)(l,c,n)}return s},value:function(){return this._value},input:function(){return this._input},set:function(e){return this._value=Number(e),this},add:function(e){var n=t.correctionFactor.call(null,this._value,e);return this._value=t.reduce([this._value,e],(function(e,t,r,s){return e+Math.round(n*t)}),0)/n,this},subtract:function(e){var n=t.correctionFactor.call(null,this._value,e);return this._value=t.reduce([e],(function(e,t,r,s){return e-Math.round(n*t)}),Math.round(this._value*n))/n,this},multiply:function(e){return this._value=t.reduce([this._value,e],(function(e,n,r,s){var o=t.correctionFactor(e,n);return Math.round(e*o)*Math.round(n*o)/Math.round(o*o)}),1),this},divide:function(e){return this._value=t.reduce([this._value,e],(function(e,n,r,s){var o=t.correctionFactor(e,n);return Math.round(e*o)/Math.round(n*o)})),this},difference:function(t){return Math.abs(e(this._value).subtract(t).value())}},e.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),e.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(t,n,r){var s,o=e._.includes(n," BPS")?" ":"";return t*=1e4,n=n.replace(/\s?BPS/,""),s=e._.numberToFormat(t,n,r),e._.includes(s,")")?((s=s.split("")).splice(-1,0,o+"BPS"),s=s.join("")):s=s+o+"BPS",s},unformat:function(t){return+(1e-4*e._.stringToNumber(t)).toFixed(15)}}),r={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},s="("+(s=(n={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}).suffixes.concat(r.suffixes.filter((function(e){return n.suffixes.indexOf(e)<0}))).join("|")).replace("B","B(?!PS)")+")",e.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(s)},format:function(t,s,o){var i,l,a,c=e._.includes(s,"ib")?r:n,h=e._.includes(s," b")||e._.includes(s," ib")?" ":"";for(s=s.replace(/\s?i?b/,""),i=0;i<=c.suffixes.length;i++)if(l=Math.pow(c.base,i),a=Math.pow(c.base,i+1),null===t||0===t||t>=l&&t<a){h+=c.suffixes[i],l>0&&(t/=l);break}return e._.numberToFormat(t,s,o)+h},unformat:function(t){var s,o,i=e._.stringToNumber(t);if(i){for(s=n.suffixes.length-1;s>=0;s--){if(e._.includes(t,n.suffixes[s])){o=Math.pow(n.base,s);break}if(e._.includes(t,r.suffixes[s])){o=Math.pow(r.base,s);break}}i*=o||1}return i}}),e.register("format","currency",{regexps:{format:/(\$)/},format:function(t,n,r){var s,o,i=e.locales[e.options.currentLocale],l={before:n.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:n.match(/([\+|\-|\)|\s|\$]*)$/)[0]};for(n=n.replace(/\s?\$\s?/,""),s=e._.numberToFormat(t,n,r),t>=0?(l.before=l.before.replace(/[\-\(]/,""),l.after=l.after.replace(/[\-\)]/,"")):t<0&&!e._.includes(l.before,"-")&&!e._.includes(l.before,"(")&&(l.before="-"+l.before),o=0;o<l.before.length;o++)switch(l.before[o]){case"$":s=e._.insert(s,i.currency.symbol,o);break;case" ":s=e._.insert(s," ",o+i.currency.symbol.length-1)}for(o=l.after.length-1;o>=0;o--)switch(l.after[o]){case"$":s=o===l.after.length-1?s+i.currency.symbol:e._.insert(s,i.currency.symbol,-(l.after.length-(1+o)));break;case" ":s=o===l.after.length-1?s+" ":e._.insert(s," ",-(l.after.length-(1+o)+i.currency.symbol.length-1))}return s}}),e.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(t,n,r){var s=("number"!=typeof t||e._.isNaN(t)?"0e+0":t.toExponential()).split("e");return n=n.replace(/e[\+|\-]{1}0/,""),e._.numberToFormat(Number(s[0]),n,r)+"e"+s[1]},unformat:function(t){var n=e._.includes(t,"e+")?t.split("e+"):t.split("e-"),r=Number(n[0]),s=Number(n[1]);return s=e._.includes(t,"e-")?s*=-1:s,e._.reduce([r,Math.pow(10,s)],(function(t,n,r,s){var o=e._.correctionFactor(t,n);return t*o*(n*o)/(o*o)}),1)}}),e.register("format","ordinal",{regexps:{format:/(o)/},format:function(t,n,r){var s=e.locales[e.options.currentLocale],o=e._.includes(n," o")?" ":"";return n=n.replace(/\s?o/,""),o+=s.ordinal(t),e._.numberToFormat(t,n,r)+o}}),e.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(t,n,r){var s,o=e._.includes(n," %")?" ":"";return e.options.scalePercentBy100&&(t*=100),n=n.replace(/\s?\%/,""),s=e._.numberToFormat(t,n,r),e._.includes(s,")")?((s=s.split("")).splice(-1,0,o+"%"),s=s.join("")):s=s+o+"%",s},unformat:function(t){var n=e._.stringToNumber(t);return e.options.scalePercentBy100?.01*n:n}}),e.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(e,t,n){var r=Math.floor(e/60/60),s=Math.floor((e-60*r*60)/60),o=Math.round(e-60*r*60-60*s);return r+":"+(s<10?"0"+s:s)+":"+(o<10?"0"+o:o)},unformat:function(e){var t=e.split(":"),n=0;return 3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1])),Number(n)}}),e},e.exports?e.exports=n():t.numeral=n()}(un);var dn=un.exports;const gn={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"};function fn(e){return null!==e&&""!==e.toString().replace(/\s/g,"")&&("boolean"!=typeof e&&!Number.isNaN(e))}let mn=new Date("2017-02-19T19:06:09.000Z");Number.isNaN(mn.getFullYear())&&(mn=new Date("2/19/17"));const pn=2017===mn.getFullYear();const bn=new Date(1900,2,1,0,0,0);function _n(e,t){let n=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());const r=Date.UTC(1899,11,31,0,0,0);return t?n-=1262304e5:e>=bn&&(n+=864e5),(n-r)/864e5}function vn(e){let t=null,n={},r=e;if(null===e)return null;if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(e)){t=e,r=Number(e.split(".")[0].replace(",",""));let s="#,##0";if(e.split(".")[1]){s="#,##0.";for(let t=0;t<e.split(".")[1].length;t++)s+=0}n={fa:s,t:"n"}}else if("'"===e.toString().substr(0,1))t=e.toString().substr(1),n={fa:"@",t:"s"};else if("TRUE"===e.toString().toUpperCase())t="TRUE",n={fa:"General",t:"b"},r=!0;else if("FALSE"===e.toString().toUpperCase())t="FALSE",n={fa:"General",t:"b"},r=!1;else if(function(e){let t=!1;for(const n in gn)if(e===gn[n]){t=!0;break}return t}(e))t=e.toString(),n={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e))t=e.toString(),n={fa:"@",t:"s"};else if(fn(e)&&Math.abs(parseFloat(e))>0&&(Math.abs(parseFloat(e))>=1e11||Math.abs(parseFloat(e))<1e-9)){r=dn(e).value();const s=r.toExponential();if(s.indexOf(".")>-1){let e=s.split(".")[1].split("e")[0].length;e>5&&(e=5),n={fa:`#0.${new Array(e+1).join("0")}E+00`,t:"n"}}else n={fa:"#0.E+00",t:"n"};t=Cn.format(n.fa,r)}else if(e.toString().indexOf("%")>-1){const s=e.toString().indexOf("%");let o=e.toString().substr(0,s);const i=o.replace(/,/g,"");if(s===e.toString().length-1&&fn(i))if(o.indexOf(".")>-1)if(o.indexOf(".")===o.lastIndexOf(".")){const s=o.split(".")[0];let i=o.split(".")[1].length;if(i>9&&(i=9),s.indexOf(",")>-1){let o=!0,l=s.split(",");for(let e=1;e<l.length;e++)if(l[e].length<3){o=!1;break}o?(n={fa:`#,##0.${new Array(i+1).join("0")}%`,t:"n"},r=dn(e).value(),t=Cn.format(n.fa,r)):(t=e.toString(),n={fa:"@",t:"s"})}else n={fa:`0.${new Array(i+1).join("0")}%`,t:"n"},r=dn(e).value(),t=Cn.format(n.fa,r)}else t=e.toString(),n={fa:"@",t:"s"};else if(o.indexOf(",")>-1){let s=!0,i=o.split(",");for(let e=1;e<i.length;e++)if(i[e].length<3){s=!1;break}s?(n={fa:"#,##0%",t:"n"},r=dn(e).value(),t=Cn.format(n.fa,r)):(t=e.toString(),n={fa:"@",t:"s"})}else n={fa:"0%",t:"n"},r=dn(e).value(),t=Cn.format(n.fa,r);else t=e.toString(),n={fa:"@",t:"s"}}else if(e.toString().indexOf(".")>-1)if(e.toString().indexOf(".")===e.toString().lastIndexOf(".")){const s=e.toString().split(".")[0];let o=e.toString().split(".")[1],i=o.length;if(i>9&&(i=9),s.indexOf(",")>-1){let o=!0,l=s.split(",");for(let e=1;e<l.length;e++)if(!fn(l[e])||l[e].length<3){o=!1;break}o?(n={fa:`#,##0.${new Array(i+1).join("0")}`,t:"n"},r=dn(e).value(),t=Cn.format(n.fa,r)):(t=e.toString(),n={fa:"@",t:"s"})}else fn(s)&&fn(o)?(n={fa:`0.${new Array(i+1).join("0")}`,t:"n"},r=dn(e).value(),t=Cn.format(n.fa,r)):(t=e.toString(),n={fa:"@",t:"s"})}else t=e.toString(),n={fa:"@",t:"s"};else fn(e)?(t=e.toString(),n={fa:"General",t:"n"},r=parseFloat(e)):null===(s=e)||s.toString().length<5||!function(e){if(!/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(e)&&!/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(e))return!1;const t=RegExp.$1,n=RegExp.$2,r=RegExp.$3;if(t<1900)return!1;if(n>12)return!1;if(r>31)return!1;if(2===n){if(29===new Date(t,1,29).getDate()&&r>29)return!1;if(29!==new Date(t,1,29).getDate()&&r>28)return!1}return!0}(s)||!(e.toString().indexOf(".")>-1||e.toString().indexOf(":")>-1||e.toString().length<16)?(t=e,n.fa="General",n.t="g"):(r=_n(function(e,t){const n=new Date(e);if(pn)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917===mn.getFullYear()&&!Number.isNaN(n.getFullYear())){const t=n.getFullYear();return e.indexOf(`${t}`)>-1||n.setFullYear(n.getFullYear()+100),n}const r=e.match(/\d+/g)||["2017","2","19","0","0","0"];let s=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}(e.toString().replace(/-/g,"/"))),r.toString().indexOf(".")>-1?e.toString().length>18?n.fa="yyyy-MM-dd hh:mm:ss":e.toString().length>11?n.fa="yyyy-MM-dd hh:mm":n.fa="yyyy-MM-dd":n.fa="yyyy-MM-dd",n.t="d",t=Cn.format(n.fa,r));var s;return[t,n,r]}const Cn={format(e,t){}},Tn=(e,t)=>{};class wn{static getApplyData(e,t,n,r,s){const o=this,i=[];o.applyType=r,o.direction=s;const l=Math.floor(n/t),a=n%t,c=e.number,h=[];if(c)for(let y=0;y<c.length;y++){const e=o.getLenS(c[y].index,a),i=c[y].index.length*l+e;let u;u=1===r?o.getDataByType(c[y].data,i,s,r,"number"):"2"===r?o.getDataByType(c[y].data,i,s,r):o.getDataByType(c[y].data,i,s,"0");const d=o.getDataIndex(t,n,c[y].index);h.push({data:u,index:d})}const u=e.extendNumber,d=[];if(u)for(let y=0;y<u.length;y++){const e=o.getLenS(u[y].index,a),i=u[y].index.length*l+e;let c;c="1"===r||"3"===r?o.getDataByType(u[y].data,i,s,r,"extendNumber"):"2"===r?o.getDataByType(u[y].data,i,s,r):o.getDataByType(u[y].data,i,s,"0");const h=o.getDataIndex(t,n,u[y].index);d.push({data:c,index:h})}const g=e.date,f=[];if(g)for(let y=0;y<g.length;y++){const e=o.getLenS(g[y].index,a),i=g[y].index.length*l+e;let c;c="1"===r||"3"===r?o.getDataByType(g[y].data,i,s,r,"date"):"8"===r?o.getDataByType(g[y].data,i,s,"0"):o.getDataByType(g[y].data,i,s,r);const h=o.getDataIndex(t,n,g[y].index);f.push({data:c,index:h})}const m=e.chnNumber,p=[];if(m)for(let y=0;y<m.length;y++){const e=o.getLenS(m[y].index,a),i=m[y].index.length*l+e;let c;c="1"===r||"3"===r?o.getDataByType(m[y].data,i,s,r,"chnNumber"):"2"===r||"8"===r?o.getDataByType(m[y].data,i,s,r):o.getDataByType(m[y].data,i,s,"0");const h=o.getDataIndex(t,n,m[y].index);p.push({data:c,index:h})}const b=e.chnWeek2,_=[];if(b)for(let y=0;y<b.length;y++){const e=o.getLenS(b[y].index,a),i=b[y].index.length*l+e;let c;c="1"===r||"3"===r?o.getDataByType(b[y].data,i,s,r,"chnWeek2"):"2"===r?o.getDataByType(b[y].data,i,s,r):o.getDataByType(b[y].data,i,s,"0");const h=o.getDataIndex(t,n,b[y].index);_.push({data:c,index:h})}const v=e.chnWeek3,C=[];if(v)for(let y=0;y<v.length;y++){const e=o.getLenS(v[y].index,a),i=v[y].index.length*l+e;let c;c="1"===r||"3"===r?o.getDataByType(v[y].data,i,s,r,"chnWeek3"):"2"===r?o.getDataByType(v[y].data,i,s,r):o.getDataByType(v[y].data,i,s,"0");const h=o.getDataIndex(t,n,v[y].index);C.push({data:c,index:h})}const T=e.other,w=[];if(T)for(let y=0;y<T.length;y++){const e=o.getLenS(T[y].index,a),i=T[y].index.length*l+e;let c;c="2"===r||"3"===r?o.getDataByType(T[y].data,i,s,r):o.getDataByType(T[y].data,i,s,"0");const h=o.getDataIndex(t,n,T[y].index);w.push({data:c,index:h})}for(let y=1;y<=n;y++){if(h.length>0)for(let e=0;e<h.length;e++)y in h[e].index&&i.push(h[e].data[h[e].index[y]]);if(d.length>0)for(let e=0;e<d.length;e++)y in d[e].index&&i.push(d[e].data[d[e].index[y]]);if(f.length>0)for(let e=0;e<f.length;e++)y in f[e].index&&i.push(f[e].data[f[e].index[y]]);if(p.length>0)for(let e=0;e<p.length;e++)y in p[e].index&&i.push(p[e].data[p[e].index[y]]);if(_.length>0)for(let e=0;e<_.length;e++)y in _[e].index&&i.push(_[e].data[_[e].index[y]]);if(C.length>0)for(let e=0;e<C.length;e++)y in C[e].index&&i.push(C[e].data[C[e].index[y]]);if(w.length>0)for(let e=0;e<w.length;e++)y in w[e].index&&i.push(w[e].data[w[e].index[y]])}return i}static getCopyData(e,t,n,r,s,o){const i=this,l=[];let a=0,c=0,h=0,u=0;o===Fe.BOTTOM||o===Fe.TOP?(a=r,c=s,h=t,u=n):o!==Fe.RIGHT&&o!==Fe.LEFT||(a=t,c=n,h=r,u=s);for(let d=a;d<=c;d++){const t={};let n=[],r=[],s="",o=null,a=null,c=!0;for(let l=h,d=0;l<=u;l++,d++){const g=e[d];let f;if(g&&g.v&&!g.f)if(g.fm&&g.fm.t===Ue.NUMBER)f="number",o=null,a=null;else if(g.fm&&g.fm.t===Ue.DATE)f="date",o=null,a=null;else if(i.isExtendNumber(g.m)[0]){f="extendNumber";const e=i.isExtendNumber(g.m);null===o||null===a?(c=!0,o=e[2],a=e[3]):e[2]!==o||e[3]!==a?(c=!1,o=e[2],a=e[3]):c=!0}else i.isChnNumber(g.m)?(f="chnNumber",o=null,a=null):i.isChnWeek2(g.m)?(f="chnWeek2",o=null,a=null):i.isChnWeek3(g.m)?(f="chnWeek3",o=null,a=null):(f="other",o=null,a=null);else f="other",o=null,a=null;"extendNumber"===f?l===h?h===u?(s=f,n.push(g),r.push(l-h+1),t[s]=[],t[s].push({data:n,index:r})):(s=f,n.push(g),r.push(l-h+1)):l===u?s===f&&c?(n.push(g),r.push(l-h+1),s in t||(t[s]=[],t[s].push({data:n,index:r}))):(s in t||(t[s]=[]),t[s].push({data:n,index:r}),s=f,n=[],n.push(g),r=[],r.push(l-h+1),s in t||(t[s]=[]),t[s].push({data:n,index:r})):s===f&&c?(n.push(g),r.push(l-h+1)):(s in t||(t[s]=[]),t[s].push({data:n,index:r}),s=f,n=[],n.push(g),r=[],r.push(l-h+1)):l===h?h===u?(s=f,n.push(g),r.push(l-h+1),t[s]=[],t[s].push({data:n,index:r})):(s=f,n.push(g),r.push(l-h+1)):l===u?s===f?(n.push(g),r.push(l-h+1),s in t||(t[s]=[]),t[s].push({data:n,index:r})):(s in t||(t[s]=[]),t[s].push({data:n,index:r}),s=f,n=[],n.push(g),r=[],r.push(l-h+1),s in t||(t[s]=[]),t[s].push({data:n,index:r})):s===f?(n.push(g),r.push(l-h+1)):(s in t||(t[s]=[]),t[s].push({data:n,index:r}),s=f,n=[],n.push(g),r=[],r.push(l-h+1))}l.push(t)}return l}static ChineseToNumber(e){const t=this;let n=0,r=0,s=0,o=!1;const i=e.split("");for(let l=0;l<i.length;l++){const e=t.chnNumChar[i[l]];if(void 0!==e)s=e,l===i.length-1&&(r+=s);else{const e=t.chnNameValue[i[l]].value;o=t.chnNameValue[i[l]].secUnit,o?(r=(r+s)*e,n+=r,r=0):r+=s*e,s=0}}return n+r}static NumberToChinese(e){const t=this;let n=0,r="",s="",o=!1;if(0===e)return t.chnNumChar2[0];for(;e>0;){const i=e%1e4;o&&(s=t.chnNumChar2[0]+s),r=t.SectionToChinese(i),r+=0!==i?t.chnUnitSection[n]:t.chnUnitSection[0],s=r+s,o=i<1e3&&i>0,e=Math.floor(e/1e4),n++}return s}static SectionToChinese(e){const t=this;let n="",r="",s=0,o=!0;for(;e>0;){const i=e%10;0===i?o||(o=!0,r=t.chnNumChar2[i]+r):(o=!1,n=t.chnNumChar2[i],n+=t.chnUnitChar[s],r=n+r),s++,e=Math.floor(e/10)}return r}static getLenS(e,t){let n=0;for(let r=0;r<e.length&&e[r]<=t;r++)n++;return n}static getDataByType(e,t,n,r,s){const o=this;let i=[];if(r===ve.ALTERNATE_SERIES)n!==Fe.TOP&&n!==Fe.LEFT||e.reverse(),i=o.FillCopy(e,t);else if(r===ve.DEFAULT_SERIES)if("number"===s)i=o.FillSeries(e,t,n);else if("extendNumber"===s)if(1===e.length){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1),i=o.FillExtendNumber(e,t,r)}else{const r=[];for(let t=0;t<e.length;t++){const n=e[t].m;r.push(Number(o.isExtendNumber(n)[1]))}if(n!==Fe.TOP&&n!==Fe.LEFT||(e.reverse(),r.reverse()),o.isEqualDiff(r)){const n=r[1]-r[0];i=o.FillExtendNumber(e,t,n)}else i=o.FillCopy(e,t)}else if("date"===s)if(1===e.length){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1),i=o.FillDays(e,t,r)}else{n!==Fe.TOP&&n!==Fe.LEFT||e.reverse();const r=o.judgeDate(e);if(r[0]&&r[3]){const n=hn(e[1].m).diff(hn(e[0].m),"months");i=o.FillMonths(e,t,n)}else if(!r[0]&&r[2]){const n=hn(e[1].m).diff(hn(e[0].m),"days");i=o.FillDays(e,t,n)}else i=o.FillCopy(e,t)}else if("chnNumber"===s)if(1===e.length)if(""===e[0].m||o.ChineseToNumber(e[0].m)<7){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1),i=o.FillChnWeek(e,t,r)}else{let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1),i=o.FillChnNumber(e,t,r)}else{let r=!1;for(let t=0;t<e.length;t++)if(""===e[t].m){r=!0;break}const s=[];let l=0;for(let t=0;t<e.length;t++)""===e[t].m?0===t?s.push(0):(l++,s.push(7*l)):r&&o.ChineseToNumber(e[t].m)>0&&o.ChineseToNumber(e[t].m)<7?s.push(o.ChineseToNumber(e[t].m)+7*l):s.push(o.ChineseToNumber(e[t].m));if(n!==Fe.TOP&&n!==Fe.LEFT||(e.reverse(),s.reverse()),o.isEqualDiff(s))if(r||s[s.length-1]<6&&s[0]>0||s[0]<6&&s[s.length-1]>0){const n=s[1]-s[0];i=o.FillChnWeek(e,t,n)}else{const n=s[1]-s[0];i=o.FillChnNumber(e,t,n)}else i=o.FillCopy(e,t)}else if("chnWeek2"===s)if(1===e.length){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1),i=o.FillChnWeek2(e,t,r)}else{const r=[];let s=0;for(let t=0;t<e.length;t++){const n=e[t].m.substr(e[t].m.length-1,1);""===e[t].m?0===t?r.push(0):(s++,r.push(7*s)):r.push(o.ChineseToNumber(n)+7*s)}if(n!==Fe.TOP&&n!==Fe.LEFT||(e.reverse(),r.reverse()),o.isEqualDiff(r)){const n=r[1]-r[0];i=o.FillChnWeek2(e,t,n)}else i=o.FillCopy(e,t)}else if("chnWeek3"===s)if(1===e.length){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1),i=o.FillChnWeek3(e,t,r)}else{const r=[];let s=0;for(let t=0;t<e.length;t++){const n=e[t].m.substr(e[t].m.length-1,1);""===e[t].m?0===t?r.push(0):(s++,r.push(7*s)):r.push(o.ChineseToNumber(n)+7*s)}if(n!==Fe.TOP&&n!==Fe.LEFT||(e.reverse(),r.reverse()),o.isEqualDiff(r)){const n=r[1]-r[0];i=o.FillChnWeek3(e,t,n)}else i=o.FillCopy(e,t)}else n!==Fe.TOP&&n!==Fe.LEFT||e.reverse(),i=o.FillCopy(e,t);else if("2"===r)n!==Fe.TOP&&n!==Fe.LEFT||e.reverse(),i=o.FillOnlyFormat(e,t);else if("3"===r){const r=o.getDataByType(e,t,n,"1",s);i=o.FillWithoutFormat(r)}else if("4"===r)if(1===e.length){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1),i=o.FillDays(e,t,r)}else if(2===e.length){n!==Fe.TOP&&n!==Fe.LEFT||e.reverse();const r=hn(e[1].m).diff(hn(e[0].m),"days");i=o.FillDays(e,t,r)}else{n!==Fe.TOP&&n!==Fe.LEFT||e.reverse();const r=o.judgeDate(e);if(r[0]&&r[3]){const n=hn(e[1].m).diff(hn(e[0].m),"months");i=o.FillMonths(e,t,n)}else if(!r[0]&&r[2]){const n=hn(e[1].m).diff(hn(e[0].m),"days");i=o.FillDays(e,t,n)}else i=o.FillCopy(e,t)}else if("5"===r)if(1===e.length){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1);const s=Math.round(1.5*t);for(let n=1;n<=s;n++){const s=__spreadValues({},e[n]),o=hn(s.m).add(n,"days").day();if(0===o||6===o)continue;const l=hn(s.m).add(r*n,"days").format("YYYY-MM-DD");if(s.m=l,s.v=vn(l)[2],i.push(s),i.length===t)break}}else if(2===e.length)if(hn(e[1].m).date()===hn(e[0].m).date()&&0!==hn(e[1].m).diff(hn(e[0].m),"months")){n!==Fe.TOP&&n!==Fe.LEFT||e.reverse();const r=hn(e[1].m).diff(hn(e[0].m),"months");for(let n=1;n<=t;n++){const t=(n-1)%e.length,s=__spreadValues({},e[t]),o=hn(e[e.length-1]).add(r*n,"months").day();let l;l=0===o?hn(e[e.length-1]).add(r*n,"months").subtract(2,"days").format("YYYY-MM-DD"):6===o?hn(e[e.length-1]).add(r*n,"months").subtract(1,"days").format("YYYY-MM-DD"):hn(e[e.length-1]).add(r*n,"months").format("YYYY-MM-DD"),s.m=l,s.v=vn(l)[2],i.push(s)}}else if(Math.abs(hn(e[1].m).diff(hn(e[0].m)))>7){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1,e.reverse());let s=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,o=__spreadValues({},e[t]),l=Math.ceil(n/e.length);0===t&&(s=hn(o.m).add(r*l,"months").diff(hn(o.m),"days"));const a=hn(o.m).add(s,"days").day();let c;c=0===a?hn(o.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6===a?hn(o.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):hn(o.m).add(s,"days").format("YYYY-MM-DD"),o.m=c,o.v=vn(c)[2],i.push(o)}}else{let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=7:n!==Fe.TOP&&n!==Fe.LEFT||(r=-7,e.reverse());let s=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,o=__spreadValues({},e[t]),l=Math.ceil(n/e.length);0===t&&(s=hn(o.m).add(r*l,"days").diff(hn(o.m),"days"));const a=hn(o.m).add(s,"days").day();let c;c=0===a?hn(o.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6===a?hn(o.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):hn(o.m).add(s,"days").format("YYYY-MM-DD"),o.m=c,o.v=vn(c)[2],i.push(o)}}else{const r=o.judgeDate(e);if(r[0]&&r[3]){n!==Fe.TOP&&n!==Fe.LEFT||e.reverse();const r=hn(e[1].m).diff(hn(e[0].m),"months");for(let n=1;n<=t;n++){const t=(n-1)%e.length,s=__spreadValues({},e[t]),o=hn(e[e.length-1].m).add(r*n,"months").day();let l;l=0===o?hn(e[e.length-1].m).add(r*n,"months").subtract(2,"days").format("YYYY-MM-DD"):6===o?hn(e[e.length-1].m).add(r*n,"months").subtract(1,"days").format("YYYY-MM-DD"):hn(e[e.length-1].m).add(r*n,"months").format("YYYY-MM-DD"),s.m=l,s.v=vn(l)[2],i.push(s)}}else if(!r[0]&&r[2])if(Math.abs(hn(e[1].m).diff(hn(e[0].m)))>7){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1,e.reverse());let s=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,o=__spreadValues({},e[t]),l=Math.ceil(n/e.length);0===t&&(s=hn(o.m).add(r*l,"months").diff(hn(o.m),"days"));const a=hn(o.m).add(s,"days").day();let c;c=0===a?hn(o.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6===a?hn(o.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):hn(o.m).add(s,"days").format("YYYY-MM-DD"),o.m=c,o.v=vn(c)[2],i.push(o)}}else{let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=7:n!==Fe.TOP&&n!==Fe.LEFT||(r=-7,e.reverse());let s=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,o=__spreadValues({},e[t]),l=Math.ceil(n/e.length);0===t&&(s=hn(o.m).add(r*l,"days").diff(hn(o.m),"days"));const a=hn(o.m).add(s,"days").day();let c;c=0===a?hn(o.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6===a?hn(o.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):hn(o.m).add(s,"days").format("YYYY-MM-DD"),o.m=c,o.v=vn(c)[2],i.push(o)}}else n!==Fe.TOP&&n!==Fe.LEFT||e.reverse(),i=o.FillCopy(e,t)}else if("6"===r)if(1===e.length){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1),i=o.FillMonths(e,t,r)}else if(2===e.length)if(hn(e[1].m).date()===hn(e[0].m).date()&&0!==hn(e[1].m).diff(hn(e[0].m),"months")){n!==Fe.TOP&&n!==Fe.LEFT||e.reverse();const r=hn(e[1].m).diff(hn(e[0].m),"months");i=o.FillMonths(e,t,r)}else{let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1,e.reverse());let s=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,o=__spreadValues({},e[t]),l=Math.ceil(n/e.length);0===t&&(s=hn(o.m).add(r*l,"months").diff(hn(o.m),"days"));const a=hn(o.m).add(s,"days").format("YYYY-MM-DD");o.m=a,o.v=vn(a)[2],i.push(o)}}else{const r=o.judgeDate(e);if(r[0]&&r[3]){n!==Fe.TOP&&n!==Fe.LEFT||e.reverse();const r=hn(e[1].m).diff(hn(e[0].m),"months");i=o.FillMonths(e,t,r)}else if(!r[0]&&r[2]){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1,e.reverse());let s=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,o=__spreadValues({},e[t]),l=Math.ceil(n/e.length);0===t&&(s=hn(o.m).add(r*l,"months").diff(hn(o.m),"days"));const a=hn(o.m).add(s,"days").format("YYYY-MM-DD");o.m=a,o.v=vn(a)[2],i.push(o)}}else n!==Fe.TOP&&n!==Fe.LEFT||e.reverse(),i=o.FillCopy(e,t)}else if("7"===r)if(1===e.length){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1),i=o.FillYears(e,t,r)}else if(2===e.length)if(hn(e[1].m).date()===hn(e[0].m).date()&&hn(e[1].m).month()===hn(e[0].m).month()&&0!==hn(e[1].m).diff(hn(e[0].m),"years")){n!==Fe.TOP&&n!==Fe.LEFT||e.reverse();const r=hn(e[1].m).diff(hn(e[0].m),"years");i=o.FillYears(e,t,r)}else{let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1,e.reverse());let s=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,o=__spreadValues({},e[t]),l=Math.ceil(n/e.length);0===t&&(s=hn(o.m).add(r*l,"years").diff(hn(o.m),"days"));const a=hn(o.m).add(s,"days").format("YYYY-MM-DD");o.m=a,o.v=vn(a)[2],i.push(o)}}else{const r=o.judgeDate(e);if(r[0]&&r[1]&&r[4]){n!==Fe.TOP&&n!==Fe.LEFT||e.reverse();const r=hn(e[1].m).diff(hn(e[0].m),"years");i=o.FillYears(e,t,r)}else if(r[0]&&r[3]||r[2]){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1,e.reverse());let s=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,o=__spreadValues({},e[t]),l=Math.ceil(n/e.length);0===t&&(s=hn(o.m).add(r*l,"years").diff(hn(o.m),"days"));const a=hn(o.m).add(s,"days").format("YYYY-MM-DD");o.m=a,o.v=vn(a)[2],i.push(o)}}else n!==Fe.TOP&&n!==Fe.LEFT||e.reverse(),i=o.FillCopy(e,t)}else if("8"===r)if(1===e.length){let r=0;n===Fe.BOTTOM||n===Fe.RIGHT?r=1:n!==Fe.TOP&&n!==Fe.LEFT||(r=-1),i=o.FillChnNumber(e,t,r)}else{const r=[];for(let t=0;t<e.length;t++)r.push(o.ChineseToNumber(e[t].m));if(n!==Fe.TOP&&n!==Fe.LEFT||(e.reverse(),r.reverse()),o.isEqualDiff(r)){const n=r[1]-r[0];i=o.FillChnNumber(e,t,n)}else i=o.FillCopy(e,t)}return i}static getDataIndex(e,t,n){const r={},s=Math.floor(t/e),o=t%e;let i=0;if(s>0){for(let t=1;t<=s;t++)for(let s=0;s<n.length;s++)r[n[s]+(t-1)*e]=i,i++;for(let t=0;t<n.length&&n[t]<=o;t++)r[n[t]+e*s]=i,i++}else for(let l=0;l<n.length&&n[l]<=o;l++)r[n[l]]=i,i++;return r}static FillCopy(e,t){const n=[];for(let r=1;r<=t;r++){const t=(r-1)%e.length,s=__spreadValues({},e[t]);n.push(s)}return n}static FillSeries(e,t,n){const r=this,s=[],o=[];for(let i=0;i<e.length;i++)o.push(Number(e[i].v));if(e.length>2&&r.isEqualRatio(o))for(let i=1;i<=t;i++){const t=(i-1)%e.length,r=__spreadValues({},e[t]);let o;n===Fe.BOTTOM||n===Fe.RIGHT?o=Number(e[e.length-1].v)*(Number(e[1].v)/Number(e[0].v))**i:n!==Fe.TOP&&n!==Fe.LEFT||(o=Number(e[0].v)/(Number(e[1].v)/Number(e[0].v))**i),r.v=o,r.m=o,s.push(r)}else{const i=r.getXArr(e.length);for(let l=1;l<=t;l++){const t=(l-1)%e.length,a=__spreadValues({},e[t]);let c;n===Fe.BOTTOM||n===Fe.RIGHT?c=r.forecast(e.length+l,o,i):n!==Fe.TOP&&n!==Fe.LEFT||(c=r.forecast(1-l,o,i)),a.v=c,a.m=c,s.push(a)}}return s}static FillExtendNumber(e,t,n){const r=[],s=/0|([1-9]+[0-9]*)/g;for(let o=1;o<=t;o++){const t=(o-1)%e.length,i=__spreadValues({},e[t]),l=e[e.length-1].m,a=l.match(s),c=a[a.length-1],h=Math.abs(Number(c)+n*o),u=l.lastIndexOf(c),d=l.substr(0,u)+h.toString()+l.substr(u+c.length);i.v=d,i.m=d,r.push(i)}return r}static FillOnlyFormat(e,t){const n=[];for(let r=1;r<=t;r++){const t=(r-1)%e.length,s=__spreadValues({},e[t]);delete s.f,delete s.m,delete s.v,n.push(s)}return n}static FillWithoutFormat(e){const t=[];for(let n=0;n<e.length;n++){const r=__spreadValues({},e[n]);let s;s=null===r.f?{m:r.v.toString(),v:r.v}:{f:r.f,m:r.v.toString(),v:r.v},t.push(s)}return t}static FillDays(e,t,n){const r=[];for(let s=1;s<=t;s++){const t=(s-1)%e.length,o=__spreadValues({},e[t]);let i=void o.v;i=hn(i).add(n*s,"days").format("YYYY-MM-DD"),o.v=vn(i)[2],o.m=(o.fm.f,void o.v),r.push(o)}return r}static FillMonths(e,t,n){const r=[];for(let s=1;s<=t;s++){const t=(s-1)%e.length,o=__spreadValues({},e[t]);let i=void o.v;i=hn(i).add(n*s,"months").format("YYYY-MM-DD"),o.v=vn(i)[2],o.m=(o.fm.f,void o.v),r.push(o)}return r}static FillYears(e,t,n){const r=[];for(let s=1;s<=t;s++){const t=(s-1)%e.length,o=__spreadValues({},e[t]);let i=void o.v;i=hn(i).add(n*s,"years").format("YYYY-MM-DD"),o.v=vn(i)[2],o.m=(o.fm.t,void o.v),r.push(o)}return r}static FillChnWeek(e,t,n){const r=this,s=[];for(let o=1;o<=t;o++){const t=(o-1)%e.length,i=__spreadValues({},e[t]);let l;l=""===e[e.length-1].m?7+n*o:r.ChineseToNumber(e[e.length-1].m)+n*o,l<0&&(l=7*Math.ceil(Math.abs(l)/7)+l);const a=l%7;0===a?(i.m="",i.v=""):1===a?(i.m="",i.v=""):2===a?(i.m="",i.v=""):3===a?(i.m="",i.v=""):4===a?(i.m="",i.v=""):5===a?(i.m="",i.v=""):6===a&&(i.m="",i.v=""),s.push(i)}return s}static FillChnWeek2(e,t,n){const r=this,s=[];for(let o=1;o<=t;o++){const t=(o-1)%e.length,i=__spreadValues({},e[t]);let l;if(""===e[e.length-1].m)l=7+n*o;else{const t=e[e.length-1].m,s=t.substr(t.length-1,1);l=r.ChineseToNumber(s)+n*o}l<0&&(l=7*Math.ceil(Math.abs(l)/7)+l);const a=l%7;0===a?(i.m="",i.v=""):1===a?(i.m="",i.v=""):2===a?(i.m="",i.v=""):3===a?(i.m="",i.v=""):4===a?(i.m="",i.v=""):5===a?(i.m="",i.v=""):6===a&&(i.m="",i.v=""),s.push(i)}return s}static FillChnWeek3(e,t,n){const r=this,s=[];for(let o=1;o<=t;o++){const t=(o-1)%e.length,i=__spreadValues({},e[t]);let l;if(""===e[e.length-1].m)l=7+n*o;else{const t=e[e.length-1].m,s=t.substr(t.length-1,1);l=r.ChineseToNumber(s)+n*o}l<0&&(l=7*Math.ceil(Math.abs(l)/7)+l);const a=l%7;0===a?(i.m="",i.v=""):1===a?(i.m="",i.v=""):2===a?(i.m="",i.v=""):3===a?(i.m="",i.v=""):4===a?(i.m="",i.v=""):5===a?(i.m="",i.v=""):6===a&&(i.m="",i.v=""),s.push(i)}return s}static FillChnNumber(e,t,n){const r=this,s=[];for(let o=1;o<=t;o++){const t=(o-1)%e.length,i=__spreadValues({},e[t]),l=r.ChineseToNumber(e[e.length-1].m)+n*o;let a;a=l<=0?"":r.NumberToChinese(l),i.v=a,i.m=a.toString(),s.push(i)}return s}static isEqualDiff(e){let t=!0;const n=e[1]-e[0];for(let r=1;r<e.length;r++)if(e[r]-e[r-1]!==n){t=!1;break}return t}static isChnNumber(e){const t=this;let n=!0;if(1===e.length)n=""===e||e in t.chnNumChar;else{const r=e.split("");for(let e=0;e<r.length;e++)if(!(r[e]in t.chnNumChar)&&!(r[e]in t.chnNameValue)){n=!1;break}}return n}static isExtendNumber(e){const t=/0|([1-9]+[0-9]*)/g,n=t.test(e);if(n){const r=e.match(t),s=r[r.length-1],o=e.lastIndexOf(s),i=e.substr(0,o),l=e.substr(o+s.length);return[n,Number(s),i,l]}return[n]}static isChnWeek1(e){const t=this;let n;return n=1===e.length&&(""===e||t.ChineseToNumber(e)<7),n}static isChnWeek2(e){let t;return t=2===e.length&&(""===e||""===e||""===e||""===e||""===e||""===e||""===e),t}static isChnWeek3(e){let t;return t=3===e.length&&(""===e||""===e||""===e||""===e||""===e||""===e||""===e),t}static isEqualRatio(e){let t=!0;const n=e[1]/e[0];for(let r=1;r<e.length;r++)if(e[r]/e[r-1]!==n){t=!1;break}return t}static getXArr(e){const t=[];for(let n=1;n<=e;n++)t.push(n);return t}static forecast(e,t,n){function r(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}const s=r(n),o=r(t);let i,l=0,a=0;for(let h=0;h<n.length;h++)l+=(n[h]-s)*(t[h]-o),a+=(n[h]-s)*(n[h]-s);i=0===a?1:l/a;const c=o-i*s;return Math.round(1e5*(c+i*e))/1e5}static judgeDate(e){let t=!0,n=!0,r=!0,s=!0,o=!0;const i=hn(e[0].m).date(),l=hn(e[0].m).month(),a=hn(e[1].m).diff(hn(e[0].m),"days"),c=hn(e[1].m).diff(hn(e[0].m),"months"),h=hn(e[1].m).diff(hn(e[0].m),"years");for(let u=1;u<e.length;u++)hn(e[u].m).date()!==i&&(t=!1),hn(e[u].m).month()!==l&&(n=!1),hn(e[u].m).diff(hn(e[u-1].m),"days")!==a&&(r=!1),hn(e[u].m).diff(hn(e[u-1].m),"months")!==c&&(s=!1),hn(e[u].m).diff(hn(e[u-1].m),"years")!==h&&(o=!1);return 0===a&&(r=!1),0===c&&(s=!1),0===h&&(o=!1),[t,n,r,s,o]}}class yn{constructor(e,t){this._context=e.getContext(),this._workbook=this._context.getWorkBook(),this._commandManager=this._context.getCommandManager(),this._worksheet=e,this._rangeList=[],t.forEach((e=>{this._rangeList.push(this._context.getWorkBook().transformRangeType(e).rangeData)})),-1===this._rangeList[0].startRow&&console.error("Invalid range,default set startRow -1")}getRangeList(){return this._rangeList}activate(){return-1===this._rangeList[0].startRow?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this._rangeList}),this)}setValue(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:s}=this;const o=t.map((t=>{let{startRow:n,startColumn:r,endRow:o,endColumn:i}=t,l=new p;for(let s=n;s<=o;s++)for(let t=r;t<=i;t++)l.setValue(n,r,{m:`${e}`,v:e});return{sheetId:s.getSheetId(),actionName:$s.NAME,cellValue:l.getData()}}));let i=new Wr({WorkBookUnit:n.getWorkBook()},...o);return r.invoke(i),this}clear(...e){const{_context:t,_worksheet:n,_commandManager:r,_rangeList:s}=this;let o={formatOnly:!0,contentsOnly:!0};Mr.checkup(e,Mr.OBJECT_TYPE)&&(o=e[0]);const i=s.map((e=>({sheetId:n.getSheetId(),actionName:Qs.NAME,options:o,rangeData:e})));let l=new Wr({WorkBookUnit:t.getWorkBook()},...i);return r.invoke(l),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}setBackground(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:s}=this;const o=t.map((t=>{let{startRow:n,startColumn:r,endRow:o,endColumn:i}=t;const l={bg:{rgb:e}},a=C.fillObjectMatrix(o-n+1,i-r+1,l);return{sheetId:s.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:a,rangeData:t}}));let i=new Wr({WorkBookUnit:n.getWorkBook()},...o);return r.invoke(i),this}setBackgroundRGB(e,t,n){const r=`RGB(${e},${t},${n})`;let{_rangeList:s,_context:o,_commandManager:i,_worksheet:l}=this;const a=s.map((e=>{let{startRow:t,startColumn:n,endRow:s,endColumn:o}=e;const i={bg:{rgb:r}},a=C.fillObjectMatrix(s-t+1,o-n+1,i);return{sheetId:l.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:a,rangeData:e}}));let c=new Wr({WorkBookUnit:o.getWorkBook()},...a);return i.invoke(c),this}setFontColor(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:s}=this;const o=t.map((t=>{let{startRow:n,startColumn:r,endRow:o,endColumn:i}=t;const l={cl:{rgb:e}},a=C.fillObjectMatrix(o-n+1,i-r+1,l);return{sheetId:s.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:a,rangeData:t}}));let i=new Wr({WorkBookUnit:n.getWorkBook()},...o);return r.invoke(i),this}setFontFamily(e){return this._setStyle(e,"ff")}setUnderline(e){const t={s:e?vt.TRUE:vt.FALSE};return this._setStyle(t,"ul")}setOverline(e){const t={s:e?vt.TRUE:vt.FALSE};return this._setStyle(t,"ol")}setStrikeThrough(e){const t={s:e?vt.TRUE:vt.FALSE};return this._setStyle(t,"st")}setFontSize(e){return this._setStyle(e,"fs")}setFontStyle(e){const t=e?vt.TRUE:vt.FALSE;return this._setStyle(t,"it")}setFontWeight(e){const t=e?vt.TRUE:vt.FALSE;return this._setStyle(t,"bl")}setHorizontalAlignment(e){return this._setStyle(e,"ht")}setTextDirection(e){return this._setStyle(e,"td")}setTextRotation(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:s}=this;const o=t.map((t=>{let{startRow:n,startColumn:r,endRow:o,endColumn:i}=t;const l={tr:{v:0,a:Number(e)}},a=C.fillObjectMatrix(o-n+1,i-r+1,l);return{sheetId:s.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:a,rangeData:t}}));let i=new Wr({WorkBookUnit:n.getWorkBook()},...o);return r.invoke(i),this}setVerticalAlignment(e){return this._setStyle(e,"vt"),this}setVerticalText(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:s}=this;const o=t.map((t=>{let{startRow:n,startColumn:r,endRow:o,endColumn:i}=t;const l={tr:{v:e,a:0}},a=C.fillObjectMatrix(o-n+1,i-r+1,l);return{sheetId:s.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:a,rangeData:t}}));let i=new Wr({WorkBookUnit:n.getWorkBook()},...o);return r.invoke(i),this}setWrap(e){return this._setStyle(e,"tb")}setWrapStrategy(e){return this._setStyle(e,"tb")}trimWhitespace(){let{_rangeList:e,_context:t,_commandManager:n,_worksheet:r}=this;const s=e.map((e=>{let{startRow:t,startColumn:n,endRow:s,endColumn:o}=e;const i=this._worksheet.getCellMatrix(),l=/\s+/g;let a=new p;for(let r=t;r<s+1;r++)for(let e=n;e<o+1;e++){const t=i.getValue(r,e).m.replace(l,"");a.setValue(r,e,t||"")}return{sheetId:r.getSheetId(),actionName:be.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:a.getData(),rangeData:e}}));let o=new Wr({WorkBookUnit:t.getWorkBook()},...s);return n.invoke(o),this}_setStyle(e,t){let{_rangeList:n,_context:r,_commandManager:s,_worksheet:o}=this;const i=n.map((n=>{let{startRow:r,startColumn:s,endRow:i,endColumn:l}=n;const a={[t]:e},c=C.fillObjectMatrix(i-r+1,l-s+1,a);return{sheetId:o.getSheetId(),value:c,rangeData:n,actionName:Co.NAME}}));let l=new Wr({WorkBookUnit:r.getWorkBook()},...i);return s.invoke(l),this}}class Sn{constructor(e,t){this._workSheet=e,this._rowData=new f(t)}getRowData(){return this._rowData}getRowDatas(e,t){const n=new f;for(let r=e;r<e+t;r++){const e=this.getRowOrCreate(r);n.push(e)}return n}getRowHeight(...e){const{_workSheet:t}=this,{_rowData:n}=this,r=t.getConfig();let s=0;if(1===e.length){s=n.obtain(e[0],{hd:vt.FALSE,h:r.defaultRowHeight}).h}else if(2===e.length)for(let o=e[0];o<e[0]+e[1];o++){s+=n.obtain(o,{hd:vt.FALSE,h:r.defaultRowHeight}).h}return s}setRowHeight(e,t){const n=this._workSheet.getContext(),r=this._workSheet.getCommandManager(),s={sheetId:this._workSheet.getSheetId(),actionName:yo.NAME,rowIndex:e,rowHeight:t},o=new Wr({WorkBookUnit:n.getWorkBook()},s);r.invoke(o)}getRow(e){const{_rowData:t}=this;return t.get(e)}getSize(){return this._rowData.getLength()}getRowOrCreate(e){const{_workSheet:t}=this,{_rowData:n}=this,r=n.get(e);if(r)return r;const s=t.getConfig(),o={hd:vt.FALSE,h:s.defaultRowHeight};return n.set(e,o),o}}class En{constructor(...e){var t;if(C.hasLength(e,1)){e=[e[0],__spreadProps(__spreadValues({},Lt),{mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A1"],rightToLeft:vt.FALSE,pluginMeta:{}})]}if(C.hasLength(e,2)){this._context=e[0],this._config=Object.assign(e[1],__spreadValues(__spreadProps(__spreadValues({},Lt),{mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A1"],rightToLeft:vt.FALSE,pluginMeta:{}}),e[1]));const{columnData:n,rowData:r,cellData:s}=this._config;this._sheetId=null!=(t=this._config.id)?t:C.generateRandomId(6),this._initialized=!1,this._cellData=new p(s),this._rowManager=new Sn(this,r),this._columnManager=new sn(this,n),this._initialize()}}getCellMatrix(){return this._cellData}activate(){if(this._config.status===vt.TRUE)return this;const{_context:e}=this,t=this.getCommandManager(),n=e.getContextObserver("onBeforeChangeActiveSheetObservable"),r=e.getContextObserver("onAfterChangeActiveSheetObservable"),s={sheetId:this._sheetId,actionName:No.NAME,status:vt.TRUE},o=new Wr({WorkBookUnit:e.getWorkBook()},s);return n.notifyObservers({sheet:this}),t.invoke(o),r.notifyObservers({sheet:this}),this}setConfig(e){return this._config=C.commonExtend(Lt,e),this}getRowManager(){return this._rowManager}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}setName(e){const{_context:t,_sheetId:n}=this,r=this.getCommandManager(),s=t.getContextObserver("onBeforeChangeSheetNameObservable"),o=t.getContextObserver("onAfterChangeSheetNameObservable"),i={actionName:Po.NAME,sheetName:e,sheetId:n},l=t.getWorkBook().getSheets();for(let c=0;c<l.length;c++){const t=l[c];if(t!==this&&t.getName()===e)return console.warn("Duplicate name"),this}s.notifyObservers();const a=new Wr({WorkBookUnit:t.getWorkBook()},i);return r.invoke(a),o.notifyObservers({name:e,sheet:this}),this}getName(){return this._config.name}clone(){const{_config:e,_context:t}=this,n=C.deepClone(e);return new En(t,n)}getContext(){return this._context}getMerges(){return this._merges}getCommandManager(){return this._context.getCommandManager()}getSheetData(){return[]}getRange(...e){return C.hasLength(e,1)?new Rn(this,e[0]):C.hasLength(e,2)?new Rn(this,{row:[e[0],e[0]],column:[e[1],e[1]]}):C.hasLength(e,3)?new Rn(this,{row:[e[0],e[2]],column:[e[1],e[1]]}):C.hasLength(e,4)?new Rn(this,{row:[e[0],e[2]],column:[e[1],e[3]]}):void 0}getRangeList(e){return new yn(this,e)}getStatus(){const{_config:e}=this;return e.status}setStatus(e){const{_context:t,_sheetId:n}=this,r=this.getCommandManager(),s={actionName:Bo.NAME,sheetId:n,sheetStatus:e},o=new Wr({WorkBookUnit:t.getWorkBook()},s);return r.invoke(o),this}getZoomRatio(){return this._config.zoomRatio||1}setZoomRatio(e){const{_context:t,_sheetId:n}=this,r=this.getCommandManager(),s={actionName:Ho.NAME,zoom:e,sheetId:n},o=new Wr({WorkBookUnit:t.getWorkBook()},s);r.invoke(o);t.getContextObserver("onZoomRatioSheetObservable").notifyObservers({zoomRatio:e})}getSelection(){return this._selection}copy(e){const{_config:t,_context:n}=this,r=C.deepClone(t);return r.name=e,r.status=vt.FALSE,r.id=C.generateRandomId(),new En(n,r)}getConfig(){return this._config}insertRows(...e){let t=0,n=1;C.hasLength(e,1)&&(t=e[0]),C.hasLength(e,2)&&(t=e[0],n=e[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:to.NAME,sheetId:s,rowIndex:t,rowData:p.MakeObjectMatrixSize(n).toJSON()},l={actionName:eo.NAME,sheetId:s,rowIndex:t,rowCount:n},a=new Wr({WorkBookUnit:r.getWorkBook()},i,l);return o.invoke(a),this}insertRowAfter(...e){let t=0,n=1;C.hasLength(e,1)&&(t=e[0]+1),C.hasLength(e,2)&&(t=e[0]+1,n=e[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:to.NAME,sheetId:s,rowIndex:t,rowData:p.MakeObjectMatrixSize(n).toJSON()},l={actionName:eo.NAME,sheetId:s,rowIndex:t,rowCount:n},a=new Wr({WorkBookUnit:r.getWorkBook()},i,l);return o.invoke(a),this}insertRowBefore(...e){let t=0,n=1;C.hasLength(e,1)&&(t=e[0]-1),C.hasLength(e,2)&&(t=e[0]-1,n=e[1]),t<0&&(t=0);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:to.NAME,sheetId:s,rowIndex:t,rowData:p.MakeObjectMatrixSize(n).toJSON()},l={actionName:eo.NAME,sheetId:s,rowIndex:t,rowCount:n},a=new Wr({WorkBookUnit:r.getWorkBook()},i,l);return o.invoke(a),this}insertColumns(...e){let t=0,n=1;C.hasLength(e,1)&&(t=e[0]),C.hasLength(e,2)&&(t=e[0],n=e[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i=new p;this._cellData.forEach((e=>{for(let r=t;r<t+n;r++)i.setValue(e,r-t,{})}));const l={actionName:Js.NAME,sheetId:s,columnIndex:t,columnData:i.toJSON()},a={actionName:qs.NAME,sheetId:s,columnIndex:t,columnCount:n},c=new Wr({WorkBookUnit:r.getWorkBook()},a,l);return o.invoke(c),this}insertColumnBefore(...e){let t=0,n=1;C.hasLength(e,1)&&(t=e[0]-1),C.hasLength(e,2)&&(t=e[0]-1,n=e[1]),t<0&&(t=0);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i=new p;if(this._cellData.getLength())this._cellData.forEach((e=>{for(let r=t;r<t+n;r++)i.setValue(e,r-t,{})}));else for(let h=0;h<this._config.rowCount;h++)for(let e=t;e<t+n;e++)i.setValue(h,e-t,{});const l={actionName:Js.NAME,sheetId:s,columnIndex:t,columnData:i.toJSON()},a={actionName:qs.NAME,sheetId:s,columnIndex:t,columnCount:n},c=new Wr({WorkBookUnit:r.getWorkBook()},a,l);return o.invoke(c),this}insertColumnAfter(...e){let t=0,n=1;C.hasLength(e,1)&&(t=e[0]+1),C.hasLength(e,2)&&(t=e[0]+1,n=e[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i=new p;this._cellData.forEach((e=>{for(let r=t;r<t+n;r++)i.setValue(e,r-t,{})}));const l={actionName:Js.NAME,sheetId:s,columnIndex:t,columnData:i.toJSON()},a={actionName:qs.NAME,sheetId:s,columnIndex:t,columnCount:n},c=new Wr({WorkBookUnit:r.getWorkBook()},l,a);return o.invoke(c),this}clear(...e){const{_context:t}=this,n=this.getCommandManager(),r={startRow:0,endRow:this.getConfig().rowCount-1,startColumn:0,endColumn:this.getConfig().columnCount-1};let s={formatOnly:!0,contentsOnly:!0};Mr.checkup(e,Mr.OBJECT_TYPE)&&(s=e[0]);const o={sheetId:this._sheetId,actionName:Qs.NAME,options:s,rangeData:r},i=new Wr({WorkBookUnit:t.getWorkBook()},o);return n.invoke(i),this}setTabColor(e){const{_context:t}=this,n=this.getCommandManager(),r=t.getContextObserver("onSheetTabColorChangeObservable"),s={sheetId:this._sheetId,actionName:Oo.NAME,color:e},o=new Wr({WorkBookUnit:t.getWorkBook()},s);return n.invoke(o),r.notifyObservers(),this}hideSheet(){const{_context:e}=this,t=this.getCommandManager(),n=e.getWorkBook();if(!this._config.hidden){const r=e.getContextObserver("onHideSheetObservable"),s={hidden:vt.TRUE,sheetId:this._sheetId,actionName:Lo.NAME},o=new Wr({WorkBookUnit:e.getWorkBook()},s);t.invoke(o),r.notifyObservers({sheet:this});const i=n.getSheetIndex(this);null!=i&&n.activateSheetByIndex(i)}return this}showSheet(){if(!this._config.hidden)return this;const{_context:e}=this,t=this.getCommandManager(),n={hidden:vt.FALSE,sheetId:this._sheetId,actionName:Lo.NAME},r=new Wr({WorkBookUnit:e.getWorkBook()},n);return t.invoke(r),e.getContextObserver("onShowSheetObservable").notifyObservers({sheet:this}),this}setActiveSelection(...e){const t=e[0];return t?this._selection.setSelection({selection:t}):this._selection.setSelection()}getFrozenRows(){return this._config.freezeRow}getFrozenColumns(){return this._config.freezeColumn}getMaxColumns(){const{_config:e}=this,{columnCount:t}=e;return t}getMaxRows(){const{_config:e}=this,{rowCount:t}=e;return t}getType(){const{_config:e}=this,{type:t}=e;return t}clearContents(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({contentsOnly:!0}),this}clearFormats(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({formatOnly:!0}),this}clearNotes(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({commentsOnly:!0}),this}deleteColumn(e){const{_context:t,_sheetId:n}=this,r=this.getCommandManager(),s={actionName:so.NAME,sheetId:n,columnCount:1,columnIndex:e},o={actionName:ro.NAME,sheetId:n,columnCount:1,columnIndex:e},i=new Wr({WorkBookUnit:t.getWorkBook()},s,o);return r.invoke(i),this}deleteColumns(e,t){const{_context:n,_sheetId:r}=this,s=this.getCommandManager(),o={actionName:so.NAME,sheetId:r,columnCount:t,columnIndex:e},i={actionName:ro.NAME,sheetId:r,columnCount:t,columnIndex:e},l=new Wr({WorkBookUnit:n.getWorkBook()},o,i);return s.invoke(l),this}deleteRow(e){const{_context:t,_sheetId:n}=this,r=this.getCommandManager(),s={actionName:lo.NAME,sheetId:n,rowCount:1,rowIndex:e},o={actionName:io.NAME,sheetId:n,rowCount:1,rowIndex:e},i=new Wr({WorkBookUnit:t.getWorkBook()},s,o);return r.invoke(i),this}deleteRows(e,t){const{_context:n,_sheetId:r}=this,s=this.getCommandManager(),o={actionName:lo.NAME,sheetId:r,rowCount:t,rowIndex:e},i={actionName:io.NAME,sheetId:r,rowCount:t,rowIndex:e},l=new Wr({WorkBookUnit:n.getWorkBook()},o,i);return s.invoke(l),this}getRowCount(){return this._config.rowCount}getColumnCount(){return this._config.columnCount}setBorderStyle(e,t,n){const{_sheetId:r}=this,s=this.getCommandManager(),o=this.getContext(),i=this.getCellMatrix(),l=o.getWorkBook(),a=l.getStyles(),c=this.getRange({startRow:e.startRow-1,startColumn:e.startColumn,endRow:e.startRow-1,endColumn:e.endColumn}),h=this.getRange({startRow:e.startRow,startColumn:e.startColumn-1,endRow:e.startRow,endColumn:e.endColumn-1}),u=this.getRange({startRow:e.endRow+1,startColumn:e.startColumn,endRow:e.endRow+1,endColumn:e.endColumn}),d=this.getRange({startRow:e.startRow,startColumn:e.endColumn+1,endRow:e.startRow,endColumn:e.endColumn+1}),g=this.getRange(e),f=new p,m=new p,b=new p,_=new p,v=new p;c.forEach(((e,t)=>{const n=i.getValue(e,t);if(n){const r=a.getStyleByCell(n);if(r){const n=C.deepClone(r);n.bd&&delete n.bd.b,f.setValue(e,t,n)}}})),u.forEach(((e,t)=>{const n=i.getValue(e,t);if(n){const r=a.getStyleByCell(n);if(r){const n=C.deepClone(r);n.bd&&delete n.bd.t,b.setValue(e,t,n)}}})),h.forEach(((e,t)=>{const n=i.getValue(e,t);if(n){const r=a.getStyleByCell(n);if(r){const n=C.deepClone(r);n.bd&&delete n.bd.r,m.setValue(e,t,n)}}})),d.forEach(((e,t)=>{const n=i.getValue(e,t);if(n){const r=a.getStyleByCell(n);if(r){const n=C.deepClone(r);n.bd&&delete n.bd.l,_.setValue(e,t,n)}}})),g.forEach(((e,n)=>{v.setValue(e,n,t)}));const T=[];if(n.includes(Fe.TOP)){const e={sheetId:r,actionName:co.NAME,styles:b.toJSON()};T.push(e)}if(n.includes(Fe.BOTTOM)){const e={sheetId:r,actionName:co.NAME,styles:f.toJSON()};T.push(e)}if(n.includes(Fe.LEFT)){const e={sheetId:r,actionName:co.NAME,styles:_.toJSON()};T.push(e)}if(n.includes(Fe.RIGHT)){const e={sheetId:r,actionName:co.NAME,styles:m.toJSON()};T.push(e)}const w={sheetId:r,actionName:co.NAME,styles:v.toJSON()};T.push(w);const y=new Wr({WorkBookUnit:l},...T);return s.invoke(y),this}setCurrentCell(e){return e.activateAsCurrentCell()}getActiveCell(){return this.getSelection().getCurrentCell()}getActiveRange(){return this.getSelection().getActiveRange()}getActiveRangeList(){return this.getSelection().getActiveRangeList()}getIndex(){const e=this._context.getWorkBook().getSheets().findIndex((e=>e&&e.getSheetId()===this._sheetId));return e>-1?e+1:null}getParent(){return this._context.getWorkBook()}isSheetHidden(){return this._config.hidden}setActiveRange(e){return this.getSelection().setSelection(e)}setActiveRangeList(e){const t=this.getSelection();return t.setSelection(e),t.getActiveRangeList()}hideRow(e){const t=e.getRangeData(),n=t.startRow,r=t.endRow-t.startRow+1,{_context:s,_sheetId:o}=this,i=this.getCommandManager(),l={actionName:So.NAME,sheetId:o,rowCount:r,rowIndex:n},a=new Wr({WorkBookUnit:s.getWorkBook()},l);return i.invoke(a),this}hideRows(...e){const t=--e[0];let n=1;e[1]&&(n=e[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:So.NAME,sheetId:s,rowCount:n,rowIndex:t},l=new Wr({WorkBookUnit:r.getWorkBook()},i);return o.invoke(l),this}hideColumn(e){const t=e.getRangeData(),n=t.startColumn,r=t.endColumn-t.startColumn+1,{_context:s,_sheetId:o}=this,i=this.getCommandManager(),l={actionName:ho.NAME,sheetId:o,columnCount:r,columnIndex:n},a=new Wr({WorkBookUnit:s.getWorkBook()},l);return i.invoke(a),this}hideColumns(...e){const t=e[0];let n=1;e[1]&&(n=e[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:ho.NAME,sheetId:s,columnCount:n,columnIndex:t},l=new Wr({WorkBookUnit:r.getWorkBook()},i);return o.invoke(l),this}unhideRow(e){const t=e.getRangeData(),n=t.startRow,r=t.endRow-t.startRow+1,{_context:s,_sheetId:o}=this,i=this.getCommandManager(),l={actionName:Eo.NAME,rowCount:r,rowIndex:n,sheetId:o},a=new Wr({WorkBookUnit:s.getWorkBook()},l);return i.invoke(a),this}unhideColumn(e){const t=e.getRangeData(),n=t.startColumn,r=t.endColumn-t.startColumn+1,{_context:s,_sheetId:o}=this,i=this.getCommandManager(),l={actionName:uo.NAME,sheetId:o,columnCount:r,columnIndex:n},a=new Wr({WorkBookUnit:s.getWorkBook()},l);return i.invoke(a),this}showColumns(...e){const t=e[0];let n=1;e[1]&&(n=e[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:uo.NAME,sheetId:s,columnCount:n,columnIndex:t},l=new Wr({WorkBookUnit:r.getWorkBook()},i);return o.invoke(l),this}showRows(...e){const t=--e[0];let n=1;e[1]&&(n=e[1]);const{_context:r,_sheetId:s}=this,o=this.getCommandManager(),i={actionName:Eo.NAME,sheetId:s,rowCount:n,rowIndex:t},l=new Wr({WorkBookUnit:r.getWorkBook()},i);return o.invoke(l),this}hasHiddenGridlines(){const{_config:e}=this,{showGridlines:t}=e;return 0===t}getTabColor(){const{_config:e}=this,{tabColor:t}=e;return t}getColumnWidth(e){return this.getColumnManager().getColumnWidth(e)}getRowHeight(e){return this.getRowManager().getRowHeight(e)}setColumnWidth(...e){let t,n=[];if(C.hasLength(e,2)&&(t=e[0],n=[e[1]]),C.hasLength(e,3)){t=e[0];for(let t=0;t<e[1];t++)n.push(e[2])}return this.getColumnManager().setColumnWidth(t,n),this}setRowHeights(e,t,n){const r=[];for(let s=0;s<t;s++)r.push(n);return this.getRowManager().setRowHeight(e,r),this}setRowHeight(e,t){const n=[t];return this.getRowManager().setRowHeight(e,n),this}setHiddenGridlines(e){const{_context:t,_sheetId:n}=this,r=this.getCommandManager(),s={actionName:fo.NAME,hideGridlines:e,sheetId:n},o=new Wr({WorkBookUnit:t.getWorkBook()},s);return r.invoke(o),this}isRightToLeft(){const{_config:e}=this,{rightToLeft:t}=e;return t}setRightToLeft(e){const{_context:t,_sheetId:n}=this,r=this.getCommandManager(),s={actionName:wo.NAME,rightToLeft:e,sheetId:n},o=new Wr({WorkBookUnit:t.getWorkBook()},s);return r.invoke(o),this}getPluginMeta(e){return this._config.pluginMeta[e]}setPluginMeta(e,t){this._config.pluginMeta[e]=t}copyTo(e){const t=this._context.getWorkBook().getSheets()[e];if(!t)return this;const n=C.deepClone(this._config);return n.sheetId=t.getConfig().id,t.setConfig(n),t}getLastRow(){return this._cellData.getLength()}getLastColumn(){return this._cellData.getRange().endColumn}getSheetValues(e,t,n,r){return new Rn(this,{startRow:e,startColumn:t,endRow:e+n-1,endColumn:t+r-1}).getValues()}getDataRange(){return new Rn(this,this._cellData.getRange())}moveRows(e,t){const{startRow:n}=e.getRangeData(),{endRow:r}=e.getRangeData(),s=this._cellData.spliceRows(n,r-n+1);return this._cellData.insertRows(t,s),this}moveColumns(e,t){const n=e.getRangeData().startColumn,r=e.getRangeData().endColumn,s=this._cellData.spliceColumns(n,r-n+1);return this._cellData.insertColumns(t,s),this}_initialize(){this._merges=new on(this,this._config.mergeData)}}class Rn{constructor(e,t){this._context=e.getContext(),this._commandManager=this._context.getCommandManager(),this._rangeData=this._context.getWorkBook().transformRangeType(t).rangeData,this._worksheet=e,Object.values(this._rangeData).includes(-1)&&console.error("Invalid range,default set index -1")}static foreach(e,t){const{startRow:n,startColumn:r,endRow:s,endColumn:o}=e;for(let i=n;i<=s;i++)for(let e=r;e<=o;e++)t(i,e)}getRangeData(){return this._rangeData}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData,s=[];for(let o=e;o<=t;o++){const e=[];for(let t=n;t<=r;t++)e.push(this.getMatrix().getValue(o,t)||null);s.push(e)}return s}getMatrix(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData,s=this._worksheet.getCellMatrix(),o=new p;for(let i=e;i<=t;i++)for(let e=n;e<=r;e++)o.setValue(i,e,s.getValue(i,e)||null);return o}getMatrixObject(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData,s=this._worksheet.getCellMatrix(),o=new p;for(let i=e;i<=t;i++)for(let t=n;t<=r;t++)o.setValue(i-e,t-n,s.getValue(i,t)||{});return o}getDisplayValue(){const e=this.getValue();return e&&e.p?e.p:e&&e.m?e.m:""}getDisplayValues(){return this.getValues().map((e=>e.map((e=>e&&e.p?e.p:e&&e.m?e.m:""))))}getA1Notation(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData;let s,o;return n<r?(s=C.numToWord(n+1)+(e+1),o=C.numToWord(r+1)+(t+1)):(s=C.numToWord(r+1)+(t+1),o=C.numToWord(n+1)+(e+1)),s===o?`${s}`:`${s}:${o}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){return this.getValues().map((e=>e.map((e=>{var t,n,r;const s=this._context.getWorkBook().getStyles();let o=null==(t=Dt.bg)?void 0:t.rgb;return o=null==(r=null==(n=s.getStyleByCell(e))?void 0:n.bg)?void 0:r.rgb,o}))))}getCell(e,t){const{startRow:n,endRow:r,startColumn:s,endColumn:o}=this._rangeData,i={startRow:n+e,endRow:n+e,startColumn:s+t,endColumn:s+t};return new Rn(this._worksheet,i)}getColumn(){return this._rangeData.startColumn}getObjectValue(e={}){return this.getObjectValues(e)[0][0]}getObjectValues(e={}){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._rangeData,o=this._worksheet.getCellMatrix().getFragments(t,n,r,s).getData();if(e.isIncludeStyle){const e=this._context.getWorkBook().getStyles();for(let i=0;i<=n-t;i++)for(let t=0;t<=s-r;t++){if(!o[i][t])continue;const n=o[i][t].s;n&&(o[i][t].s=e.get(n))}}return o}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){return this.getValues().map((e=>e.map((e=>{var t,n;const r=this._context.getWorkBook().getStyles().getStyleByCell(e);return(null==(t=null==r?void 0:r.cl)?void 0:t.rgb)||(null==(n=Dt.cl)?void 0:n.rgb)}))))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){return this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getStrikeThrough(){return this.getStrikeThroughs()[0][0]}getFontSize(){return this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getBorder(){return this.getBorders()[0][0]}getBorders(){return this._getStyles("bd")}getFontStyle(){return this.getFontStyles()[0][0]}getFontStyles(){return this._getStyles("it")}getFontWeight(){return this.getFontWeights()[0][0]}getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_rangeData:e,_worksheet:t}=this,{startRow:n,endRow:r}=e;let s=0;for(let o=0;o<=r-n;o++){s+=t.getRowHeight(o)}return s}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._rangeData.endColumn}getLastRow(){return this._rangeData.endRow}getMergedRanges(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData;return this._worksheet.getMerges().getMergedRanges({startRow:e,endRow:t,startColumn:n,endColumn:r}).map((e=>new Rn(this._worksheet,e)))}getNextDataCell(e){const{_worksheet:t}=this,{startRow:n,endRow:r,startColumn:s,endColumn:o}=this._rangeData,i=t.getMaxRows(),l=t.getMaxColumns();if(e===Fe.BOTTOM){for(let e=0;e<i-s;e++){this._worksheet.getCellMatrix().getValue(n+e,s)&&t.getRange(n+e,s,n+e,s)}return t.getRange(i,s,i,s)}if(e===Fe.TOP){for(let e=0;e<n;e++){this._worksheet.getCellMatrix().getValue(n-e,s)&&t.getRange(n-e,s,n-e,n)}return t.getRange(0,s,0,s)}if(e===Fe.RIGHT){for(let e=0;e<l-s;e++){this._worksheet.getCellMatrix().getValue(n,s+e)&&t.getRange(n,s+e,n,s+e)}return t.getRange(n,l,n,l)}if(e===Fe.LEFT){for(let e=0;e<i-s;e++){this._worksheet.getCellMatrix().getValue(n,s-e)&&t.getRange(n,s-e,n,s-e)}return t.getRange(n,0,n,0)}return t.getRange(Ot)}getNumColumns(){const{startColumn:e,endColumn:t}=this._rangeData;return t-e+1}getNumRows(){const{startRow:e,endRow:t}=this._rangeData;return t-e+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map((e=>e.map((e=>(null==e?void 0:e.p)||""))))}getRowIndex(){return this._rangeData.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){return this.getValues().map((e=>e.map((e=>this._context.getWorkBook().getStyles().getStyleByCell(e)))))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_rangeData:e,_worksheet:t}=this,{startColumn:n,endColumn:r}=e;let s=0;for(let o=0;o<=r-n;o++)s+=t.getColumnWidth(o);return s}getWrap(){return this.getWraps()[0][0]}getWraps(){return this._getStyles("tb")}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}isBlank(){return this.getValues().some((e=>e.some((e=>""===(null==e?void 0:e.m)))))}isPartOfMerge(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData;return!!this._worksheet.getMerges().getByRowColumn(e,t,n,r)}setBackground(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a={bg:{rgb:e}},c=C.fillObjectMatrix(o-s+1,l-i+1,a),h={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},u=new Wr({WorkBookUnit:t.getWorkBook()},h);return r.invoke(u),this}setBackgrounds(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a=new p;for(let u=0;u<o-s+1;u++)for(let t=0;t<l-i+1;t++)a.setValue(u,t,{bg:{rgb:e[u][t]}});const c={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:a.getData(),rangeData:this._rangeData},h=new Wr({WorkBookUnit:t.getWorkBook()},c);return r.invoke(h),this}setBackgroundRGB(e,t,n){const{_context:r,_worksheet:s,_commandManager:o}=this,{startRow:i,endRow:l,startColumn:a,endColumn:c}=this._rangeData,h={bg:{rgb:`RGB(${e},${t},${n})`}},u=C.fillObjectMatrix(l-i+1,c-a+1,h),d={sheetId:s.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},g=new Wr({WorkBookUnit:r.getWorkBook()},d);return o.invoke(g),this}setFontColors(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a=new p;for(let u=0;u<o-s+1;u++)for(let t=0;t<l-i+1;t++)a.setValue(u,t,{cl:{rgb:e[u][t]}});const c={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:a.getData(),rangeData:this._rangeData},h=new Wr({WorkBookUnit:t.getWorkBook()},c);return r.invoke(h),this}setFontFamilies(e){return this._setStyles(e,"ff"),this}setUnderline(e){return this._setStyle(e,"ul"),this}setOverline(e){return this._setStyle(e,"ol"),this}setStrikeThrough(e){return this._setStyle(e,"st"),this}setUnderlines(e){return this._setStyles(e,"ul"),this}setOverlines(e){return this._setStyles(e,"ol"),this}setStrikeThroughs(e){return this._setStyles(e,"st"),this}setFontSizes(e){return this._setStyles(e,"fs"),this}setFontStyle(e){return this._setStyle(e,"it"),this}setFontStyles(e){return this._setStyles(e,"it"),this}setFontWeight(e){return this._setStyle(e,"bl"),this}setFontWeights(e){return this._setStyles(e,"bl"),this}setHorizontalAlignments(e){return this._setStyles(e,"ht"),this}setTextDirections(e){return this._setStyles(e,"td"),this}setTextRotation(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a={tr:{v:0,a:Number(e)}},c=C.fillObjectMatrix(o-s+1,l-i+1,a),h={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},u=new Wr({WorkBookUnit:t.getWorkBook()},h);return r.invoke(u),this}setTextRotations(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a=new p;for(let u=0;u<o-s+1;u++)for(let t=0;t<l-i+1;t++)a.setValue(u,t,{tr:{v:0,a:e[u][t]}});a.getData();const c={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:a.getData(),rangeData:this._rangeData},h=new Wr({WorkBookUnit:t.getWorkBook()},c);return r.invoke(h),this}setTextStyle(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a=__spreadValues({},e),c=C.fillObjectMatrix(o-s+1,l-i+1,a),h={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},u=new Wr({WorkBookUnit:t.getWorkBook()},h);return r.invoke(u),this}setTextStyles(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a=new p;for(let u=0;u<o-s+1;u++)for(let t=0;t<l-i+1;t++)a.setValue(u,t,__spreadValues({},e[u][t]));const c={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:a.getData(),rangeData:this._rangeData},h=new Wr({WorkBookUnit:t.getWorkBook()},c);return r.invoke(h),this}setVerticalAlignments(e){return this._setStyles(e,"vt"),this}setVerticalText(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a={tr:{v:e,a:90}},c=C.fillObjectMatrix(o-s+1,l-i+1,a),h={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},u=new Wr({WorkBookUnit:t.getWorkBook()},h);return r.invoke(u),this}setWrap(e){return this._setStyle(e,"tb"),this}setWrapStrategies(e){return this._setStyles(e,"tb"),this}setWraps(e){return this._setStyles(e,"tb"),this}autoFill(e,t){const{_worksheet:n,_context:r,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:l,endColumn:a}=this._rangeData,{startRow:c,endRow:h,startColumn:u,endColumn:d}=e._rangeData;let g=Fe.BOTTOM,f=0,m=0;const b=o,_=i,v=l,C=a,T=c,w=h,y=u,S=d,E=new p;if(g=y===v&&S===C?w>_?Fe.BOTTOM:Fe.TOP:S>C?Fe.RIGHT:Fe.LEFT,g===Fe.BOTTOM||g===Fe.TOP){f=_-b+1,m=w-T+1;for(let e=0;e<=a-l;e++){const n=this.getColumnMatrix(e).toArray();wn.getCopyData(n,b,_,v,C,g).forEach((n=>{wn.getApplyData(n,f,m,t,g).forEach(((t,n)=>{E.setValue(n,e,t)}))}))}}else if(g===Fe.RIGHT||g===Fe.LEFT){m=S-y,f=C-v;for(let e=0;e<=i-o;e++){const n=this.getRowMatrix(e).toArray();wn.getCopyData(n,b,_,v,C,g).forEach((e=>{wn.getApplyData(e,f,m,t,g)}))}}const R={sheetId:n.getSheetId(),actionName:be.SET_RANGE_DATA_ACTION,cellValue:E.getData()},I=new Wr({WorkBookUnit:r.getWorkBook()},R);return s.invoke(I),this}getDataRegion(...e){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._rangeData;let o,i;const l=this._worksheet.getCellMatrix();if(!C.isNumber(e[0])){let e=t,n=t;const s=this._worksheet.getRowCount();for(let o=1;o<t;o++){if(!l.getValue(t-o,r)){e=t-o+1;break}}const a=0;for(;a<s-t;){if(!l.getValue(t+a,r)){n=t-a-1;break}}let c=t,h=t;const u=this._worksheet.getColumnCount();for(let o=1;o<t;o++){if(!l.getValue(t,r-o)){c=t-o+1;break}}const d=0;for(;d<u-r;){if(!l.getValue(t,r+d)){h=t-d-1;break}}return i=c-h,i=e-n,o=t,this._worksheet.getRange(e,c,o,i)}{const n=e[0];if(n===Be.COLUMNS){let e=t,n=t;const s=this._worksheet.getRowCount();for(let o=1;o<t;o++){if(!l.getValue(t-o,r)){e=t-o+1;break}}const a=0;for(;a<s-t;){if(!l.getValue(t+a,r)){n=t-a-1;break}}return i=e-n,o=0,this._worksheet.getRange(t,e,o,i)}if(n===Be.ROWS){let e=t,n=t;const s=this._worksheet.getColumnCount();for(let o=1;o<t;o++){if(!l.getValue(t,r-o)){e=t-o+1;break}}const a=0;for(;a<s-r;){if(!l.getValue(t,r+a)){n=t-a-1;break}}return i=0,o=e-n,this._worksheet.getRange(e,r,o,i)}}return this}trimWhitespace(){var e;const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a=this._worksheet.getCellMatrix(),c=/\s+/g,h=new p;for(let g=0;g<=o-s;g++)for(let t=0;t<=l-i;t++){const n=null==(e=a.getValue(g,t).m)?void 0:e.replace(c,"");h.setValue(g+s,t+i,n||"")}const u={sheetId:n.getSheetId(),actionName:be.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:this._rangeData},d=new Wr({WorkBookUnit:t.getWorkBook()},u);return r.invoke(d),this}activate(){var e;return-1===(null==(e=this._rangeData)?void 0:e.startRow)?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this}),this)}activateAsCurrentCell(){return this._worksheet.getSelection().setCurrentCell(this),this}isIntersection(e){const t=this._rangeData.startRow,n=this._rangeData.endRow,r=this._rangeData.startColumn,s=this._rangeData.endColumn,o=e.getRangeData().startRow,i=e.getRangeData().endRow,l=e.getRangeData().startColumn,a=e.getRangeData().endColumn,c=Math.abs(r+s-l-a),h=Math.abs(r-s)+Math.abs(l-a),u=Math.abs(t+n-o-i),d=Math.abs(t-n)+Math.abs(o-i);return c<=h&&u<=d}setFontColor(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a={cl:{rgb:e}},c=C.fillObjectMatrix(o-s+1,l-i+1,a),h={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},u=new Wr({WorkBookUnit:t.getWorkBook()},h);return r.invoke(u),this}copyTo(...e){const{_context:t,_worksheet:n,_commandManager:r}=this,s=e[0],[o,i]=this._handleCopyRange(this,s),{startRow:l,startColumn:a,endRow:c,endColumn:h}=i;if(Mr.checkup(e,Rn,Mr.BOOLEAN_TYPE)){const s=e[1];if(e[2],s===ke.PASTE_NORMAL){const e=new p;o.forEach(((t,n)=>t.forEach(((t,r)=>{t=t,e.setValue(n+l,r+a,t||{})}))));const s={sheetId:n.getSheetId(),actionName:be.SET_RANGE_DATA_ACTION,cellValue:e.getData()},i=new Wr({WorkBookUnit:t.getWorkBook()},s);r.invoke(i)}else if(s===ke.PASTE_FORMAT){const e=t.getWorkBook().getStyles(),s=new p;o.map(((t,n)=>t.forEach(((t,r)=>{t=t,s.setValue(n,r,e.getStyleByCell(t)||{})}))));const l={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:s.getData(),rangeData:i},a=new Wr({WorkBookUnit:t.getWorkBook()},l);r.invoke(a)}else if(s===ke.PASTE_VALUES){const e=new p;o.forEach(((t,n)=>t.forEach(((t,r)=>{t=t,e.setValue(n+l,r+a,(null==t?void 0:t.v)||"")}))));const s={sheetId:n.getSheetId(),actionName:be.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:e.getData(),rangeData:i},c=new Wr({WorkBookUnit:t.getWorkBook()},s);r.invoke(c)}else if(s===ke.PASTE_COLUMN_WIDTHS){const e=this._rangeData.startColumn;for(let t=0;t<h-e;t++){const r=n.getColumnWidth(e+t);n.setColumnWidth(e+t,r)}}}else if(Mr.checkup(e,Rn,Mr.OBJECT_TYPE)){const s=e[1],i=new p;o.forEach(((e,t)=>e.forEach(((e,n)=>{e=e,i.setValue(t+l,n+a,e||{})}))));const c={sheetId:n.getSheetId(),actionName:be.SET_RANGE_DATA_ACTION,cellValue:i.getData(),options:s},h=new Wr({WorkBookUnit:t.getWorkBook()},c);r.invoke(h)}else if(Mr.checkup(e,Rn)){const e=new p;o.forEach(((t,n)=>t.forEach(((t,r)=>{t=t,e.setValue(n+l,r+a,t||{})}))));const s={sheetId:n.getSheetId(),actionName:be.SET_RANGE_DATA_ACTION,cellValue:e.getData()},i=new Wr({WorkBookUnit:t.getWorkBook()},s);r.invoke(i)}}copyFormatToRange(...e){const{_context:t,_commandManager:n}=this,r=e[1],s=e[2],o=e[3],i=e[4],l=C.isAssignableFrom(e[0],En)?e[0].getSheetId():e[0],[a,c]=this._handleCopyRange(this,{startRow:r,endRow:s,startColumn:o,endColumn:i}),h=t.getWorkBook().getStyles(),u=new p;a.map(((e,t)=>e.map(((e,n)=>(e=e,u.setValue(t,n,h.getStyleByCell(e)||{}),h.getStyleByCell(e)||{})))));const d={sheetId:l,actionName:be.SET_RANGE_STYLE_ACTION,value:u.getData(),rangeData:c},g=new Wr({WorkBookUnit:t.getWorkBook()},d);n.invoke(g)}copyValuesToRange(...e){const{_context:t,_commandManager:n}=this,r=e[1],s=e[2],o=e[3],i=e[4],l=C.isAssignableFrom(e[0],En)?e[0].getSheetId():e[0],[a,c]=this._handleCopyRange(this,{startRow:r,endRow:s,startColumn:o,endColumn:i}),h=new p;a.forEach(((e,t)=>e.forEach(((e,n)=>{e=e,h.setValue(t+c.startRow,n+c.startColumn,(null==e?void 0:e.v)||"")}))));const u={sheetId:l,actionName:be.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:c},d=new Wr({WorkBookUnit:t.getWorkBook()},u);n.invoke(d)}moveTo(e){const{_context:t,_worksheet:n,_commandManager:r,_rangeData:s}=this,o={sheetId:n.getSheetId(),actionName:be.CLEAR_RANGE_ACTION,options:{formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0},rangeData:s},i=this.getMatrix(),{startRow:l,endRow:a,startColumn:c,endColumn:h}=this._rangeData,{startRow:u,startColumn:d}=e.getRangeData(),g=new p;for(let p=l;p<=a;p++)for(let e=c;e<=h;e++)g.setValue(u+(p-l),d+(e-c),i.getValue(p,e)||{});const f={sheetId:n.getSheetId(),actionName:be.SET_RANGE_DATA_ACTION,cellValue:g.getData()},m=new Wr({WorkBookUnit:t.getWorkBook()},o,f);r.invoke(m)}offset(...e){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._rangeData,o=e[0],i=e[1],l=e[2],a=e[3],c={startRow:t+o,endRow:n+o,startColumn:r+i,endColumn:s+i};return C.isNumber(l)&&(c.endRow=c.startRow+l-1),C.isNumber(a)&&(c.endColumn=c.endColumn+a-1),new Rn(this._worksheet,c)}setBorder(...e){const t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],i=e[5],l=e[6]?e[6]:"black",a=e[7]?e[7]:ye.DASH_DOT,{_context:c,_worksheet:h,_commandManager:u}=this,d=c.getWorkBook(),g=this._rangeData,f=h.getSheetId(),m={startRow:g.startRow-1,startColumn:g.startColumn,endRow:g.startRow-1,endColumn:g.endColumn},b={startRow:g.startRow,startColumn:g.startColumn-1,endRow:g.endRow,endColumn:g.startColumn-1},_={startRow:g.endRow+1,startColumn:g.startColumn,endRow:g.endRow+1,endColumn:g.endColumn},v={startRow:g.startRow,startColumn:g.endColumn+1,endRow:g.endRow,endColumn:g.endColumn+1},T={startRow:g.startRow,startColumn:g.startColumn,endRow:g.startRow,endColumn:g.endColumn},w={startRow:g.startRow,startColumn:g.startColumn,endRow:g.endRow,endColumn:g.startColumn},y={startRow:g.endRow,startColumn:g.startColumn,endRow:g.endRow,endColumn:g.endColumn},S={startRow:g.startRow,startColumn:g.endColumn,endRow:g.endRow,endColumn:g.endColumn},E=new Rn(h,m),R=new Rn(h,b),I=new Rn(h,_),A=new Rn(h,v),x=new Rn(h,T),O=new Rn(h,w),M=new Rn(h,y),N=new Rn(h,S),k=new p,L=new p,D=new p,P=new p,B=new p,H=[],F={s:a,cl:{rgb:l}};if(!0===t||!1===t){if(E.isValid()){E.forEach(((e,t)=>{k.setValue(e,t,{bd:{b:null}})}));const e={sheetId:f,actionName:be.SET_RANGE_STYLE_ACTION,value:k.getArrayData(),rangeData:m};H.push(e)}x.forEach(((e,n)=>{if(!0===t){const t=C.deepMerge(B.getValue(e,n)||{},{bd:{t:C.deepClone(F)}});B.setValue(e,n,t)}else if(!1===t){const t=C.deepMerge(B.getValue(e,n)||{},{bd:{t:null}});B.setValue(e,n,t)}}))}if(!0===r||!1===r){if(I.isValid()){I.forEach(((e,t)=>{D.setValue(e,t,{bd:{t:null}})}));const e={sheetId:f,actionName:be.SET_RANGE_STYLE_ACTION,value:D.getArrayData(),rangeData:_};H.push(e)}M.forEach(((e,t)=>{if(!0===r){const n=C.deepMerge(B.getValue(e,t)||{},{bd:{b:C.deepClone(F)}});B.setValue(e,t,n)}else if(!1===r){const n=C.deepMerge(B.getValue(e,t)||{},{bd:{b:null}});B.setValue(e,t,n)}}))}if(!0===n||!1===n){if(R.isValid()){R.forEach(((e,t)=>{L.setValue(e,t,{bd:{r:null}})}));const e={sheetId:f,actionName:be.SET_RANGE_STYLE_ACTION,value:L.getArrayData(),rangeData:b};H.push(e)}O.forEach(((e,t)=>{if(!0===n){const n=C.deepMerge(B.getValue(e,t)||{},{bd:{l:C.deepClone(F)}});B.setValue(e,t,n)}else if(!1===n){const n=C.deepMerge(B.getValue(e,t)||{},{bd:{l:null}});B.setValue(e,t,n)}}))}if(!0===s||!1===s){if(A.isValid()){A.forEach(((e,t)=>{P.setValue(e,t,{bd:{l:null}})}));const e={sheetId:f,actionName:be.SET_RANGE_STYLE_ACTION,value:P.getArrayData(),rangeData:v};H.push(e)}N.forEach(((e,t)=>{if(!0===s){const n=C.deepMerge(B.getValue(e,t)||{},{bd:{r:C.deepClone(F)}});B.setValue(e,t,n)}else if(!1===s){const n=C.deepMerge(B.getValue(e,t)||{},{bd:{r:null}});B.setValue(e,t,n)}}))}!0!==o&&!1!==o||this.forEach(((e,t)=>{if(t!==g.endColumn)if(!0===o){const n=C.deepMerge(B.getValue(e,t)||{},{bd:{r:C.deepClone(F)}});B.setValue(e,t,n)}else if(!1===o){const n=C.deepMerge(B.getValue(e,t)||{},{bd:{r:null}});B.setValue(e,t,n)}if(t!==g.startColumn){const n=C.deepMerge(B.getValue(e,t)||{},{bd:{l:null}});B.setValue(e,t,n)}})),!0!==i&&!1!==i||this.forEach(((e,t)=>{if(e!==g.endRow)if(!0===i){const n=C.deepMerge(B.getValue(e,t)||{},{bd:{b:C.deepClone(F)}});B.setValue(e,t,n)}else if(!1===i){const n=C.deepMerge(B.getValue(e,t)||{},{bd:{b:null}});B.setValue(e,t,n)}if(e!==g.startRow){const n=C.deepMerge(B.getValue(e,t)||{},{bd:{t:null}});B.setValue(e,t,n)}}));const z={sheetId:f,actionName:be.SET_RANGE_STYLE_ACTION,value:B.getArrayData(),rangeData:B.getDataRange()};H.push(z);const U=new Wr({WorkBookUnit:d},...H);return u.invoke(U),this}setBorderByType(e,t,n){let r=null,s=null,o=null,i=null,l=null,a=null;switch(e){case Ee.TOP:r=!0;break;case Ee.BOTTOM:o=!0;break;case Ee.LEFT:s=!0;break;case Ee.RIGHT:i=!0;break;case Ee.NONE:r=!1,s=!1,o=!1,i=!1,l=!1,a=!1;break;case Ee.ALL:r=!0,s=!0,o=!0,i=!0,l=!0,a=!0;break;case Ee.OUTSIDE:r=!0,s=!0,o=!0,i=!0;break;case Ee.INSIDE:l=!0,a=!0;break;case Ee.HORIZONTAL:a=!0;break;case Ee.VERTICAL:l=!0}this.setBorder(r,s,o,i,l,a,t,n)}setFontFamily(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a={ff:e},c=C.fillObjectMatrix(o-s+1,l-i+1,a),h={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},u=new Wr({WorkBookUnit:t.getWorkBook()},h);return r.invoke(u),this}setFontSize(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a={fs:e},c=C.fillObjectMatrix(o-s+1,l-i+1,a),h={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},u=new Wr({WorkBookUnit:t.getWorkBook()},h);return r.invoke(u),this}setHorizontalAlignment(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a={ht:e},c=C.fillObjectMatrix(o-s+1,l-i+1,a),h={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},u=new Wr({WorkBookUnit:t.getWorkBook()},h);return r.invoke(u),this}setVerticalAlignment(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a={vt:e},c=C.fillObjectMatrix(o-s+1,l-i+1,a),h={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},u=new Wr({WorkBookUnit:t.getWorkBook()},h);return r.invoke(u),this}setTextDirection(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a={td:e},c=C.fillObjectMatrix(o-s+1,l-i+1,a),h={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},u=new Wr({WorkBookUnit:t.getWorkBook()},h);return r.invoke(u),this}setWrapStrategy(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a={tb:e},c=C.fillObjectMatrix(o-s+1,l-i+1,a),h={sheetId:n.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},u=new Wr({WorkBookUnit:t.getWorkBook()},h);return r.invoke(u),this}setValue(e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:s}=this,{startRow:o,startColumn:i,endRow:l,endColumn:a}=t,c=new p;for(let d=o;d<=l;d++)for(let t=i;t<=a;t++)c.setValue(d,t,e);const h={sheetId:s.getSheetId(),actionName:be.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:this._rangeData},u=new Wr({WorkBookUnit:n.getWorkBook()},h);return r.invoke(u),this}setValues(...e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:s}=this,o=e[0];if(Mr.checkup(e,Array)){const{startRow:e,startColumn:i,endRow:l,endColumn:a}=t,c=new p;for(let t=0;t<=l-e;t++)for(let n=0;n<=a-i;n++)c.setValue(t+e,n+i,o[t][n]);const h={sheetId:s.getSheetId(),actionName:be.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:this._rangeData},u=new Wr({WorkBookUnit:n.getWorkBook()},h);r.invoke(u)}else if(Mr.checkup(e,p)){const e={sheetId:s.getSheetId(),actionName:be.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:o,rangeData:this._rangeData},t=new Wr({WorkBookUnit:n.getWorkBook()},e);r.invoke(t)}return this}setRangeData(e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:s}=this,{startRow:o,startColumn:i}=t,l={sheetId:s.getSheetId(),actionName:be.SET_RANGE_DATA_ACTION,cellValue:{[o]:{[i]:e}}},a=new Wr({WorkBookUnit:n.getWorkBook()},l);return r.invoke(a),this}setRangeDatas(...e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:s}=this,o=e[0];if(Mr.checkup(e,Array)){const{startRow:e,startColumn:i,endRow:l,endColumn:a}=t,c=new p;for(let t=0;t<=l-e;t++)for(let n=0;n<=a-i;n++)c.setValue(t+e,n+i,o[t][n]);const h={sheetId:s.getSheetId(),actionName:be.SET_RANGE_DATA_ACTION,cellValue:c.getData()},u=new Wr({WorkBookUnit:n.getWorkBook()},h);r.invoke(u)}else if(Mr.checkup(e,p)){const e={sheetId:s.getSheetId(),actionName:be.SET_RANGE_DATA_ACTION,cellValue:o},t=new Wr({WorkBookUnit:n.getWorkBook()},e);r.invoke(t)}return this}clear(...e){const{_context:t,_worksheet:n,_commandManager:r,_rangeData:s}=this;let o={formatOnly:!0,contentsOnly:!0};Mr.checkup(e,Mr.OBJECT_TYPE)&&(o=e[0]);const i={sheetId:n.getSheetId(),actionName:be.CLEAR_RANGE_ACTION,options:o,rangeData:s},l=new Wr({WorkBookUnit:t.getWorkBook()},i);return r.invoke(l),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}deleteCells(e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:s}=this,o={sheetId:s.getSheetId(),actionName:be.DELETE_RANGE_ACTION,shiftDimension:e,rangeData:t},i=new Wr({WorkBookUnit:n.getWorkBook()},o);r.invoke(i)}insertCells(...e){const t=e[0],n=e[1],{_rangeData:r,_context:s,_commandManager:o,_worksheet:i}=this,{startRow:l,endRow:a,startColumn:c,endColumn:h}=this._rangeData;let u=this._rangeData,d=new p;if(n){d=n.getMatrixObject();const e=n.getRangeData();u={startRow:l,endRow:l+e.endRow-e.startRow,startColumn:c,endColumn:l+e.endColumn-e.startColumn}}else for(let m=l;m<=a;m++)for(let e=c;e<=h;e++)d.setValue(m,e,{m:"",v:""});const g={sheetId:i.getSheetId(),actionName:be.INSERT_RANGE_ACTION,shiftDimension:t,rangeData:u,cellValue:d.getData()},f=new Wr({WorkBookUnit:s.getWorkBook()},g);return o.invoke(f),this}merge(){const{_worksheet:e}=this;return e.getMerges().add(this._rangeData),this}mergeAcross(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),r=e.getSheetId(),{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a=[];for(let u=s;u<=o;u++){const e={startRow:u,endRow:u,startColumn:i,endColumn:l};a.push(e)}const c={actionName:be.ADD_MERGE_ACTION,sheetId:r,rectangles:a},h=new Wr({WorkBookUnit:n.getWorkBook()},c);return t.invoke(h),this}mergeVertically(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),r=e.getSheetId(),{startRow:s,endRow:o,startColumn:i,endColumn:l}=this._rangeData,a=[];for(let u=i;u<=l;u++){const e={startRow:s,endRow:o,startColumn:u,endColumn:u};a.push(e)}const c={actionName:be.ADD_MERGE_ACTION,sheetId:r,rectangles:a},h=new Wr({WorkBookUnit:n.getWorkBook()},c);return t.invoke(h),this}breakApart(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),r=e.getSheetId(),s=this._worksheet.getMerges().getMergedRanges(this._rangeData),o={actionName:be.REMOVE_MERGE_ACTION,sheetId:r,rectangles:s},i=new Wr({WorkBookUnit:n.getWorkBook()},o);return t.invoke(i),this}removeDuplicates(...e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:s}=this;Array.isArray(e[0])&&e[0];const o=this.getMatrix().getData(),i=[];for(let u=0;u<=t.endColumn-t.startColumn;u++){const e=[],t={},n=this.getColumnMatrix(u).getData();for(const r in n){const s=n[r][u].m;t.hasOwnProperty(s)||(t[s]=1,e.push(u))}i.push(e)}const l=Array.from(new Set(i.flat())),a={};l.forEach(((e,t)=>{a[t]=o[e]}));const c=[{sheetId:s.getSheetId(),actionName:be.SET_RANGE_DATA_ACTION,cellValue:a}],h=new Wr({WorkBookUnit:n.getWorkBook()},...c);return r.invoke(h),this}getRowMatrix(e){const{startColumn:t,endColumn:n}=this._rangeData,r=this._worksheet.getCellMatrix(),s=new p;for(let o=e;o<=e;o++)for(let e=t;e<=n;e++)s.setValue(o,e,r.getValue(o,e)||{});return s}getColumnMatrix(e){const{startRow:t,endRow:n}=this._rangeData,r=this._worksheet.getCellMatrix(),s=new p;for(let o=t;o<=n;o++)for(let t=e;t<=e;t++)s.setValue(o,t,r.getValue(o,t)||{});return s}forEach(e){Rn.foreach(this._rangeData,e)}randomize(){const{_context:e,_worksheet:t,_commandManager:n,_rangeData:r}=this,{startRow:s,startColumn:o}=r,i=new p;C.randSort(this.getMatrix().toArray()).forEach(((e,t)=>e.forEach(((e,n)=>{e=e,i.setValue(t+s,n+o,e||{})}))));const l={sheetId:t.getSheetId(),actionName:be.SET_RANGE_DATA_ACTION,cellValue:i.getData()},a=new Wr({WorkBookUnit:e.getWorkBook()},l);n.invoke(a)}isValid(){return!Object.values(this._rangeData).includes(-1)}_handleCopyRange(...e){const t=e[0];let n=e[1];n=Mr.checkup(e,Rn,Rn)?n.getRangeData():n;const r=t._worksheet.getCellMatrix(),{startRow:s,endRow:o,startColumn:i,endColumn:l}=t.getRangeData();let{startRow:a,endRow:c,startColumn:h,endColumn:u}=n;const d=o-s+1,g=l-i+1,f=c-a+1,m=u-h+1;let p,b=[];if(f%d==0&&m%g==0){for(let e=0;e<f;e++){const t=[];for(let n=0;n<m;n++){const o=r.getValue((e+s)%d,(n+i)%g)||{};t.push(o)}b.push(t)}p=n}else b=r.getFragments(s,o,i,l).getData(),c+=d-f,u+=g-m,p={startRow:a,endRow:c,startColumn:h,endColumn:u};return[b,p]}_getStyles(e){return this.getValues().map((t=>t.map((t=>{const n=this._context.getWorkBook().getStyles(),r=n&&n.getStyleByCell(t);return r&&r[e]||Dt[e]}))))}_setStyle(e,t){const{_context:n,_worksheet:r,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:l,endColumn:a}=this._rangeData,c={[t]:e},h=C.fillObjectMatrix(i-o+1,a-l+1,c),u={sheetId:r.getSheetId(),actionName:Co.NAME,value:h,rangeData:this._rangeData},d=new Wr({WorkBookUnit:n.getWorkBook()},u);return s.invoke(d),this}_setStyles(e,t){const{_context:n,_worksheet:r,_commandManager:s}=this,{startRow:o,endRow:i,startColumn:l,endColumn:a}=this._rangeData,c=new p;for(let d=0;d<i-o+1;d++)for(let n=0;n<a-l+1;n++)c.setValue(d,n,{[t]:e[d][n]});const h={sheetId:r.getSheetId(),actionName:be.SET_RANGE_STYLE_ACTION,value:c.getData(),rangeData:this._rangeData},u=new Wr({WorkBookUnit:n.getWorkBook()},h);return s.invoke(u),this}}class In{constructor(e={}){this._styles=e}each(e){return Object.entries(this._styles).forEach(e),this}search(e){const{_styles:t}=this;for(const n in t)if(C.diffValue(t[n],e))return n;return"-1"}get(e){return"string"!=typeof(e=String(e))?e:this._styles[e]}add(e){const t=C.generateRandomId(6);return this._styles[t]=e,t}setValue(e){if(null==e)return;const t=this.search(e);return"-1"!==t?t:this.add(e)}toJSON(){return this._styles}getStyleByCell(e){let t;return t=e&&C.isObject(e.s)?e.s:(null==e?void 0:e.s)&&this.get(e.s),t}}class An{constructor(e){this._workbook=e,this._commandManager=this._workbook.getCommandManager(),this._context=this._workbook.getContext()}addNamedRange(e){const{_workbook:t,_context:n,_commandManager:r}=this,s={actionName:js.NAME,namedRange:e,sheetId:e.range.sheetId},o=new Wr({WorkBookUnit:t},s);r.invoke(o)}setNamedRange(e){const{_workbook:t,_commandManager:n}=this,r={actionName:be.SET_NAMED_RANGE_ACTION,namedRange:e,sheetId:e.range.sheetId},s=new Wr({WorkBookUnit:t},r);n.invoke(s)}remove(e){const{_context:t,_workbook:n,_commandManager:r}=this,s={actionName:be.DELETE_NAMED_RANGE_ACTION,namedRangeId:e,sheetId:n.getActiveSheet().getSheetId()},o=new Wr({WorkBookUnit:n},s);r.invoke(o)}}class xn{constructor(e={},t){this._config=C.commonExtend(kt,e),this._context=t;const{styles:n}=this._config;""===this._config.id&&(this._config.id=C.generateRandomId(6)),this._unitId=this._config.id,this._styles=new In(n),this._worksheets=new Map,this._getDefaultWorkSheet(),this._namedRange=new An(this)}static rangeDataToRangeStringData(e){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=e;return`${C.chatAtABC(r)+(t+1)}:${C.chatAtABC(s)}${n+1}`}static isIRangeType(e){return"string"==typeof e||"startRow"in e||"row"in e}getUnitId(){return this._unitId}getWorksheets(){return this._worksheets}getNamedRang(){return this._namedRange}activateSheetByIndex(e){if(e>=0){const{sheetOrder:t}=this._config;for(let r=e;r<t.length;r++){const e=this._worksheets.get(t[r]);if(e&&!e.isSheetHidden())return e.activate(),e}if(e<t.length)for(let r=e-1;r>=0;r--){const e=this._worksheets.get(t[r]);if(e&&!e.isSheetHidden())return e.activate(),e}const n=this._worksheets.get(t[t.length-1]);return n&&n.activate(),n}}setContext(e){this._context=e}insertSheet(...e){const{_context:t}=this,n=t.getGenName(),r=this.getCommandManager(),s=t.getContextObserver("onBeforeInsertSheetObservable"),o=t.getContextObserver("onAfterInsertSheetObservable");if(C.hasLength(e,0)){const e={name:n.sheetName(),status:0,id:C.generateRandomId(6)},i=this.getSheetSize();return s.notifyObservers({index:i,sheetId:e.id}),r.invoke(new Wr({WorkBookUnit:t.getWorkBook()},{actionName:no.NAME,sheetId:e.id,index:i,sheet:e})),o.notifyObservers({index:i,sheetId:e.id}),e.id}if(C.hasLength(e,1)){if(C.isAssignableFrom(e[0],En)){const n=e[0],i=this.getSheetSize(),l=n.getConfig();return l.id=C.generateRandomId(6),s.notifyObservers({index:i,sheetId:l.id}),r.invoke(new Wr({WorkBookUnit:t.getWorkBook()},{actionName:no.NAME,sheetId:l.id,index:i,sheet:l})),o.notifyObservers({index:i,sheetId:l.id}),l.id}if(C.isNumber(e[0])){const i=e[0],l={name:n.sheetName(),status:0,id:C.generateRandomId(6)};return s.notifyObservers({index:i,sheetId:l.id}),r.invoke(new Wr({WorkBookUnit:t.getWorkBook()},{actionName:no.NAME,sheetId:l.id,index:i,sheet:l})),o.notifyObservers({index:i,sheetId:l.id}),l.id}if(C.isString(e[0])){const n=e[0],i=this.getSheetSize(),l={status:0,name:n,id:C.generateRandomId(6)};return s.notifyObservers({index:i,sheetId:l.id}),r.invoke(new Wr({WorkBookUnit:t.getWorkBook()},{actionName:no.NAME,sheetId:l.id,index:i,sheet:l})),o.notifyObservers({index:i,sheetId:l.id}),l.id}if(C.isPlainObject(e[0])){const n=e[0],i=this.getSheetSize();return s.notifyObservers({index:i,sheetId:n.id}),r.invoke(new Wr({WorkBookUnit:t.getWorkBook()},{actionName:no.NAME,sheetId:n.id,index:i,sheet:n})),o.notifyObservers({index:i,sheetId:n.id}),n.id}}if(C.hasLength(e,2)){if(C.isString(e[0])){const n=e[0],i=e[1],l={status:0,name:n,id:C.generateRandomId(6)};return s.notifyObservers({index:i,sheetId:l.id}),r.invoke(new Wr({WorkBookUnit:t.getWorkBook()},{actionName:no.NAME,sheetId:l.id,index:i,sheet:l})),o.notifyObservers({index:i,sheetId:l.id}),l.id}if(C.isNumber(e[0])){if(C.isAssignableFrom(e[1],En)){const n=e[0],i=e[1].getConfig();return i.id=C.generateRandomId(6),s.notifyObservers({index:n,sheetId:i.id}),r.invoke(new Wr({WorkBookUnit:t.getWorkBook()},{actionName:no.NAME,sheetId:i.id,index:n,sheet:i})),o.notifyObservers({index:n,sheetId:i.id}),i.id}if(C.isPlainObject(e[1])){const n=e[0],i=e[1];return s.notifyObservers({index:n,sheetId:i.id}),r.invoke(new Wr({WorkBookUnit:t.getWorkBook()},{actionName:no.NAME,sheetId:i.id,index:n,sheet:i})),o.notifyObservers({index:n,sheetId:i.id}),i.id}}}}getActiveSpreadsheet(){return this}getStyles(){return this._styles}getContext(){return this._context}getConfig(){return this._config}create(...e){if(C.hasLength(e,1)){const{_context:t}=this,n=e[0],r=__spreadProps(__spreadValues({},Lt),{name:n}),s=new En(t,r);return this.insertSheet(s),s}if(C.hasLength(e,3)){const{_context:t}=this,n=e[0],r=e[1],s=e[2],o=__spreadProps(__spreadValues({},Lt),{name:n,rowCount:r,columnCount:s}),i=new En(t,o);return this.insertSheet(i),i}}setDefaultActiveSheet(){this._setDefaultActiveSheet()}getIndexBySheetId(e){const{sheetOrder:t}=this._config;return t.findIndex((t=>t===e))}getActiveSheet(){const{sheetOrder:e}=this._config,t=e.find((e=>this._worksheets.get(e).getStatus()===vt.TRUE));return t?this._worksheets.get(t):(console.warn("No active sheet, get first sheet"),this._worksheets[0])}getActiveSheetIndex(){const{sheetOrder:e}=this._config;return e.findIndex((e=>1===this._worksheets.get(e).getStatus()))}getActiveRange(){const e=this.getActiveSheet();if(e){return e.getSelection().getActiveRange()}return null}setActiveRange(e){const t=this.getActiveSheet();return t?t.setActiveSelection(e):null}setActiveRangeList(e){const t=this.getActiveSheet();if(t){const n=t.getRangeList(e);return n.activate(),n.getRangeList()}return null}getActiveRangeList(){const e=this.getActiveSheet();if(e){return e.getSelection().getActiveRangeList()}return null}getSelection(){const e=this.getActiveSheet();if(e)return e.getSelection()}getCurrentCell(){const e=this.getSelection();if(e)return e.getCurrentCell()}getSheetSize(){return this._config.sheetOrder.length}setCurrentCell(e){return e.activateAsCurrentCell()}flush(){}setSheetOrder(e,t){const{_context:n}=this,r=this.getCommandManager(),s=n.getContextObserver("onSheetOrderObservable"),o={actionName:Ao.NAME,sheetId:e,order:t},i=new Wr({WorkBookUnit:n.getWorkBook()},o);r.invoke(i),s.notifyObservers()}getSheets(){const{sheetOrder:e}=this._config;return e.map((e=>this._worksheets.get(e)))}getSheetIndex(e){const{sheetOrder:t}=this._config;return t.findIndex((t=>e.getSheetId()===t))}removeSheetBySheetId(e){const{_config:t}=this,{sheetOrder:n}=t,r=this.getCommandManager(),s=this.getSheetBySheetId(e);if(n.length>1&&null!=s){const t=this.getSheetIndex(s),n=this.getContext().getContextObserver("onBeforeRemoveSheetObservable"),o=this.getContext().getContextObserver("onAfterRemoveSheetObservable");n.notifyObservers({index:t}),r.invoke(new Wr({WorkBookUnit:this},{actionName:ao.NAME,sheetId:e})),o.notifyObservers({index:t,sheetId:e}),this.activateSheetByIndex(t)}}getSheetBySheetName(e){const{sheetOrder:t}=this._config,n=t.find((t=>this._worksheets.get(t).getName()===e));return this._worksheets.get(n)}getSheetBySheetId(e){return this._worksheets.get(e)}setActiveSheet(...e){let t=!1;const n=e[0];return Mr.checkup(e,En,Mr.BOOLEAN_TYPE)&&(t=e[1]),n.activate(),t&&n.setActiveSelection(),n}getCommandManager(){return this._context.getCommandManager()}getPluginMeta(e){return this._config.pluginMeta[e]}setPluginMeta(e,t){return this._config.pluginMeta||(this._config.pluginMeta={}),this._config.pluginMeta[e]=t}transformRangeType(e){if("string"==typeof e){return this._getCellRange(e)}return"string"!=typeof e&&"row"in e?{sheetId:"",rangeData:{startRow:e.row[0],startColumn:e.column[0],endRow:e.row[1],endColumn:e.column[1]}}:"string"!=typeof e&&"startRow"in e?{sheetId:"",rangeData:e}:xt}load(e){this._config=e}save(){return this._config}_getDefaultWorkSheet(){const{_context:e,_config:t,_worksheets:n}=this,{sheets:r,sheetOrder:s}=t,o=e.getGenName();C.isEmptyObject(r)&&(r[Lt.id]=Object.assign(Lt,{status:vt.TRUE}));let i=null;for(let l in r){let t=r[l];t.name=o.sheetName(t.name);const a=new En(e,t);n.set(l,a),s.includes(l)||s.push(l),null==i&&(i=a)}i&&i.activate()}_setDefaultActiveSheet(){this._worksheets.size>0&&(this._worksheets.forEach((e=>{e.setStatus(vt.FALSE)})),this._worksheets[0].setStatus(vt.TRUE))}_getCellRange(e){var t,n,r,s,o;let i="",l="";if(e.indexOf("!")>-1){const t=e.split("!");i=t[0],l=t[1],i=i.replace(/\\'/g,"'").replace(/''/g,"'"),"'"===i.substring(0,1)&&"'"===i.substring(i.length-1,1)&&(i=i.substring(1,i.length-1))}else l=e;if(-1===l.indexOf(":")){const e=parseInt(l.replace(/[^0-9]/g,""),10)-1,t=C.ABCatNum(l.replace(/[^A-Za-z]/g,""));if(!Number.isNaN(e)&&!Number.isNaN(t)){return{sheetId:i,rangeData:{startRow:e,endRow:e,startColumn:t,endColumn:t}}}return xt}l=l.split(":");const a=[0,0],c=[0,0],h=(null==(t=this.getSheetBySheetName(i))?void 0:t.getMaxRows())||(null==(n=this.getActiveSheet())?void 0:n.getMaxRows()),u=(null==(r=this.getSheetBySheetName(i))?void 0:r.getMaxColumns())||(null==(s=this.getActiveSheet())?void 0:s.getMaxColumns());if(a[0]=parseInt(l[0].replace(/[^0-9]/g,""),10)-1,a[1]=parseInt(l[1].replace(/[^0-9]/g,""),10)-1,Number.isNaN(a[0])&&(a[0]=0),Number.isNaN(a[1])&&(a[1]=h),a[0]>a[1])return xt;if(c[0]=C.ABCatNum(l[0].replace(/[^A-Za-z]/g,"")),c[1]=C.ABCatNum(l[1].replace(/[^A-Za-z]/g,"")),Number.isNaN(c[0])&&(c[0]=0),Number.isNaN(c[1])&&(c[1]=u),c[0]>c[1])return xt;return{sheetId:(null==(o=this.getSheetBySheetName(i))?void 0:o.getSheetId())||"",rangeData:{startRow:a[0],endRow:a[1],startColumn:c[0],endColumn:c[1]}}}}class On{constructor(e){this._workSheet=e,this._context=e.getContext(),this._commandManager=this._context.getCommandManager(),this._workbook=e.getContext().getWorkBook(),this._activeRangeList=this._workSheet.getRangeList([Mt]),this._activeRange=this._workSheet.getRange(Mt),this._currentCell=this._workSheet.getRange(Mt)}static cellInRange(e,t){for(const n of e)if(n.startRow<=t.startRow&&t.endRow<=n.endRow&&n.startColumn<=t.startColumn&&t.endColumn<=n.endColumn)return n;return null}setWorkSheet(e){this._workSheet=e}setSelection({selection:e,cell:t}={}){var n;let r,s,o;if(e instanceof Rn?(s=e.getRangeData(),-1===s.startRow&&console.error("Invalid selection, default set startRow -1"),r=[s],o={startRow:s.startRow,endRow:s.startRow,startColumn:s.startColumn,endColumn:s.startColumn}):e&&xn.isIRangeType(e)?(s=this._workbook.transformRangeType(e).rangeData,-1===s.startRow&&console.error("Invalid selection, default set startRow -1"),r=[s],o={startRow:s.startRow,endRow:s.startRow,startColumn:s.startColumn,endColumn:s.startColumn}):e instanceof Array?(r=e.map((e=>{const t=this._workbook.transformRangeType(e).rangeData;return-1===t.startRow&&console.error("Invalid selection, default set startRow -1"),t})),s=r[r.length-1],o={startRow:s.startRow,endRow:s.startRow,startColumn:s.startColumn,endColumn:s.startColumn}):(r=this._activeRangeList.getRangeList(),s=this._activeRange.getRangeData(),o=this._currentCell.getRangeData()),t){o=this._workbook.transformRangeType(t).rangeData;On.cellInRange(r,o)||(s=o,r=[s])}const{_context:i,_workSheet:l,_commandManager:a}=this,c={sheetId:l.getSheetId(),actionName:Io.NAME,activeRangeList:r,activeRange:s,currentCell:o},h=new Wr({WorkBookUnit:i.getWorkBook()},c);a.invoke(h);const u=`${C.chatAtABC(s.startColumn)+(s.startRow+1)}:${C.chatAtABC(s.endColumn)}${s.endRow+1}`;return null==(n=this._context.getObserverManager().getObserver("onAfterSetSelectionObservable"))||n.notifyObservers(u),this._activeRange}getSelection(){return C.deepClone(this._activeRange.getRangeData())}getActiveRange(){return this._activeRange}getActiveRangeList(){return this._activeRangeList}getActiveSheet(){return this._workbook.getActiveSheet()}getCurrentCell(){return this._currentCell}setCurrentCell(e){if(C.isAssignableFrom(e,Rn)&&(e=e.getRangeData()),-1===(null==e?void 0:e.startRow))return console.error("Invalid range,default set startRow -1"),this;if(e.startRow!==e.endRow||e.startColumn!==e.endColumn)return console.error("Exception: Range must have a single cell."),this;const t=this._activeRangeList.getRangeList(),{_context:n,_workSheet:r,_commandManager:s}=this,o={sheetId:r.getSheetId(),actionName:Io.NAME,activeRangeList:t,activeRange:e,currentCell:e},i=new Wr({WorkBookUnit:n.getWorkBook()},o);return s.invoke(i),this}setRanges(e,t,n){this._activeRangeList=this._workSheet.getRangeList(e),this._activeRange=this._workSheet.getRange(t),this._currentCell=this._workSheet.getRange(n)}getNextDataRange(e){const t=this._expandRange(e);return this.setSelection({selection:t}),this.getActiveRange()}_expandRange(e){const t=this._workSheet.getColumnCount(),n=this._workSheet.getRowCount(),r=this._activeRange.getRangeData();let s=Mt;const o=this.getCurrentCell().getRangeData();if(e===Fe.RIGHT)if(o.startColumn===r.startColumn){const e=this._workSheet.getCellMatrix().getValue(o.startRow,r.endColumn);let n;if(e&&void 0===e.v)for(let s=r.endColumn+1;s<=t;s++){if(s===t){n=t;break}const e=this._workSheet.getCellMatrix().getValue(o.startRow,s);if(e&&void 0!==e.v){n=s;break}}else for(let s=r.endColumn+1;s<=t;s++){if(s===t){n=t;break}const e=this._workSheet.getCellMatrix().getValue(o.startRow,s);if(e&&void 0===e.v){const e=this._workSheet.getCellMatrix().getValue(o.startRow,s-1);if(e&&void 0!==e.v){n=s-1;break}}}s={startRow:r.startRow,endRow:r.endRow,startColumn:r.startColumn,endColumn:void 0!==n?n:r.endColumn}}else{const e=this._workSheet.getCellMatrix().getValue(o.startRow,r.startColumn);let t;if(e&&void 0===e.v)for(let n=r.startColumn+1;n<=o.startColumn;n++){if(n===o.startColumn){t=o.startColumn;break}const e=this._workSheet.getCellMatrix().getValue(o.startRow,n);if(e&&void 0!==e.v){t=n;break}}else for(let n=r.startColumn+1;n<=o.startColumn;n++){if(n===o.startColumn){t=o.startColumn;break}const e=this._workSheet.getCellMatrix().getValue(o.startRow,n);if(e&&void 0===e.v){const e=this._workSheet.getCellMatrix().getValue(o.startRow,n-1);if(e&&void 0!==e.v){t=n-1;break}}}s={startRow:r.startRow,endRow:r.endRow,startColumn:t||o.startColumn,endColumn:r.endColumn}}if(e===Fe.LEFT){let e,t;if(o.endColumn===r.endColumn){const t=this._workSheet.getCellMatrix().getValue(o.startRow,r.startColumn);if(t&&void 0===t.v)for(let n=r.startColumn-1;n>=0;n--){if(0===n){e=0;break}const t=this._workSheet.getCellMatrix().getValue(o.startRow,n);if(t&&void 0!==t.v){e=n;break}}else for(let n=r.startColumn-1;n>=0;n--){if(0===n){e=0;break}const t=this._workSheet.getCellMatrix().getValue(o.startRow,n);if(t&&void 0===t.v){const t=this._workSheet.getCellMatrix().getValue(o.startRow,n-1);if(t&&void 0!==t.v){e=n-1;break}}}}else{const e=this._workSheet.getCellMatrix().getValue(o.startRow,r.endColumn);if(e&&void 0===e.v)for(let n=r.endColumn-1;n>=o.startColumn;n--){if(n===o.startColumn){t=n;break}const e=this._workSheet.getCellMatrix().getValue(o.startRow,n);if(e&&void 0!==e.v){t=n;break}}else for(let n=r.endColumn-1;n>=o.startColumn;n--){if(n===o.startColumn){t=n;break}const e=this._workSheet.getCellMatrix().getValue(o.startRow,n);if(e&&void 0===e.v){const e=this._workSheet.getCellMatrix().getValue(o.startRow,n-1);if(e&&void 0!==e.v){t=n-1;break}}}}s={startRow:r.startRow,endRow:r.endRow,startColumn:void 0!==e?e:r.startColumn,endColumn:void 0!==t?t:r.endColumn}}if(e===Fe.TOP){let e,t;if(o.endRow===r.endRow){const t=this._workSheet.getCellMatrix().getValue(r.startRow,o.startColumn);if(t&&void 0===t.v)for(let n=r.endRow-1;n>=0;n--){const t=this._workSheet.getCellMatrix().getValue(n,o.startColumn);if(t&&void 0!==t.v||0===n){e=n;break}}else for(let n=r.startRow-1;n>=0;n--){if(0===n){e=0;break}const t=this._workSheet.getCellMatrix().getValue(n,o.startColumn);if(t&&void 0===t.v){const t=this._workSheet.getCellMatrix().getValue(n-1,o.startColumn);if(t&&void 0!==t.v){e=n-1;break}}}}else{const e=this._workSheet.getCellMatrix().getValue(r.endRow,o.startColumn);if(e&&void 0===e.v)for(let n=r.endRow-1;n>=o.startRow;n--){if(n===o.startRow){t=o.startRow;break}const e=this._workSheet.getCellMatrix().getValue(n,o.startColumn);if(e&&void 0!==e.v){t=n;break}}else for(let n=r.endRow-1;n>=o.startRow;n--){const e=this._workSheet.getCellMatrix().getValue(n,o.startColumn);if(n===o.startRow){t=o.startRow;break}if(e&&void 0===e.v&&n!==r.endRow-1){const e=this._workSheet.getCellMatrix().getValue(n+1,o.startColumn);if(e&&void 0!==e.v){t=n+1;break}}}}s={startRow:void 0!==e?e:r.startRow,endRow:void 0!==t?t:r.endRow,startColumn:r.startColumn,endColumn:r.endColumn}}if(e===Fe.BOTTOM){let e,t;if(o.startRow===r.startRow){const e=this._workSheet.getCellMatrix().getValue(r.endRow,o.startColumn);if(e&&void 0===e.v)for(let s=r.endRow+1;s<=n;s++){if(s===n){t=n;break}const e=this._workSheet.getCellMatrix().getValue(s,o.startColumn);if(e&&void 0!==e.v){t=s;break}}else for(let s=r.endRow+1;s<=n;s++){if(s===n){t=n;break}const e=this._workSheet.getCellMatrix().getValue(s,o.startColumn);if(e&&void 0===e.v){const e=this._workSheet.getCellMatrix().getValue(s+1,o.startColumn);if(e&&void 0!==e.v){t=s+1;break}}}}else{const t=this._workSheet.getCellMatrix().getValue(r.startRow+1,o.startColumn);if(t&&void 0===t.v)for(let n=r.startRow+1;n<=o.startRow;n++){if(n===o.startRow){e=o.startRow;break}const t=this._workSheet.getCellMatrix().getValue(n,o.startColumn);if(t&&void 0!==t.v){e=n;break}}else for(let n=r.startRow+1;n<=o.startRow;n++){if(n===o.startRow){e=o.startRow;break}const t=this._workSheet.getCellMatrix().getValue(n,o.startColumn);if(t&&void 0===t.v&&n!==r.startRow+1){const t=this._workSheet.getCellMatrix().getValue(n-1,o.startColumn);if(t&&void 0!==t.v){e=n-1;break}}}}s={startRow:void 0!==e?e:r.startRow,endRow:void 0!==t?t:r.endRow,startColumn:r.startColumn,endColumn:r.endColumn}}return s}}function Mn(e){if(!e)return;let{row:t,column:n,startY:r,endY:s,startX:o,endX:i,isMerged:l,mergeInfo:a}=e,c=t,h=n,u=t,d=n;if(l&&a){const{startRow:e,startColumn:t,endRow:n,endColumn:l,startY:g,endY:f,startX:m,endX:p}=a;c=e,h=t,u=n,d=l,r=g,s=f,o=m,i=p}return{startRow:c,startColumn:h,endRow:u,endColumn:d,startY:r,endY:s,startX:o,endX:i}}function Nn(e){if(!e)return!0;return 0===((null==e?void 0:e.m)||"").length&&!e.p}function kn(e){if(e){if(e.rgb)return e.rgb;if(e.th)return(new Zt).setThemeColor(e.th).asThemeColor().asRgbColor().getCssString()}return null}function Ln(e){var t;let n="";if(null==(t=e.body)?void 0:t.blockElements)for(let r in e.body.blockElements){const t=e.body.blockElements[r];if((t.blockType===I.PARAGRAPH||t.blockType===I.SECTION_BREAK)&&t.blockType===I.PARAGRAPH)for(let e in t.paragraph){const r=t.paragraph[e];for(let e in r){const t=r[e];if(t.et===B.TEXT_RUN){let e=`display:inline-block;${Dn(t.tr.ts)}`;n+=`<span id='${t.eId}' ${e.length?`style="${e}"`:""} >${t.tr.ct}</span>`}}}}return n}function Dn(e,t=!1){var n;let r="";const s=new Map([["ff",()=>{e.ff&&(r+=`font-family: ${e.ff}; `)}],["fs",()=>{if(e.fs){let t=e.fs;e.va&&(t/=2),r+=`font-size: ${t}pt; `}}],["it",()=>{e.it?r+="font-style: italic; ":r+="font-style: normal; "}],["bl",()=>{e.bl?r+="font-weight: bold; ":r+="font-weight: normal; "}],["ul",()=>{var t;(null==(t=e.ul)?void 0:t.s)&&(r.indexOf("text-decoration-line")>-1?r=r.replace(/(?<=text-decoration-line:.*)\b(?=;)/g," underline"):r+="text-decoration-line: underline; ",e.ul.cl&&-1===r.indexOf("text-decoration-color")&&(r+=`text-decoration-color: ${kn(e.ul.cl)}; `),e.ul.t&&-1===r.indexOf("text-decoration-style")&&(r+=`text-decoration-style: ${e.ul.t} `))}],["st",()=>{var t;(null==(t=e.st)?void 0:t.s)&&(r.indexOf("text-decoration-line")>-1?r=r.replace(/(?<=text-decoration-line:.*)\b(?=;)/g," line-through"):r+="text-decoration-line: line-through; ",e.st.cl&&-1===r.indexOf("text-decoration-color")&&(r+=`text-decoration-color: ${kn(e.st.cl)}; `),e.st.t&&-1===r.indexOf("text-decoration-style")&&(r+=`text-decoration-style: ${e.st.t} `))}],["ol",()=>{var t;(null==(t=e.ol)?void 0:t.s)&&(r.indexOf("text-decoration-line")>-1?r=r.replace(/(?<=text-decoration-line:.*)\b(?=;)/g," overline"):r+="text-decoration-line: overline; ",e.ol.cl&&-1===r.indexOf("text-decoration-color")&&(r+=`text-decoration-color: ${kn(e.ol.cl)}; `),e.ol.t&&-1===r.indexOf("text-decoration-style")&&(r+=`text-decoration-style: ${e.ol.t} `))}],["bg",()=>{r+=`background: ${kn(e.bg)}; `}],["bd",()=>{var t,n,s,o,i,l,a,c,h,u,d,g;(null==(t=e.bd)?void 0:t.b)&&(r+=`border-bottom: ${Pn(null==(n=e.bd)?void 0:n.b.s)} ${null!=(s=kn(e.bd.b.cl))?s:""}; `),(null==(o=e.bd)?void 0:o.t)&&(r+=`border-top: ${Pn(null==(i=e.bd)?void 0:i.t.s)} ${null!=(l=kn(e.bd.t.cl))?l:""}; `),(null==(a=e.bd)?void 0:a.r)&&(r+=`border-right: ${Pn(null==(c=e.bd)?void 0:c.r.s)} ${null!=(h=kn(e.bd.r.cl))?h:""}; `),(null==(u=e.bd)?void 0:u.l)&&(r+=`border-left: ${Pn(null==(d=e.bd)?void 0:d.l.s)} ${null!=(g=kn(e.bd.l.cl))?g:""}; `)}],["cl",()=>{r+=`color: ${kn(e.cl)}; `}],["va",()=>{e.va===bt.NORMAL?r+="vertical-align: baseline; ":e.va===bt.SUBSCRIPT?r+="vertical-align: sub; ":r+="vertical-align: super; "}],["td",()=>{e.td===rt.UNSPECIFIED?r+="direction: inherit; ":e.td===rt.LEFT_TO_RIGHT?r+="direction: ltr; ":r+="direction: rtl; "}],["tr",()=>{var t,n,s;r+=`data-rotate: (${null==(t=e.tr)?void 0:t.a}deg${(null==(n=e.tr)?void 0:n.v)?` ,${null==(s=e.tr)?void 0:s.v}`:""});`}],["ht",()=>{e.ht===lt.UNSPECIFIED?r+="text-align: inherit; ":e.ht===lt.LEFT?r+="text-align: left; ":e.ht===lt.RIGHT?r+="text-align: right; ":e.ht===lt.CENTER?r+="text-align: center; ":r+="text-align: justify; "}],["vt",()=>{e.vt===ct.UNSPECIFIED?r+="vertical-align: inherit; ":e.vt===ct.BOTTOM?r+="vertical-align: bottom; ":e.vt===ct.TOP?r+="vertical-align: top; ":r+="vertical-align: middle; "}],["tb",()=>{e.tb===ut.CLIP?r+="text-overflow: clip; ":e.tb===ut.OVERFLOW?r+="text-break: overflow; ":e.tb===ut.WRAP&&(r+="word-wrap: break-word; word-break: normal; ")}],["pd",()=>{var t,n,s,o,i,l,a,c;let h=`${null==(t=e.pd)?void 0:t.b}pt`,u=`${null==(n=e.pd)?void 0:n.t}pt`,d=`${null==(s=e.pd)?void 0:s.l}pt`,g=`${null==(o=e.pd)?void 0:o.r}pt`;(null==(i=e.pd)?void 0:i.b)&&(r+=`padding-bottom: ${h}; `),(null==(l=e.pd)?void 0:l.t)&&(r+=`padding-top: ${u}; `),(null==(a=e.pd)?void 0:a.l)&&(r+=`padding-left: ${d}; `),(null==(c=e.pd)?void 0:c.r)&&(r+=`padding-right: ${g}; `)}]]),o=["bd","tr","tb"];for(let i in e)t&&o.includes(i)||null==(n=s.get(i))||n();return r}function Pn(e){let t="";return e===ye.NONE?t="none":e===ye.THIN?t="0.5pt solid":e===ye.HAIR?t="0.5pt double":e===ye.DOTTED?t="0.5pt dotted":e===ye.DASHED||e===ye.DASH_DOT?t="0.5pt dashed":e===ye.DASH_DOT_DOT?t="0.5pt dotted":e===ye.DOUBLE?t="0.5pt double":e===ye.MEDIUM?t="1pt solid":e===ye.MEDIUM_DASHED||e===ye.MEDIUM_DASH_DOT?t="1pt dashed":e===ye.MEDIUM_DASH_DOT_DOT?t="1pt dotted":e===ye.SLANT_DASH_DOT?t="0.5pt dashed":e===ye.THICK&&(t="1.5pt solid"),t}function Bn(e){let t=0;return"none"===e?t=ye.NONE:"0.5pt solid"===e?t=ye.THIN:"0.5pt double"===e?t=ye.HAIR:"0.5pt dotted"===e?t=ye.DOTTED:"0.5pt dashed"===e?t=ye.DASHED:"1pt solid"===e?t=ye.MEDIUM:"1pt dashed"===e?t=ye.MEDIUM_DASHED:"1pt dotted"===e?t=ye.MEDIUM_DASH_DOT_DOT:"1.5pt solid"===e&&(t=ye.THICK),t}function Hn(e){return e instanceof FormData}const Fn=()=>{},zn=e=>e;var Un,Wn,Vn,jn,Yn,Gn;(Wn=Un||(Un={})).POST="POST",Wn.GET="GET",Wn.PUT="PUT",Wn.DELETE="DELETE",(jn=Vn||(Vn={}))[jn.UNSENT=0]="UNSENT",jn[jn.OPENED=1]="OPENED",jn[jn.HEADERS_RECEIVED=2]="HEADERS_RECEIVED",jn[jn.LOADING=3]="LOADING",jn[jn.DONE=4]="DONE",(Gn=Yn||(Yn={})).ARRAY_BUFFER="arraybuffer",Gn.BLOB="blob",Gn.TEXT="text",Gn.DOCUMENT="document",Gn.JSON="json",Gn.STREAM="stream";const Xn={type:Un.POST,url:"",async:!0,header:{},dataType:Yn.JSON,contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{},username:"",password:"",timeout:500,error:Fn,beforeSend:zn,dataFilter:zn,success:Fn,complete:Fn};function $n(e){return new Promise(((t,n)=>{const r=function(e,...t){for(const n of t)if(n)for(const t in n)n.hasOwnProperty(t)&&null!=n[t]&&(e[t]=n[t]);return e}({},Xn,e),s=new XMLHttpRequest;switch(r.beforeSend(r),s.responseType=r.dataType,s.timeout=r.timeout,s.addEventListener("readystatechange",(e=>{if(4===s.readyState)if(200===s.status){const e=r.dataFilter(s.response);r.success(e),r.complete(),t(e)}else r.error(e),n(e)})),s.addEventListener("timeout",(e=>{r.error(e)})),s.open(r.type,r.url,r.async,r.username,r.password),Object.keys(r.header).forEach((e=>{const t=r.header[e];s.setRequestHeader(e,t)})),Hn(r.data)?s.setRequestHeader("Content-Type","multipart/form-data"):r.contentType&&s.setRequestHeader("Content-Type",r.contentType),r.type){case Un.DELETE:case Un.GET:s.send();break;case Un.POST:case Un.PUT:if((o=r.data)&&Object.getPrototypeOf(o)===Object.getPrototypeOf({}))return void s.send(JSON.stringify(r.data));if(function(e){return"[object String]"===Object.prototype.toString.apply(e)}(r.data))return void s.send(r.data);if(function(e){return"[object Array]"===Object.prototype.toString.apply(e)}(r.data))return void s.send(JSON.stringify(r.data));Hn(r.data)&&s.send(r.data)}var o}))}var Qn,Kn;(Kn=Qn||(Qn={})).MESSAGE="message",Kn.OPEN="open",Kn.CLOSE="close",Kn.ERROR="error",Kn.RETRY="retry",Kn.DESTROY="destroy";const Zn={url:"",heartbeatTime:3e4},qn="heart_beat_message";class Jn{constructor(e){const t=Object.assign(Zn,e);if(function(e){return null==e}(n=t.url)||""===n.toString())throw new Error("url must be input");var n;this._listens=new Map,this._timer=-1,this._config=t}link(){this._create(),this._bind()}send(e){this._socket.send(e)}destroy(){const e=this._listens.get(Qn.DESTROY);e&&e(),this._clear(),this._listens.clear()}on(e,t){this._listens.set(e,t)}close(){this._socket&&this._socket.close()}_create(){const{_config:e}=this;this._socket=new WebSocket(e.url)}_bind(){this._socket.addEventListener(Qn.MESSAGE,this._message.bind(this)),this._socket.addEventListener(Qn.OPEN,this._open.bind(this)),this._socket.addEventListener(Qn.CLOSE,this._close.bind(this)),this._socket.addEventListener(Qn.ERROR,this._error.bind(this))}_message(e){const t=this._listens.get(Qn.MESSAGE);t&&t(e)}_open(e){const t=this._listens.get(Qn.OPEN);t&&(t(e),this._heartbeat())}_error(e){const t=this._listens.get(Qn.ERROR);t&&(t(e),this._retry())}_close(e){const t=this._listens.get(Qn.CLOSE);t&&(t(e),this.destroy())}_clear(){this._timer>-1&&clearInterval(this._timer),this._timer=-1,this._socket.removeEventListener(Qn.MESSAGE,this._message.bind(this)),this._socket.removeEventListener(Qn.OPEN,this._open.bind(this)),this._socket.removeEventListener(Qn.CLOSE,this._close.bind(this)),this._socket.removeEventListener(Qn.ERROR,this._error.bind(this))}_heartbeat(){const{_socket:e,_config:t}=this,{heartbeatTime:n}=t;this._timer=setInterval((function(){e.send(qn)}),n)}_retry(){const e=this._listens.get(Qn.RETRY);e&&e(),this._clear(),this._create(),this._bind()}}const er=Object.keys(zt).reduce(((e,t)=>[...e,...zt[t]]),[]);function tr(e){return-1===er.indexOf(e)}const nr={},rr={};class sr{static getValue(e,t){try{return e[t]?e[t]:t.split(".").reduce(((e,t)=>e[t]),e)}catch(n){console.error("Key %s not found",t)}}initialize(e){this.options={currentLocale:e||["zh","zh-CN"].includes(C.getLanguage())?Qe.ZH:Qe.EN,locales:{zh:nr,en:rr}}}get(e){if(e){const{locales:t,currentLocale:n}=this.options;return sr.getValue(t[n],e)||e}return String()}getObject(e){const{locales:t,currentLocale:n}=this.options;return sr.getValue(t[n],e)}load(e){C.deepMerge(this.options.locales,e)}change(e){this.options.currentLocale=e}getCurrentLocale(){return this.options.currentLocale}}class or{static log(...e){console&&console.log(...e)}static info(...e){console&&console.info(...e)}static error(...e){console&&console.error(...e)}static warn(...e){console&&console.warn(...e)}static br(){or.info("\n")}static capsule(e,t,n="",r=""){console&&console.log(`%c${n}%c${e}%c${t}%c${r}`,"","padding:3px;color:white;background:#023047","padding:3px;color:white;background:#219EBC","")}}class ir{constructor(){this._include=[],this._count=1}checked(e){return this._include.includes(e)}onlyName(e){let t=e,n=1;for(;this.checked(t);)t=e+n,n++;return this._include.push(t),t}sheetName(e="sheet1"){let t=e;for(;this.checked(t);)t=`sheet${this._count}`,this._count++;return this._include.push(t),t}}class lr{static hasLength(e,t){return e.length===t}static getValueType(e){return Object.prototype.toString.apply(e)}static isObject(e){return"[object Object]"===this.getValueType(e)}static isIterable(e){return null!=e[Symbol.iterator]}static isNumber(e){return"[object Number]"===this.getValueType(e)}}const ar=Symbol("newer"),cr=Symbol("older");class hr{constructor(e){this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[ar],{done:!1,value:e.key}):{done:!0,value:void 0}}}class ur{constructor(e){this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[ar],{done:!1,value:e.value}):{done:!0,value:void 0}}}class dr{constructor(e){this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[ar],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}}}class gr{constructor(e,t){this.key=e,this.value=t,this[ar]=void 0,this[cr]=void 0}toJSON(){return{key:this.key,value:this.value}}}class fr{constructor(...e){if(lr.hasLength(e,1)){if(lr.isNumber(e[0])){const t=e[0];return void this._initialize(t,void 0)}if(lr.isIterable(e[0])){const t=e[0];return void this._initialize(0,t)}}else if(lr.hasLength(e,2)){const t=e[0],n=e[1];this._initialize(t,n)}}_initialize(e,t){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=e,this._keymap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[ar]&&(e===this.oldest&&(this.oldest=e[ar]),e[ar][cr]=e[cr]),e[cr]&&(e[cr][ar]=e[ar]),e[ar]=void 0,e[cr]=this.newest,this.newest&&(this.newest[ar]=e),this.newest=e)}assign(e){let t,n=this.limit||Number.MAX_VALUE;this._keymap.clear();let r=e[Symbol.iterator]();for(let s=r.next();!s.done;s=r.next()){let e=new gr(s.value[0],s.value[1]);if(this._keymap.set(e.key,e),t?(t[ar]=e,e[cr]=t):this.oldest=e,t=e,0==n--)throw new Error("overflow")}this.newest=t,this.size=this._keymap.size}set(e,t){let n=this._keymap.get(e);return n?(n.value=t,this._markEntryAsUsed(n),this):(this._keymap.set(e,n=new gr(e,t)),this.newest?(this.newest[ar]=n,n[cr]=this.newest):this.oldest=n,this.newest=n,++this.size,this.size>this.limit&&this.shift(),this)}shift(){let e=this.oldest;if(e)return this.oldest&&this.oldest[ar]?(this.oldest=this.oldest[ar],this.oldest[cr]=void 0):(this.oldest=void 0,this.newest=void 0),e[ar]=e[cr]=void 0,this._keymap.delete(e.key),--this.size,[e.key,e.value]}get(e){const t=this._keymap.get(e);if(t)return this._markEntryAsUsed(t),t.value}has(e){return this._keymap.has(e)}find(e){let t=this._keymap.get(e);return t?t.value:void 0}delete(e){let t=this._keymap.get(e);if(t)return this._keymap.delete(t.key),t[ar]&&t[cr]?(t[cr][ar]=t[ar],t[ar][cr]=t[cr]):t[ar]?(t[ar][cr]=void 0,this.oldest=t[ar]):t[cr]?(t[cr][ar]=void 0,this.newest=t[cr]):this.oldest=this.newest=void 0,this.size--,t.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new hr(this.oldest)}values(){return new ur(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new dr(this.oldest)}forEach(e,t){"object"!=typeof t&&(t=this);let n=this.oldest;for(;n;)e.call(t,n.value,n.key,this),n=n[ar]}toJSON(){let e=new Array(this.size),t=0,n=this.oldest;for(;n;)e[t++]={key:n.key,value:n.value},n=n[ar];return e}toString(){let e=String(),t=this.oldest;for(;t;)e+=`${String(t.key)}:${t.value}`,t=t[ar],t&&(e+=" < ");return e}}function mr(e,t){var n,r,s,o,i,l,a,c,h,u,d,g,f,m,p,b,_,v,C,T,w,y,S,E,R,I,A,x,O,M,N,k,L,D,P,B,H,F,z,U,W,V,j,Y,G,X,$,Q,K,Z,q,J,ee,te,ne,re,se,oe,ie,le,ae,ce,he,ue,de,ge;e.cellData={};for(let fe of t.config.borderInfo)if("cell"===fe.rangeType){const t=fe.value.row_index,f=fe.value.col_index;e.cellData[String(t)]||(e.cellData[String(t)]={}),e.cellData[String(t)][String(f)]||(e.cellData[String(t)][String(f)]={}),e.cellData[String(t)][String(f)].s||(e.cellData[String(t)][String(f)].s={});const m={};fe.value.l&&(m.l={s:fe.value.l.style,cl:{rgb:fe.value.l.color}},e.cellData[String(t)]&&(null==(s=null==(r=null==(n=e.cellData[String(t)][String(f-1)])?void 0:n.s)?void 0:r.bd)?void 0:s.r)&&delete e.cellData[String(t)][String(f-1)].s.bd.r),fe.value.r&&(m.r={s:fe.value.r.style,cl:{rgb:fe.value.r.color}},e.cellData[String(t)]&&(null==(l=null==(i=null==(o=e.cellData[String(t)][String(Number(f)+1)])?void 0:o.s)?void 0:i.bd)?void 0:l.l)&&delete e.cellData[String(t)][String(f-1)].s.bd.l),fe.value.t&&(m.t={s:fe.value.t.style,cl:{rgb:fe.value.t.color}},e.cellData[String(t-1)]&&(null==(h=null==(c=null==(a=e.cellData[String(t)][String(f)])?void 0:a.s)?void 0:c.bd)?void 0:h.b)&&delete e.cellData[String(t)][String(f-1)].s.bd.b),fe.value.b&&(m.b={s:fe.value.b.style,cl:{rgb:fe.value.b.color}},e.cellData[String(Number(t)+1)]&&(null==(g=null==(d=null==(u=e.cellData[String(t)][String(f)])?void 0:u.s)?void 0:d.bd)?void 0:g.t)&&delete e.cellData[String(t)][String(f-1)].s.bd.t),e.cellData[String(t)][String(f)].s.bd=Object.assign(e.cellData[String(t)][String(f)].s.bd||{},m)}else if("range"===fe.rangeType)for(const t of fe.range){const n=t.row[0],r=t.row[1],s=t.column[0],o=t.column[1];switch(fe.borderType){case"border-left":for(let t=n;t<=r;t++)for(let n=s;n<s+1;n++){e.cellData[String(t)]||(e.cellData[String(t)]={}),e.cellData[String(t)][String(n)]||(e.cellData[String(t)][String(n)]={}),e.cellData[String(t)][String(n)].s||(e.cellData[String(t)][String(n)].s={});const r={};r.l={s:fe.style,cl:{rgb:fe.color}},e.cellData[String(t)][String(n)].s.bd=Object.assign(e.cellData[String(t)][String(n)].s.bd||{},r)}for(let t=n;t<=r;t++)for(let n=s-1;n<s;n++)e.cellData[String(t)]&&(null==(p=null==(m=null==(f=e.cellData[String(t)][String(n)])?void 0:f.s)?void 0:m.bd)?void 0:p.r)&&delete e.cellData[String(t)][String(n)].s.bd.r;break;case"border-right":for(let t=n;t<=r;t++)for(let n=o;n<o+1;n++){e.cellData[String(t)]||(e.cellData[String(t)]={}),e.cellData[String(t)][String(n)]||(e.cellData[String(t)][String(n)]={}),e.cellData[String(t)][String(n)].s||(e.cellData[String(t)][String(n)].s={});const r={};r.r={s:fe.style,cl:{rgb:fe.color}},e.cellData[String(t)][String(n)].s.bd=Object.assign(e.cellData[String(t)][String(n)].s.bd||{},r)}for(let t=n;t<=r;t++)for(let n=o+1;n<o+2;n++)e.cellData[String(t)]&&(null==(v=null==(_=null==(b=e.cellData[String(t)][String(n)])?void 0:b.s)?void 0:_.bd)?void 0:v.l)&&delete e.cellData[String(t)][String(n)].s.bd.l;break;case"border-top":for(let t=n;t<n+1;t++)for(let n=s;n<=o;n++){e.cellData[String(t)]||(e.cellData[String(t)]={}),e.cellData[String(t)][String(n)]||(e.cellData[String(t)][String(n)]={}),e.cellData[String(t)][String(n)].s||(e.cellData[String(t)][String(n)].s={});const r={};r.t={s:fe.style,cl:{rgb:fe.color}},e.cellData[String(t)][String(n)].s.bd=Object.assign(e.cellData[String(t)][String(n)].s.bd||{},r)}for(let t=n-1;t<n;t++)for(let n=s;n<=o;n++)e.cellData[String(t)]&&(null==(w=null==(T=null==(C=e.cellData[String(t)][String(n)])?void 0:C.s)?void 0:T.bd)?void 0:w.b)&&delete e.cellData[String(t)][String(n)].s.bd.b;break;case"border-bottom":for(let t=r;t<r+1;t++)for(let n=s;n<=o;n++){e.cellData[String(t)]||(e.cellData[String(t)]={}),e.cellData[String(t)][String(n)]||(e.cellData[String(t)][String(n)]={}),e.cellData[String(t)][String(n)].s||(e.cellData[String(t)][String(n)].s={});const r={};r.b={s:fe.style,cl:{rgb:fe.color}},e.cellData[String(t)][String(n)].s.bd=Object.assign(e.cellData[String(t)][String(n)].s.bd||{},r)}for(let t=r+1;t<r+2;t++)for(let n=s;n<=o;n++)e.cellData[String(t)]&&(null==(E=null==(S=null==(y=e.cellData[String(t)][String(n)])?void 0:y.s)?void 0:S.bd)?void 0:E.t)&&delete e.cellData[String(t)][String(n)].s.bd.t;break;case"border-all":for(let t=n;t<=r;t++)for(let n=s;n<=o;n++){e.cellData[String(t)]||(e.cellData[String(t)]={}),e.cellData[String(t)][String(n)]||(e.cellData[String(t)][String(n)]={}),e.cellData[String(t)][String(n)].s||(e.cellData[String(t)][String(n)].s={});const s={};s.l={s:fe.style,cl:{rgb:fe.color}},s.t={s:fe.style,cl:{rgb:fe.color}},n===o&&(s.r={s:fe.style,cl:{rgb:fe.color}}),t===r&&(s.b={s:fe.style,cl:{rgb:fe.color}}),e.cellData[String(t)][String(n)].s.bd=s}for(let t=n;t<=r;t++)for(let n=s-1;n<s;n++)e.cellData[String(t)]&&(null==(A=null==(I=null==(R=e.cellData[String(t)][String(n)])?void 0:R.s)?void 0:I.bd)?void 0:A.r)&&delete e.cellData[String(t)][String(n)].s.bd.r;for(let t=n;t<=r;t++)for(let n=o+1;n<o+2;n++)e.cellData[String(t)]&&(null==(M=null==(O=null==(x=e.cellData[String(t)][String(n)])?void 0:x.s)?void 0:O.bd)?void 0:M.l)&&delete e.cellData[String(t)][String(n)].s.bd.l;for(let t=n-1;t<n;t++)for(let n=s;n<=o;n++)e.cellData[String(t)]&&(null==(L=null==(k=null==(N=e.cellData[String(t)][String(n)])?void 0:N.s)?void 0:k.bd)?void 0:L.b)&&delete e.cellData[String(t)][String(n)].s.bd.b;for(let t=r+1;t<r+2;t++)for(let n=s;n<=o;n++)e.cellData[String(t)]&&(null==(B=null==(P=null==(D=e.cellData[String(t)][String(n)])?void 0:D.s)?void 0:P.bd)?void 0:B.t)&&delete e.cellData[String(t)][String(n)].s.bd.t;break;case"border-outside":for(let t=n;t<=r;t++)for(let i=s;i<=o;i++){e.cellData[String(t)]||(e.cellData[String(t)]={}),e.cellData[String(t)][String(i)]||(e.cellData[String(t)][String(i)]={}),e.cellData[String(t)][String(i)].s||(e.cellData[String(t)][String(i)].s={});const l={};t===n&&(l.t={s:fe.style,cl:{rgb:fe.color}}),t===r&&(l.b={s:fe.style,cl:{rgb:fe.color}}),i===s&&(l.l={s:fe.style,cl:{rgb:fe.color}}),i===o&&(l.r={s:fe.style,cl:{rgb:fe.color}}),e.cellData[String(t)][String(i)].s.bd=Object.assign(e.cellData[String(t)][String(i)].s.bd||{},l)}for(let t=n;t<=r;t++)for(let n=s-1;n<s;n++)e.cellData[String(t)]&&(null==(z=null==(F=null==(H=e.cellData[String(t)][String(n)])?void 0:H.s)?void 0:F.bd)?void 0:z.r)&&delete e.cellData[String(t)][String(n)].s.bd.r;for(let t=n;t<=r;t++)for(let n=o+1;n<o+2;n++)e.cellData[String(t)]&&(null==(V=null==(W=null==(U=e.cellData[String(t)][String(n)])?void 0:U.s)?void 0:W.bd)?void 0:V.l)&&delete e.cellData[String(t)][String(n)].s.bd.l;for(let t=n-1;t<n;t++)for(let n=s;n<=o;n++)e.cellData[String(t)]&&(null==(G=null==(Y=null==(j=e.cellData[String(t)][String(n)])?void 0:j.s)?void 0:Y.bd)?void 0:G.b)&&delete e.cellData[String(t)][String(n)].s.bd.b;for(let t=r+1;t<r+2;t++)for(let n=s;n<=o;n++)e.cellData[String(t)]&&(null==(Q=null==($=null==(X=e.cellData[String(t)][String(n)])?void 0:X.s)?void 0:$.bd)?void 0:Q.t)&&delete e.cellData[String(t)][String(n)].s.bd.t;break;case"border-inside":for(let t=n;t<=r;t++)for(let r=s;r<=o;r++){e.cellData[String(t)]||(e.cellData[String(t)]={}),e.cellData[String(t)][String(r)]||(e.cellData[String(t)][String(r)]={}),e.cellData[String(t)][String(r)].s||(e.cellData[String(t)][String(r)].s={});const o={};t===n&&r===s||(t===n?o.l={s:fe.style,cl:{rgb:fe.color}}:(r===s||(o.l={s:fe.style,cl:{rgb:fe.color}}),o.t={s:fe.style,cl:{rgb:fe.color}}),e.cellData[String(t)][String(r)].s.bd=o)}break;case"border-horizontal":for(let t=n;t<r;t++)for(let n=s;n<=o;n++){e.cellData[String(t)]||(e.cellData[String(t)]={}),e.cellData[String(t)][String(n)]||(e.cellData[String(t)][String(n)]={}),e.cellData[String(t)][String(n)].s||(e.cellData[String(t)][String(n)].s={});const r={};r.b={s:fe.style,cl:{rgb:fe.color}},e.cellData[String(t)][String(n)].s.bd=Object.assign(e.cellData[String(t)][String(n)].s.bd||{},r)}for(let t=n+1;t<=r;t++)for(let n=s;n<=o;n++)e.cellData[String(t)]&&(null==(q=null==(Z=null==(K=e.cellData[String(t)][String(n)])?void 0:K.s)?void 0:Z.bd)?void 0:q.t)&&delete e.cellData[String(t)][String(n)].s.bd.t;break;case"border-vertical":for(let t=n;t<=r;t++)for(let n=s;n<o;n++){e.cellData[String(t)]||(e.cellData[String(t)]={}),e.cellData[String(t)][String(n)]||(e.cellData[String(t)][String(n)]={}),e.cellData[String(t)][String(n)].s||(e.cellData[String(t)][String(n)].s={});const r={};r.r={s:fe.style,cl:{rgb:fe.color}},e.cellData[String(t)][String(n)].s.bd=Object.assign(e.cellData[String(t)][String(n)].s.bd||{},r)}for(let t=n;t<=r;t++)for(let n=s+1;n<=o;n++)e.cellData[String(t)]&&(null==(te=null==(ee=null==(J=e.cellData[String(t)][String(n)])?void 0:J.s)?void 0:ee.bd)?void 0:te.l)&&delete e.cellData[String(t)][String(n)].s.bd.l;break;case"border-none":for(let t=n;t<=r;t++)for(let n=s;n<=o;n++){if(!e.cellData[String(t)])continue;if(!e.cellData[String(t)][String(n)])continue;if(!e.cellData[String(t)][String(n)].s)continue;const r={};e.cellData[String(t)][String(n)].s.bd=r}for(let t=n;t<=r;t++)for(let n=s-1;n<s;n++)e.cellData[String(t)]&&(null==(se=null==(re=null==(ne=e.cellData[String(t)][String(n)])?void 0:ne.s)?void 0:re.bd)?void 0:se.r)&&delete e.cellData[String(t)][String(n)].s.bd.r;for(let t=n;t<=r;t++)for(let n=o+1;n<o+2;n++)e.cellData[String(t)]&&(null==(le=null==(ie=null==(oe=e.cellData[String(t)][String(n)])?void 0:oe.s)?void 0:ie.bd)?void 0:le.l)&&delete e.cellData[String(t)][String(n)].s.bd.l;for(let t=n-1;t<n;t++)for(let n=s;n<=o;n++)e.cellData[String(t)]&&(null==(he=null==(ce=null==(ae=e.cellData[String(t)][String(n)])?void 0:ae.s)?void 0:ce.bd)?void 0:he.b)&&delete e.cellData[String(t)][String(n)].s.bd.b;for(let t=r+1;t<r+2;t++)for(let n=s;n<=o;n++)e.cellData[String(t)]&&(null==(ge=null==(de=null==(ue=e.cellData[String(t)][String(n)])?void 0:ue.s)?void 0:de.bd)?void 0:ge.t)&&delete e.cellData[String(t)][String(n)].s.bd.t}}}function pr(e){var t;const n={styles:{}};if(e.hasOwnProperty("lang")&&(n.locale=e.lang),e.hasOwnProperty("data")){n.sheets={};for(let r of e.data){const e={};if(e.id=C.generateRandomId(6),r.hasOwnProperty("zoomRatio")&&(e.zoomRatio=r.zoomRatio),r.hasOwnProperty("row")&&(e.rowCount=r.row),r.hasOwnProperty("column")&&(e.columnCount=r.column),r.hasOwnProperty("status")&&(e.status=parseInt(r.status)),r.hasOwnProperty("name")&&(e.name=r.name),r.hasOwnProperty("universheet_select_save")&&(e.selections=[],r.universheet_select_save.forEach((t=>{var n;null==(n=e.selections)||n.push({startRow:t.row[0],endRow:t.row[1],startColumn:t.column[0],endColumn:t.column[1]})}))),r.hasOwnProperty("scrollLeft")&&(e.scrollLeft=r.scrollLeft),r.hasOwnProperty("scrollTop")&&(e.scrollTop=r.scrollTop),r.hasOwnProperty("config")){if(r.config.merge){e.mergeData=[];for(const t of Object.keys(r.config.merge)){const n=r.config.merge[t],s={startRow:n.r,endRow:n.r+n.rs-1,startColumn:n.c,endColumn:n.c+n.cs-1};e.mergeData.push(s)}}if(r.config.borderInfo&&mr(e,r),r.config.rowlen){e.rowData={};for(const[t,n]of Object.entries(r.config.rowlen))e.rowData[String(t)]={h:n,hd:0}}if(r.config.columnlen){e.columnData={};for(const[t,n]of Object.entries(r.config.columnlen))e.columnData[String(t)]={w:n,hd:0}}if(r.config.rowhidden){e.rowData||(e.rowData={});for(const[t,n]of Object.entries(r.config.rowhidden))e.rowData[String(t)]||(e.rowData[String(t)]={}),e.rowData[String(t)].hd=n}if(r.config.colhidden){e.columnData||(e.columnData={});for(const[t,n]of Object.entries(r.config.colhidden))e.columnData[String(t)]||(e.columnData[String(t)]={}),e.columnData[String(t)].hd=n}}if(r.hasOwnProperty("celldata")){e.cellData||(e.cellData={});for(const n of r.celldata){e.cellData[n.r]||(e.cellData[n.r]={}),e.cellData[n.r][n.c]||(e.cellData[n.r][n.c]={});const r=n.v,s=e.cellData[n.r][n.c];if("inlineStr"===(null==(t=null==r?void 0:r.ct)?void 0:t.t)){const e=[];r.ct.s.forEach((t=>{const n={};t.hasOwnProperty("bg")&&(n.bg={rgb:t.fc}),t.hasOwnProperty("ff")&&(n.ff=t.ff),t.hasOwnProperty("fc")&&(n.cl={rgb:t.fc}),t.hasOwnProperty("fs")&&(n.fs=t.fs),t.hasOwnProperty("bl")&&(n.bl=t.bl),t.hasOwnProperty("it")&&(n.it=t.it),t.hasOwnProperty("cl")&&(n.st={s:1}),t.hasOwnProperty("un")&&(n.ul={s:t.un});const r=C.generateRandomId(6);e.push({eId:r,st:0,ed:t.v.length-1,et:0,tr:{ct:t.v,ts:n}})})),s.p={id:C.generateRandomId(6),body:{blockElements:[{blockId:"p1",st:0,ed:r.ct.s.length-1,blockType:0,paragraph:{elements:e}}]},documentStyle:{}}}else{r.hasOwnProperty("v")&&(s.v=r.v),r.hasOwnProperty("m")?s.m=r.m:s.m=String(r.v||"");const e={};r.hasOwnProperty("bg")&&(e.bg={rgb:r.bg}),r.hasOwnProperty("ff")&&(e.ff=r.ff),r.hasOwnProperty("fc")&&(e.cl={rgb:r.fc}),r.hasOwnProperty("fs")&&(e.fs=r.fs),r.hasOwnProperty("bl")&&(e.bl=r.bl),r.hasOwnProperty("it")&&(e.it=r.it),r.hasOwnProperty("cl")&&(e.st={s:r.cl}),r.hasOwnProperty("un")&&(e.ul={s:r.un});const t={0:2,1:1,2:3};if(r.hasOwnProperty("vt")&&(e.vt=t[String(r.vt)]),r.hasOwnProperty("ht")&&(e.ht=t[String(r.ht)]),r.hasOwnProperty("tr"))switch(r.tr){case"0":e.tr={a:0,v:0};break;case"1":e.tr={a:45,v:0};break;case"2":e.tr={a:-45,v:0};break;case"3":e.tr={a:0,v:1};break;case"4":e.tr={a:90,v:0};break;case"5":e.tr={a:-90,v:0}}r.hasOwnProperty("rt")&&(e.tr={a:r.tr,v:0}),r.hasOwnProperty("tb")&&(e.tb=t[String(r.tb)]),s.s=Object.assign(s.s||{},e)}}}n.sheets[e.id]=e}}return n}class br{constructor(...e){if(C.hasLength(e,0))return this.startRow=0,this.startColumn=0,this.endRow=0,void(this.endColumn=0);if(C.hasLength(e,1)){const t=e[0];return this.startRow=t.startRow,this.startColumn=t.startColumn,this.endRow=t.endRow,void(this.endColumn=t.endColumn)}if(C.hasLength(e,4)){const t=e[0],n=e[1],r=e[2],s=e[3];this.startRow=t,this.startColumn=n,this.endRow=r,this.endColumn=s}}static equals(e,t){return e.endRow===t.endRow&&e.endColumn===t.endColumn&&e.startRow===t.startRow&&e.startColumn===t.startColumn}static intersects(e,t){const n=e.startRow,r=e.endRow,s=e.startColumn,o=e.endColumn,i=t.startRow,l=t.endRow,a=t.startColumn,c=t.endColumn,h=Math.abs(s+o-a-c),u=Math.abs(s-o)+Math.abs(a-c),d=Math.abs(n+r-i-l),g=Math.abs(n-r)+Math.abs(i-l);return h<=u&&d<=g}intersects(e){return br.intersects(this,e)}union(e){const{startRow:t,startColumn:n,endRow:r,endColumn:s}=this;return new br(e.startRow<this.startRow?e.startRow:t,e.startColumn<n?e.startColumn:n,e.endRow>r?e.endRow:r,e.endColumn>s?e.endColumn:s)}getData(){return{startRow:this.startRow,startColumn:this.startColumn,endRow:this.endRow,endColumn:this.endColumn}}equals(e){return br.equals(this,e)}}const _r=/[^0-9]/g,vr=/[^A-Za-z]/g;function Cr(e){return{row:parseInt(e.replace(_r,""))-1,column:C.ABCatNum(e.replace(vr,""))}}const Tr="A".charCodeAt(0),wr="Z".charCodeAt(0),yr="a".charCodeAt(0);function Sr(e){const t=wr-Tr+1;let n="";for(;e>=0;)n=String.fromCharCode(e%t+Tr)+n,e=Math.floor(e/t)-1;return n}function Er(e,t){let n="";for(;t>0;)n+=e,t--;return n}function Rr(e,t=!1){const n=wr-Tr+1;let r=yr;t&&(r=Tr);return Er(String.fromCharCode(e%n+r),Math.floor(e/n)+1)}class Ir{static fromSequence(e){if(C.isObject(e)&&Ir.requiredNewInstance(this)){return this.newInstance(e)}if(C.isArray(e)&&Ir.requiredNewInstance(this)){const t=this;return e.map((e=>t.newInstance(e)))}return[]}toSequence(){return{className:C.getClassName(this)}}}function Ar(e,t){return e.zIndex>t.zIndex?1:e.zIndex===t.zIndex?0:-1}function xr(e,t){return e.zIndex>t.zIndex?-1:e.zIndex===t.zIndex?0:1}(Ir||(Ir={})).requiredNewInstance=function(e){if(C.isDefine(e.newInstance))return!0;throw new Error("sequence newInstance need subclass implement!")};const Or=class{static checkup(e,...t){if(e.length!==t.length)return!1;const n=e.length;for(let r=0;r<n;r++){const n=e[r],s=t[r];switch(s){case Or.BOOLEAN_TYPE:if(!C.isBoolean(n))return!1;break;case Or.NUMBER_TYPE:if(!C.isNumber(n))return!1;break;case Or.STRING_TYPE:if(!C.isString(n))return!1;break;case Or.FUNCTION_TYPE:if(!C.isFunction(n))return!1;break;case Or.OBJECT_TYPE:if(!C.isPlainObject(n))return!1;break;default:if(!C.isAssignableFrom(n,s))return!1}}return!0}};let Mr=Or;Mr.STRING_TYPE=1,Mr.NUMBER_TYPE=2,Mr.BOOLEAN_TYPE=3,Mr.FUNCTION_TYPE=4,Mr.OBJECT_TYPE=5;class Nr{static GetClass(e){return this.RegisteredTypes&&this.RegisteredTypes[e]?this.RegisteredTypes[e]:null}}Nr.RegisteredTypes={};class kr{constructor(e,t,n){this.path=e,this.namespace=t,this.observable=n}}class Lr{constructor(){this._observableArray=[]}hasObserver(e,t){return null!=this.getObserver(e,t)}getObserver(...e){if(1===e.length){const t=e[0],n=this._observableArray.find((e=>e.path===t));return n?n.observable:null}if(2===e.length){const t=e[0],n=e[1],r=this._observableArray.find((e=>e.path===t&&e.namespace===n));return r?r.observable:null}}requiredObserver(...e){if(C.hasLength(e,1)){const t=e[0],n=this.getObserver(t);if(null==n)throw new Error(`not found observable ${t}`);return n}if(C.hasLength(e,2)){const t=e[0],n=e[1],r=this.getObserver(t,n);if(null==r)throw new Error(`not found observable ${t}`);return r}throw new Error("requiredObserver arguments error")}removeObserver(...e){if(C.hasLength(e,1)){const t=e[0],n=this._observableArray.findIndex((e=>e.path===t));n>-1&&this._observableArray.splice(n,1)}else if(C.hasLength(e,2)){const t=e[0],n=e[1],r=this._observableArray.findIndex((e=>e.path===t&&e.namespace===n));r>-1&&this._observableArray.splice(r,1)}}addObserver(...e){if(1===e.length){const t=e[0],n=e[1];return this.hasObserver(t,t)&&this.removeObserver(t),void this._observableArray.push(new kr(t,t,n))}if(3===e.length){const t=e[0],n=e[1],r=e[2];this.hasObserver(t,t)&&this.removeObserver(t,n),this._observableArray.push(new kr(t,n,r))}}}var Dr,Pr;(Pr=Dr||(Dr={}))[Pr.REDO=0]="REDO",Pr[Pr.UNDO=1]="UNDO";class Br extends i{}class Hr extends i{}class Fr extends i{}class zr{constructor(e){this._undoManager=e.getUndoManager(),this._actionExtensionManager=new jr}static staticInitialize(){this._actionClass=new Map,this._actionObservers=new Br,this._commandObservers=new Fr,this._commandInjectorObservers=new Hr}static getAction(e){return this._actionClass[e]}static getActionObservers(){return this._actionObservers}static getCommandObservers(){return this._commandObservers}static register(e,t){this._actionClass[e]=t}static getCommandInjectorObservers(){return this._commandInjectorObservers}getActionExtensionManager(){return this._actionExtensionManager}undo(){const{_undoManager:e}=this,t=e.undo();t&&t.undo()}redo(){const{_undoManager:e}=this,t=e.redo();t&&t.redo()}invoke(e){const{_undoManager:t}=this,{_actionDataList:n,_unit:r,_actionList:s}=e;this._actionExtensionManager.handle(n),n.forEach((e=>{const t=zr.getAction(e.actionName),n=zr.getActionObservers(),o=new t(e,r,n);s.push(o)})),e.invoke(),t.push(e)}}zr.staticInitialize();class Ur extends r{constructor(e,t,n){if(super(e,n),null==t.WorkBookUnit)throw new Error("action workbook domain can not be null!");this._commandUnit=t,this._workbook=t.WorkBookUnit}getWorkSheet(){const{_workbook:e,_doActionData:t}=this,{sheetId:n}=t;return e.getSheetBySheetId(n)}getWorkBook(){return this._workbook}}class Wr{constructor(e,...t){this._unit=e,this._actionDataList=t,this._actionList=[]}getDoData(){return this._actionList.map((e=>e.getDoActionData()))}getOldData(){return this._actionList.map((e=>e.getOldActionData()))}getInjector(){const e=this;return new class{injectAction(t){e._actionList.push(t)}getActions(){return e._actionList.concat([])}include(t){for(let n=0;n<e._actionList.length;n++)if(e._actionList[n]instanceof t)return e._actionList[n];return null}}}redo(){this._actionList.forEach((e=>{Kr.hasUndo(e.getDoActionData())&&e.redo()})),zr.getCommandObservers().notifyObservers({type:Dr.REDO,actions:this._actionList})}undo(){this._actionList.reverse().forEach((e=>{Kr.hasUndo(e.getOldActionData())&&e.undo()})),zr.getCommandObservers().notifyObservers({type:Dr.UNDO,actions:this._actionList})}invoke(){zr.getCommandInjectorObservers().notifyObservers(this.getInjector()),zr.getCommandObservers().notifyObservers({type:Dr.REDO,actions:this._actionList})}}class Vr{constructor(){this._undoStack=[],this._redoStack=[]}push(e){this._redoStack.push(e)}undo(){const e=this._redoStack.pop();if(e)return this._undoStack.push(e),e}redo(){const e=this._undoStack.pop();if(e)return this._redoStack.push(e),e}}class jr{constructor(){this._register=new Qr,this._register.initialize()}getRegister(){return this._register}handle(e){var t;const n=null==(t=this._register)?void 0:t.actionExtensionFactoryList;n&&(this._actionExtensionFactoryList=n,0!==e.length&&this._checkExtension(e))}_checkExtension(e){if(!this._actionExtensionFactoryList)return!1;this._actionExtensionFactoryList.forEach((t=>{const n=t.check(e);!1!==n&&n.execute()}))}}class Yr{constructor(e,t){this.actionDataList=e,this._plugin=t}getActionDataList(){return this.actionDataList}push(e){this.actionDataList.push(e)}setValue(){}execute(){}}class Gr{constructor(e){this._plugin=e}get zIndex(){return 0}create(e){return new Yr(e,this._plugin)}check(e){return this.create(e)}}class Xr{constructor(){this._data=[]}static create(){return new Xr}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}}const $r=Xr.create();class Qr{constructor(){this._actionExtensionFactoryList=[]}get actionExtensionFactoryList(){return this._actionExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._actionExtensionFactoryList.push(...e),this._actionExtensionFactoryList.sort(Ar)}delete(e){const t=this._actionExtensionFactoryList.indexOf(e);this._actionExtensionFactoryList.splice(t,1)}_initExtensions(){this._actionExtensionFactoryList.push(...$r.getData().sort(Ar))}}class Kr{constructor(e){this._action=e}static hasObserver(e){return!e.operation||(e.operation&t.OBSERVER_ACTION)===t.OBSERVER_ACTION}static hasUndo(e){return!e.operation||(e.operation&t.UNDO_ACTION)===t.UNDO_ACTION}static hasCollaboration(e){return!e.operation||(e.operation&t.SERVER_ACTION)===t.SERVER_ACTION}static hasExtension(e){return!e.operation||(e.operation&t.EXTENSION_ACTION)===t.EXTENSION_ACTION}static make(e){return e.operation=t.DEFAULT_ACTION,new Kr(e)}removeObserver(){return this._action.operation&&(this._action.operation&=~t.OBSERVER_ACTION),this}removeUndo(){return this._action.operation&&(this._action.operation&=~t.UNDO_ACTION),this}removeCollaboration(){return this._action.operation&&(this._action.operation&=~t.SERVER_ACTION),this}removeExtension(){return this._action.operation&&(this._action.operation&=~t.EXTENSION_ACTION),this}getAction(){return this._action}}function Zr(e,t){var n;let r=null==(n=null==e?void 0:e.WorkBookUnit)?void 0:n.getSheetBySheetId(t.sheetId);if(r){let e=r.getConfig().mergeData,n=t.rectangles;for(let t=0;t<n.length;t++)e.push(n[t]);return n}return[]}function qr(e,t){var n;const r=null==(n=e.WorkBookUnit)?void 0:n.getConfig().namedRanges;null==r||r.push(t.namedRange)}function Jr(e,t){var n;const r=null==(n=e.WorkBookUnit)?void 0:n.getSheetBySheetId(t.sheetId),s=null==r?void 0:r.getCellMatrix(),{startRow:o,endRow:i,startColumn:l,endColumn:a}=t.rangeData,c=new p;for(let h=o;h<=i;h++)for(let e=l;e<=a;e++){const n=null==s?void 0:s.getValue(h,e);c.setValue(h,e,C.deepClone(n)),n&&(t.options.formatOnly&&delete n.s,t.options.contentsOnly&&(n.v="",n.m=""),null==s||s.setValue(h,e,C.deepClone(n)))}return c.getData()}function es(e,t){const n=e.WorkBookUnit,r=null==n?void 0:n.getConfig().namedRanges;return null==r?void 0:r.find(((e,n)=>e.namedRangeId===t.namedRangeId?(r.splice(n,1),e):null))}function ts(e,t){var n,r,s;const o=null==(n=e.WorkBookUnit)?void 0:n.getSheetBySheetId(t.sheetId),i=null==o?void 0:o.getCellMatrix(),l={rowCount:null==o?void 0:o.getConfig().rowCount,columnCount:null==o?void 0:o.getConfig().columnCount},{startRow:a,endRow:c,startColumn:h,endColumn:u}=t.rangeData,d=c-a+1,g=u-h+1,f=null!=(r=l.rowCount)?r:0,m=null!=(s=l.columnCount)?s:0,b=new p;if(t.shiftDimension===Be.ROWS)for(let p=a;p<=f;p++)for(let e=h;e<=u;e++){if(p<=c){const t=null==i?void 0:i.getValue(p,e);b.setValue(p,e,t)}const t=null==i?void 0:i.getValue(p+d,e);if(t)null==i||i.setValue(p,e,C.deepClone(t));else{(null==i?void 0:i.getValue(p,e))&&(null==i||i.deleteValue(p,e),e--)}}else if(t.shiftDimension===Be.COLUMNS)for(let p=a;p<=c;p++)for(let e=h;e<=m;e++){if(e<=u){const t=null==i?void 0:i.getValue(p,e);b.setValue(p,e,t)}else for(let n=0;n<=u;n++){const t=null==i?void 0:i.getValue(p,e);b.setValue(p,e+n,t)}const t=null==i?void 0:i.getValue(p,e+g);if(t)null==i||i.setValue(p,e,C.deepClone(t));else{if(null==i?void 0:i.getValue(p,e)){for(let t=0;t<=u;t++)null==i||i.deleteValue(p,e);break}}}return b.getData()}function ns(e,t){const n=e.getConfig(),r=n.hidden;return n.hidden=t,r}function rs(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId).getColumnManager().getColumnData().toJSON();new f(n).inserts(t.columnIndex,new f(t.columnCount))}function ss(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId).getCellMatrix().toJSON();new p(n).insertColumns(t.columnIndex,new p(t.columnData))}function os(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId).getCellMatrix().toJSON();new p(n).insertRows(t.rowIndex,new p(t.rowData))}function is(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId),r=n.getLastRow(),s=n.getLastColumn(),o=n.getCellMatrix(),{startRow:i,endRow:l,startColumn:a,endColumn:c}=t.rangeData,h=l-i+1,u=c-a+1,d=r,g=s;if(t.shiftDimension===Be.ROWS){for(let e=d;e>=i;e--)for(let t=a;t<=c;t++){const n=o.getValue(e,t);o.setValue(e+h,t,n)}for(let e=l;e>=i;e--)for(let n=a;n<=c;n++)o.setValue(e,n,t.cellValue[e-i][n-a])}else if(t.shiftDimension===Be.COLUMNS){for(let e=i;e<=l;e++)for(let t=g;t>=a;t--){const n=o.getValue(e,t);o.setValue(e,t+u,n)}for(let e=i;e<=l;e++)for(let n=c;n>=a;n--)o.setValue(e,n,t.cellValue[e-i][n-a])}}function ls(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId).getRowManager().getRowData().toJSON();new f(n).inserts(t.rowIndex,new f(t.rowCount))}function as(e,t){e.WorkBookUnit.getSheetBySheetId(t.sheetId);const n=t.index,r=t.sheet,s=e.WorkBookUnit.getWorksheets(),o=e.WorkBookUnit.getConfig(),{sheets:i,sheetOrder:l}=o;if(i[r.id])throw new Error(`Insert Sheet fail ${r.id} is already exist`);return i[r.id]=r,l.splice(n,0,r.id),s.set(r.id,new En(e.WorkBookUnit.getContext(),r)),r.id}function cs(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId).getColumnManager().getColumnData().toJSON(),r=new f(n),s=new f,o=t.columnIndex,i=t.columnIndex+t.columnCount;for(let l=o;l<i;l++){const e=r.splice(t.columnIndex,1);e.getLength()&&s.set(l,e.first())}return s.getLength()}function hs(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId).getCellMatrix().toJSON();return new p(n).spliceColumns(t.columnIndex,t.columnCount).toJSON()}function us(e,t){let n=e.WorkBookUnit.getSheetBySheetId(t.sheetId);if(n){let e=[],r=n.getConfig().mergeData,s=t.rectangles;for(let t=0;t<s.length;t++)for(let n=r.length-1;n>=0;n--){let o=r[n],i=s[t];br.intersects(o,i)&&e.push(r.splice(n,1)[0])}return e}return[]}function ds(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId).getRowManager().getRowData().toJSON(),r=new f(n),s=new f,o=t.rowIndex,i=t.rowIndex+t.rowCount;for(let l=o;l<i;l++){const e=r.splice(t.rowIndex,1);e.getLength()&&s.set(l,e.first())}return s.getLength()}function gs(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId).getCellMatrix().toJSON();return new p(n).spliceRows(t.rowIndex,t.rowCount).toJSON()}function fs(e,t){let n=e.WorkBookUnit,r=t.sheetId;const s=n.getWorksheets(),o=n.getConfig(),{sheets:i}=o;if(null==i[r])throw new Error(`Remove Sheet fail ${r} is not exist`);const l=i[r],a=o.sheetOrder.findIndex((e=>e===r));return delete i[r],o.sheetOrder.splice(a,1),s.delete(r),{index:a,sheet:l}}function ms(e,t){const n=e.WorkBookUnit,r=n.getSheetBySheetId(t.sheetId),s=n.getStyles(),o=r.getCellMatrix(),i=new p(t.styles),l=new p;return i.forValue(((e,t,n)=>{const r=o.getValue(e,t);if(r){const o=s.get(r.s);o&&l.setValue(e,t,o),r.s=s.setValue(n)}})),l.toJSON()}function ps(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId),r=t.columnIndex,s=t.columnCount,o=n.getColumnManager();for(let i=r;i<r+s;i++){o.getColumnOrCreate(i).hd=1}}function bs(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId).getColumnManager();for(let r=0;r<0;r++){const e=n.getColumn(r);e&&(e.hd=0)}}function _s(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId),r=t.columnIndex,s=t.columnWidth,o=n.getColumnManager(),i=[];for(let l=r;l<r+s.length;l++){const e=o.getColumnOrCreate(l);i[l-r]=e.w,e.w=s[l-r]}return i}function vs(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId),r=t.hideGridlines,s=n.getConfig(),o=0===s.showGridlines;return s.showGridlines=r?0:1,o}function Cs(e=0,t,n){for(let r=e;r<e+t;r++){const e=n.getRowOrCreate(r);e&&(e.hd=1)}}function Ts(e,t){const n=e.WorkBookUnit;n.getSheetBySheetId(t.sheetId);const r=t.namedRange,s=n.getConfig().namedRanges;return s.find(((e,t)=>e.namedRangeId===r.namedRangeId?(s[t]=r,e):null))}function ws(e,t,n,r){const{startRow:s,endRow:o,startColumn:i,endColumn:l}=n,a=new p;for(let c=s;c<=o;c++)for(let n=i;n<=l;n++){const o=e.getValue(c,n)||{},l=r.getStyleByCell(o);null==l&&delete o.s;const h=Rs(l,t[c-s][n-i]);h&&C.removeNull(h),C.isEmptyObject(h)?delete o.s:o.s=r.setValue(h),o.p&&Is(o.p,t[c-s][n-i]),e.setValue(c,n,o),a.setValue(c-s,n-i,ys(l,t[c-s][n-i]))}return a.getData()}function ys(e,t){return Ss(e,t)}function Ss(e,t){if(!t||!Object.keys(t).length)return e;const n=C.deepClone(e)||{};for(const r in t)"bd"===r?n[r]=Es(n[r]||{},t[r]):r in n||(n[r]=null);return n}function Es(e,t){if(!t||!Object.keys(t).length)return e;for(const n in t)n in e||(e[n]=null);return e}function Rs(e,t,n=!1){if(null===t)return t;if(void 0===t)return e;const r=C.deepClone(e)||{};for(const s in t)n&&["bd","tr","td","ht","vt","tb","pd"].includes(s)||(s in r&&"bd"===s?r[s]=Object.assign(r[s],t[s]):(r[s]=t[s],"cl"in r&&["ul","ol","st"].includes(s)&&(r[s].cl=r.cl)));return r}function Is(e,t){var n;null==(n=e.body)||n.blockElements.forEach((e=>{if(0===e.blockType){const n=e.paragraph;null==n||n.elements.forEach((e=>{e.tr||(e.tr={});const n=e.tr;n.ts||(n.ts={});const r=Rs(n.ts,t,!0);r&&C.removeNull(r),C.isEmptyObject(r)?delete n.ts:n.ts=r}))}}))}function As(e,t){const n=e.WorkBookUnit,r=n.getSheetBySheetId(t.sheetId).getCellMatrix(),s=t.options,o=t.cellValue,i=n.getStyles(),l=new p(o),a=new p;return s?(l.forValue(((e,t,n)=>{const o=r.getValue(e,t),i={};s.contentsOnly&&(i.m=null==o?void 0:o.m,i.v=null==o?void 0:o.v),s.formatOnly&&(i.v=null==o?void 0:o.v,i.m=null==o?void 0:o.m),a.setValue(e,t,i||{}),r.setValue(e,t,n||{})})),a.getData()):(l.forValue(((e,t,n)=>{const s=r.getValue(e,t)||{};if(n){const o=i.getStyleByCell(s),l=ys(o,null==n?void 0:n.s),c=C.deepClone(s);c.s=l,a.setValue(e,t,c),null==o&&delete s.s;const h=Rs(o,null==n?void 0:n.s);h&&C.removeNull(h),C.isEmptyObject(h)?delete s.s:s.s=i.setValue(h),null!=n.v&&(s.v=n.v),null!=n.m?s.m=n.m:s.m=String(s.v),null!=n.t&&(s.t=n.t),r.setValue(e,t,s)}else r.setValue(e,t,n),a.setValue(e,t,s)})),a.getData())}function xs(e,t,n){const r=new p(t),s=new p;for(let o=n.startRow;o<=n.endRow;o++)for(let t=n.startColumn;t<=n.endColumn;t++){const n=r.getValue(o,t),s=e.getValue(o,t),i=C.deepClone(s||{});i.n=n,e.setValue(o,t,i||{})}return s.getData()}function Os(e,t,n){const r=new p(t),s=new p;for(let o=n.startRow;o<=n.endRow;o++)for(let t=n.startColumn;t<=n.endColumn;t++){const n=r.getValue(o,t),i=e.getValue(o,t);s.setValue(o,t,i&&i.v||"");const l=C.deepClone(i||{});l.v=n,l.m=`${n}`,e.setValue(o,t,l||{})}return s.getData()}function Ms(e,t){const n=e.getConfig(),r=n.rightToLeft;return n.rightToLeft=t,r}function Ns(e=0,t,n){const r=[];for(let s=e;s<e+t.length;s++){const o=n.getRowOrCreate(s);r[s-e]=o.h,o.h=t[s-e]}return r}function ks(e,t,n,r){var s,o,i;const l=e.getSelection(),a=null==(s=l.getActiveRangeList())?void 0:s.getRangeList(),c=null==(o=l.getActiveRange())?void 0:o.getRangeData(),h=null==(i=l.getCurrentCell())?void 0:i.getRangeData();return l.setRanges(t,n,r),{activeRangeList:a,activeRange:c,currentCell:h}}function Ls(e,t,n){const r=e.getConfig(),s=r.sheetOrder.findIndex((e=>e===t)),o=r.sheetOrder.filter((e=>e!==t));return o.splice(n,0,t),r.sheetOrder=o,s}function Ds(e=0,t,n){for(let r=e;r<e+t;r++){const e=n.getRow(r);e&&(e.hd=0)}}function Ps(e,t){const n=e.getConfig(),r=n.tabColor;return n.tabColor=t,r}function Bs(e,t){const n=e.getContext().getWorkBook().getActiveSheet();let r="";const s=vt.FALSE;n&&(r=n.getSheetId());const o=e.getContext().getWorkBook().getSheets(),i=e.getSheetId();return o.forEach((e=>{const t=e.getSheetId();e.getConfig().status=t===i?vt.TRUE:vt.FALSE})),{oldSheetId:r,status:s}}function Hs(e,t){const n=e.getConfig(),r=n.name;return n.name=t,r}function Fs(e,t){const n=e.getConfig(),r=n.status;return n.status=t,r}function zs(e,t,n){const r=e.getSheetBySheetId(t);if(r){const e=r.getConfig().zoomRatio;return r.getConfig().zoomRatio=n,e}return 1}class Us extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{rectangles:this.do()}),this.validate()}do(){return Zr(this._commandUnit,this._doActionData)}redo(){this.do()}undo(){us(this._commandUnit,this._oldActionData)}validate(){return!1}}Us.NAME="AddMergeAction",zr.register(Us.NAME,Us);class Ws extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData={actionName:js.NAME,sheetId:e.sheetId,namedRange:this.do()},this.validate()}do(){const e=es(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:js.NAME,namedRange:this.do()}}undo(){qr(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Ws.NAME="DeleteNamedRangeAction",zr.register(Ws.NAME,Ws);const Vs=class extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this.do(),this._oldActionData={actionName:Ws.NAME,sheetId:e.sheetId,namedRangeId:e.namedRange.namedRangeId},this.validate()}do(){qr(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const{sheetId:e}=this._oldActionData;this._doActionData={actionName:Vs.NAME,sheetId:e,namedRange:es(this._commandUnit,this._oldActionData)},this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let js=Vs;var Ys,Gs;js.NAME="AddNamedRangeAction",zr.register(js.NAME,js),(Gs=Ys||(Ys={})).DEFAULT="default",Gs.PASTE="paste";const Xs=class extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{cellValue:this.do()}),this.validate()}do(){const e=As(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,options:t}=this._doActionData;this._oldActionData={actionName:Xs.NAME,sheetId:e,cellValue:this.do(),options:t}}undo(){const{sheetId:e,cellValue:t,options:n}=this._oldActionData,r=this.getWorkSheet();this._workbook.getStyles(),r&&(this._doActionData={actionName:Xs.NAME,sheetId:e,cellValue:As(this._commandUnit,this._oldActionData),options:n},this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}};let $s=Xs;$s.NAME="SetRangeDataAction",zr.register($s.NAME,$s);class Qs extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{cellValue:this.do()}),this.validate()}do(){const e=Jr(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={actionName:$s.NAME,sheetId:e,cellValue:this.do()}}undo(){this.getWorkSheet()&&(As(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}Qs.NAME="ClearRangeAction",zr.register(Qs.NAME,Qs);class Ks extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this.do(),this._oldActionData=__spreadValues({},e),this.validate()}do(){this.getWorkSheet()&&(is(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}))}redo(){this.do()}undo(){const{rangeData:e,sheetId:t,shiftDimension:n}=this._oldActionData;this.getWorkSheet()&&(this._doActionData={actionName:$s.NAME,sheetId:t,cellValue:ts(this._commandUnit,this._oldActionData),rangeData:e,shiftDimension:n},this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}Ks.NAME="InsertRangeAction",zr.register(Ks.NAME,Ks);class Zs extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{cellValue:this.do()}),this.validate()}do(){const e=ts(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,rangeData:t,shiftDimension:n}=this._doActionData;this._oldActionData={sheetId:e,actionName:Ks.NAME,shiftDimension:n,rangeData:t,cellValue:this.do()}}undo(){this.getWorkSheet()&&(is(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}Zs.NAME="DeleteRangeAction",zr.register(Zs.NAME,Zs);class qs extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this.do(),this._oldActionData=__spreadValues({},e),this.validate()}do(){rs(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){cs(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}qs.NAME="InsertColumnAction",zr.register(qs.NAME,qs);class Js extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this.do(),this._oldActionData=__spreadProps(__spreadValues({},e),{columnCount:f.getMaxLength(e.columnData[0])}),this.validate()}do(){ss(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){hs(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Js.NAME="InsertColumnDataAction",zr.register(Js.NAME,Js);class eo extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this.do(),this._oldActionData=__spreadValues({},e),this.validate()}do(){ls(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){ds(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}eo.NAME="InsertRowAction",zr.register(eo.NAME,eo);class to extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this.do(),this._oldActionData=__spreadProps(__spreadValues({},e),{rowCount:f.getMaxLength(e.rowData[0])}),this.validate()}do(){os(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){gs(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}to.NAME="InsertRowDataAction",zr.register(to.NAME,to);class no extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{sheetId:this.do()})}do(){const e=as(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){this.redo()}undo(){fs(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}no.NAME="InsertSheetAction",zr.register(no.NAME,no);class ro extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{columnCount:this.do()}),this.validate()}do(){const e=cs(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){rs(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}ro.NAME="RemoveColumnAction",zr.register(ro.NAME,ro);class so extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{columnData:this.do()}),this.validate()}do(){const e=hs(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){ss(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}so.NAME="RemoveColumnDataAction",zr.register(so.NAME,so);class oo extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{rectangles:this.do()}),this.validate()}do(){const e=us(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){Zr(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}oo.NAME="RemoveMergeAction",zr.register(oo.NAME,oo);class io extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{rowCount:this.do()}),this.validate()}do(){const e=ds(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){ls(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}io.NAME="RemoveRowAction",zr.register(io.NAME,io);class lo extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{rowData:this.do()}),this.validate()}do(){const e=gs(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){os(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}lo.NAME="RemoveRowDataAction",zr.register(lo.NAME,lo);class ao extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadValues(__spreadValues({},e),this.do())}do(){return this.redo()}redo(){const e=fs(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}undo(){this.getWorkBook(),as(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}ao.NAME="RemoveSheetAction",zr.register(ao.NAME,ao);class co extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{styles:this.do()}),this.validate()}do(){const e=ms(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){ms(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}co.NAME="SetBorderAction",zr.register(co.NAME,co);class ho extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this.do(),this._oldActionData=__spreadValues({},e),this.validate()}do(){ps(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){bs(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}ho.NAME="SetColumnHideAction",zr.register(ho.NAME,ho);class uo extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this.do(),this._oldActionData=__spreadValues({},e),this.validate()}do(){bs(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){ps(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}uo.NAME="SetColumnShowAction",zr.register(uo.NAME,uo);class go extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{columnWidth:this.do()}),this.validate()}do(){const e=_s(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){const e=_s(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this}),e}validate(){return!1}}go.NAME="SetColumnWidthAction",zr.register(go.NAME,go);class fo extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{hideGridlines:this.do()}),this.validate()}do(){const e=vs(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){vs(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}fo.NAME="SetHiddenGridlinesAction",zr.register(fo.NAME,fo);const mo=class extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData={actionName:mo.NAME,namedRange:this.do(),sheetId:e.sheetId},this.validate()}do(){const e=Ts(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={actionName:mo.NAME,sheetId:e,namedRange:this.do()}}undo(){const{sheetId:e}=this._oldActionData;this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:mo.NAME,sheetId:e,namedRange:Ts(this._commandUnit,this._oldActionData)}}validate(){return!1}};let po=mo;po.NAME="SetNamedRangeAction",zr.register(po.NAME,po);const bo=class extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{cellNote:this.do()}),this.validate()}do(){const e=xs(this.getWorkSheet().getCellMatrix(),this._doActionData.cellNote,this._doActionData.rangeData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:bo.NAME,sheetId:e,cellNote:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellNote:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:bo.NAME,sheetId:t,cellNote:xs(r.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}};let _o=bo;_o.NAME="SetRangeNoteAction",zr.register(_o.NAME,_o);const vo=class extends Ur{constructor(e,t,n){super(e,t,n),this._oldActionData=__spreadProps(__spreadValues({},e),{value:this.do()}),this.validate()}do(){const{value:e,rangeData:t}=this._doActionData,n=this._workbook.getStyles(),r=ws(this.getWorkSheet().getCellMatrix(),e,t,n);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),r}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:vo.NAME,sheetId:e,value:this.do(),rangeData:t}}undo(){const{value:e,rangeData:t,sheetId:n}=this._oldActionData,r=this._workbook.getStyles(),s=this.getWorkSheet().getCellMatrix();this._doActionData={actionName:vo.NAME,sheetId:n,value:ws(s,e,t,r),rangeData:t},this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let Co=vo;Co.NAME="SetRangeStyleAction",zr.register(Co.NAME,Co);class To extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{cellValue:this.do()}),this.validate()}do(){const e=Os(this.getWorkSheet().getCellMatrix(),this._doActionData.cellValue,this._doActionData.rangeData);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:$s.NAME,sheetId:e,cellValue:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellValue:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:$s.NAME,sheetId:t,cellValue:Os(r.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}To.NAME="SetRangeFormattedValueAction",zr.register(To.NAME,To);class wo extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{rightToLeft:this.do()}),this.validate()}do(){const e=Ms(this.getWorkSheet(),this._doActionData.rightToLeft);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){this._oldActionData;Ms(this.getWorkSheet(),this._oldActionData.rightToLeft),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}wo.NAME="SetRightToLeftAction",zr.register(wo.NAME,wo);class yo extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{rowHeight:this.do()}),this.validate()}do(){const e=this.getWorkSheet(),t=Ns(this._doActionData.rowIndex,this._doActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=Ns(this._oldActionData.rowIndex,this._oldActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}yo.NAME="SetRowHeightAction",zr.register(yo.NAME,yo);class So extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this.do(),this._oldActionData=__spreadValues({},e),this.validate()}do(){const e=this.getWorkSheet();Cs(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Ds(this._oldActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}So.NAME="SetRowHideAction",zr.register(So.NAME,So);class Eo extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this.do(),this._oldActionData=__spreadValues({},e),this.validate()}do(){const e=this.getWorkSheet();Ds(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Cs(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Eo.NAME="SetRowShowAction",zr.register(Eo.NAME,Eo);const Ro=class extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e);const{activeRangeList:r,activeRange:s,currentCell:o}=this.do();this._oldActionData=__spreadProps(__spreadValues({},e),{activeRangeList:r,activeRange:s,currentCell:o}),this.validate()}do(){const{activeRangeList:e,activeRange:t,currentCell:n}=this._doActionData,r=ks(this.getWorkSheet(),e,t,n);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),r}redo(){const{sheetId:e}=this._doActionData,{activeRangeList:t,activeRange:n,currentCell:r}=this.do();this._oldActionData={actionName:Ro.NAME,sheetId:e,activeRangeList:t,activeRange:n,currentCell:r}}undo(){const{activeRangeList:e,activeRange:t,currentCell:n,sheetId:r}=this._oldActionData,s=ks(this.getWorkSheet(),e,t,n);this._doActionData={actionName:Ro.NAME,sheetId:r,activeRangeList:s.activeRangeList,activeRange:s.activeRange,currentCell:s.currentCell},this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let Io=Ro;Io.NAME="SetSelectionActivateAction",zr.register(Io.NAME,Io);class Ao extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{order:this.do()}),this.validate()}do(){const e=Ls(this.getWorkSheet().getContext().getWorkBook(),this._doActionData.sheetId,this._doActionData.order);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){Ls(this.getWorkSheet().getContext().getWorkBook(),this._oldActionData.sheetId,this._oldActionData.order),this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Ao.NAME="SetSheetOrderAction",zr.register(Ao.NAME,Ao);const xo=class extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{color:this.do()}),this.validate()}do(){const e=Ps(this.getWorkSheet(),this._doActionData.color);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:xo.NAME,color:this.do()}}undo(){const{color:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:xo.NAME,sheetId:t,color:Ps(n,e)},this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let Oo=xo;Oo.NAME="SetTabColorAction",zr.register(Oo.NAME,Oo);const Mo=class extends Ur{constructor(e,n,r){super(e,n,r),this._doActionData=__spreadValues({},e);const{oldSheetId:s,status:o}=this.do();this._oldActionData=__spreadProps(__spreadValues({},e),{sheetId:s,status:o}),this.validate(),this.removeOperation(t.SERVER_ACTION)}do(){const{sheetId:e,status:t}=this._doActionData,n=Bs(this._workbook.getSheetBySheetId(e));return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),n}redo(){const{oldSheetId:e,status:t}=this.do();this._oldActionData={actionName:Mo.NAME,sheetId:e,status:t}}undo(){const{sheetId:e}=this._oldActionData;this._oldActionData.status;const t=this._workbook.getSheetBySheetId(e);if(t){const{oldSheetId:e,status:n}=Bs(t);this._doActionData={actionName:Mo.NAME,sheetId:e,status:n},this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}}validate(){return!1}};let No=Mo;No.NAME="SetWorkSheetActivateAction",zr.register(No.NAME,No);const ko=class extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{hidden:this.do()}),this.validate()}do(){const e=ns(this.getWorkSheet(),this._doActionData.hidden);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:ko.NAME,hidden:this.do()}}undo(){const{hidden:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:ko.NAME,sheetId:t,hidden:ns(n,e)},this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let Lo=ko;Lo.NAME="SetWorkSheetHideAction",zr.register(Lo.NAME,Lo);const Do=class extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{sheetName:this.do()}),this.validate()}do(){const e=Hs(this.getWorkSheet(),this._doActionData.sheetName);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:Do.NAME,sheetName:this.do()}}undo(){const{sheetName:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Do.NAME,sheetId:t,sheetName:Hs(n,e)},this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let Po=Do;Po.NAME="SetWorkSheetNameAction",zr.register(Po.NAME,Po);class Bo extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{sheetStatus:this.do()}),this.validate()}do(){const e=Fs(this.getWorkSheet(),this._doActionData.sheetStatus);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:be.SET_WORKSHEET_STATUS_ACTION,sheetStatus:this.do()}}undo(){const{sheetStatus:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:be.SET_WORKSHEET_STATUS_ACTION,sheetId:t,sheetStatus:Fs(n,e)},this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Bo.NAME="SetWorkSheetStatusAction",zr.register(Bo.NAME,Bo);class Ho extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e),this._oldActionData=__spreadProps(__spreadValues({},e),{zoom:this.do()}),this.validate()}redo(){const e=zs(this.getWorkBook(),this._doActionData.sheetId,this._doActionData.zoom);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),e}do(){return this.redo()}undo(){zs(this.getWorkBook(),this._oldActionData.sheetId,this._oldActionData.zoom),this._observers.notifyObservers({type:Dr.REDO,data:this._oldActionData,action:this})}validate(){return!1}}Ho.NAME="SetZoomRatioAction",zr.register(Ho.NAME,Ho);class Fo{constructor(e){this._name=e,this._observeNames=[]}onCreate(e){this.context=e}load(e){}save(){return Object()}onMounted(e){}onDestroy(){this.deleteObserve(...this._observeNames)}getPluginName(){return this._name}getContext(){return this.context}getGlobalContext(){return this.context.getUniver().getGlobalContext()}getLocale(){return this.getGlobalContext().getLocale()}getUniver(){return this.context.getUniver()}getObserver(e){return this.context.getObserverManager().getObserver(e,this._name)}getPluginByName(e){return this.context.getPluginManager().getPluginByName(e)}pushToObserve(...e){const t=this.context.getObserverManager();e.forEach((e=>{this._observeNames.includes(e)||this._observeNames.push(e),t.addObserver(e,this._name,new i)}))}deleteObserve(...e){const t=this.context.getObserverManager();e.forEach((e=>{t.removeObserver(e,this._name)}))}}class zo{constructor(e,t=[]){this._context=e,this._plugins=[],this._initialized=!0,this._plugins=this._plugins.concat(t),this._initialize()}install(e){const{_plugins:t}=this;t.push(e),e.onCreate(this._context),e.onMounted(this._context)}uninstall(e){const{_plugins:t}=this,n=t.findIndex((t=>t.getPluginName()===e));if(n>-1){const e=t.splice(n,1)[0];e&&e.onDestroy()}}setContext(e){this._context=e}getRequirePluginByName(e){for(let t=0;t<this._plugins.length;t++)if(this._plugins[t].getPluginName()===e)return this._plugins[t];throw new Error(`not found plugin ${e}`)}getPlugins(){return this._plugins}getPluginByName(e){for(let t=0;t<this._plugins.length;t++)if(this._plugins[t].getPluginName()===e)return this._plugins[t];return null}_initialize(){this._initialized&&(this._initialized=!1,this._plugins.forEach((e=>{e.onCreate(this._context),e.onMounted(this._context)})))}}class Uo{constructor(){this.os="",this.app_version="",this.platform="",this.device_id="",this.os_version=""}}class Wo{constructor(){this._hooksManager=new a,this._pluginManager=new zo(this),this._environment=new Uo,this._observerManager=new Lr,this._initialize()}onUniver(e){const t=e.getGlobalContext();this._univer=e,this._undoManager=t.getUndoManager(),this._commandManager=t.getCommandManager()}getHook(e){return this._hooksManager.getHooks(e)}getHooksManager(){return this._hooksManager}getObserverManager(){return this._observerManager}getPluginManager(){return this._pluginManager}getUndoManager(){return this._undoManager}getCommandManager(){return this._commandManager}getUniver(){return this._univer}_initialize(){this._undoManager=new Vr,this._commandManager=new zr(this)}}class Vo extends Wo{constructor(e={}){super(),this._locale=new sr,this._locale.initialize()}getLocale(){return this._locale}_setObserver(){}}var jo,Yo;function Go(e,t){let n=e.body;if(t){const{headers:r,footers:s}=e;(null==r?void 0:r[t])?n=r[t].body:(null==s?void 0:s[t])&&(n=s[t].body)}return n}(Yo=jo||(jo={})).INSERT_TEXT_ACTION_NAME="InsertTextAction",Yo.DELETE_TEXT_ACTION_NAME="DeleteTextAction",Yo.CLEAR_TEXT_STYLE_ACTION_NAME="ClearTextStyleAction",Yo.DELETE_PARAGRAPH_ACTION_NAME="DeleteParagraphAction",Yo.INSERT_PARAGRAPH_ACTION_NAME="InsertParagraphAction",Yo.MERGE_PARAGRAPH_ACTION_NAME="MergeParagraphAction",Yo.MOVE_PARAGRAPH_ACTION_NAME="MoveParagraphAction",Yo.SET_TEXT_STYLE_ACTION_NAME="SetTextStyleAction",Yo.SPLIT_PARAGRAPH_ACTION_NAME="SplitParagraphAction",Yo.UPDATE_DOCUMENT_STYLE_ACTION_NAME="UpdateDocumentAction",Yo.UPDATE_PARAGRAPH_STYLE_ACTION_NAME="UpdateParagraphAction",Yo.UPDATE_SECTION_ACTION_NAME="UpdateSectionAction",Yo.DELETE_BULLET_ACTION_NAME="DeleteBulletAction",Yo.DELETE_PARAGRAPH_BULLET_ACTION_NAME="DeleteParagraphBulletAction",Yo.DELETE_SECTION_ACTION_NAME="DeleteSectionAction",Yo.INSERT_BULLET_ACTION_NAME="InsertBulletAction",Yo.INSERT_PARAGRAPH_BULLET_ACTION_NAME="InsertParagraphBulletAction",Yo.INSERT_SECTION_ACTION_NAME="InsertSectionAction",Yo.UPDATE_BULLET_ACTION_NAME="UpdateBulletAction",Yo.UPDATE_PARAGRAPH_BULLET_ACTION_NAME="UpdateParagraphBulletAction",Yo.TEXT_INDEX_ADJUST_ACTION_NAME="TextIndexAdjustAction";class Xo{constructor(e,t){var n;this._context=t,this._snapshot=__spreadValues(__spreadValues({},Pt),e),this._unitId=null!=(n=this._snapshot.id)?n:C.generateRandomId(6)}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}insertText(e,t,n){const{_context:r}=this,s=r.getCommandManager(),o=__spreadProps(__spreadValues({actionName:jo.INSERT_TEXT_ACTION_NAME},t),{text:e,length:e.length,segmentId:n}),i=new Wr({DocumentUnit:this},o);return s.invoke(i),this}deleteText(e,t){const{_context:n}=this,r=n.getCommandManager(),s=this._getDeleteTextAction(e,t),o=new Wr({DocumentUnit:this},...s);return r.invoke(o),this}updateText(e,t,n,r){const{_context:s}=this,o=s.getCommandManager(),i={actionName:jo.DELETE_TEXT_ACTION_NAME,text:t,start:n+t.length,length:t.length,segmentId:r},l={actionName:jo.INSERT_TEXT_ACTION_NAME,text:e,start:n,length:e.length,segmentId:r},a=new Wr({DocumentUnit:this},i,l);return o.invoke(a),this}_getDeleteTextAction(e,t){const{cursorStart:n,cursorEnd:r,isCollapse:s,isEndBack:o,isStartBack:i}=e;let l=[];return l=s?this._getDeleteTextActionCollapse(e,t):this._getDeleteTextActionRange(e,t),0===l.length?[]:(l.push({actionName:jo.TEXT_INDEX_ADJUST_ACTION_NAME,cursorStart:n,cursorEnd:r,isCollapse:s,isEndBack:o,isStartBack:i,segmentId:t}),l)}_getDeleteTextActionCollapse(e,t){var n;const r=Go(this._snapshot,t);if(null==r)return[];const{blockElements:s}=r,{cursorStart:o,isCollapse:i,isStartBack:l}=e,a=[];let c=null,h=null,u=null;for(let d of s){if(null==d)continue;const{blockType:e,st:r,ed:s,blockId:i}=d;if(e===I.PARAGRAPH){if(o>s||o<r)continue;o===r&&l?(null==(n=d.paragraph)?void 0:n.bullet)?a.push({actionName:jo.DELETE_BULLET_ACTION_NAME,blockId:i,blockElement:d,segmentId:t}):(c=u,h=i):a.push({actionName:jo.DELETE_TEXT_ACTION_NAME,cursorStart:o,cursorEnd:o,isCollapse:!0,isEndBack:l,isStartBack:l,segmentId:t})}u=i}return null!=c&&null!=h&&c!==h&&a.push({actionName:jo.MERGE_PARAGRAPH_ACTION_NAME,startBlockId:c,endBlockId:h,segmentId:t,cursorStart:o,isStartBack:l}),a}_getDeleteTextActionRange(e,t){const n=Go(this._snapshot,t);if(null==n)return[];const{blockElements:r}=n,{cursorStart:s,cursorEnd:o,isCollapse:i,isEndBack:l,isStartBack:a}=e,c=[];let h=null,u=null;for(let d of r){if(null==d)continue;const{blockType:e,st:n,ed:r,blockId:g}=d;if(e===I.PARAGRAPH){if(s>r||o<n)continue;let e=n,f=r,m=a,p=l;n<=s&&r>=s?(h=g,e=s):m=!0,n<=o&&r>=o?(u=g,f=o):p=!1,(s<n||s===n&&a)&&(o>r||o===r&&!l)&&!i?c.push({actionName:jo.DELETE_PARAGRAPH_ACTION_NAME,cursorStart:n,cursorEnd:r,isCollapse:!1,isEndBack:!1,isStartBack:!0,blockId:g,blockElement:d,segmentId:t}):c.push({actionName:jo.DELETE_TEXT_ACTION_NAME,cursorStart:e,cursorEnd:f,isCollapse:i,isEndBack:p,isStartBack:m,segmentId:t})}}return null!=h&&null!=u&&h!==u&&c.push({actionName:jo.MERGE_PARAGRAPH_ACTION_NAME,startBlockId:h,endBlockId:u,segmentId:t,cursorStart:s,isStartBack:a}),c}}class $o extends Wo{constructor(e={}){super(),this._document=new Xo(e,this)}getDocument(){return this._document}_setObserver(){}}class Qo{constructor(){this._data=[]}static create(){return new Qo}add(e){this._data.indexOf(e)>-1||this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}}class Ko{constructor(){this._data=new Map}static create(){return new Ko}add(e,t){this._data.has(e)||this._data.set(e,t)}delete(e){this._data.delete(e)}getData(){return this._data}}class Zo{install(e){e.addObserver("onAfterSetSelectionObservable","core",new i),e.addObserver("onBeforeChangeNameObservable","core",new i),e.addObserver("onAfterChangeNameObservable","core",new i),e.addObserver("onBeforeChangeActiveSheetObservable","core",new i),e.addObserver("onAfterChangeActiveSheetObservable","core",new i),e.addObserver("onBeforeChangeSheetNameObservable","core",new i),e.addObserver("onAfterChangeSheetNameObservable","core",new i),e.addObserver("onBeforeInsertSheetObservable","core",new i),e.addObserver("onAfterInsertSheetObservable","core",new i),e.addObserver("onBeforeRemoveSheetObservable","core",new i),e.addObserver("onAfterRemoveSheetObservable","core",new i),e.addObserver("onBeforeChangeSheetColorObservable","core",new i),e.addObserver("onAfterChangeSheetColorObservable","core",new i),e.addObserver("onBeforeChangeSheetDataObservable","core",new i),e.addObserver("onAfterChangeSheetDataObservable","core",new i),e.addObserver("onSheetBarDidMountObservable","core",new i),e.addObserver("onInfoBarDidMountObservable","core",new i),e.addObserver("onRightMenuDidMountObservable","core",new i),e.addObserver("onAfterChangeSheetScrollObservable","core",new i),e.addObserver("onSheetRenderDidMountObservable","core",new i),e.addObserver("onHideSheetObservable","core",new i),e.addObserver("onShowSheetObservable","core",new i),e.addObserver("onSheetTabColorChangeObservable","core",new i),e.addObserver("onSheetOrderObservable","core",new i),e.addObserver("onZoomRatioSheetObservable","core",new i)}}class qo extends Wo{constructor(e={}){super(),this._setObserver(),this._genname=new ir,this._workbook=new xn(e,this)}getWorkBook(){return this._workbook}getGenName(){return this._genname}getContextObserver(e){return this.getObserverManager().requiredObserver(e,"core")}refreshWorkbook(e={}){this._workbook=new xn(e,this)}_setObserver(){const e=this.getObserverManager();(new Zo).install(e)}_initialize(){}}class Jo{constructor(e,t){var n;this._context=t,this._snapshot=__spreadValues(__spreadValues({},Bt),e),this._unitId=null!=(n=this._snapshot.id)?n:C.generateRandomId(6)}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var e;return null==(e=this._snapshot.body)?void 0:e.pages}getPageOrder(){var e;return null==(e=this._snapshot.body)?void 0:e.pageOrder}getPage(e){const t=this.getPages();return null==t?void 0:t[e]}getElementsByPage(e){var t;return null==(t=this.getPage(e))?void 0:t.pageElements}getElement(e,t){var n;return null==(n=this.getElementsByPage(e))?void 0:n[t]}getPageSize(){return this._snapshot.pageSize}addPage(){return{id:"cover_1",pageType:Yt.SLIDE,zIndex:1,title:"cover",description:"this is first page, cover",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}}class ei extends Wo{constructor(e={}){super(),this._slide=new Jo(e,this)}getSlide(){return this._slide}_setObserver(){}}const ti="dev",ni="0.0.1";class ri{constructor(e={}){this.univerDocConfig=e,this._context=new $o(e)}get context(){return this._context}static newInstance(e={}){return or.capsule(ti,ni,"powered by :: UniverDoc :: "),new ri(e)}static get(e){return $n(__spreadProps(__spreadValues({},e),{type:"GET"}))}static post(e){return $n(__spreadProps(__spreadValues({},e),{type:"POST"}))}getUnitId(){return this._context.getDocument().getUnitId()}installPlugin(e){this._context.getPluginManager().install(e)}uninstallPlugin(e){this._context.getPluginManager().uninstall(e)}}class si{constructor(e={}){this.univerSheetConfig=e,this._context=new qo(e)}get context(){return this._context}static newInstance(e={}){return or.capsule(ti,ni,"powered by :: universheet :: "),new si(e)}static get(e){return $n(__spreadProps(__spreadValues({},e),{type:"GET"}))}static post(e){return $n(__spreadProps(__spreadValues({},e),{type:"POST"}))}static load(e,t){e.getWorkBook().load(t.workbookConfig),e.context.getPluginManager().getPlugins().forEach((e=>{e.load(t[`${e.getPluginName()}Config`])}))}static newColor(){return new Zt}static toJson(e){const t=e.getWorkBook().save(),n={};return e.context.getPluginManager().getPlugins().forEach((e=>{n[`${e.getPluginName()}Config`]=e.save()})),__spreadValues({workbookConfig:t},n)}getUnitId(){return this.getWorkBook().getUnitId()}installPlugin(e){this._context.getPluginManager().install(e)}uninstallPlugin(e){this._context.getPluginManager().uninstall(e)}getWorkBook(){return this._context.getWorkBook()}refreshWorkbook(e={}){this._context.refreshWorkbook(e)}}class oi{constructor(e={}){this.UniverSlideConfig=e,this._context=new ei(e)}get context(){return this._context}static newInstance(e={}){return or.capsule(ti,ni,"powered by :: UniverSlide :: "),new oi(e)}static get(e){return $n(__spreadProps(__spreadValues({},e),{type:"GET"}))}static post(e){return $n(__spreadProps(__spreadValues({},e),{type:"POST"}))}static newColor(){return new Zt}installPlugin(e){this._context.getPluginManager().install(e)}uninstallPlugin(e){this._context.getPluginManager().uninstall(e)}}class ii{constructor(){this._univerSheets=[],this._univerDocs=[],this._univerSlides=[],this._context=new Vo,this._context.onUniver(this)}addUniverSheet(e){e.context.onUniver(this),this._univerSheets.push(e)}addUniverDoc(e){e.context.onUniver(this),this._univerDocs.push(e)}addUniverSlide(e){e.context.onUniver(this),this._univerSlides.push(e)}getUniverSheetInstance(e){return this._univerSheets.find((t=>t.getUnitId()===e))}getUniverDocInstance(e){return this._univerDocs.find((t=>t.getUnitId()===e))}getUniverSlideInstance(e){return null}getAllUniverSheetsInstance(){return this._univerSheets}getAllUniverDocsInstance(){return this._univerDocs}getAllUniverSlidesInstance(){return this._univerSlides}getCurrentUniverSheetInstance(){return this._univerSheets[0]}getCurrentUniverDocInstance(){return this._univerDocs[0]}getCurrentUniverSlideInstance(){return this._univerSlides[0]}getGlobalContext(){return this._context}install(e){this._context.getPluginManager().install(e)}uninstall(e){this._context.getPluginManager().uninstall(e)}}
/*! *****************************************************************************
      Copyright (C) Microsoft. All rights reserved.
      Licensed under the Apache License, Version 2.0 (the "License"); you may not use
      this file except in compliance with the License. You may obtain a copy of the
      License at http://www.apache.org/licenses/LICENSE-2.0
  
      THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
      KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
      WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
      MERCHANTABLITY OR NON-INFRINGEMENT.
  
      See the Apache Version 2.0 License for specific language governing permissions
      and limitations under the License.
      ***************************************************************************** */var li,ai;function ci(e){return"function"==typeof e}function hi(e){return null!=e}function ui(e){return null==e}ai=li||(li={}),function(e){var t="object"==typeof ln?ln:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=r(ai);function r(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===t.Reflect?t.Reflect=ai:n=r(t.Reflect,n),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,i={__proto__:[]}instanceof Array,l=!o&&!i,a={create:o?function(){return re(Object.create(null))}:i?function(){return re({__proto__:null})}:function(){return re({})},has:l?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:l?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),h="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,u=h||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,d=h||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,g=new(h||"function"!=typeof WeakMap?ne():WeakMap);function f(e,t,n,r){if(D(n)){if(!j(e))throw new TypeError;if(!G(t))throw new TypeError;return S(e,t)}if(!j(e))throw new TypeError;if(!H(t))throw new TypeError;if(!H(r)&&!D(r)&&!P(r))throw new TypeError;return P(r)&&(r=void 0),E(e,t,n=V(n),r)}function m(e,t){function n(n,r){if(!H(n))throw new TypeError;if(!D(r)&&!X(r))throw new TypeError;M(e,t,n,r)}return n}function p(e,t,n,r){if(!H(n))throw new TypeError;return D(r)||(r=V(r)),M(e,t,n,r)}function b(e,t,n){if(!H(t))throw new TypeError;return D(n)||(n=V(n)),I(e,t,n)}function _(e,t,n){if(!H(t))throw new TypeError;return D(n)||(n=V(n)),A(e,t,n)}function v(e,t,n){if(!H(t))throw new TypeError;return D(n)||(n=V(n)),x(e,t,n)}function C(e,t,n){if(!H(t))throw new TypeError;return D(n)||(n=V(n)),O(e,t,n)}function T(e,t){if(!H(e))throw new TypeError;return D(t)||(t=V(t)),N(e,t)}function w(e,t){if(!H(e))throw new TypeError;return D(t)||(t=V(t)),k(e,t)}function y(e,t,n){if(!H(t))throw new TypeError;D(n)||(n=V(n));var r=R(t,n,!1);if(D(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var s=g.get(t);return s.delete(n),s.size>0||g.delete(t),!0}function S(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!D(r)&&!P(r)){if(!G(r))throw new TypeError;t=r}}return t}function E(e,t,n,r){for(var s=e.length-1;s>=0;--s){var o=(0,e[s])(t,n,r);if(!D(o)&&!P(o)){if(!H(o))throw new TypeError;r=o}}return r}function R(e,t,n){var r=g.get(e);if(D(r)){if(!n)return;r=new u,g.set(e,r)}var s=r.get(t);if(D(s)){if(!n)return;s=new u,r.set(t,s)}return s}function I(e,t,n){if(A(e,t,n))return!0;var r=J(t);return!P(r)&&I(e,r,n)}function A(e,t,n){var r=R(t,n,!1);return!D(r)&&U(r.has(e))}function x(e,t,n){if(A(e,t,n))return O(e,t,n);var r=J(t);return P(r)?void 0:x(e,r,n)}function O(e,t,n){var r=R(t,n,!1);if(!D(r))return r.get(e)}function M(e,t,n,r){R(n,r,!0).set(e,t)}function N(e,t){var n=k(e,t),r=J(e);if(null===r)return n;var s=N(r,t);if(s.length<=0)return n;if(n.length<=0)return s;for(var o=new d,i=[],l=0,a=n;l<a.length;l++){var c=a[l];o.has(c)||(o.add(c),i.push(c))}for(var h=0,u=s;h<u.length;h++)c=u[h],o.has(c)||(o.add(c),i.push(c));return i}function k(e,t){var n=[],r=R(e,t,!1);if(D(r))return n;for(var s=Q(r.keys()),o=0;;){var i=Z(s);if(!i)return n.length=o,n;var l=K(i);try{n[o]=l}catch(a){try{q(s)}finally{throw a}}o++}}function L(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function D(e){return void 0===e}function P(e){return null===e}function B(e){return"symbol"==typeof e}function H(e){return"object"==typeof e?null!==e:"function"==typeof e}function F(e,t){switch(L(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",s=$(e,r);if(void 0!==s){var o=s.call(e,n);if(H(o))throw new TypeError;return o}return z(e,"default"===n?"number":n)}function z(e,t){if("string"===t){var n=e.toString;if(Y(n)&&!H(s=n.call(e)))return s;if(Y(r=e.valueOf)&&!H(s=r.call(e)))return s}else{var r;if(Y(r=e.valueOf)&&!H(s=r.call(e)))return s;var s,o=e.toString;if(Y(o)&&!H(s=o.call(e)))return s}throw new TypeError}function U(e){return!!e}function W(e){return""+e}function V(e){var t=F(e,3);return B(t)?t:W(t)}function j(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function Y(e){return"function"==typeof e}function G(e){return"function"==typeof e}function X(e){switch(L(e)){case 3:case 4:return!0;default:return!1}}function $(e,t){var n=e[t];if(null!=n){if(!Y(n))throw new TypeError;return n}}function Q(e){var t=$(e,s);if(!Y(t))throw new TypeError;var n=t.call(e);if(!H(n))throw new TypeError;return n}function K(e){return e.value}function Z(e){var t=e.next();return!t.done&&t}function q(e){var t=e.return;t&&t.call(e)}function J(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c)return t;if(t!==c)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var s=r.constructor;return"function"!=typeof s||s===e?t:s}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[s]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,s=n+1;s<r;s++)this._keys[s-1]=this._keys[s],this._values[s-1]=this._values[s];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,o)},t.prototype.entries=function(){return new n(this._keys,this._values,i)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[s]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function o(e,t){return t}function i(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new u}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[s]=function(){return this.keys()},e}()}function ne(){var e=16,n=a.create(),r=s();return function(){function e(){this._key=s()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&a.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?a.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=s()},e}();function s(){var e;do{e="@@WeakMap@@"+c()}while(a.has(n,e));return n[e]=!0,e}function o(e,n){if(!t.call(e,r)){if(!n)return;Object.defineProperty(e,r,{value:a.create()})}return e[r]}function i(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function l(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):i(new Uint8Array(e),e):i(new Array(e),e)}function c(){var t=l(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var s=t[r];4!==r&&6!==r&&8!==r||(n+="-"),s<16&&(n+="0"),n+=s.toString(16).toLowerCase()}return n}}function re(e){return e.__=void 0,delete e.__,e}e("decorate",f),e("metadata",m),e("defineMetadata",p),e("hasMetadata",b),e("hasOwnMetadata",_),e("getMetadata",v),e("getOwnMetadata",C),e("getMetadataKeys",T),e("getOwnMetadataKeys",w),e("deleteMetadata",y)}(n)}();const di=class{static register(e,t){let n=di.sMap.get(e);n?n.push(t):(n=new Array,n.push(t),di.sMap.set(e,n))}static getTable(e){var t;let n=new Array,r=e;for(;null!=r;){const e=null!=(t=di.sMap.get(r))?t:[];n=n.concat(e),r=Object.getPrototypeOf(r)}return n}};let gi=di;gi.sMap=new Map;class fi{constructor(e={}){this._config=e,this._value=e.value}getValue(){return this._value}setValue(e){this._value=e}}class mi{constructor(e={}){this._mappings=new Map,this._instance=new Map,this._configure=new Map,this._attribute=e instanceof fi?e:new fi(e),this._circulate=[]}static postDestroy(e){if(e){const t=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(t);for(const r of n){if(hi(Reflect.getMetadata("PreDestroy",t,r))){const n=t[r];ci(n)&&n.apply(e)}}}}static postConstruct(e,t){if(e){const n=Object.getPrototypeOf(e),r=Object.getOwnPropertyNames(n);for(const s of r){if(hi(Reflect.getMetadata("PostConstruct",n,s))){const r=n[s];ci(r)&&r.apply(e,t)}}}}inject(e){if(e){const t=[[e,[]]];this._inject(e,t),this._clearCirculate();for(const e of t.reverse())mi.postConstruct(e[0],e[1])}}getAttribute(){return this._attribute}getInstance(e,...t){const n=[],r=this._getInstance(e,n,pi.prototype,t);this._clearCirculate();for(const s of n.reverse())mi.postConstruct(s[0],s[1]);return r}getSingleton(e,...t){const n=[],r=this._getInstance(e,n,pi.singleton,t);this._clearCirculate();for(const s of n.reverse())mi.postConstruct(s[0],s[1]);return r}getBaseClassByInstance(e){if("object"==typeof e){const{constructor:t}=e,n=this._mappings.entries();for(const[e,r]of n)if(t===r)return e}}removeMapping(e){this._mappings.delete(e);const t=this._instance.get(e),n=e=>{const t=Object.keys(e);for(const r of t){const t=e[r];this.getBaseClassByInstance(t)&&(n(t),mi.postDestroy(e))}mi.postDestroy(e)};hi(t)&&n(t),this._instance.delete(e)}addMapping(e,t,n){this._mappings.set(e,t),hi(n)&&this._configure.set(e,n)}addSingletonMapping(e,t){return this.addMapping(e,t,{scope:pi.singleton})}addClass(e,t){this.addMapping(e.name,e,t)}removeClass(e){this.removeMapping(e.name)}addSingletonClass(e){this.addSingletonMapping(e.name,e)}_inject(e,t){const n=Object.getPrototypeOf(e),r=gi.getTable(n);for(const s of r){const r=Reflect.getMetadata("Container",n,s),o=Reflect.getMetadata("Inject",n,s),i=Reflect.getMetadata("Attribute",n,s),l=Reflect.getMetadata("AttributeValue",n,s);switch(typeof o){case"string":e[s]=this._getInstance(o,t,pi.nothing,[]);break;case"object":{const n=o,{mapping:r}=n,{scope:i}=n,{argument:l}=n;e[s]=this._getInstance(r,t,i,l)}}if(r){e[s]=this}if(i){e[s]=this._attribute}if(l){e[s]=this._attribute.getValue()}}}_getInstance(e,t,n,r){const s=this._mappings.get(e);if(s){if(n===pi.nothing){const t=this._configure.get(e);n=t?t.scope:pi.prototype}switch(n){case pi.singleton:{const o=this._instance.get(e);if(hi(o))return o;const i=hi(r)?new s(...r):new s;return this._instance.set(e,i),this._addCirculate(e,n),this._inject(i,t),this._popCirculate(),t.push([i,r]),i}case pi.prototype:{const o=hi(r)?new s(...r):new s;return this._addCirculate(e,n),this._inject(o,t),this._popCirculate(),t.push([o,r]),o}}}}_printCirculate(){let e="The dependencies of some of the instance in the application context form a cycle";return e+="\n",this._circulate.reverse().forEach((t=>{const{baseClass:n}=t,r=this._mappings.get(n),{name:s}=r;e+="\n",e+=`Class: ${s} Field: ${n}`})),e}_clearCirculate(){this._circulate=[]}_addCirculate(e,t){this._circulate.forEach((n=>{if(n.baseClass===e&&n.scope===t&&t===pi.prototype)throw this._circulate.push({baseClass:e,scope:t}),new Error(this._printCirculate())})),this._circulate.push({baseClass:e,scope:t})}_popCirculate(){this._circulate.pop()}}var pi,bi;function _i(){return(e,t,n)=>{gi.register(e,t),Reflect.defineMetadata("PostConstruct",n,e,t)}}function vi(){return(e,t)=>{gi.register(e,t),Reflect.defineMetadata("AttributeValue",{},e,t)}}(bi=pi||(pi={}))[bi.singleton=0]="singleton",bi[bi.prototype=1]="prototype",bi[bi.nothing=2]="nothing";const Ci="MessageQueue";class Ti{constructor(){this.load()}first(){return this._messages[0]}last(){return this._messages[this._messages.length-1]}size(){return this._messages.length}pop(){this._messages.shift(),this.save()}push(e){this._messages.push(e),this.save()}hasMessage(){return this._messages.length>0}isEmpty(){return!this.hasMessage()}save(){const e=JSON.stringify(this._messages);localStorage.setItem(Ci,e)}load(){const e=localStorage.getItem(Ci);e&&(this._messages=JSON.parse(e))}}var wi;(wi||(wi={})).MESSAGE_RESPONSE="message_response";class yi{static isMessageResponseReceive(e){return e.type===wi.MESSAGE_RESPONSE}packMessage(e){return{changed:e,version:C.generateRandomId(6)}}}var Si,Ei,Ri=Object.defineProperty,Ii=Object.getOwnPropertyDescriptor,Ai=(e,t,n,r)=>{for(var s,o=r>1?void 0:r?Ii(t,n):t,i=e.length-1;i>=0;i--)(s=e[i])&&(o=(r?s(t,n,o):s(o))||o);return r&&o&&Ri(t,n,o),o};(Ei=Si||(Si={})).WAIT="wait",Ei.WORK="work";const xi=class extends yi{initialize(){this.messageQueue=new Ti,this.status=Si.WAIT,this.globalSendResolve=()=>{},this.config.socketEnable&&(this.socket=new Jn({url:this.config.socketUrl}),this.socket.on(Qn.MESSAGE,(e=>{this.checkupReceiveMessage(e.data)})),this.socket.on(Qn.ERROR,(()=>{})),this.socket.on(Qn.OPEN,(()=>{})),this.socket.on(Qn.CLOSE,(()=>{})),this.socket.on(Qn.RETRY,(()=>{})),this.socket.on(Qn.DESTROY,(()=>{})),this.socket.link())}pushMessageQueue(e){this.config.socketEnable&&(this.messageQueue.push(this.packMessage(e)),this.sendMessageQueue())}getTopMessage(){return this.messageQueue.first()}popTopMessage(){this.messageQueue.pop()}serializeTopMessage(){var e;const t=this.getTopMessage();return null!=(e=JSON.stringify(t))?e:""}checkupReceiveMessage(e){xi.isMessageResponseReceive(e)&&this.getTopMessage().version===e.message.version&&(this.popTopMessage(),this.globalSendResolve())}async sendTopMessage(){const e=this.serializeTopMessage();return this.socket.send(e),new Promise((e=>this.globalSendResolve=e))}async sendMessageQueue(){const{messageQueue:e,status:t}=this;if(t===Si.WAIT){for(this.status=Si.WORK;e.hasMessage();)await this.sendTopMessage();this.status=Si.WAIT}return this.status}};let Oi=xi;Ai([vi()],Oi.prototype,"config",2),Ai([_i()],Oi.prototype,"initialize",1);var Mi=Object.freeze(Object.defineProperty({__proto__:null,get ActionOperationType(){return t},ActionBase:r,get ActionType(){return Dr},ActionObservers:Br,CommandInjectorObservers:Hr,CommandObservers:Fr,CommandManager:zr,SheetActionBase:Ur,CommandUnit:class{},Command:Wr,UndoManager:Vr,ActionExtensionManager:jr,BaseActionExtension:Yr,BaseActionExtensionFactory:Gr,REGISTRY_ACTION_FACTORY:$r,ActionExtensionRegister:Qr,ActionOperation:Kr,ContextBase:Wo,Context:Vo,DocContext:$o,Environment:Uo,Registry:Qo,RegistryAsMap:Ko,SheetContext:qo,SlideContext:ei,UniverDoc:ri,UniverSheet:si,UniverSlide:oi,Univer:ii,VersionEnv:ti,VersionCode:ni,WorkBookObserverImpl:Zo,get ACTION_NAMES(){return be},DEFAULT_RANGE_ARRAY:xt,DEFAULT_RANGE:Ot,DEFAULT_SELECTION:Mt,DEFAULT_CELL:Nt,DEFAULT_WORKBOOK:kt,DEFAULT_WORKSHEET:Lt,DEFAULT_STYLES:Dt,DEFAULT_DOC:Pt,DEFAULT_SLIDE:Bt,get EXTENSION_NAMES(){return Ht},KEYBOARD_KEYS:zt,get PLUGIN_NAMES(){return Ut},THEME_COLORS:Vt,AddMergeAction:Us,AddNamedRangeAction:js,ClearRangeAction:Qs,DeleteNamedRangeAction:Ws,DeleteRangeAction:Zs,InsertColumnAction:qs,InsertColumnDataAction:Js,InsertRangeAction:Ks,InsertRowAction:eo,InsertRowDataAction:to,InsertSheetAction:no,RemoveColumnAction:ro,RemoveColumnDataAction:so,RemoveMergeAction:oo,RemoveRowAction:io,RemoveRowDataAction:lo,RemoveSheetAction:ao,SetBorderAction:co,SetColumnHideAction:ho,SetColumnShowAction:uo,SetColumnWidthAction:go,SetHiddenGridlinesAction:fo,SetNamedRangeAction:po,SetRangeDataAction:$s,SetRangeNoteAction:_o,SetRangeStyleAction:Co,SetRangeFormattedValueAction:To,SetRightToLeftAction:wo,SetRowHeightAction:yo,SetRowHideAction:So,SetRowShowAction:Eo,SetSelectionActivateAction:Io,SetSheetOrderAction:Ao,SetTabColorAction:Oo,SetWorkSheetActivateAction:No,SetWorkSheetHideAction:Lo,SetWorkSheetNameAction:Po,SetWorkSheetStatusAction:Bo,SetZoomRatioAction:Ho,Color:qt,HLSColor:Jt,RgbColor:tn,ThemeColor:rn,ColorBuilder:Zt,ColumnManager:sn,Merges:on,Range:Rn,RangeList:yn,RowManager:Sn,Selection:On,Styles:In,Workbook:xn,Worksheet:En,addMerge:function(e,t){for(let n=0;n<t.length;n++)e.add(t[n]);return[]},addMergeApply:Zr,AddNamedRange:function(e,t){e.push(t)},AddNamedRangeApply:qr,ClearRangeApply:Jr,DeleteNamedRange:function(e,t){return e.find(((n,r)=>n.namedRangeId===t?(e.splice(r,1),n):null))},DeleteNamedRangeApply:es,DeleteRange:function(e,t,n,r){const{startRow:s,endRow:o,startColumn:i,endColumn:l}=r,a=o-s+1,c=l-i+1,h=e.rowCount,u=e.columnCount,d=new p;if(n===Be.ROWS)for(let g=s;g<=h;g++)for(let e=i;e<=l;e++){if(g<=o){const n=t.getValue(g,e);d.setValue(g,e,n)}const n=t.getValue(g+a,e);if(n)t.setValue(g,e,C.deepClone(n));else{t.getValue(g,e)&&(t.deleteValue(g,e),e--)}}else if(n===Be.COLUMNS)for(let g=s;g<=o;g++)for(let e=i;e<=u;e++){if(e<=l){const n=t.getValue(g,e);d.setValue(g,e,n)}else for(let r=0;r<=l;r++){const n=t.getValue(g,e);d.setValue(g,e+r,n)}const n=t.getValue(g,e+c);if(n)t.setValue(g,e,C.deepClone(n));else{if(t.getValue(g,e)){for(let n=0;n<=l;n++)t.deleteValue(g,e);break}}}return d.getData()},DeleteRangeApply:ts,SetWorkSheetHideService:ns,SetWorkSheetHideServiceApply:function(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId).getConfig(),r=n.hidden;return n.hidden=t.hidden,r},InsertColumn:function(e=0,t=1,n){new f(n).inserts(e,new f(t))},InsertColumnApply:rs,InsertDataColumn:function(e,t,n){new p(n).insertColumns(e,new p(t))},InsertDataColumnApply:ss,InsertDataRow:function(e,t,n){new p(n).insertRows(e,new p(t))},InsertDataRowApply:os,InsertRange:function(e,t,n,r,s){const{startRow:o,endRow:i,startColumn:l,endColumn:a}=r,c=i-o+1,h=a-l+1,u=e.rowCount,d=e.columnCount;if(n===Be.ROWS){for(let e=u;e>=o;e--)for(let n=l;n<=a;n++){const r=t.getValue(e,n);t.setValue(e+c,n,r)}for(let e=i;e>=o;e--)for(let n=l;n<=a;n++)t.setValue(e,n,s[e-o][n-l])}else if(n===Be.COLUMNS){for(let e=o;e<=i;e++)for(let n=d;n>=l;n--){const r=t.getValue(e,n);t.setValue(e,n+h,r)}for(let e=o;e<=i;e++)for(let n=a;n>=l;n--)t.setValue(e,n,s[e-o][n-l])}},InsertRangeApply:is,InsertRow:function(e=0,t=1,n){new f(n).inserts(e,new f(t))},InsertRowApply:ls,InsertSheet:function(e,t,n){const r=e.getWorksheets(),s=e.getConfig(),{sheets:o,sheetOrder:i}=s;if(o[n.id])throw new Error(`Insert Sheet fail ${n.id} is already exist`);return o[n.id]=n,i.splice(t,0,n.id),r.set(n.id,new En(e.getContext(),n)),n.id},InsertSheetApply:as,RemoveColumn:function(e,t,n){const r=new f(n),s=new f,o=e+t;for(let i=e;i<o;i++){const t=r.splice(e,1);t.getLength()&&s.set(i,t.first())}return s.getLength()},RemoveColumnApply:cs,RemoveColumnData:function(e,t,n){return new p(n).spliceColumns(e,t).toJSON()},RemoveColumnDataApply:hs,RemoveMergeApply:us,RemoveRow:function(e,t,n){const r=new f(n),s=new f,o=e+t;for(let i=e;i<o;i++){const t=r.splice(e,1);t.getLength()&&s.set(i,t.first())}return s.getLength()},RemoveRowApply:ds,RemoveRowData:function(e,t,n){return new p(n).spliceRows(e,t).toJSON()},RemoveRowDataApply:gs,RemoveSheet:function(e,t){const n=e.getWorksheets(),r=e.getConfig(),{sheets:s}=r;if(null==s[t])throw new Error(`Remove Sheet fail ${t} is not exist`);const o=s[t],i=r.sheetOrder.findIndex((e=>e===t));return delete s[t],r.sheetOrder.splice(i,1),n.delete(t),{index:i,sheet:o}},RemoveSheetApply:fs,SetBorder:function(e,t,n){const r=new p(n),s=new p;return r.forValue(((n,r,o)=>{const i=e.getValue(n,r);if(i){const e=t.get(i.s);e&&s.setValue(n,r,e),i.s=t.setValue(o)}})),s.toJSON()},SetBorderApply:ms,SetColumnHide:function(e=0,t,n){for(let r=e;r<e+t;r++){n.getColumnOrCreate(r).hd=1}},SetColumnHideApply:ps,SetColumnShow:function(e=0,t,n){for(let r=e;r<e+t;r++){const e=n.getColumn(r);e&&(e.hd=0)}},SetColumnShowApply:bs,SetColumnWidth:function(e=0,t,n){const r=[];for(let s=e;s<e+t.length;s++){const o=n.getColumnOrCreate(s);r[s-e]=o.w,o.w=t[s-e]}return r},SetColumnWidthApply:_s,SetHiddenGridlines:function(e,t){const n=e.getConfig(),r=0===n.showGridlines;return n.showGridlines=t?0:1,r},SetHiddenGridlinesApply:vs,SetHideRow:Cs,SetHideRowApply:function(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId),r=t.rowIndex,s=t.rowCount,o=n.getRowManager();for(let i=r;i<r+s;i++){const e=o.getRowOrCreate(i);e&&(e.hd=1)}},SetNamedRange:function(e,t){return e.find(((n,r)=>n.namedRangeId===t.namedRangeId?(e[r]=t,n):null))},SetNamedRangeApply:Ts,SetRangeDataApply:As,SetRangeNote:xs,SetRangeNoteApply:function(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId).getCellMatrix(),r=t.cellNote,s=t.rangeData,o=new p(r),i=new p;for(let l=s.startRow;l<=s.endRow;l++)for(let e=s.startColumn;e<=s.endColumn;e++){const t=o.getValue(l,e),r=n.getValue(l,e),s=C.deepClone(r||{});s.n=t,n.setValue(l,e,s||{})}return i.getData()},SetRangeStyle:ws,transformStyle:ys,transformNormalKey:Ss,transformBorders:Es,mergeStyle:Rs,mergeRichTextStyle:Is,SetRangeFormattedValue:Os,SetRangeFormattedValueApply:function(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId).getCellMatrix(),r=t.cellValue,s=t.rangeData,o=new p(r),i=new p;for(let l=s.startRow;l<=s.endRow;l++)for(let e=s.startColumn;e<=s.endColumn;e++){const t=o.getValue(l,e),r=n.getValue(l,e);i.setValue(l,e,r&&r.v||"");const s=C.deepClone(r||{});s.v=t,s.m=`${t}`,n.setValue(l,e,s||{})}return i.getData()},SetRightToLeft:Ms,SetRightToLeftApply:function(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId),r=t.rightToLeft,s=n.getConfig(),o=s.rightToLeft;return s.rightToLeft=r,o},SetRowHeight:Ns,SetRowHeightApply:function(e,t){const n=e.WorkBookUnit.getSheetBySheetId(t.sheetId),r=t.rowIndex,s=t.rowHeight,o=n.getRowManager(),i=[];for(let l=r;l<r+s.length;l++){const e=o.getRowOrCreate(l);i[l-r]=e.h,e.h=s[l-r]}return i},SetSelectionActivate:ks,SetSheetOrder:Ls,SetShowRow:Ds,SetTabColor:Ps,SetWorkSheetActivate:Bs,SetWorkSheetName:Hs,SetWorkSheetNameApply:function(){},SetWorkSheetStatus:Fs,SetZoomRatio:zs,DocumentModel:Xo,SlideModel:Jo,get AutoFillSeries(){return ve},get BooleanCriteria(){return Te},get BorderStyleTypes(){return ye},get BorderType(){return Ee},get ColorType(){return Ie},get CommonHideTypes(){return xe},get ConditionType(){return Me},get CopyPasteType(){return ke},get DeveloperMetadataVisibility(){return De},get Dimension(){return Be},get Direction(){return Fe},get FormatType(){return Ue},get InterpolationPointType(){return Ve},get KeyCode(){return Ye},get KeyboardKeyType(){return Xe},get LocaleType(){return Qe},get ProtectionType(){return Ze},get RelativeDate(){return Je},get SheetTypes(){return tt},get TextDirection(){return rt},get TextDecoration(){return ot},get HorizontalAlign(){return lt},get VerticalAlign(){return ct},get WrapStrategy(){return ut},get FontItalic(){return gt},get FontWeight(){return mt},get BaselineOffset(){return bt},get BooleanNumber(){return vt},get CellValueType(){return Tt},get ThemeColorType(){return yt},get ThemeColors(){return Et},get ShapeType(){return It},get FollowNumberWithType(){return T},get GlyphType(){return y},get BulletAlignment(){return E},get BlockType(){return I},get GridType(){return x},get SectionType(){return M},get ColumnSeparatorType(){return k},get TextDirectionType(){return D},get ParagraphElementType(){return B},get WrapTextType(){return F},get PositionedObjectLayoutType(){return U},get NamedStyleType(){return V},get SpacingRule(){return Y},get DashStyleType(){return X},get TabStopAlignment(){return Q},get WidthType(){return Z},get ContentAlignment(){return J},get FontStyleType(){return te},get ObjectRelativeFromH(){return re},get ObjectRelativeFromV(){return oe},get NumberUnitType(){return le},get AlignTypeH(){return ce},get AlignTypeV(){return ue},get characterSpacingControlType(){return ge},get PageOrientType(){return me},DEFAULT_NAMED_RANGE:jt,get PageType(){return Yt},get PageElementType(){return Xt},get RelativeSlideLink(){return Qt},AttributeMap:gi,IOCAttribute:fi,IOCContainer:mi,get IOCScope(){return pi},PostConstruct:_i,PreDestroy:function(){return(e,t,n)=>{gi.register(e,t),Reflect.defineMetadata("PreDestroy",n,e,t)}},Inject:function(e){return(t,n)=>{(gi.register(t,n),"string"!=typeof e)?hi(e)&&(ui(e.argument)&&(e.argument=[]),ui(e.scope)&&(e.scope=1),Reflect.defineMetadata("Inject",e,t,n)):Reflect.defineMetadata("Inject",e,t,n)}},Attribute:function(){return(e,t)=>{gi.register(e,t),Reflect.defineMetadata("Attribute",{},e,t)}},Container:function(){return(e,t)=>{gi.register(e,t),Reflect.defineMetadata("Container",{},e,t)}},AttributeValue:vi,EventState:s,Observer:o,Observable:i,ObservableHooks:class extends i{add(e){if(!e)return null;const t=new o(e);return this._observers=[t],this._onObserverAdded&&this._onObserverAdded(t),t}makeObserverTopPriority(){}makeObserverBottomPriority(){}},PathObservableHooks:l,HooksManager:a,PathObservable:kr,ObserverManager:Lr,Plugin:Fo,PluginManager:zo,MessageQueue:Ti,get ServerReceiveType(){return wi},ServerBase:yi,ServerHttp:class extends yi{pushMessageQueue(e){throw new Error("Method not implemented.")}},get MessageQueueStatus(){return Si},ServerSocket:Oi,binarySearchArray:c,orderSearchArray:h,searchArray:u,makeCellToSelection:Mn,isEmptyCell:Nn,getColorStyle:kn,isFormulaString:function(e){return C.isString(e)&&0===e.indexOf("=")&&e.length>1},handleJsonToDom:Ln,handleStyleToString:Dn,getBorderStyleType:Bn,DateTime:class{},DropCell:wn,ExcelDateTime:class{},error:gn,datenum_local:_n,generate:vn,update:Tn,get IOHttpRequestType(){return Un},get IOHttpReadyState(){return Vn},get IOHttpResponseType(){return Yn},IOHttp:$n,Post:function(e,t={},n=Fn){return $n({url:e,type:Un.POST,data:t,success:n})},Get:function(e,t={},n=Fn){return $n({url:e+=function(e){if(null==e)return"";let t="";for(const n in e)e.hasOwnProperty(n)&&void 0!==e[n]&&null!==e[n]&&(t+=`${n}=${e[n]}&`);return t=t.substring(0,t.length-1),t?`?${encodeURI(t)}`:""}(t),type:Un.GET,success:n})},get IOSocketListenType(){return Qn},HEART_BEAT_MESSAGE:qn,IOSocket:Jn,isKeyPrintable:tr,Locale:sr,Logger:or,GenName:ir,LRUHelper:lr,KeyIterator:hr,ValueIterator:ur,EntryIterator:dr,Entry:gr,LRUMap:fr,migrate:pr,ObjectArray:f,ObjectArrayIterableIterator:m,ObjectMatrix:p,Rectangle:br,referenceToGrid:function(e){const t=e.indexOf("!");let n="",r="";t>-1?(n=e.substring(0,t),r=e.substring(t)):r=e;let s=r.indexOf(":");if(-1===s){const e=Cr(r),t=e.row,s=e.column;return{sheetName:n,rangeData:{startRow:t,startColumn:s,endRow:t,endColumn:s}}}const o=r.substring(0,s),i=r.substring(s+1),l=Cr(o),a=Cr(i);return{sheetName:n,rangeData:{startRow:l.row,startColumn:l.column,endRow:a.row,endColumn:a.column}}},ABCToNumber:function(e){if(null==e||0===e.length)return NaN;let t=e.toLowerCase().split(""),n=t.length,r=0,s=0;for(let o=0;o<n;o++)s=t[o].charCodeAt(0)-96,r+=s*26**(n-o-1);return 0===r?NaN:r-1},numberToABC:Sr,repeatStringNumTimes:Er,numberToListABC:Rr,SerializeManager:class{constructor(){this._storage=new Map}addSerializer(...e){if(C.hasLength(e,1)){const t=e[0];this._storage.set(t.name,t)}else if(C.hasLength(e,2)){const t=e[0],n=e[1];this._storage.set(n,t)}}fromSequence(e){if(C.isObject(e)){return this._storage.get(e.className).fromSequence(e)}if(C.isArray(e)){let t=new Array;for(let n of e)t.push(this.fromSequence(n));return t}return[]}toSequence(e){if(C.isObject(e))return e.toSequence();if(C.isArray(e)){let t=new Array;for(let n of e)t.push(this.toSequence(n));return t}return[]}fromStringifyParse(e){return this.fromSequence(JSON.parse(e))}},get Serializer(){return Ir},sortRules:Ar,sortRulesByDesc:xr,Tools:C,Tuples:Mr,TypeStoreBase:Nr,hashAlgorithm:function(e){let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+(t<<6)+(t<<16)-t;return t>>>0}},Symbol.toStringTag,{value:"Module"})),Ni={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana","","","","","","","","",""],defaultFontSize:14,unit:"pt"}},ki={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana"],defaultFontSize:9,unit:"pt"}};const Li={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]};var Di,Pi,Bi,Hi,Fi;(Di||(Di={})).rect="rect",(Bi=Pi||(Pi={})).PointerMove="PointerMove",Bi.PointerDown="PointerDown",Bi.PointerUp="PointerUp",Bi.PointerOut="PointerOut",Bi.PointerLeave="PointerLeave",Bi.PointerOver="PointerOver",Bi.PointerEnter="PointerEnter",Bi.wheel="MouseWheel",Bi.KeyDown="KeyDown",Bi.KeyUp="KeyUp",(Fi=Hi||(Hi={}))[Fi.XY=0]="XY",Fi[Fi.X=1]="X",Fi[Fi.Y=2]="Y";const zi='"Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',Ui={lines:[],drawings:new Map,height:0,st:0,ed:0,marginLeft:0},Wi=__spreadProps(__spreadValues({},Ui),{marginTop:20}),Vi=__spreadProps(__spreadValues({},Ui),{marginBottom:20}),ji=14;var Yi,Gi,Xi,$i;(Gi=Yi||(Yi={})).DEFAULT="default",Gi.AUTO="auto",Gi.CROSSHAIR="crosshair",Gi.POINTER="pointer",Gi.MOVE="move",Gi.EAST_RESIZE="e-resize",Gi.NORTH_EAST_RESIZE="ne-resize",Gi.NORTH_WEST_RESIZE="nw-resize",Gi.NORTH_RESIZE="n-resize",Gi.SOUTH_EAST_RESIZE="se-resize",Gi.SOUTH_WEST_RESIZE="sw-resize",Gi.SOUTH_RESIZE="s-resize",Gi.WEST_RESIZE="w-resize",Gi.TEXT="text",Gi.WAIT="wait",Gi.HELP="help",Gi.CELL="cell",Gi.NONE="none",Gi.VERTICAL_TEXT="vertical-text",Gi.NO_DROP="no-drop",Gi.GRAB="grab",Gi.GRABBING="grabbing",Gi.ALL_SCROLL="all-scroll",Gi.COLUMN_RESIZE="col-resize",Gi.ROW_RESIZE="row-resize",Gi.PROGRESS="progress",Gi.NOT_ALLOWED="not-allowed",Gi.ZOOM_IN="zoom-in",Gi.ZOOM_OUT="zoom-out",($i=Xi||(Xi={}))[$i.noClip=0]="noClip",$i[$i.DOC_SIZE=1]="DOC_SIZE",$i[$i.CONTENT_SIZE_LEFT=2]="CONTENT_SIZE_LEFT",$i[$i.CONTENT_SIZE_CENTER=3]="CONTENT_SIZE_CENTER",$i[$i.CONTENT_SIZE_Right=4]="CONTENT_SIZE_Right";const Qi="rgb(0,0,0)";var Ki,Zi,qi,Ji,el,tl;(Zi=Ki||(Ki={})).TOP="t",Zi.BOTTOM="b",Zi.LEFT="l",Zi.RIGHT="r",(Ji=qi||(qi={}))[Ji.UP=0]="UP",Ji[Ji.DOWN=1]="DOWN",(tl=el||(el={})).ENGINE="Engine",tl.SCENE="Scene",tl.BASE_OBJECT="BaseObject",tl.SCENE_VIEWER="SceneViewer",tl.CANVAS="Canvas",tl.VIEWPORT="Viewport",tl.LAYER="Layer",tl.GROUP="Group";const nl=e=>({sbr:.5,sbo:e,spr:.5,spo:e});class rl{static get globalFontMeasureCache(){return this._globalFontMeasureCache}static setFontMeasureCache(e,t,n){this._globalFontMeasureCache.has(e)||(this._globalFontMeasureCache[e]=new Map),this._globalFontMeasureCache[e][t]=n}static clearFontMeasureCache(e){var t;const n=e.split("/");if(1===n.length){const e=n[0];this._globalFontMeasureCache.delete(e)}else{if(2!==n.length)return!1;{const e=n[0],r=n[1];null==(t=this._globalFontMeasureCache.get(e))||t.delete(r)}}return!0}static getFontMeasureCache(e,t){var n;return null==(n=this._globalFontMeasureCache[e])?void 0:n[t]}static autoCleanFontMeasureCache(e=1e6){let t=0,n=!1;for(let r of this._globalFontMeasureCache){const[,s]=r;if(t+=s.size,t>e){n=!0;break}}if(n){let t=0;for(let n of this._globalFontMeasureCache){const[r,s]=n;if(t+=s.size,t>e/2){const n=t-e/2;this._clearMeasureCache(n,s);break}this._globalFontMeasureCache.delete(r)}return!0}return!1}static getBaselineOffsetInfo(e,t){if(0===this._fontDataMap.size)return nl(t);const n=e.split(",");for(let r of n){r=r.replace(/'/g,"");const e=this._fontDataMap.get(r);if(!e)continue;const{subscriptSizeRatio:n,subscriptOffset:s,superscriptSizeRatio:o,superscriptOffset:i}=e;return{sbr:n,sbo:s*t,spr:o,spo:i*t}}return nl(t)}static getTextSizeByDom(e,t){if(t in this._getTextHeightCache)return this._getTextHeightCache[t];let n=document.getElementById("universheetTextSizeTest");n||(n=document.createElement("span"),n.id="universheetTextSizeTest",document.getElementsByTagName("body")[0].appendChild(n)),n.style.cssText+=`float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;;${t}`,n.innerText=e;const r=n.getBoundingClientRect(),s={width:r.width,height:r.height};return this._getTextHeightCache[t]=s,s}static getTextSize(e,t){const{fontString:n,fontSize:r,fontFamily:s}=t;let o=this._getBoundingBoxByFont(s,r);if(!o){const t=this.getMeasureText(e,n);o=this._calculateBoundingBoxByMeasureText(t,r)}return o}static getMeasureText(e,t){if(!this._context){const e=document.createElement("canvas");this._context=e.getContext("2d")}const n=this._context,r=this.getFontMeasureCache(t,e);if(null!=r)return r;n.font=t;const s=n.measureText(e),{width:o,fontBoundingBoxAscent:i,fontBoundingBoxDescent:l,actualBoundingBoxAscent:a,actualBoundingBoxDescent:c}=s,h={width:o,fontBoundingBoxAscent:i,fontBoundingBoxDescent:l,actualBoundingBoxAscent:a,actualBoundingBoxDescent:c};if(null==i||null==l||Number.isNaN(i)||Number.isNaN(l)){let e=this.getTextSizeByDom("0",t)[1];"top"===n.textBaseline?(h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=e,h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=0):"middle"===n.textBaseline?(h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=e/2,h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=e/2):(h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=0,h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=e)}return this.setFontMeasureCache(t,e,h),h}static _clearMeasureCache(e,t){let n=0;for(let r of t){const[s]=r;if(n>e)break;t.delete(s),n++}return!0}static _getBoundingBoxByFont(e,t=28,n=""){const r=this._fontDataMap.get(e);if(!r)return;const{notDefWidth:s,ascender:o,descender:i,typoAscender:l,typoDescender:a,strikeoutPosition:c,subscriptSizeRatio:h,subscriptOffset:u,superscriptSizeRatio:d,superscriptOffset:g,hdmxData:f,glyphHorizonMap:m}=r,p=null==f?void 0:f.indexOf(Math.floor(t)),b=m.get(n.charCodeAt(0));let _=s;if(b){const{width:e,pixelsPerEm:t=[]}=b;_=p?t[p]:e}return{width:_*t,ba:o*t,bd:i*t,aba:l*t,abd:a*t,sp:c*t,sbr:h,sbo:u*t,spr:d,spo:g*t}}static _calculateBoundingBoxByMeasureText(e,t){const{width:n,fontBoundingBoxAscent:r,fontBoundingBoxDescent:s,actualBoundingBoxAscent:o,actualBoundingBoxDescent:i}=e;return{width:n,ba:r,bd:s,aba:o,abd:i,sp:(r+s)/2,sbr:.5,sbo:t,spr:.5,spo:t}}}var sl,ol,il,ll,al,cl,hl,ul,dl,gl,fl,ml,pl,bl,_l,vl,Cl,Tl;rl._getTextHeightCache={},rl._fontDataMap=new Map,rl._globalFontMeasureCache=new Map,(ol=sl||(sl={}))[ol.SPAN=0]="SPAN",ol[ol.DIVIDE=1]="DIVIDE",ol[ol.LINE=2]="LINE",ol[ol.COLUMN=3]="COLUMN",ol[ol.SECTION=4]="SECTION",ol[ol.PAGE=5]="PAGE",ol[ol.DRAWING=6]="DRAWING",ol[ol.BULLET=7]="BULLET",ol[ol.HEADER=8]="HEADER",ol[ol.FOOTER=9]="FOOTER",ol[ol.ALL=10]="ALL",(ll=il||(il={}))[ll.SECTION=0]="SECTION",ll[ll.PAGE=1]="PAGE",ll[ll.COLUMN=2]="COLUMN",(cl=al||(al={}))[cl.PARAGRAPH=0]="PARAGRAPH",cl[cl.BLOCK=1]="BLOCK",(ul=hl||(hl={}))[ul.LETTER=0]="LETTER",ul[ul.WORD=1]="WORD",ul[ul.LIST=2]="LIST",ul[ul.TAB=3]="TAB",ul[ul.IMAGE=4]="IMAGE",ul[ul.AT=5]="AT",ul[ul.MATH=6]="MATH",ul[ul.MULTI_LINE=7]="MULTI_LINE",ul[ul.CUSTOM=8]="CUSTOM",(gl=dl||(dl={}))[gl.VERTICAL=0]="VERTICAL",gl[gl.HORIZONTAL=1]="HORIZONTAL",gl[gl.AUTO=2]="AUTO",(ml=fl||(fl={}))[ml.PointerMove=0]="PointerMove",ml[ml.PointerDown=1]="PointerDown",ml[ml.PointerUp=2]="PointerUp";class wl{}wl.DOM_DELTA_PIXEL=0,wl.DOM_DELTA_LINE=1,wl.DOM_DELTA_PAGE=2,(bl=pl||(pl={}))[bl.Generic=0]="Generic",bl[bl.Keyboard=1]="Keyboard",bl[bl.Mouse=2]="Mouse",bl[bl.Touch=3]="Touch",(vl=_l||(_l={}))[vl.Horizontal=0]="Horizontal",vl[vl.Vertical=1]="Vertical",vl[vl.LeftClick=2]="LeftClick",vl[vl.MiddleClick=3]="MiddleClick",vl[vl.RightClick=4]="RightClick",vl[vl.BrowserBack=5]="BrowserBack",vl[vl.BrowserForward=6]="BrowserForward",vl[vl.MouseWheelX=7]="MouseWheelX",vl[vl.MouseWheelY=8]="MouseWheelY",vl[vl.MouseWheelZ=9]="MouseWheelZ",vl[vl.DeltaHorizontal=10]="DeltaHorizontal",vl[vl.DeltaVertical=11]="DeltaVertical",vl[vl.FakeMove=12]="FakeMove",(Tl=Cl||(Cl={}))[Tl.translate=0]="translate",Tl[Tl.resize=1]="resize",Tl[Tl.scale=2]="scale",Tl[Tl.skew=3]="skew",Tl[Tl.flip=4]="flip",Tl[Tl.all=5]="all";class yl{constructor(e=30){this._enabled=!0,this._rollingFrameTime=new Sl(e)}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){let e=this._rollingFrameTime.history(0);return 0===e?0:1e3/e}get isSaturated(){return this._rollingFrameTime.isSaturated()}get isEnabled(){return this._enabled}sampleFrame(e=this.Now()){if(this._enabled){if(null!=this._lastFrameTimeMs){let t=e-this._lastFrameTimeMs;this._rollingFrameTime.add(t)}this._lastFrameTimeMs=e}}Now(){return window.performance&&window.performance.now?window.performance.now():Date.now()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class Sl{constructor(e){this._samples=new Array(e),this.reset()}add(e){let t;if(this.isSaturated()){let e=this._samples[this._pos];t=e-this.average,this.average-=t/(this._sampleCount-1),this._m2-=t*(e-this.average)}else this._sampleCount++;t=e-this.average,this.average+=t/this._sampleCount,this._m2+=t*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length}history(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;let t=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(t-e)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(e){let t=this._samples.length;return(e%t+t)%t}}const El=Math.PI/180,Rl=180/Math.PI,Il="rgb(",Al=(e,t)=>e?null!=t?`${"rgba("+e.join(",")},${t})`:`${Il+e.join(",")})`:"rgb(0,0,0)",xl=(e,t)=>{if(C.isNumber(e))return e;if(t&&e&&C.isString(e)&&"%"===e.substr(e.length-1,1)){return t*(parseFloat(e)/100)}return 0},Ol=(e,t)=>(t||(t=window),t.requestPostAnimationFrame?t.requestPostAnimationFrame(e):t.requestAnimationFrame?t.requestAnimationFrame(e):t.msRequestAnimationFrame?t.msRequestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.mozRequestAnimationFrame?t.mozRequestAnimationFrame(e):t.oRequestAnimationFrame?t.oRequestAnimationFrame(e):window.setTimeout(e,16)),Ml=(e,t)=>(t||(t=window),t.requestPostAnimationFrame?t.cancelPostAnimationFrame(e):t.requestAnimationFrame?t.cancelAnimationFrame(e):t.msRequestAnimationFrame?t.msCancelAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitCancelAnimationFrame(e):t.mozRequestAnimationFrame?t.mozCancelAnimationFrame(e):t.oRequestAnimationFrame?t.oCancelAnimationFrame(e):window.clearTimeout(e)),Nl=()=>{let e=document.createElement("canvas");try{e.style=e.style||{}}catch(t){console.error(t)}return e},kl=e=>e*Rl,Ll=e=>e*El,Dl=()=>{let e="pointer";return"undefined"==typeof window||window.PointerEvent||"undefined"==typeof navigator||navigator.pointerEnabled||(e="mouse"),!C.isTablet()||C.isIPhone()||document&&"ontouchend"in document||(e="mouse"),e},Pl=()=>"safari"===C.getBrowserType(),Bl=(e="obj",t=4)=>{let n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),r="";for(let s=0;s<t;s++)r+=n[Math.round(Math.random()*(n.length-1))];return`${e}_${r}_${(new Date).getTime()}`};function Hl(e){return Object.prototype.toString.apply(e)}function Fl(e){return"[object Function]"===Hl(e)}function zl(e){return"[object String]"===Hl(e)}function Ul(e,t){return t=10**t,Math.round(e*t)/t}function Wl(e,t){return Math.round(e*t)/t}function Vl(e,t){t||(t={fontList:["Arial"],defaultFontSize:14});const{fontList:n,defaultFontSize:r}=t;if(!e)return{fontString:`${r}px  ${n[0]}`,fontSize:r,fontFamily:n[0]};let s=te.ITALIC;0!==e.it&&void 0!==e.it||(s=te.NORMAL);let o=te.BOLD;0!==e.bl&&void 0!==e.bl||(o=te.NORMAL);let i=r;e.fs&&(i=Math.ceil(e.fs));let l=n[0];if(e.ff){let t=e.ff;t=t.replace(/"/g,"").replace(/'/g,""),t.indexOf(" ")>-1&&(t=`"${t}"`),null==t&&(t=n[0]),l=t}const{va:a}=e;if(a===bt.SUBSCRIPT||a===bt.SUPERSCRIPT){const e=rl.getBaselineOffsetInfo(l,i),{sbr:t,spr:n}=e;i*=a===bt.SUBSCRIPT?t:n}return{fontString:`${s} ${o} ${i}px ${l}, ${zi} `,fontSize:i,fontFamily:l}}function jl(e){return!!/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/gi.exec(e)}function Yl(e){return!!/[-]+|[-]+|[-]+|[a-zA-Z0-9]+|[---]+|[]+/giu.exec(e)}function Gl(e){return!!/[\u2E80-\uA4CF]|[\uF900-\uFAFF]|[\uFE30-\uFE4F]|[\uFF00-\uFFEF]/gi.exec(e)}function Xl(e){return!!/[\u0600-\u06FF]|[\u0750-\u0750]|[\u0870-\u08FF]|[\uFB50-\uFDFF]|[\uFE70-\uFEFF]/gi.exec(e)}function $l(e){return!!/[\u0180-\u024F]/gi.exec(e)}function Ql(e){return!!/\s+|\t+/g.exec(e)}let Kl;function Zl(){if(Kl)return Kl;let e=56;for(;e<2e3;e++)if(!0===matchMedia(`(max-resolution: ${e}dpi)`).matches)return e;return Kl=e,setTimeout((()=>{Kl=null}),1e3),e}function ql(e){return e/(72/Zl())}function Jl(e){return e*(72/Zl())}function ea(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}function ta(e,t,n,r){const s=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[s]||0,endX:r[t]}}function na(e,t,n,r,s){let{startY:o,endY:i,startX:l,endX:a}=ta(e,t,n,r);const{isMerged:c,isMergedMainCell:h,newEndRow:u,newEndColumn:d,mergeRow:g,mergeColumn:f}=ra(e,t,s);let m={startRow:g,startColumn:f,endRow:u,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==g&&-1!==f){let e=n[g-1]||0,t=n[u],s=r[f-1]||0,o=r[d];m=__spreadProps(__spreadValues({},m),{startY:e,endY:t,startX:s,endX:o})}else c||-1===u||-1===d||(i=n[u]||0,a=r[d]||0);return{isMerged:c,isMergedMainCell:h,row:e,column:t,startY:o,endY:i,startX:l,endX:a,mergeInfo:m}}function ra(e,t,n){let r=!1,s=!1,o=-1,i=-1,l=-1,a=-1;return null==n||n.forEach(((n,c)=>{let h=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:u,endRow:d,startColumn:g,endColumn:f}=c;return e===u&&t===g?(o=d,i=f,l=u,a=g,h=!0,s=!0,!1):e>=u&&e<=d&&t>=g&&t<=f?(o=d,i=f,l=u,a=g,h=!0,r=!0,!1):void 0})),h)return!1})),{isMergedMainCell:s,isMerged:r,newEndRow:o,newEndColumn:i,mergeRow:l,mergeColumn:a}}function sa(e,t,n,r,s){const{startY:o,endY:i,startX:l,endX:a}=e;return e.startY=Wl(o+n,s),e.endY=Wl(i+n,s),e.startX=Wl(l+t,r),e.endX=Wl(a+t,r),__spreadValues({},e)}function oa(e,t){return!(e.left>t.right||e.top>t.bottom||t.left>e.right||t.top>e.bottom)}function ia(e){const t=document.createElement("style");document.head.appendChild(t);const n=t.sheet;for(let r of e)null==n||n.insertRule(r,n.cssRules.length)}function la(e){for(let t=0,n=document.head.childNodes.length;t<n;t++){const n=document.head.childNodes[t];if("STYLE"===n.nodeName&&n.textContent&&n.textContent.indexOf(e)>-1)return!0}return!1}function aa(e){return Number(e.replace(/px/gi,""))}function ca(e){const t=getComputedStyle(e),{borderTopWidth:n,borderLeftWidth:r,borderRightWidth:s,borderBottomWidth:o,width:i,height:l}=t;return{top:aa(n),left:aa(r),right:aa(s),bottom:aa(o),width:aa(i),height:aa(l)}}class ha{constructor(e=0,t=0){this.x=e,this.y=t}static Zero(){return new ha(0,0)}static One(){return new ha(1,1)}static FromArray(e,t=0){return new ha(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,s){let o=s*s,i=s*o,l=.5*(2*t.x+(-e.x+n.x)*s+(2*e.x-5*t.x+4*n.x-r.x)*o+(-e.x+3*t.x-3*n.x+r.x)*i),a=.5*(2*t.y+(-e.y+n.y)*s+(2*e.y-5*t.y+4*n.y-r.y)*o+(-e.y+3*t.y-3*n.y+r.y)*i);return new ha(l,a)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let s=e.y;return s=s>n.y?n.y:s,s=s<t.y?t.y:s,new ha(r,s)}static Hermite(e,t,n,r,s){let o=s*s,i=s*o,l=2*i-3*o+1,a=-2*i+3*o,c=i-2*o+s,h=i-o,u=e.x*l+n.x*a+t.x*c+r.x*h,d=e.y*l+n.y*a+t.y*c+r.y*h;return new ha(u,d)}static Hermite1stDerivative(e,t,n,r,s){let o=ha.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,s,o),o}static Hermite1stDerivativeToRef(e,t,n,r,s,o){const i=s*s;o.x=6*(i-s)*e.x+(3*i-4*s+1)*t.x+6*(-i+s)*n.x+(3*i-2*s)*r.x,o.y=6*(i-s)*e.y+(3*i-4*s+1)*t.y+6*(-i+s)*n.y+(3*i-2*s)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,s=e.y+(t.y-e.y)*n;return new ha(r,s)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=ha.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new ha(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new ha(n,r)}static Transform(e,t,n=!1){const r=t,s=e;return n?new ha(r[0]*s.x+r[2]*s.y,r[1]*s.x+r[3]*s.y):new ha(r[0]*s.x+r[2]*s.y+r[4],r[1]*s.x+r[3]*s.y+r[5])}static PointInTriangle(e,t,n,r){let s=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),o=s<0?-1:1,i=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*o,l=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*o;return i>0&&l>0&&i+l<2*s*o}static Distance(e,t){return Math.sqrt(ha.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return ha.CenterToRef(e,t,ha.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=ha.DistanceSquared(t,n);if(0===r)return ha.Distance(e,t);let s=n.subtract(t),o=Math.max(0,Math.min(1,ha.Dot(e.subtract(t),s)/r)),i=t.add(s.multiplyByFloats(o,o));return ha.Distance(e,i)}static create(e,t){return new ha(e,t)}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return ha.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new ha(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new ha(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new ha(this.x-e.x,this.y-e.y)}subtractByPoint(e,t){return new ha(this.x-e,this.y-t)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new ha(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new ha(this.x*e,this.y*t)}divide(e){return new ha(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new ha(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new ha(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new ha(Math.floor(this.x),Math.floor(this.y))}fract(){return new ha(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,s=n*this.x+t*this.y;return this.x=r,this.y=s,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=ha.create(0,0)){const n=Math.cos(e),r=Math.sin(e),s=t.x+(this.x-t.x)*n-(this.y-t.y)*r,o=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=s,this.y=o,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return ha.NormalizeToRef(this,this),this}clone(){return new ha(this.x,this.y)}}const ua=[1,0,0,1,0,0];class da{constructor(e=ua){this.dirty=!1,this._m=e&&e.slice()||ua}static create(e=ua){return new this(e)}reset(){this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=1,this._m[4]=0,this._m[5]=0}copy(){return new da(this._m)}copyInto(e){e._m[0]=this._m[0],e._m[1]=this._m[1],e._m[2]=this._m[2],e._m[3]=this._m[3],e._m[4]=this._m[4],e._m[5]=this._m[5]}applyPoint(e,t=!1){const n=this._m;let r=n[0]*e.x+n[2]*e.y,s=n[1]*e.x+n[3]*e.y;return t?new ha(r,s):new ha(r+n[4],s+n[5])}translate(e,t){return this._m[4]+=this._m[0]*e+this._m[2]*t,this._m[5]+=this._m[1]*e+this._m[3]*t,this}scale(e,t){return this._m[0]*=e,this._m[1]*=e,this._m[2]*=t,this._m[3]*=t,this}rotate(e){const t=Ll(e);let n=Math.cos(t),r=Math.sin(t),s=this._m[0]*n+this._m[2]*r,o=this._m[1]*n+this._m[3]*r,i=this._m[0]*-r+this._m[2]*n,l=this._m[1]*-r+this._m[3]*n;return this._m[0]=s,this._m[1]=o,this._m[2]=i,this._m[3]=l,this}getTranslation(){return{x:this._m[4],y:this._m[5]}}skew(e,t){let n=this._m[0]+this._m[2]*t,r=this._m[1]+this._m[3]*t,s=this._m[2]+this._m[0]*e,o=this._m[3]+this._m[1]*e;return this._m[0]=n,this._m[1]=r,this._m[2]=s,this._m[3]=o,this}multiply(e){let t=this._m[0]*e._m[0]+this._m[2]*e._m[1],n=this._m[1]*e._m[0]+this._m[3]*e._m[1],r=this._m[0]*e._m[2]+this._m[2]*e._m[3],s=this._m[1]*e._m[2]+this._m[3]*e._m[3],o=this._m[0]*e._m[4]+this._m[2]*e._m[5]+this._m[4],i=this._m[1]*e._m[4]+this._m[3]*e._m[5]+this._m[5];return this._m[0]=t,this._m[1]=n,this._m[2]=r,this._m[3]=s,this._m[4]=o,this._m[5]=i,this}invert(){let e=1/(this._m[0]*this._m[3]-this._m[1]*this._m[2]),t=this._m[3]*e,n=-this._m[1]*e,r=-this._m[2]*e,s=this._m[0]*e,o=e*(this._m[2]*this._m[5]-this._m[3]*this._m[4]),i=e*(this._m[1]*this._m[4]-this._m[0]*this._m[5]);return this._m[0]=t,this._m[1]=n,this._m[2]=r,this._m[3]=s,this._m[4]=o,this._m[5]=i,this}getMatrix(){return this._m}getMatrixByAccurate(e=3){return this._m.map((t=>Ul(t,e)))}setAbsolutePosition(e){let t=this._m[0],n=this._m[1],r=this._m[2],s=this._m[3],o=this._m[4],i=this._m[5],l=(t*(e.y-i)-n*(e.x-o))/(t*s-n*r),a=(e.x-o-r*l)/t;return this.translate(a,l)}decompose(){let e=this._m[0],t=this._m[1],n=this._m[2],r=this._m[3],s=e*r-t*n,o={x:this._m[4],y:this._m[5],angle:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==e||0!==t){let i=Math.sqrt(e*e+t*t);o.angle=t>0?Math.acos(e/i):-Math.acos(e/i),o.scaleX=i,o.scaleY=s/i,o.skewX=(e*n+t*r)/s,o.skewY=0}else if(0!==n||0!==r){let i=Math.sqrt(n*n+r*r);o.angle=Math.PI/2-(r>0?Math.acos(-n/i):-Math.acos(n/i)),o.scaleX=s/i,o.scaleY=i,o.skewX=0,o.skewY=(e*n+t*r)/s}return o.angle=kl(o.angle),o}makeBoundingBoxFromPoints(e){if(this)for(let i=0;i<e.length;i++)e[i]=this.applyPoint(e[i]);const t=[e[0].x,e[1].x,e[2].x,e[3].x],n=Math.min(...t),r=Math.max(...t)-n,s=[e[0].y,e[1].y,e[2].y,e[3].y],o=Math.min(...s);return{left:n,top:o,width:r,height:Math.max(...s)-o,points:e}}composeMatrix(e){const t=new da([1,0,0,1,e.left||0,e.top||0]);return e.angle&&t.rotate(e.angle),(1!==e.scaleX||1!==e.scaleY||e.skewX||e.skewY||e.flipX||e.flipY)&&t.multiply(this._calcDimensionsMatrix(e)),this._m=t.getMatrix(),this}clone(){return new da([...this._m])}_calcDimensionsMatrix(e){var t,n;const r=null!=(t=e.scaleX)?t:1,s=null!=(n=e.scaleY)?n:1,o=new da([e.flipX?-r:r,0,0,e.flipY?-s:s,0,0]);return e.skewX&&o.multiply(new da([1,0,Math.tan(Ll(e.skewX)),1,0,0])),e.skewY&&o.multiply(new da([1,Math.tan(Ll(e.skewY)),0,1,0,0])),o}}function ga(e,t,n){let r=0,s=0,o=0,i=0;const{startX:l,startY:a,endX:c,endY:h}=n;t===Ki.TOP?(r=l,s=a,o=c,i=a):t===Ki.BOTTOM?(r=l,s=h,o=c,i=h):t===Ki.LEFT?(r=l,s=a,o=l,i=h):t===Ki.RIGHT&&(r=c,s=a,o=c,i=h),e.beginPath(),e.moveTo(r,s),e.lineTo(o,i),e.stroke()}function fa(e,t){t===ye.HAIR?e.setLineDash([1,2]):t===ye.DASH_DOT_DOT||t===ye.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===ye.DASH_DOT||t===ye.MEDIUM_DASH_DOT||t===ye.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===ye.DOTTED?e.setLineDash([2]):t===ye.DASHED||t===ye.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function ma(e){let t=1;return e===ye.MEDIUM||e===ye.MEDIUM_DASH_DOT||e===ye.MEDIUM_DASHED||e===ye.MEDIUM_DASH_DOT_DOT?t=2:e===ye.THICK&&(t=3),t}function pa(e,t,n,r,s=ha.create(0,0)){const o=e.add(t).rotateByPoint(r),i=r-n;return o.subtract(t).rotateByPoint(i,o).add(s).transformCoordinateOnRotate(i)}function ba(e){return e>0?qi.DOWN:qi.UP}function _a(e,t,n){const r=[];let s=0,o=0,i=0,l=0,a=0;const c=ba(n),h=e.length;n=Math.abs(n);const u=Math.tan(n),d=Math.sin(n),g=Math.cos(n);if(c===qi.UP){let n=0;for(let s=0;s<h;s++){const l=e[s],{lineHeight:c=0}=l;n+=0===s?0:c;const h=(c/u+t)*d;r.push(n/u),h>o&&(o=h),0===s&&(i+=c*d,a+=c*g)}i+=n/d+t*g,a-=o}else{let n=0,a=-1;const c=[];for(let r=h-1;r>=0;r--){const s=e[r],{lineHeight:l=0}=s,f=l/u,m=(t+f)*d;c.unshift(l/u),m>o&&(o=m,n=f,a=r),i+=0===r?l*d:r===h-1?t*g+l/d:l/d}let f=e[a].lineHeight||0,m=0;for(let t=a+1;t<=h-1;t++){const n=e[t],{lineHeight:s=0}=n;f+=s,m+=c[t]||0,r[t]=-m}m=0;for(let t=a-1;t>=0;t--){const n=e[t],{lineHeight:o=0}=n;m+=c[t+1]||0,r[t]=m,s+=o}r[a]=0,1===h&&(i+=t*g),l=f/d-n*g}return{rotateTranslateXList:r,rotatedHeight:o,rotatedWidth:i,fixOffsetX:l,fixOffsetY:a,rotateTranslateY:s}}const va=[new ha(0,0),new ha(1,1)];class Ca{constructor(e=va){this._lines=e}intersection(e){if(this._lines.length<1||e.length<1)return;const t=[];for(let n=1;n<this._lines.length;n++){const r=this._lines[n-1],s=this._lines[n];for(let o=1;o<e.length;o++){const e=this._lines[n-1],o=this._lines[n],i=this._intersection({from:r,to:s},{from:e,to:o});i&&t.push(i)}}return t}_intersection(e,t){const n=e.from,r=e.to,s=t.from,o=t.to;let i=(n.x-s.x)*(r.y-s.y)-(n.y-s.y)*(r.x-s.x),l=(n.x-o.x)*(r.y-o.y)-(n.y-o.y)*(r.x-o.x);if(i*l>=0)return!1;let a=(s.x-n.x)*(o.y-n.y)-(s.y-n.y)*(o.x-n.x);if(a*(a+i-l)>=0)return!1;let c=a/(l-i),h=c*(r.x-n.x),u=c*(r.y-n.y);return new ha(n.x+h,n.y+u)}}function Ta(e,t,n,r,s,o){if(!o)return[];const i=o.getPluginManager().getPluginByName("documentCustomBlock");return i?i.dealWidthCustomBlock(e,t,n,r,s):[]}function wa(e,t,n,r){if(!r)return"";const s=r.getPluginManager().getPluginByName("documentCustomBullet");return s?s.dealWidthCustomBulletOrderedSymbol(e,t,n):""}const ya=["top","left","width","height","angle","scaleX","scaleY","skewX","skewY","flipX","flipY","strokeWidth"];class Sa{constructor(e){this.isInGroup=!1,this.onTransformChangeObservable=new i,this.onPointerDownObserver=new i,this.onPointerMoveObserver=new i,this.onPointerUpObserver=new i,this.onDblclickObserver=new i,this.onMouseWheelObserver=new i,this.onPointerOutObserver=new i,this.onPointerLeaveObserver=new i,this.onPointerOverObserver=new i,this.onPointerEnterObserver=new i,this.onIsAddedToParentObserver=new i,this.onDisposeObserver=new i,this._dirty=!0,this._top=0,this._topOrigin=0,this._left=0,this._leftOrigin=0,this._width=0,this._widthOrigin=0,this._height=0,this._heightOrigin=0,this._angle=0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._flipX=!1,this._flipY=!1,this._strokeWidth=0,this._zIndex=0,this._evented=!0,this._visible=!0,this._debounceParentDirty=!0,this._transform=new da,this._cursor=Yi.DEFAULT,this._isTransformer=!1,this._forceRender=!1,this._oKey=e||Bl()}get transform(){return this._transform}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get widthOrigin(){return this._widthOrigin}get heightOrigin(){return this._heightOrigin}get classType(){return el.BASE_OBJECT}get top(){return this._top}get left(){return this._left}get width(){return this._width}get height(){return this._height}get strokeWidth(){return this._strokeWidth}get angle(){return this._angle}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){var e;let t=(null==(e=this.getParent())?void 0:e.ancestorScaleX)||1;return this.scaleX*t}get ancestorScaleY(){var e;let t=(null==(e=this.getParent())?void 0:e.ancestorScaleY)||1;return this.scaleY*t}get skewX(){return this._skewX}get skewY(){return this._skewY}get flipX(){return this._flipX}get flipY(){return this._flipY}get parent(){return this._parent}get oKey(){return this._oKey}get zIndex(){return this._zIndex}get evented(){return this._evented}get visible(){return this._visible}get debounceParentDirty(){return this._debounceParentDirty}get isTransformer(){return this._isTransformer}get cursor(){return this._cursor}set transform(e){this._transform=e}set zIndex(e){this._zIndex=e}set parent(e){this._parent=e}set evented(e){this._evented=e}set debounceParentDirty(e){this._debounceParentDirty=e}set isTransformer(e){this._isTransformer=e}set cursor(e){this.setCursor(e)}set top(e){var t;this._topOrigin=e,this._top=xl(e,null==(t=this._parent)?void 0:t.height)}set left(e){var t;this._leftOrigin=e,this._left=xl(e,null==(t=this._parent)?void 0:t.width)}set width(e){var t;this._widthOrigin=e,this._width=xl(e,null==(t=this._parent)?void 0:t.width)}set height(e){var t;this._heightOrigin=e,this._height=xl(e,null==(t=this._parent)?void 0:t.height)}set strokeWidth(e){this._strokeWidth=e}set angle(e){this._angle=e}set scaleX(e){this._scaleX=e}set scaleY(e){this._scaleY=e}set skewX(e){this._skewX=e}set flipY(e){this._flipY=e}set flipX(e){this._flipX=e}set skewY(e){this._skewY=e}makeDirty(e=!0){return this._dirty=e,e&&(window.clearTimeout(this.__debounceParentTimeout),this.__debounceParentTimeout=window.setTimeout((()=>{var t;null==(t=this.parent)||t.makeDirty(e)}),0)),this}makeDirtyNoDebounce(e=!0){var t;return this._dirty=e,e&&(null==(t=this.parent)||t.makeDirty(e)),this}isDirty(){return this._dirty}translate(e,t){const n=this.top;void 0!==t&&(this.top=t);const r=this.left;return void 0!==e&&(this.left=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Cl.translate,value:{top:this._top,left:this._left},preValue:{top:n,left:r}}),this}resize(e,t){const n=this.width;void 0!==e&&(this.width=e);const r=this.height;return void 0!==t&&(this.height=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Cl.resize,value:{width:this._width,height:this._height},preValue:{width:n,height:r}}),this}scale(e,t){const n=this.scaleX;void 0!==e&&(this.scaleX=e);const r=this.scaleY;return void 0!==t&&(this.scaleY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Cl.scale,value:{scaleX:this._scaleX,scaleY:this._scaleY},preValue:{scaleX:n,scaleY:r}}),this}skew(e,t){const n=e;void 0!==e&&(this.skewX=e);const r=t;return void 0!==t&&(this.skewY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Cl.skew,value:{skewX:this._skewX,skewY:this._skewY},preValue:{skewX:n,skewY:r}}),this}flip(e,t){const n=e;void 0!==e&&(this.flipX=e);const r=t;return void 0!==t&&(this.flipY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Cl.flip,value:{flipX:this._flipX,flipY:this._flipY},preValue:{flipX:n,flipY:r}}),this}transformByState(e){const t=Object.keys(e),n={};if(0!==t.length)return t.forEach((t=>{void 0!==e[t]&&(n[t]=this[t],this[t]=e[t])})),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Cl.all,value:e,preValue:n}),this}isRender(e){return!this._forceRender&&(e&&!this.isInGroup)}getParent(){return this._parent}getState(){return{left:this.left,top:this.top,width:this.width,height:this.height,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}hide(){this._visible=!1,this._makeDirtyMix()}show(){this._visible=!0,this._makeDirtyMix()}render(e,t){}isHit(e){const t=this._getInverseCoord(e);return t.x>=-this.strokeWidth/2&&t.x<=this.width+this.strokeWidth/2&&t.y>=-this.strokeWidth/2&&t.y<=this.height+this.strokeWidth/2}on(e,t){return this[`on${e}Observer`].add(t.bind(this))}off(e,t){this[`on${e}Observer`].remove(t)}clear(e){this[`on${e}Observer`].clear()}resizeCacheCanvas(){}scaleCacheCanvas(){}triggerPointerMove(e){var t,n;return!!(null==(t=this.onPointerMoveObserver.notifyObservers(e))?void 0:t.stopPropagation)||(null==(n=this._parent)||n.triggerPointerMove(e),!1)}triggerPointerDown(e){var t,n;return!!(null==(t=this.onPointerDownObserver.notifyObservers(e))?void 0:t.stopPropagation)||(null==(n=this._parent)||n.triggerPointerDown(e),!1)}triggerPointerUp(e){var t,n;return!!(null==(t=this.onPointerUpObserver.notifyObservers(e))?void 0:t.stopPropagation)||(null==(n=this._parent)||n.triggerPointerUp(e),!1)}triggerDblclick(e){var t,n;return!!(null==(t=this.onDblclickObserver.notifyObservers(e))?void 0:t.stopPropagation)||(null==(n=this._parent)||n.triggerDblclick(e),!1)}triggerMouseWheel(e){var t,n;return!!(null==(t=this.onMouseWheelObserver.notifyObservers(e))?void 0:t.stopPropagation)||(null==(n=this._parent)||n.triggerMouseWheel(e),!1)}triggerPointerOut(e){var t,n;return!!(null==(t=this.onPointerOutObserver.notifyObservers(e))?void 0:t.stopPropagation)||(null==(n=this._parent)||n.triggerPointerOut(e),!1)}triggerPointerLeave(e){var t,n;return!!(null==(t=this.onPointerLeaveObserver.notifyObservers(e))?void 0:t.stopPropagation)||(null==(n=this._parent)||n.triggerPointerLeave(e),!1)}triggerPointerOver(e){var t;return!!this.onPointerOverObserver.notifyObservers(e)||(null==(t=this._parent)||t.triggerPointerOver(e),!1)}triggerPointerEnter(e){var t,n;return!!(null==(t=this.onPointerEnterObserver.notifyObservers(e))?void 0:t.stopPropagation)||(null==(n=this._parent)||n.triggerPointerEnter(e),!1)}dispose(){var e;this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onMouseWheelObserver.clear(),this.onPointerOutObserver.clear(),this.onPointerLeaveObserver.clear(),this.onPointerOverObserver.clear(),this.onPointerEnterObserver.clear(),this.onDblclickObserver.clear(),this.onIsAddedToParentObserver.clear(),null==(e=this.parent)||e.removeObject(this),this.onDisposeObserver.notifyObservers(this)}toJson(){const e={};return ya.forEach((t=>{this[t]&&(e[t]=this[t])})),e}getScene(){let e=this.parent;if(null!=e){if(e.classType===el.SCENE)return e;for(;e;){if(e.classType===el.SCENE)return e;e=e.getParent()}}}resetCursor(){this.setCursor(Yi.DEFAULT)}setCursor(e){var t;this._cursor=e,null==(t=this.getScene())||t.setCursor(e)}getEngine(){let e=this.getParent();for(;null!=e;){if(e===el.ENGINE)return e;e=e.getParent()}return null}_getInverseCoord(e){return this._transform.clone().invert().applyPoint(e)}_setTransForm(){const e=da.create().composeMatrix({left:this.left+this.strokeWidth/2,top:this.top+this.strokeWidth/2,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY});this.transform=e,this._makeDirtyMix()}_makeDirtyMix(){this.debounceParentDirty?this.makeDirty(!0):this.makeDirtyNoDebounce(!0)}}function Ea(e){const t=e.getScene(),n=e.getViewportByCoord(t);if(!n)return{scrollX:0,scrollY:0};const r=n.getActualScroll(n.scrollX,n.scrollY);return{scrollX:r.x,scrollY:r.y}}function Ra(e,t){const n=e.transform.clone().invert().applyPoint(t.tl),r=e.transform.clone().invert().applyPoint(t.tr),s=e.transform.clone().invert().applyPoint(t.bl),o=e.transform.clone().invert().applyPoint(t.br),i=[n.x,r.x,s.x,o.x],l=[n.y,r.y,s.y,o.y],a=Math.max(...i),c=Math.min(...i),h=Math.max(...l);return{minX:c,maxX:a,minY:Math.min(...l),maxY:h}}function Ia(){let e=1,t=Nl().getContext("2d");return e=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1),e<1?1:Math.ceil(10*e)/10}class Aa{constructor(e){this.isCache=!1,this._pixelRatio=1,this._width=0,this._height=0,e=e||{},this._canvasEle=Nl(),this._canvasEle.style.padding="0",this._canvasEle.style.margin="0",this._canvasEle.style.border="0",this._canvasEle.style.background="transparent",this._canvasEle.style.position="absolute",this._canvasEle.style.top="0",this._canvasEle.style.left="0",this._canvasEle.tabIndex=1,this._canvasEle.style.touchAction="none",this._canvasEle.style.outline="0",this._context=this._canvasEle.getContext("2d"),this.setSize(e.width,e.height,e.pixelRatio)}getCanvasEle(){return this._canvasEle}getContext(){return this._context}getPixelRatio(){return this._pixelRatio}getWidth(){return this._width}getHeight(){return this._height}setSize(e,t,n){this._pixelRatio=n||Ia(),e&&(this._width=e,this._canvasEle.width=e*this._pixelRatio,this._canvasEle.style.width=`${e}px`),t&&(this._height=t,this._canvasEle.height=t*this._pixelRatio,this._canvasEle.style.height=`${t}px`),this.getContext().setTransform(this._pixelRatio,0,0,this._pixelRatio,0,0)}setPixelRatio(e){0!==this._width&&0!==this._height&&(e<1&&(e=1),this.setSize(this._width,this._height,e))}dispose(){this.clear(),this._canvasEle.remove()}clear(){this.getContext().clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}toDataURL(e,t){try{return this._canvasEle.toDataURL(e,t)}catch(n){try{return this._canvasEle.toDataURL()}catch(r){const{message:e}=r;return console.error(`Unable to get data URL. ${e} For more info read https://universheet.net/docs/Canvas.html.`),""}}}}class xa{constructor(e=100,t=100){this.onInputChangedObservable=new i,this.renderEvenInBackground=!0,this.onBeginFrameObservable=new i,this.onEndFrameObservable=new i,this.onTransformChangeObservable=new i,this._canvas=new Aa,this._scenes={},this._activeScene=null,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this._usingSafari=Pl(),this._fps=60,this._deltaTime=0,this._performanceMonitor=new yl,this.__pointer={},this.__mouseId=-1,this.__isUsingFirefox=-1!==navigator.userAgent.indexOf("Firefox"),this._canvasEle=this._canvas.getCanvasEle(),this._canvas.setSize(e,t),this._handleKeyboardAction(),this._handlePointerAction()}get width(){return this._canvas.getWidth()}get height(){return this._canvas.getHeight()}get classType(){return el.ENGINE}get activeScene(){return this._activeScene}get requestNewFrameHandler(){return this._requestNewFrameHandler}get frameId(){return this._frameId}getCanvas(){return this._canvas}getScenes(){return this._scenes}getScene(e){return this._scenes[e]}hasScene(e){return e in this._scenes}addScene(e){const t=e.sceneKey;return this.hasScene(t)&&console.warn("Scenes has similar key, it will be covered"),this._scenes[t]=e,e}setActiveScene(e){const t=this.getScene(e);return t&&(this._activeScene=t),t}hasActiveScene(){return null!=this._activeScene}setContainer(e){this._container=e,this._container.appendChild(this._canvasEle),this.resize()}resize(){if(!this._container)return;const{width:e,height:t}=ca(this._container);this.resizeBySize(e,t)}resizeBySize(e,t){const n=this.width,r=this.height;this._canvas.setSize(e,t),this.onTransformChangeObservable.notifyObservers({type:Cl.resize,value:{width:e,height:t},preValue:{width:n,height:r}})}dispose(){const e=this.getScenes();Object.keys(e).forEach((t=>{e[t].dispose()}));const t=Dl();this._canvasEle.removeEventListener(`${t}move`,this._pointerMoveEvent),this._canvasEle.removeEventListener(`${t}down`,this._pointerDownEvent),this._canvasEle.removeEventListener(`${t}up`,this._pointerUpEvent),this._canvasEle.removeEventListener("blur",this._pointerBlurEvent),this._canvasEle.removeEventListener(this._getWheelEventName(),this._pointerWheelEvent),this._activeRenderLoops=[],this._canvas.dispose(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear(),this.onTransformChangeObservable.clear()}remainScene(e){const t=this.getScenes();if(t[e]){const n=t[e];return delete t[e],n}}runRenderLoop(e){-1===this._activeRenderLoops.indexOf(e)&&(this._activeRenderLoops.push(e),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._renderFunction=this._renderLoop.bind(this),this._requestNewFrameHandler=Ol(this._renderFunction)))}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}_renderFrame(){for(let e=0;e<this._activeRenderLoops.length;e++){(0,this._activeRenderLoops[e])()}}_renderLoop(){let e=!0;this.renderEvenInBackground||(e=!1),e&&(this.beginFrame(),this._renderFrame(),this.endFrame()),this._activeRenderLoops.length>0?this._requestNewFrameHandler=Ol(this._renderFunction):this._renderingQueueLaunched=!1}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}_handleKeyboardAction(){this._canvasEle.addEventListener("keydown",(e=>{let t=e;t.deviceType=pl.Keyboard,t.inputIndex=e.keyCode,t.previousState=0,t.currentState=1,this.onInputChangedObservable.notifyObservers(t)})),this._canvasEle.addEventListener("keyup",(e=>{let t=e;t.deviceType=pl.Keyboard,t.inputIndex=e.keyCode,t.previousState=1,t.currentState=0,this.onInputChangedObservable.notifyObservers(t)}))}_handlePointerAction(){const e=Dl();this._pointerMoveEvent=e=>{const t=this.__getPointerType(e),n=this.__pointer[_l.Horizontal],r=this.__pointer[_l.Vertical],s=this.__pointer[_l.DeltaHorizontal],o=this.__pointer[_l.DeltaVertical];this.__pointer[_l.Horizontal]=e.clientX,this.__pointer[_l.Vertical]=e.clientY,this.__pointer[_l.DeltaHorizontal]=e.movementX,this.__pointer[_l.DeltaVertical]=e.movementY;let i=e;i.deviceType=t,n!==e.clientX&&(i.inputIndex=_l.Horizontal,i.previousState=n,i.currentState=this.__pointer[_l.Horizontal],this.onInputChangedObservable.notifyObservers(i)),r!==e.clientY&&(i.inputIndex=_l.Vertical,i.previousState=r,i.currentState=this.__pointer[_l.Vertical],this.onInputChangedObservable.notifyObservers(i)),0!==this.__pointer[_l.DeltaHorizontal]&&(i.inputIndex=_l.DeltaHorizontal,i.previousState=s,i.currentState=this.__pointer[_l.DeltaHorizontal],this.onInputChangedObservable.notifyObservers(i)),0!==this.__pointer[_l.DeltaVertical]&&(i.inputIndex=_l.DeltaVertical,i.previousState=o,i.currentState=this.__pointer[_l.DeltaVertical],this.onInputChangedObservable.notifyObservers(i)),this._usingSafari||-1===e.button||(i.inputIndex=e.button+2,i.previousState=this.__pointer[e.button+2],this.__pointer[e.button+2]=this.__pointer[e.button+2]?0:1,i.currentState=this.__pointer[e.button+2],this.onInputChangedObservable.notifyObservers(i))},this._pointerDownEvent=e=>{const t=this.__getPointerType(e),n=this.__pointer[_l.Horizontal],r=this.__pointer[_l.Vertical],s=this.__pointer[e.button+2];t===pl.Mouse?(-1===this.__mouseId&&(void 0===e.pointerId?this.__mouseId=this.__isUsingFirefox?0:1:this.__mouseId=e.pointerId),document.pointerLockElement||this._canvasEle.setPointerCapture(this.__mouseId)):e.pointerId&&!document.pointerLockElement&&this._canvasEle.setPointerCapture(e.pointerId),this.__pointer[_l.Horizontal]=e.clientX,this.__pointer[_l.Vertical]=e.clientY,this.__pointer[e.button+2]=1;let o=e;o.deviceType=t,n!==e.clientX&&(o.inputIndex=_l.Horizontal,o.previousState=n,o.currentState=this.__pointer[_l.Horizontal],this.onInputChangedObservable.notifyObservers(o)),r!==e.clientY&&(o.inputIndex=_l.Vertical,o.previousState=r,o.currentState=this.__pointer[_l.Vertical],this.onInputChangedObservable.notifyObservers(o)),o.inputIndex=e.button+2,o.previousState=s,o.currentState=this.__pointer[e.button+2],this.onInputChangedObservable.notifyObservers(o)},this._pointerUpEvent=e=>{const t=this.__getPointerType(e),n=this.__pointer[_l.Horizontal],r=this.__pointer[_l.Vertical],s=this.__pointer[e.button+2];this.__pointer[_l.Horizontal]=e.clientX,this.__pointer[_l.Vertical]=e.clientY,this.__pointer[e.button+2]=0;let o=e;o.deviceType=t,n!==e.clientX&&(o.inputIndex=_l.Horizontal,o.previousState=n,o.currentState=this.__pointer[_l.Horizontal],this.onInputChangedObservable.notifyObservers(o)),r!==e.clientY&&(o.inputIndex=_l.Vertical,o.previousState=r,o.currentState=this.__pointer[_l.Vertical],this.onInputChangedObservable.notifyObservers(o)),o.inputIndex=e.button+2,o.previousState=s,o.currentState=this.__pointer[e.button+2],t===pl.Mouse&&this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)?this._canvasEle.releasePointerCapture(this.__mouseId):e.pointerId&&this._canvasEle.hasPointerCapture(e.pointerId)&&this._canvasEle.releasePointerCapture(e.pointerId),this.onInputChangedObservable.notifyObservers(o),t!==pl.Mouse&&(this.__pointer={})},this._pointerBlurEvent=e=>{this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)&&(this._canvasEle.releasePointerCapture(this.__mouseId),this.__mouseId=-1),this.__pointer={}},this._pointerWheelEvent=e=>{const t=pl.Mouse;let n=this.__pointer[_l.MouseWheelX],r=this.__pointer[_l.MouseWheelY],s=this.__pointer[_l.MouseWheelZ];this.__pointer[_l.MouseWheelX]=e.deltaX||0,this.__pointer[_l.MouseWheelY]=e.deltaY||e.wheelDelta||0,this.__pointer[_l.MouseWheelZ]=e.deltaZ||0;let o=e;o.deviceType=t,0!==this.__pointer[_l.MouseWheelX]&&(o.inputIndex=_l.MouseWheelX,o.previousState=n,o.currentState=this.__pointer[_l.MouseWheelX],this.onInputChangedObservable.notifyObservers(o)),0!==this.__pointer[_l.MouseWheelY]&&(o.inputIndex=_l.MouseWheelY,o.previousState=r,o.currentState=this.__pointer[_l.MouseWheelY],this.onInputChangedObservable.notifyObservers(o)),0!==this.__pointer[_l.MouseWheelZ]&&(o.inputIndex=_l.MouseWheelZ,o.previousState=s,o.currentState=this.__pointer[_l.MouseWheelZ],this.onInputChangedObservable.notifyObservers(o))},this._canvasEle.addEventListener(`${e}move`,this._pointerMoveEvent),this._canvasEle.addEventListener(`${e}down`,this._pointerDownEvent),this._canvasEle.addEventListener(`${e}up`,this._pointerUpEvent),this._canvasEle.addEventListener("blur",this._pointerBlurEvent),this._canvasEle.addEventListener(this._getWheelEventName(),this._pointerWheelEvent,!!this._getPassive()&&{passive:!1})}_getWheelEventName(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"}_getPassive(){let e=!1;const t=()=>{};try{const n={passive:{get(){e=!0}}};this._canvasEle.addEventListener("test",t,n),this._canvasEle.removeEventListener("test",t,n)}catch(n){}return e}__getPointerType(e){let t=pl.Mouse;return("touch"===e.pointerType||"pen"===e.pointerType||e.touches)&&(t=pl.Touch),t}}class Oa{constructor(e,t=[],n=1){this._scene=e,this._zIndex=n,this._objects=[],this.addObjects(t)}get scene(){return this._scene}get zIndex(){return this._zIndex}static create(e,t=[],n=1e3){return new this(e,t,n)}getObjectsByOrder(){const e=[];this._objects.sort(Ar);for(let t of this._objects)!t.isInGroup&&t.visible&&e.push(t);return e}getObjectsByOrderForPick(){const e=[];this._objects.sort(Ar);for(let t of this._objects)t.classType!==el.GROUP&&t.visible&&e.push(t);return e}getObjects(){return this._objects}addObject(e){if(e.classType===el.GROUP){const t=e.getObjects();for(let e of t)this.scene.getObject(e.oKey)||(this._objects.push(e),this.scene.setObjectBehavior(e))}return this._objects.push(e),this.scene.setObjectBehavior(e),this.scene.applyTransformer(e),this}removeObject(e){const t=this.getObjects(),n=t.length;if(e instanceof Sa)for(let r=0;r<n;r++){if(t[r]===e)return void t.splice(r,1)}else for(let r=0;r<n;r++){if(t[r].oKey===e)return void t.splice(r,1)}}addObjects(e){return e.forEach((e=>{this.addObject(e)})),this}removeObjects(e){const t=this.getObjects();for(let n=t.length-1;n>=0;n--){let r=t[n];const s=e.length;if(0===s)break;for(let o=0;o<s;o++){const s=e[o];if(r=s instanceof Sa?r:r.oKey,r===s){t.splice(n,1);break}}}}clear(){this._objects=[]}dispose(){this.getObjects().forEach((e=>{e.dispose()})),this.clear()}}const Ma=class{constructor(e){this._alreadyAttached=!1,this._startingPosition=new ha(1/0,1/0),this._doubleClickOccurred=0,this._scene=e}mouseLeaveEnterHandler(e,t){var n;if(null==e)null==(n=this._currentMouseEnterPicked)||n.triggerPointerLeave(t),this._currentMouseEnterPicked=null;else if(e!==this._currentMouseEnterPicked){const n=this._currentMouseEnterPicked;this._currentMouseEnterPicked=e,null==n||n.triggerPointerLeave(t),null==e||e.triggerPointerEnter(t)}}attachControl(e=!0,t=!0,n=!0,r=!0){const s=this._scene.getEngine();s&&(this._onPointerMove=e=>{void 0===e.pointerId&&(e.pointerId=0);const t=this._getCurrentObject(e.offsetX,e.offsetY),n=null==t?void 0:t.triggerPointerMove(e);this.mouseLeaveEnterHandler(t,e),this._checkDirectSceneEventTrigger(!n,t)&&this._scene.onPointerMoveObserver.hasObservers()&&this._scene.onPointerMoveObserver.notifyObservers(e)},this._onPointerDown=e=>{void 0===e.pointerId&&(e.pointerId=0);const t=this._getCurrentObject(e.offsetX,e.offsetY),n=null==t?void 0:t.triggerPointerDown(e);this._checkDirectSceneEventTrigger(!n,t)&&this._scene.onPointerDownObserver.hasObservers()&&this._scene.onPointerDownObserver.notifyObservers(e)},this._onPointerUp=e=>{void 0===e.pointerId&&(e.pointerId=0);const t=this._getCurrentObject(e.offsetX,e.offsetY),n=null==t?void 0:t.triggerPointerUp(e);this._checkDirectSceneEventTrigger(!n,t)&&this._scene.onPointerUpObserver.hasObservers()&&this._scene.onPointerUpObserver.notifyObservers(e),this._prePointerDoubleClick(e)},this._onMouseWheel=e=>{const t=this._getCurrentObject(e.offsetX,e.offsetY),n=null==t?void 0:t.triggerMouseWheel(e);this._scene.getViewports().forEach((t=>{t.onMouseWheelObserver.hasObservers()&&t.onMouseWheelObserver.notifyObservers(e)})),this._checkDirectSceneEventTrigger(!n,t)&&this._scene.onMouseWheelObserver.hasObservers()&&this._scene.onMouseWheelObserver.notifyObservers(e)},this._onKeyDown=e=>{this._scene.onKeyDownObservable.hasObservers()&&this._scene.onKeyDownObservable.notifyObservers(e)},this._onKeyUp=e=>{this._scene.onKeyUpObservable.hasObservers()&&this._scene.onKeyUpObservable.notifyObservers(e)},this._onInputObserver=s.onInputChangedObservable.add((s=>{const o=s;s.deviceType===pl.Keyboard&&(1===s.currentState&&this._onKeyDown(o),0===s.currentState&&this._onKeyUp(o)),s.deviceType!==pl.Mouse&&s.deviceType!==pl.Touch||(e&&s.inputIndex>=_l.LeftClick&&s.inputIndex<=_l.RightClick&&1===s.currentState&&this._onPointerDown(o),t&&s.inputIndex>=_l.LeftClick&&s.inputIndex<=_l.RightClick&&0===s.currentState&&this._onPointerUp(o),!n||s.inputIndex!==_l.Horizontal&&s.inputIndex!==_l.Vertical&&s.inputIndex!==_l.DeltaHorizontal&&s.inputIndex!==_l.DeltaVertical?!r||s.inputIndex!==_l.MouseWheelX&&s.inputIndex!==_l.MouseWheelY&&s.inputIndex!==_l.MouseWheelZ||this._onMouseWheel(o):this._onPointerMove(o))})),this._alreadyAttached=!0)}detachControl(){if(!this._alreadyAttached)return;const e=this._scene.getEngine();e&&(e.onInputChangedObservable.remove(this._onInputObserver),this._alreadyAttached=!1)}_getCurrentObject(e,t){var n;return null==(n=this._scene)?void 0:n.pick(ha.FromArray([e,t]))}_checkDirectSceneEventTrigger(e,t){let n=!1;null==t&&(n=!0);let r=!0;if(t&&t.classType===el.BASE_OBJECT){const e=t.getScene();if(e){r=e.getParent().classType!==el.SCENE_VIEWER}}return!this._scene.evented&&e&&r||n}_isPointerSwiping(e,t){return Math.abs(this._startingPosition.x-e)>Ma.DragMovementThreshold||Math.abs(this._startingPosition.y-t)>Ma.DragMovementThreshold}_prePointerDoubleClick(e){var t,n;const{clientX:r,clientY:s}=e;if(0===this._doubleClickOccurred&&(this._startingPosition.x=r,this._startingPosition.y=s),this._doubleClickOccurred+=1,this._delayedTimeout=window.setTimeout((()=>{this._resetDoubleClickParam()}),Ma.DoubleClickDelay),this._doubleClickOccurred<2)return;this._isPointerSwiping(r,s)?this._resetDoubleClickParam():(null==(n=null==(t=this._scene)?void 0:t.pick(ha.FromArray([e.offsetX,e.offsetY])))||n.triggerDblclick(e),this._scene.onDblclickObserver.hasObservers()&&this._scene.onDblclickObserver.notifyObservers(e),this._resetDoubleClickParam(),console.log("_prePointerDoubleClick",e))}_resetDoubleClickParam(){this._doubleClickOccurred=0,this._startingPosition.x=1/0,this._startingPosition.y=1/0,window.clearTimeout(this._delayedTimeout)}};let Na=Ma;Na.DragMovementThreshold=10,Na.LongPressDelay=500,Na.DoubleClickDelay=300,Na.ExclusiveDoubleClickMode=!1;class ka extends Sa{constructor(e,...t){super(e),this._objects=[],this.addObjects(...t)}get classType(){return el.GROUP}set cursor(e){this.setCursor(e)}addObjects(...e){for(const t of e)this.addObject(t)}addObject(e){let t=e;if(zl(e)){const n=this.getScene();if(t=null==n?void 0:n.getObject(e),!t)return void console.info("No object be added");t.parent=this,t.isInGroup=!0,t.groupKey=this.oKey,this._objects.push(t)}else e.parent=this,e.isInGroup=!0,e.groupKey=this.oKey,this._objects.push(e)}removeObject(e){const t=this.getObjects(),n=t.length;if(zl(e))for(let r=0;r<n;r++){const n=t[r];if(n.oKey===e)return t.splice(r,1),void this.parent.removeObject(n)}else for(let r=0;r<n;r++){const n=t[r];if(n===e)return t.splice(r,1),void this.parent.removeObject(n)}}getObjectsByOrder(){const e=[];this._objects.sort(Ar);for(let t of this._objects)!t.isInGroup&&t.visible&&e.push(t);return e}getObjects(){return this._objects}render(e,t){e.save();const n=this.transform.getMatrix();e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._objects.sort(Ar);for(let r of this._objects)r.render(e,this._transformBounds(t));e.restore()}resize(e,t){return this}scale(e,t){return this}skew(e,t){return this}flip(e,t){return this}isHit(e){return!0}pick(e){}dispose(){this.getObjects().forEach((e=>{e.dispose()})),super.dispose()}_transformBounds(e){return e}}class La{constructor(e,t,n=.05,r=.05){this._scene=e,this._padding=t,this._smoothRatioX=n,this._smoothRatioY=r,this._offsetX=0,this._offsetY=0,this._moveX=0,this._moveY=0,this._scrollX=0,this._scrollY=0,this._padding||(this._padding={t:20,b:20,l:46,r:60})}static create(e,t){return new La(e,t)}startScroll(e,t){this._offsetX=e,this._offsetY=t,this._moveX=e,this._moveY=t,this._viewport=this.getViewportByCoord(this._scene),this._runRenderLoop()}_scroll(e){const t=(null==e?void 0:e.top)||0,n=t+((null==e?void 0:e.height)||0),r=(null==e?void 0:e.left)||0,s=r+((null==e?void 0:e.width)||0),{t:o=0,b:i=0,r:l=0,l:a=0}=this._padding;let c=0,h=0;this._moveX<r+a&&(c=(this._moveX-r-a)*this._smoothRatioX),this._moveX>s-l&&(c=(this._moveX-s+l)*this._smoothRatioX),this._moveY<t+o&&(h=(this._moveY-t-o)*this._smoothRatioY),this._moveY>n-i&&(h=(this._moveY-n+i)*this._smoothRatioY);const u=null==e?void 0:e.scrollBy({x:c,y:h}),d=null==e?void 0:e.getActualScroll(c,h);if(this._scrollX=(null==d?void 0:d.x)||0,this._scrollY=(null==d?void 0:d.y)||0,u){const t=this._findAncestorScene(null==e?void 0:e.scene),n=this.getViewportByCoord(t);n&&this._scroll(n)}}scrolling(e,t,n){this._moveX=e,this._moveY=t,this._scrollFunction=n}stopScroll(){Ml(this._requestNewFrameNumber)}getViewportByCoord(e){return null==e?void 0:e.getActiveViewportByRelativeCoord(ha.FromArray([this._offsetX,this._offsetY]))}getScene(){return this._scene}_runRenderLoop(){this._scroll(this._viewport),this._scrollFunction&&this._scrollFunction(this._scrollX,this._scrollY),this._requestNewFrameNumber=Ol(this._runRenderLoop.bind(this))}_findAncestorScene(e){let t=null==e?void 0:e.getParent();for(;t;){if(t.classType===el.SCENE)return t;t=(null==t?void 0:t.getParent)&&(null==t?void 0:t.getParent())}}}const Da=["hoverCursor","moveCursor","fillRule","globalCompositeOperation","allowCache","paintFirst","stroke","strokeScaleEnabled","fill","fillAfterStrokeEnabled","hitStrokeWidth","strokeLineJoin","strokeLineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","shadowForStrokeEnabled","strokeDashArray","strokeDashOffset","strokeMiterLimit"];class Pa extends Sa{constructor(e,t){super(e),this._moveCursor=null,this._fillRule="nonzero",this._globalCompositeOperation="source-over",this._allowCache=!1,this._allowCache&&(this._cacheCanvas=new Aa,this.onTransformChangeObservable.add((()=>{this.resizeCacheCanvas()}))),this._initialProps(t)}get hoverCursor(){return this._hoverCursor}get moveCursor(){return this._moveCursor}get fillRule(){return this._fillRule}get globalCompositeOperation(){return this._globalCompositeOperation}get allowCache(){return this._allowCache}get paintFirst(){return this._paintFirst}get stroke(){return this._stroke}get strokeScaleEnabled(){return this._strokeScaleEnabled}get fill(){return this._fill}get fillAfterStrokeEnabled(){return this._fillAfterStrokeEnabled}get hitStrokeWidth(){return this._hitStrokeWidth}get strokeLineJoin(){return this._strokeLineJoin}get strokeLineCap(){return this._strokeLineCap}get shadowColor(){return this._shadowColor}get shadowBlur(){return this._shadowBlur}get shadowOffset(){return this._shadowOffset}get shadowOffsetX(){return this._shadowOffsetX}get shadowOffsetY(){return this._shadowOffsetY}get shadowOpacity(){return this._shadowOpacity}get shadowEnabled(){return this._shadowEnabled}get shadowForStrokeEnabled(){return this._shadowForStrokeEnabled}get strokeDashArray(){return this._strokeDashArray}get strokeDashOffset(){return this._strokeDashOffset}get strokeMiterLimit(){return this._strokeMiterLimit}static drawWith(e,t){}static _renderPaintInOrder(e,t){"stroke"===t.paintFirst?(this._renderStroke(e,t),this._renderFill(e,t)):(this._renderFill(e,t),this._renderStroke(e,t))}static _renderFill(e,t){t.fill&&(e.save(),this.__setFillStyles(e,t),"evenodd"===t.fillRule?e.fill("evenodd"):e.fill(),e.restore())}static _renderStroke(e,t){let{stroke:n,strokeWidth:r,shadowEnabled:s,shadowForStrokeEnabled:o,strokeScaleEnabled:i,scaleX:l,scaleY:a,parent:c}=t;if(n&&0!==r){if(s&&!o&&this.__removeShadow(e),e.save(),i&&c){let t=this.__getObjectScaling();e.scale(1/t.scaleX,1/t.scaleY)}else i&&(l=null!=l?l:1,a=null!=a?a:1,e.scale(1/l,1/a));this.__setLineDash(e),this.__setStrokeStyles(e,t),e.stroke(),e.restore()}}static __getObjectScaling(){return{scaleX:1,scaleY:1}}static __removeShadow(e){}static __setFillStyles(e,t){e.fillStyle=t.fill}static __setStrokeStyles(e,t){const{strokeWidth:n,strokeLineCap:r,strokeDashOffset:s,strokeLineJoin:o,strokeMiterLimit:i,stroke:l}=t;e.lineWidth=n,e.lineCap=r,e.lineDashOffset=s,e.lineJoin=o,e.miterLimit=i,e.strokeStyle=l}static __setLineDash(e){}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{minX:e,maxX:n,minY:r,maxY:s}=Ra(this,t);if(this.width+this.strokeWidth<e||n<0||this.height+this.strokeWidth<r||s<0)return this}const n=this.transform.getMatrix();if(e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const e=this._cacheCanvas.getContext();this._cacheCanvas.clear(),e.save(),e.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(e),e.restore()}this._applyCache(e)}else this._draw(e);return e.restore(),this.makeDirty(!1),this}setProps(e){if(!e)return;const t=Object.keys(e);return 0!==t.length?(t.forEach((t=>{if(void 0===e[t])return!0;-1===ya.indexOf(t)&&(this[`_${t}`]=e[t])})),this.makeDirty(!0),this):void 0}resizeCacheCanvas(){var e;null==(e=this._cacheCanvas)||e.setSize(this.width+this.strokeWidth,this.height+this.strokeWidth),this.makeDirty(!0)}scaleCacheCanvas(){var e,t,n;let r=(null==(e=this.getParent())?void 0:e.ancestorScaleX)||1,s=(null==(t=this.getParent())?void 0:t.ancestorScaleX)||1;null==(n=this._cacheCanvas)||n.setPixelRatio(Math.max(r,s)*Ia()),this.makeDirty(!0)}toJson(){const e={};return Da.forEach((t=>{this[t]&&(e[t]=this[t])})),__spreadValues(__spreadValues({},super.toJson()),e)}_applyCache(e){if(!e||!this._cacheCanvas)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,r=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,r,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}_draw(e){}_initialProps(e){if(!e)return;const t=Object.keys(e);if(0===t.length)return;const n={};let r=!1;t.forEach((t=>{if(void 0===e[t])return!0;ya.indexOf(t)>-1?(n[t]=e[t],r=!0):this[`_${t}`]=e[t]})),r&&this.transformByState(n),this.makeDirty(!0)}}const Ba=["radius"];class Ha extends Pa{constructor(e,t){super(e,t),(null==t?void 0:t.radius)&&(this._radius=null==t?void 0:t.radius)}get radius(){return this._radius}static drawWith(e,t){let{radius:n,width:r,height:s}=t;if(n=null!=n?n:0,r=null!=r?r:30,s=null!=s?s:30,e.beginPath(),t.strokeDashArray&&e.setLineDash(t.strokeDashArray),n){let t=0,o=0,i=0,l=0;t=o=i=l=Math.min(n,r/2,s/2),e.moveTo(t,0),e.lineTo(r-o,0),e.arc(r-o,o,o,3*Math.PI/2,0,!1),e.lineTo(r,s-l),e.arc(r-l,s-l,l,0,Math.PI/2,!1),e.lineTo(i,s),e.arc(i,s-i,i,Math.PI/2,Math.PI,!1),e.lineTo(0,t),e.arc(t,t,t,Math.PI,3*Math.PI/2,!1)}else e.rect(0,0,r,s);e.closePath(),this._renderPaintInOrder(e,t)}toJson(){const e={};return Ba.forEach((t=>{this[t]&&(e[t]=this[t])})),__spreadValues(__spreadValues({},super.toJson()),e)}_draw(e){Ha.drawWith(e,this)}}const Fa=["pointsGroup"];class za extends Pa{constructor(e,t){super(e,t),this._pointsGroup=(null==t?void 0:t.pointsGroup)||[[]],this._setFixBoundingBox(),this.onTransformChangeObservable.add((e=>{const{type:t,value:n,preValue:r}=e;t!==Cl.resize&&t!==Cl.all||this.resizePolygon(r)}))}get pointsGroup(){return this._pointsGroup}static drawWith(e,t){let{pointsGroup:n}=t;n=null!=n?n:[[]],t.strokeDashArray&&e.setLineDash(t.strokeDashArray),e.beginPath();for(let r of n){e.moveTo(r[0].x,r[0].y);for(let t=1;t<r.length;t++){const n=r[t];e.lineTo(n.x,n.y)}}e.closePath(),this._renderPaintInOrder(e,t)}updatePointGroup(e){this._pointsGroup=e,this._setFixBoundingBox()}resizePolygon(e){const{left:t,top:n,width:r,height:s}=this._getSelfRect(),{width:o,height:i}=e;let l,a;l=o?this.width-o:0,a=i?this.height-i:0;const c=l/r,h=a/s;this.scaleX+=c,this.scaleY+=h,this.left=this.left-t*c,this.top=this.top-n*h,this._setTransForm()}toJson(){const e={};return Fa.forEach((t=>{this[t]&&(e[t]=this[t])})),__spreadValues(__spreadValues({},super.toJson()),e)}getState(){const{left:e,top:t,width:n,height:r}=this.getRect();return{left:e,top:t,width:n,height:r,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:e,top:t,width:n,height:r}=this._getSelfRect();return{left:e*this.scaleX+this.left,top:t*this.scaleY+this.top,width:n*this.scaleX,height:r*this.scaleY}}_draw(e){za.drawWith(e,this)}_setFixBoundingBox(){const{width:e,height:t,left:n,top:r}=this._getSelfRect();this.left=this.left+n,this.top=this.top+r,this.width=e,this.height=t;const s=this.pointsGroup;for(let o of s)for(let e of o)e.x-=n,e.y-=r;this._setTransForm()}_getSelfRect(){const e=this.pointsGroup;let t=e[0][0].x,n=e[0][0].x,r=e[0][0].y,s=e[0][0].y;for(let o of e)for(let e of o)t=Math.min(t,e.x),n=Math.max(n,e.x),r=Math.min(r,e.y),s=Math.max(s,e.y);return{left:t,top:r,width:n-t,height:s-r}}}const Ua=17;class Wa{constructor(e,t){this._thumbMargin=2,this._thumbLengthRatio=1,this._thumbBackgroundColor=Al(Li.black,.2),this._thumbHoverBackgroundColor=Al(Li.black,.35),this._thumbActiveBackgroundColor=Al(Li.black,.4),this._barSize=14,this._barBackgroundColor=Al(Li.white),this._barBorder=1,this._barBorderColor=Al([218,220,224]),this._enableHorizontal=!0,this._enableVertical=!0,this._verticalMinusMiniThumb=0,this._horizontalMinusMiniThumb=0,this._isHorizonMove=!1,this._isVerticalMove=!1,e||console.warn("Missing viewport"),this._view=e,this.setProps(t),this._initialScrollRect(),this._view.setScrollBar(this)}get limitX(){return this._horizonThumbRect.visible?this._horizontalBarWidth-this._horizontalThumbWidth:0}get limitY(){return this._verticalThumbRect.visible?this._verticalBarHeight-this._verticalThumbHeight:0}get horizontalThumbWidth(){return this._horizontalThumbWidth}get verticalThumbHeight(){return this._verticalThumbHeight}get ratioScrollX(){return void 0===this._horizontalThumbWidth||void 0===this._horizontalBarWidth?1:(this._horizontalThumbWidth-this._horizontalMinusMiniThumb)/this._horizontalBarWidth}get ratioScrollY(){return void 0===this._verticalThumbHeight||void 0===this._verticalBarHeight?1:(this._verticalThumbHeight-this._verticalMinusMiniThumb)/this._verticalBarHeight}get barSize(){return this._barSize}get barBorder(){return this._barBorder}static attachTo(e,t){return new Wa(e,t)}setProps(e){if(!e)return;const t=Object.keys(e);0!==t.length&&t.forEach((t=>{void 0!==e[t]&&(this[`_${t}`]=e[t])}))}render(e,t=0,n=0){let{scrollX:r,scrollY:s}=this._view;e.save();const o=new da([1,0,0,1,t,n]).getMatrix();e.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this._horizonBarRect.render(e),this._horizonThumbRect.translate(r).render(e),this._verticalBarRect.render(e),this._verticalThumbRect.translate(void 0,s).render(e),this._placeholderBarRect.render(e),e.restore()}resize(e=0,t=0,n=0,r=0){var s,o,i,l,a,c,h,u,d,g,f;0===e&&0===e||(this._enableHorizontal&&(this._horizontalMinusMiniThumb=0,this._horizontalBarWidth=e-this._barSize,this._horizontalThumbWidth=this._horizontalBarWidth*(this._horizontalBarWidth-this._barBorder)/n*this._thumbLengthRatio,this._horizontalThumbWidth<Ua&&(this._horizontalMinusMiniThumb=Ua-this._horizontalThumbWidth,this._horizontalThumbWidth=Ua),null==(s=this._horizonBarRect)||s.transformByState({left:0,top:t-this._barSize,width:this._horizontalBarWidth,height:this._barSize-this._barBorder}),this._horizontalThumbWidth>=e?null==(o=this._horizonThumbRect)||o.setProps({visible:!1}):((null==(i=this._horizonThumbRect)?void 0:i.visible)||null==(l=this._horizonThumbRect)||l.setProps({visible:!0}),null==(a=this._horizonThumbRect)||a.transformByState({left:this._view.scrollX,top:t-this._barSize+this._thumbMargin,width:this._horizontalThumbWidth,height:this._barSize-2*this._thumbMargin}))),this._enableVertical&&(this._verticalMinusMiniThumb=0,this._verticalBarHeight=t-this._barSize,this._verticalThumbHeight=this._verticalBarHeight*(this._verticalBarHeight-this._barBorder)/r*this._thumbLengthRatio,this._verticalThumbHeight<Ua&&(this._verticalMinusMiniThumb=Ua-this._verticalThumbHeight,this._verticalThumbHeight=Ua),null==(c=this._verticalBarRect)||c.transformByState({left:e-this._barSize,top:0,width:this._barSize-this._barBorder,height:this._verticalBarHeight}),this._verticalThumbHeight>=t?null==(h=this._verticalThumbRect)||h.setProps({visible:!1}):((null==(u=this._verticalThumbRect)?void 0:u.visible)||null==(d=this._verticalThumbRect)||d.setProps({visible:!0}),null==(g=this._verticalThumbRect)||g.transformByState({left:e-this._barSize+this._thumbMargin,top:this._view.scrollY,width:this._barSize-2*this._thumbMargin,height:this._verticalThumbHeight}))),this._enableHorizontal&&this._enableVertical&&(null==(f=this._placeholderBarRect)||f.transformByState({left:e-this._barSize,top:t-this._barSize,width:this._barSize-this._barBorder,height:this._barSize-this._barBorder})))}makeDirty(e){var t,n,r,s,o;null==(t=this._horizonBarRect)||t.makeDirty(e),null==(n=this._horizonThumbRect)||n.makeDirty(e),null==(r=this._verticalBarRect)||r.makeDirty(e),null==(s=this._verticalThumbRect)||s.makeDirty(e),null==(o=this._placeholderBarRect)||o.makeDirty(e),this.makeViewDirty(e)}makeViewDirty(e){this._view.makeDirty(e);const t=this._view.scene.getParent();t.classType===el.SCENE_VIEWER&&t.makeDirty(!0)}pick(e){var t,n,r,s;return(null==(t=this._horizonThumbRect)?void 0:t.isHit(e))?this._horizonThumbRect:(null==(n=this._verticalThumbRect)?void 0:n.isHit(e))?this._verticalThumbRect:(null==(r=this._horizonBarRect)?void 0:r.isHit(e))?this._horizonBarRect:(null==(s=this._verticalBarRect)?void 0:s.isHit(e))?this._verticalBarRect:null}dispose(){this._horizonBarRect.dispose(),this._horizonThumbRect.dispose(),this._verticalBarRect.dispose(),this._verticalThumbRect.dispose(),this._placeholderBarRect.dispose()}_initialScrollRect(){this._enableHorizontal&&(this._horizonBarRect=new Ha("__horizonBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._horizonThumbRect=new Ha("__horizonThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableVertical&&(this._verticalBarRect=new Ha("__verticalBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._verticalThumbRect=new Ha("__verticalThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableHorizontal&&this._enableVertical&&(this._placeholderBarRect=new Ha("__placeholderBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor})),this.__initialEvent()}__initialEvent(){const e=this._mainScene||this._view.scene,t=(e,t)=>(n,r)=>{if(this._isHorizonMove||this._isVerticalMove)return;t.setProps({fill:e}),this.makeViewDirty(!0)};this._enableHorizontal&&(this._horizonThumbRect.on(Pi.PointerEnter,t(this._thumbHoverBackgroundColor,this._horizonThumbRect)),this._horizonThumbRect.on(Pi.PointerLeave,t(this._thumbBackgroundColor,this._horizonThumbRect)),this._horizonBarRect.on(Pi.PointerDown,((e,t)=>{const n=e;this._view.scrollTo({x:n.offsetX-this._view.left-this._horizontalThumbWidth/2}),t.stopPropagation()})),this._horizonThumbRect.on(Pi.PointerDown,((t,n)=>{const r=t;this._isHorizonMove=!0,this._lastX=r.offsetX,this._lastY=r.offsetY,this._horizonThumbRect.setProps({fill:this._thumbActiveBackgroundColor}),this.makeViewDirty(!0),e.disableEvent(),n.stopPropagation()})),e.on(Pi.PointerMove,((e,t)=>{const n=e;this._isHorizonMove&&(this._view.scrollBy({x:n.offsetX-this._lastX}),this._lastX=n.offsetX)})),e.on(Pi.PointerUp,((t,n)=>{const r=this._horizonThumbRect;this._isHorizonMove=!1,e.enableEvent(),r.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)}))),this._enableVertical&&(this._verticalThumbRect.on(Pi.PointerEnter,t(this._thumbHoverBackgroundColor,this._verticalThumbRect)),this._verticalThumbRect.on(Pi.PointerLeave,t(this._thumbBackgroundColor,this._verticalThumbRect)),this._verticalBarRect.on(Pi.PointerDown,((e,t)=>{const n=e;this._view.scrollTo({y:n.offsetY-this._view.top-this._verticalThumbHeight/2}),t.stopPropagation()})),this._verticalThumbRect.on(Pi.PointerDown,((t,n)=>{const r=t,s=this._verticalThumbRect;this._isVerticalMove=!0,this._lastX=r.offsetX,this._lastY=r.offsetY,s.setProps({fill:this._thumbActiveBackgroundColor}),e.disableEvent(),this.makeViewDirty(!0),n.stopPropagation()})),e.on(Pi.PointerMove,((e,t)=>{const n=e;this._isVerticalMove&&(this._view.scrollBy({y:n.offsetY-this._lastY}),this._lastY=n.offsetY)})),e.on(Pi.PointerUp,((t,n)=>{const r=this._verticalThumbRect;this._isVerticalMove=!1,e.enableEvent(),r.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)})))}}class Va extends Pa{constructor(e,t){super(e,t),this._props=__spreadValues({autoWidth:!1,autoHeight:!1},t),t.image?(this._native=t.image,this._init()):t.url&&(this._native=document.createElement("img"),this._native.src=t.url,this._native.onload=()=>{var e;null==(e=t.success)||e.call(t),this._init(),this.makeDirty(!0)},this._native.onerror=()=>{t.fail?t.fail():(this._native.src="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTMwNC4xMjggNDU2LjE5MmM0OC42NCAwIDg4LjA2NC0zOS40MjQgODguMDY0LTg4LjA2NHMtMzkuNDI0LTg4LjA2NC04OC4wNjQtODguMDY0LTg4LjA2NCAzOS40MjQtODguMDY0IDg4LjA2NCAzOS40MjQgODguMDY0IDg4LjA2NCA4OC4wNjR6bTAtMTE2LjIyNGMxNS4zNiAwIDI4LjE2IDEyLjI4OCAyOC4xNiAyOC4xNnMtMTIuMjg4IDI4LjE2LTI4LjE2IDI4LjE2LTI4LjE2LTEyLjI4OC0yOC4xNi0yOC4xNiAxMi4yODgtMjguMTYgMjguMTYtMjguMTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PHBhdGggZD0iTTg4Ny4yOTYgMTU5Ljc0NEgxMzYuNzA0Qzk2Ljc2OCAxNTkuNzQ0IDY0IDE5MiA2NCAyMzIuNDQ4djU1OS4xMDRjMCAzOS45MzYgMzIuMjU2IDcyLjcwNCA3Mi43MDQgNzIuNzA0aDE5OC4xNDRMNTAwLjIyNCA2ODguNjRsLTM2LjM1Mi0yMjIuNzIgMTYyLjMwNC0xMzAuNTYtNjEuNDQgMTQzLjg3MiA5Mi42NzIgMjE0LjAxNi0xMDUuNDcyIDE3MS4wMDhoMzM1LjM2QzkyNy4yMzIgODY0LjI1NiA5NjAgODMyIDk2MCA3OTEuNTUyVjIzMi40NDhjMC0zOS45MzYtMzIuMjU2LTcyLjcwNC03Mi43MDQtNzIuNzA0em0tMTM4Ljc1MiA3MS42OHYuNTEySDg1Ny42YzE2LjM4NCAwIDMwLjIwOCAxMy4zMTIgMzAuMjA4IDMwLjIwOHYzOTkuODcyTDY3My4yOCA0MDguMDY0bDc1LjI2NC0xNzYuNjR6TTMwNC42NCA3OTIuMDY0SDE2NS44ODhjLTE2LjM4NCAwLTMwLjIwOC0xMy4zMTItMzAuMjA4LTMwLjIwOHYtOS43MjhsMTM4Ljc1Mi0xNjQuMzUyIDEwNC45NiAxMjQuNDE2LTc0Ljc1MiA3OS44NzJ6bTgxLjkyLTM1NS44NGwzNy4zNzYgMjI4Ljg2NC0uNTEyLjUxMi0xNDIuODQ4LTE2OS45ODRjLTMuMDcyLTMuNTg0LTkuMjE2LTMuNTg0LTEyLjI4OCAwTDEzNS42OCA2NTIuOFYyNjIuMTQ0YzAtMTYuMzg0IDEzLjMxMi0zMC4yMDggMzAuMjA4LTMwLjIwOGg0NzQuNjI0TDM4Ni41NiA0MzYuMjI0em01MDEuMjQ4IDMyNS42MzJjMCAxNi44OTYtMTMuMzEyIDMwLjIwOC0yOS42OTYgMzAuMjA4SDY4MC45Nmw1Ny4zNDQtOTMuMTg0LTg3LjU1Mi0yMDIuMjQgNy4xNjgtNy42OCAyMjkuODg4IDI3Mi44OTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PC9zdmc+",this._init(),this.makeDirty(!0))})}static drawWith(e,t){var n;if(null==(n=t._native)?void 0:n.complete){const{width:n,height:s}=t;try{e.drawImage(t._native,0,0,n,s)}catch(r){console.error(r)}}}static create(e,t,n){return new Va(e,{url:t,success:n})}_draw(e){Va.drawWith(e,this)}_init(){this._props.autoWidth&&this.resize(this._native.width),this._props.autoHeight&&this.resize(void 0,this._native.height)}}const ja=["dataArray"];class Ya extends Pa{constructor(e,t){super(e,t),this.pathLength=0,this._reCalculateCache=!0,(null==t?void 0:t.data)?this._dataArray=Ya.parsePathData(t.data):(null==t?void 0:t.dataArray)&&(this._dataArray=t.dataArray);for(let n=0;n<this.dataArray.length;++n)this.pathLength+=this.dataArray[n].pathLength;this._setFixBoundingBox(),this.onTransformChangeObservable.add((e=>{const{type:t,value:n,preValue:r}=e;if(t===Cl.resize||t===Cl.all){this._reCalculateCache=!0;const{left:e,top:t,width:n,height:s}=this._getSelfRect(),{width:o,height:i}=r;let l,a;l=o?this.width-o:0,a=i?this.height-i:0;const c=l/n,h=a/s;this.scaleX+=c,this.scaleY+=h,this.left=this.left-e*c,this.top=this.top-t*h,this._setTransForm()}}))}get dataArray(){return this._dataArray}static drawWith(e,t){const n=t.dataArray;if(n){e.beginPath();for(let t=0;t<n.length;t++){let r=n[t].command,s=n[t].points;switch(r){case"L":e.lineTo(s[0],s[1]);break;case"M":e.moveTo(s[0],s[1]);break;case"C":e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":e.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":{const t=s[0],n=s[1],r=s[2],o=s[3],i=s[4],l=s[5],a=s[6],c=s[7],h=r>o?r:o,u=r>o?1:r/o,d=r>o?o/r:1;e.translate(t,n),e.rotate(a),e.scale(u,d),e.arc(0,0,h,i,i+l,!!(1-c)),e.scale(1/u,1/d),e.rotate(-a),e.translate(-t,-n);break}case"z":e.closePath()}}this._renderPaintInOrder(e,t)}}static getLineLength(e,t,n,r){return Math.sqrt((n-e)*(n-e)+(r-t)*(r-t))}static getPointOnLine(e,t,n,r,s,o,i){void 0===o&&(o=t),void 0===i&&(i=n);let l=(s-n)/(r-t+1e-8),a=Math.sqrt(e*e/(1+l*l));r<t&&(a*=-1);let c,h=l*a;if(r===t)c={x:o,y:i+h};else if((i-n)/(o-t+1e-8)===l)c={x:o+a,y:i+h};else{let u,d,g=this.getLineLength(t,n,r,s),f=(o-t)*(r-t)+(i-n)*(s-n);f/=g*g,u=t+f*(r-t),d=n+f*(s-n);let m=this.getLineLength(o,i,u,d),p=Math.sqrt(e*e-m*m);a=Math.sqrt(p*p/(1+l*l)),r<t&&(a*=-1),h=l*a,c={x:u+a,y:d+h}}return c}static getPointOnCubicBezier(e,t,n,r,s,o,i,l,a){function c(e){return e*e*e}function h(e){return 3*e*e*(1-e)}function u(e){return 3*e*(1-e)*(1-e)}function d(e){return(1-e)*(1-e)*(1-e)}return{x:l*c(e)+o*h(e)+r*u(e)+t*d(e),y:a*c(e)+i*h(e)+s*u(e)+n*d(e)}}static getPointOnQuadraticBezier(e,t,n,r,s,o,i){function l(e){return e*e}function a(e){return 2*e*(1-e)}function c(e){return(1-e)*(1-e)}return{x:o*l(e)+r*a(e)+t*c(e),y:i*l(e)+s*a(e)+n*c(e)}}static getPointOnEllipticalArc(e,t,n,r,s,o){let i=Math.cos(o),l=Math.sin(o),a=n*Math.cos(s),c=r*Math.sin(s);return{x:e+(a*i-c*l),y:t+(a*l+c*i)}}static parsePathData(e){if(!e)return[];let t=e,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(let h=0,u=n.length;h<u;h++)t=t.replace(new RegExp(n[h],"g"),`|${n[h]}`);let r,s=t.split("|"),o=[],i=[],l=0,a=0,c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(let h=1,u=s.length;h<u;h++){let e=s[h],t=e.charAt(0);for(e=e.slice(1),i.length=0;r=c.exec(e);)i.push(r[0]);let n=[];for(let r=0,s=i.length;r<s;r++){if("00"===i[r]){n.push(0,0);continue}let e=parseFloat(i[r]);isNaN(e)?n.push(0):n.push(e)}for(;n.length>0&&!isNaN(n[0]);){let e,r,s,i,c,h,u,d,g,f,m,p=[],b=l,_=a;switch(t){case"l":l+=n.shift()||0,a+=n.shift()||0,e="L",p.push(l,a);break;case"L":l=n.shift()||0,a=n.shift()||0,p.push(l,a);break;case"m":{let r=n.shift()||0,s=n.shift()||0;if(l+=r,a+=s,e="M",o.length>2&&"z"===o[o.length-1].command)for(let e=o.length-2;e>=0;e--)if("M"===o[e].command){l=o[e].points[0]+r,a=o[e].points[1]+s;break}p.push(l,a),t="l";break}case"M":l=n.shift()||0,a=n.shift()||0,e="M",p.push(l,a),t="L";break;case"h":l+=n.shift()||0,e="L",p.push(l,a);break;case"H":l=n.shift()||0,e="L",p.push(l,a);break;case"v":a+=n.shift()||0,e="L",p.push(l,a);break;case"V":a=n.shift()||0,e="L",p.push(l,a);break;case"C":p.push(n.shift()||0,n.shift()||0,n.shift()||0,n.shift()||0),l=n.shift()||0,a=n.shift()||0,p.push(l,a);break;case"c":p.push(l+(n.shift()||0),a+(n.shift()||0),l+(n.shift()||0),a+(n.shift()||0)),l+=n.shift()||0,a+=n.shift()||0,e="C",p.push(l,a);break;case"S":s=l,i=a,r=o[o.length-1],"C"===r.command&&(s=l+(l-r.points[2]),i=a+(a-r.points[3])),p.push(s,i,n.shift()||0,n.shift()||0),l=n.shift()||0,a=n.shift()||0,e="C",p.push(l,a);break;case"s":s=l,i=a,r=o[o.length-1],"C"===r.command&&(s=l+(l-r.points[2]),i=a+(a-r.points[3])),p.push(s,i,l+(n.shift()||0),a+(n.shift()||0)),l+=n.shift()||0,a+=n.shift()||0,e="C",p.push(l,a);break;case"Q":p.push(n.shift()||0,n.shift()||0),l=n.shift()||0,a=n.shift()||0,p.push(l,a);break;case"q":p.push(l+(n.shift()||0),a+(n.shift()||0)),l+=n.shift()||0,a+=n.shift()||0,e="Q",p.push(l,a);break;case"T":s=l,i=a,r=o[o.length-1],"Q"===r.command&&(s=l+(l-r.points[0]),i=a+(a-r.points[1])),l=n.shift()||0,a=n.shift()||0,e="Q",p.push(s,i,l,a);break;case"t":s=l,i=a,r=o[o.length-1],"Q"===r.command&&(s=l+(l-r.points[0]),i=a+(a-r.points[1])),l+=n.shift()||0,a+=n.shift()||0,e="Q",p.push(s,i,l,a);break;case"A":c=n.shift()||0,h=n.shift()||0,u=n.shift()||0,d=n.shift()||0,g=n.shift()||0,f=l,m=a,l=n.shift()||0,a=n.shift()||0,e="A",p=this.convertEndpointToCenterParameterization(f,m,l,a,d,g,c,h,u);break;case"a":c=n.shift()||0,h=n.shift()||0,u=n.shift()||0,d=n.shift()||0,g=n.shift()||0,f=l,m=a,l+=n.shift()||0,a+=n.shift()||0,e="A",p=this.convertEndpointToCenterParameterization(f,m,l,a,d,g,c,h,u)}o.push({command:e||t,points:p,start:{x:b,y:_},pathLength:this.calcLength(b,_,e||t,p)})}"z"!==t&&"Z"!==t||o.push({command:"z",points:[],start:{x:0,y:0},pathLength:0})}return o}static calcLength(e,t,n,r){let s,o,i,l,a=Ya;switch(n){case"L":return a.getLineLength(e,t,r[0],r[1]);case"C":for(s=0,o=a.getPointOnCubicBezier(0,e,t,r[0],r[1],r[2],r[3],r[4],r[5]),l=.01;l<=1;l+=.01)i=a.getPointOnCubicBezier(l,e,t,r[0],r[1],r[2],r[3],r[4],r[5]),s+=a.getLineLength(o.x,o.y,i.x,i.y),o=i;return s;case"Q":for(s=0,o=a.getPointOnQuadraticBezier(0,e,t,r[0],r[1],r[2],r[3]),l=.01;l<=1;l+=.01)i=a.getPointOnQuadraticBezier(l,e,t,r[0],r[1],r[2],r[3]),s+=a.getLineLength(o.x,o.y,i.x,i.y),o=i;return s;case"A":{s=0;let e=r[4],t=r[5],n=r[4]+t,c=Math.PI/180;if(Math.abs(e-n)<c&&(c=Math.abs(e-n)),o=a.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],e,0),t<0)for(l=e-c;l>n;l-=c)i=a.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],l,0),s+=a.getLineLength(o.x,o.y,i.x,i.y),o=i;else for(l=e+c;l<n;l+=c)i=a.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],l,0),s+=a.getLineLength(o.x,o.y,i.x,i.y),o=i;return i=a.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],n,0),s+=a.getLineLength(o.x,o.y,i.x,i.y),s}}return 0}static convertEndpointToCenterParameterization(e,t,n,r,s,o,i,l,a){let c=a*(Math.PI/180),h=Math.cos(c)*(e-n)/2+Math.sin(c)*(t-r)/2,u=-1*Math.sin(c)*(e-n)/2+Math.cos(c)*(t-r)/2,d=h*h/(i*i)+u*u/(l*l);d>1&&(i*=Math.sqrt(d),l*=Math.sqrt(d));let g=Math.sqrt((i*i*(l*l)-i*i*(u*u)-l*l*(h*h))/(i*i*(u*u)+l*l*(h*h)));s===o&&(g*=-1),isNaN(g)&&(g=0);let f=g*i*u/l,m=g*-l*h/i,p=(e+n)/2+Math.cos(c)*f-Math.sin(c)*m,b=(t+r)/2+Math.sin(c)*f+Math.cos(c)*m,_=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),v=(e,t)=>(e[0]*t[0]+e[1]*t[1])/(_(e)*_(t)),C=(e,t)=>(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(v(e,t)),T=C([1,0],[(h-f)/i,(u-m)/l]),w=[(h-f)/i,(u-m)/l],y=[(-1*h-f)/i,(-1*u-m)/l],S=C(w,y);return v(w,y)<=-1&&(S=Math.PI),v(w,y)>=1&&(S=0),0===o&&S>0&&(S-=2*Math.PI),1===o&&S<0&&(S+=2*Math.PI),[p,b,i,l,T,S,c,o]}toJson(){const e={};return ja.forEach((t=>{this[t]&&(e[t]=this[t])})),__spreadValues(__spreadValues({},super.toJson()),e)}getState(){const{left:e,top:t,width:n,height:r}=this.getRect();return{left:e,top:t,width:n,height:r,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:e,top:t,width:n,height:r}=this._getSelfRect();return{left:e*this.scaleX+this.left,top:t*this.scaleY+this.top,width:n*this.scaleX,height:r*this.scaleY}}getLength(){return this.pathLength}getPointAtLength(e){let t,n=0,r=this.dataArray.length;if(!r)return null;for(;n<r&&e>this.dataArray[n].pathLength;)e-=this.dataArray[n].pathLength,++n;if(n===r)return t=this.dataArray[n-1].points.slice(-2),{x:t[0],y:t[1]};if(e<.01)return t=this.dataArray[n].points.slice(0,2),{x:t[0],y:t[1]};let s=this.dataArray[n],o=s.points;switch(s.command){case"L":return Ya.getPointOnLine(e,s.start.x,s.start.y,o[0],o[1]);case"C":return Ya.getPointOnCubicBezier(e/s.pathLength,s.start.x,s.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return Ya.getPointOnQuadraticBezier(e/s.pathLength,s.start.x,s.start.y,o[0],o[1],o[2],o[3]);case"A":{let t=o[0],n=o[1],r=o[2],i=o[3],l=o[4],a=o[5],c=o[6];return l+=a*e/s.pathLength,Ya.getPointOnEllipticalArc(t,n,r,i,l,c)}}return null}_draw(e){Ya.drawWith(e,this)}_setFixBoundingBox(){const{left:e,top:t,width:n,height:r}=this._getSelfRect(),s=this.width/n,o=this.height/r;this.left=this.left-e*s,this.top=this.top-t*o,this.scaleX=s,this.scaleY=o,this.width=n,this.height=r,this._setTransForm()}_getSelfRect(){if(!this._reCalculateCache)return this._selfRectCache;let e=[];this.dataArray.forEach((t=>{if("A"===t.command){let n=t.points[4],r=t.points[5],s=t.points[4]+r,o=Math.PI/180;if(Math.abs(n-s)<o&&(o=Math.abs(n-s)),r<0)for(let i=n-o;i>s;i-=o){const n=Ya.getPointOnEllipticalArc(t.points[0],t.points[1],t.points[2],t.points[3],i,0);e.push(n.x,n.y)}else for(let i=n+o;i<s;i+=o){const n=Ya.getPointOnEllipticalArc(t.points[0],t.points[1],t.points[2],t.points[3],i,0);e.push(n.x,n.y)}}else if("C"===t.command)for(let n=0;n<=1;n+=.01){const r=Ya.getPointOnCubicBezier(n,t.start.x,t.start.y,t.points[0],t.points[1],t.points[2],t.points[3],t.points[4],t.points[5]);e.push(r.x,r.y)}else e=e.concat(t.points)}));let t,n,r=e[0],s=e[0],o=e[1],i=e[1];for(let a=0;a<e.length/2;a++)t=e[2*a],n=e[2*a+1],isNaN(t)||(r=Math.min(r,t),s=Math.max(s,t)),isNaN(n)||(o=Math.min(o,n),i=Math.max(i,n));const l={left:r,top:o,width:s-r,height:i-o};return this._selfRectCache=l,l}}const Ga=["radius"];class Xa extends Pa{constructor(e,t){super(e,t),this._radius=(null==t?void 0:t.radius)||10,this._setFixBoundingBox(),this.onTransformChangeObservable.add((e=>{const{type:t,value:n,preValue:r}=e;if(t===Cl.resize||t===Cl.all){const e=Math.min(this.width,this.height);this._radius=e/2,this.width=e,this.height=e,this._setTransForm()}}))}get radius(){return this._radius}static drawWith(e,t){let{radius:n}=t;n=null!=n?n:10,e.beginPath(),t.strokeDashArray&&e.setLineDash(t.strokeDashArray),e.beginPath(),e.arc(n,n,n||0,0,2*Math.PI,!1),e.closePath(),this._renderPaintInOrder(e,t)}toJson(){const e={};return Ga.forEach((t=>{this[t]&&(e[t]=this[t])})),__spreadValues(__spreadValues({},super.toJson()),e)}_draw(e){Xa.drawWith(e,this)}_setFixBoundingBox(){this.transformByState({width:2*this._radius,height:2*this._radius})}}function $a(e){return null==e?void 0:e[e.length-1]}function Qa(e){var t;return null==(t=null==e?void 0:e.sections)?void 0:t[e.sections.length-1]}function Ka(e){var t;const n=null==(t=ec(e))?void 0:t.column.lines;return null==n?void 0:n[n.length-1]}function Za(e){return e.lines[e.lines.length-1]}function qa(e){const{width:t,marginLeft:n,marginRight:r}=e;return t-n-r}function Ja(e){var t;const n=null==(t=e.parent)?void 0:t.parent;if(n)return n}function ec(e){const t=Qa(e);for(let n=0;n<t.columns.length;n++){const e=t.columns[n];if(!e.isFull)return{column:e,isLast:n===t.columns.length-1,index:n}}}function tc(e){const t=Ka(e);if(t)for(let n=0;n<t.divides.length;n++){const e=t.divides[n];if(!e.isFull)return{divide:e,isLast:n===t.divides.length-1,index:n}}}function nc(e){const t=Qa(e),n=t.columns.length;for(let r=0;r<n;r++){if(!t.columns[r].isFull)return!1}return!0}function rc(e){if(e.sections.length>1)return!1;const t=Qa(e),n=t.columns.length;for(let r=0;r<n;r++){if(!sc(t.columns[r]))return!1}return!0}function sc(e){const t=e.lines;if(t.length>1)return!1;return function(e){if(!e)return!0;for(let t=0;t<e.divides.length;t++){const n=e.divides[t].spanGroup.length;if(n>1)return!1;if(1===n){const n=e.divides[t].spanGroup[0],{spanType:r}=n;if(r!==hl.TAB&&r!==hl.LIST)return!1}}return!0}(t[t.length-1])}function oc(e,t){if(e instanceof Object){const{v:n,u:r}=e;return r===le.POINT?n:n*t}return e}function ic(e=0,t,n=x.LINES,r=vt.TRUE){let s=1;return lc(n,r)&&(s=e),s*=t,s}function lc(e=x.LINES,t=vt.FALSE){return t===vt.TRUE&&(e===x.LINES_AND_CHARS||e===x.SNAP_TO_CHARS)}function ac(e,t){const{paragraphStyle:n={}}=t,{linePitch:r=15.6,gridType:s=x.LINES,paragraphLineGapDefault:o=0}=e,{lineSpacing:i=1,spacingRule:l=Y.AUTO,snapToGrid:a=vt.TRUE}=n;return{paragraphLineGapDefault:o,linePitch:r,gridType:s,lineSpacing:i,spacingRule:l,snapToGrid:a}}function cc(e,t){const{paragraphStyle:n={}}=t,{charSpace:r=0,gridType:s=x.LINES,defaultTabStop:o=36,documentTextStyle:i={}}=e,{fs:l=ji}=i,{snapToGrid:a=vt.TRUE}=n;return{charSpace:r,documentFontSize:l,defaultTabStop:o,gridType:s,snapToGrid:a}}function hc(e,t=-1){e[0];let n=t;for(let r of e){const{sections:e}=r;let t=n,s=t,o=-1/0,i=0;for(let n of e){const{columns:e}=n;let t=s,r=t,l=-1/0;for(let n of e){const{lines:e}=n;let t=r,s=t,i=0,a=-1/0,c=null;for(let n of e){const{divides:e,lineHeight:t}=n;let r=s,o=r,l=0,h=0;i+=t;const u=e.length;for(let n=0;n<u;n++){const t=e[n],{spanGroup:r}=t;if(0===r.length)continue;let s=o,i=s;for(let e of r){i+=e.spanType===hl.LIST?0:e.count||1;const r=e.bBox,{ba:s}=r;h=Math.max(h,s),n===u-1&&t.width===1/0&&(l+=e.width)}n===u-1&&(t.width===1/0?t.width=l:l+=t.width,l+=t.left),t.st=0===s?0:s+1,t.ed=i>=t.st?i:t.st,o=t.ed}n.st=0===r?0:r+1,n.ed=o>=n.st?o:n.st,n.width=l,n.asc=h,a=Math.max(a,l),n.top=((null==c?void 0:c.top)||0)+((null==c?void 0:c.lineHeight)||0),c=n,s=n.ed}n.st=0===t?0:t+1,n.ed=s>=n.st?s:n.st,n.height=i,n.width===1/0&&(n.width=a),o=Math.max(o,a),l=Math.max(l,n.height),r=n.ed}n.st=0===t?0:t+1,n.ed=r>=n.st?r:n.st,n.height=l,i+=l,s=n.ed}r.st=0===t?0:t+1,r.ed=s>=r.st?s:r.st,r.height=i,r.width=o,n=r.ed}}function uc(e,t){for(let n of e){const{sections:e}=n;for(let n of e){const{columns:e}=n;for(let n of e){const{lines:e}=n;for(let n of e)t&&Fl(t)&&t(n)}}}}function dc(e,t){for(let n of e){const{sections:e}=n;for(let n of e){const{columns:e}=n;for(let n of e)t&&Fl(t)&&t(n)}}}function gc(e,t,n,r,s=!1){const{relativeFrom:o,align:i,posOffset:l,percent:a}=e;if(null!=i)if(i===ce.INSIDE||i===ce.OUTSIDE)o===re.MARGIN||re.PAGE;else{if(o===re.COLUMN){const{width:e,left:n}=t;let s=0;return i===ce.LEFT?s=n:i===ce.RIGHT?s=n+e-r:i===ce.CENTER&&(s=n+e/2-r/2),s}if(o===re.LEFT_MARGIN);else if(o===re.MARGIN);else if(o===re.RIGHT_MARGIN);else if(o===re.INSIDE_MARGIN);else if(o===re.OUTSIDE_MARGIN);else if(o===re.PAGE){const{width:e}=n;let t=0;return i===ce.RIGHT?t=e-r:i===ce.CENTER&&(t=e/2-r/2),t}}else{if(l){const{width:e,marginLeft:i,marginRight:a}=n,c=e-a;let h=0;return o===re.COLUMN?h=(s?0:(null==t?void 0:t.left)||0)+l:o===re.LEFT_MARGIN||(o===re.MARGIN?h=l+i:o===re.RIGHT_MARGIN||o===re.INSIDE_MARGIN||o===re.OUTSIDE_MARGIN||o===re.PAGE&&(h=l)),h+r>c&&(h=c-r),h}if(a){const{width:e,marginLeft:t,marginRight:r}=n;if(o===re.LEFT_MARGIN);else if(o===re.MARGIN);else if(o===re.RIGHT_MARGIN);else if(o===re.INSIDE_MARGIN);else if(o===re.OUTSIDE_MARGIN);else if(o===re.PAGE)return a*e}}}function fc(e,t,n,r,s,o,i=!1){const{relativeFrom:l,align:a,posOffset:c,percent:h}=e;if(null!=a){if(l===oe.LINE){let e=0;return a===ue.BOTTOM?e=n+r-s:a===ue.TOP?e=n:a===ue.CENTER&&(e=n+r/2-s/2),e}if(l===oe.TOP_MARGIN);else if(l===oe.MARGIN);else if(l===oe.BOTTOM_MARGIN);else if(l===oe.INSIDE_MARGIN);else if(l===oe.OUTSIDE_MARGIN);else if(l===oe.PAGE){const{height:e}=t;let n=0;return a===ue.BOTTOM?n=e-s:a===ue.CENTER&&(n=e/2-s/2),n}}else{if(c){let e=0;return l===oe.LINE?e=n||0+c:l===oe.TOP_MARGIN||l===oe.MARGIN||l===oe.BOTTOM_MARGIN||l===oe.INSIDE_MARGIN||l===oe.OUTSIDE_MARGIN||(l===oe.PAGE?e=c:l===oe.PARAGRAPH&&(e=(i?0:null==o?n:o)+c)),e}if(h){const{height:e,marginBottom:n,marginTop:r}=t;if(l===oe.TOP_MARGIN);else if(l===oe.MARGIN);else if(l===oe.BOTTOM_MARGIN);else if(l===oe.INSIDE_MARGIN);else if(l===oe.OUTSIDE_MARGIN);else if(l===oe.PAGE)return h*e}}}function mc(e){const t=e.spanGroup;let n=0;for(let r of t)n+=r.width;return n}function pc(e=[],t=k.NONE,n=0,r=0,s=1/0,o=1/0){const i=[];let l=0,a=0;if(0===e.length)i.push(_c(r,s,0,k.NONE));else for(let h=0;h<e.length;h++){const{width:n,paddingEnd:o}=e[h];a=o,l=n,i.push(_c(r,l,a,t)),r+=l+a,h===e.length-1&&(l=s!==1/0?s-l:n,a=0,i.push(_c(r,l,a,t)))}const c={columns:i,colCount:(null==e?void 0:e.length)||1,height:o,top:n,st:0,ed:0};return i.forEach((e=>{e.parent=c})),c}function bc(e,t){e.isFull=t}function _c(e,t,n,r){return{lines:[],left:e,width:t,height:0,spaceWidth:n,separator:r,st:0,ed:0,drawingLRIds:[],isFull:!1}}function vc(e,t,n,r){return n in y?function(e,t,n){if(n===y.DECIMAL)return Cc(e,t);if(n===y.ZERO_DECIMAL)return function(e,t){const n=e+t;if(n<10)return`0${n}`;return n.toString()}(e,t);if(n===y.UPPER_ALPHA)return function(e,t){return Rr(e+t-1,!0)}(e,t);if(n===y.ALPHA)return function(e,t){return Rr(e+t-1,!1)}(e,t);if(n===y.UPPER_ROMAN)return function(e,t){return Tc(e+t,!0)}(e,t);if(n===y.ROMAN)return function(e,t){return Tc(e+t,!1)}(e,t);return Cc(e,t)}(e,t,n):wa(e,t,n,r)}function Cc(e,t){return(e+t).toString()}function Tc(e,t=!1){let n={m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};t&&(n={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1});let r="";for(let s in n)for(;e>=n[s];)r+=s,e-=n[s];return r}function wc(e,t,n,r,s){var o,i;if(!e||!t)return;const{listId:l,nestingLevel:a=0,textStyle:c}=e,h=t[l];if(!h||!h.nestingLevel)return yc(l,null==(o=null==n?void 0:n[a])?void 0:o.startIndexItem,r);if(!h.nestingLevel[a])return yc(l,null==(i=null==n?void 0:n[a])?void 0:i.startIndexItem,r);return function(e,t,n,r,s,o,i){var l,a;const c=n[t],{bulletAlignment:h,glyphFormat:u,textStyle:d,startNumber:g,glyphType:f,glyphSymbol:m,indentFirstLine:p,hanging:b,indentStart:_}=c,v=__spreadValues(__spreadValues({},s),d),C=Vl(v,o);let T;T=m||function(e,t,n,r,s){var o;const i=e.split("%"),l=[i[0]];for(let a=1;a<i.length;a++){const e=i[a],{level:c,suffix:h}=Ec(e);let u=(null==(o=null==r?void 0:r[c])?void 0:o.startIndexItem)||1;c!==t&&null!==(null==r?void 0:r[c])&&(u-=1);const d=Sc(u,n[c],s);l.push(d,h)}return l.join("")}(u,t,n,r,i);const w=rl.getTextSize(T,C),y=null!=(a=null==(l=null==r?void 0:r[t])?void 0:l.startIndexItem)?a:1;return{listId:e,symbol:T,ts:v,fontStyle:C,startIndexItem:y+1,bBox:w,nestingLevel:c,bulletAlign:h,bulletType:!m&&!!f,indentFirstLine:p,hanging:b,indentStart:_}}(l,a,h.nestingLevel,n,c,r,s)}function yc(e,t=1,n){return{listId:e,symbol:"",ts:{ff:(null==n?void 0:n.fontList[0])||"Arial",fs:(null==n?void 0:n.defaultFontSize)||9},startIndexItem:t,bBox:{width:8.4560546875,ba:7,bd:-1,aba:7,abd:-1,sp:-2,sbr:.5,sbo:0,spr:.5,spo:0},indentFirstLine:0,hanging:21,indentStart:0}}function Sc(e=1,t,n){const{startNumber:r,glyphType:s,glyphSymbol:o}=t;return o||(s?vc(e,r,s,n):"")}function Ec(e){if(""===e)return{level:0,suffix:""};const t=e.split("");let n="",r="",s=!1;const o=/[0-9]/g;return t.forEach((e=>{!s&&o.test(`${n}${e}`)?n+=e:(s=!0,r+=e)})),{level:parseInt(n)-1,suffix:r}}function Rc(e,t,n){return xc(hl.WORD,e,t,n)}function Ic(e,t,n){return xc(hl.LETTER,e,t,n)}function Ac(e,t){return xc(hl.TAB," ",e,t)}function xc(e,t,n,r){const{fontStyle:s,textStyle:o,charSpace:i=1,gridType:l=x.LINES,snapToGrid:a=vt.FALSE}=n,c=rl.getTextSize(t,s),{width:h=0}=c;let u=null!=r?r:h,d=0;if(lc(l,a)){u=Math.ceil(h/i)*i,l===x.LINES_AND_CHARS&&(d=(u-h)/2)}return{content:t,ts:o,fontStyle:s,width:u,bBox:c,paddingLeft:d,left:0,spanType:e}}function Oc(e,t,n){const{bBox:r,symbol:s,ts:o,fontStyle:i,bulletAlign:l=E.START,bulletType:a=!1}=t,c=r.width,h=Math.ceil(c/n);let u=(h<2?2:h)*n,d=0;a&&(l===E.CENTER?(d=-c/2,u-=d):l===E.END&&(d=-c,u-=d));return{content:s,ts:o,fontStyle:i,width:u,paddingLeft:0,bBox:function(e,t){const{ba:n,bd:r}=e.bBox,{ba:s,bd:o}=t.bBox;if(n+r>s+o)return e.bBox;return t.bBox}(e,t),left:d,spanType:hl.LIST}}function Mc(e,t=0){const n=e.length;let r;for(let s=0;s<n;s++){const n=e[s];n.left=r?r.left+r.width:t,r=n}}function Nc(e,t,n,r){return Xl(e)?function(e,t,n,r){const s=[e];let o=t;for(let i=t+1;i<n.length;i++){const e=n[i];if(!Xl(e))break;s.unshift(e),o=i}return{charIndex:o,spanGroup:[Ic(s.join(""),r)]}}(e,t,n,r):$l(e)?function(e,t,n,r){const s=[e];let o=t;for(let i=t+1;i<n.length;i++){const e=n[i];if(!$l(e))break;s.push(e),o=i}return{charIndex:o,spanGroup:[Rc(s.join(""),r)]}}(e,t,n,r):Gl(e)?void 0:function(e,t,n,r){const{pageWidth:s=1/0}=r,o=Ic(e,r),i=[o];let l=o.width,a=t;for(let c=t+1;c<n.length;c++){const e=n[c];if(Gl(e)||Ql(e))break;{const t=Ic(e,r),n=t.width;if(l+n>s)break;i.push(t),l+=n,a=c}}return{charIndex:a,spanGroup:i}}(e,t,n,r)}var kc,Lc,Dc,Pc,Bc,Hc;function Fc(e,t,n,r,s=0,o=0,i=!1,l,a,c){const{lineHeight:h=15.6,lineTop:u=0,contentHeight:d=0,paddingLeft:g=0,paddingRight:f=0,paddingTop:m=0,paddingBottom:p=0,marginTop:b=0,spaceBelowApply:_=0}=n,v=function(e,t){return{blockId:t,type:e,divides:[],lineHeight:0,contentHeight:0,top:0,asc:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0,spaceBelowApply:0,divideLen:0,st:-1,ed:-1,lineIndex:0,paragraphStart:!1}}(t,e);v.lineIndex=s,v.paragraphStart=$c(o,i),v.contentHeight=d,v.top=u,v.lineHeight=h,v.paddingTop=m,v.paddingBottom=p,v.marginTop=b,v.spaceBelowApply=_,v.divides=function(e,t,n,r,s,o,i,l){const a=[];return a.push({left:0,width:r},{left:n-s,width:s}),null==i||i.forEach(((r,s)=>{const o=Vc(r,e,t,n);o&&a.push(o)})),null==l||l.forEach(((r,s)=>{const o=Vc(r,e,t,n);o&&a.push(o)})),null==o||o.forEach(((r,s)=>{const o=Vc(r,e,t,n);o&&a.push(o)})),function(e,t){t.sort(((e,t)=>e.left>t.left?1:-1));const n=[];let r=0;const s=t.length;for(let o=0;o<s;o++){const i=t[o],{left:l,width:a}=i;if(l>r){let t=l-r;t=t<e?t:e-r;const s=Xc(r,t);n.push(s)}if(r=Math.max(l+a,r),o===s-1&&l+a<e){const t=Xc(l+a,e-l-a);n.push(t)}}return n}(n,a)}(h,u,r,g,f,l,a,c);for(let C of v.divides)C.parent=v;return v}function zc(e=15.6,t=0,n=0,r,s,o){let i=t;return null==s||s.forEach((n=>{const r=Uc(n,e,t);r&&(i=Math.max(i,r))})),null==o||o.forEach((n=>{const r=Uc(n,e,t);r&&(i=Math.max(i,r))})),null==r||r.forEach((n=>{const r=Uc(n,e,t);r&&(i=Math.max(i,r))})),i}function Uc(e,t,n,r){const{aTop:s,height:o,aLeft:i,width:l,angle:a=0,drawingOrigin:c}=e,{layoutType:h,distT:u=0,distB:d=0}=c;if(h!==U.WRAP_TOP_AND_BOTTOM)return;if(0===a){const e=s-u;if(e+(o+d)<n||e>t+n)return;return e+o}let{top:g=0,height:f=0}=jc(a,i,l,s,o);return g-=u,f+=d,g+f<n||g>t+n?void 0:g+f}function Wc(e,t){e.isFull=t}function Vc(e,t,n,r){const{aTop:s,height:o,aLeft:i,width:l,angle:a=0,drawingOrigin:c}=e,{layoutType:h}=c;if(h===U.WRAP_NONE||h===U.WRAP_TOP_AND_BOTTOM)return;if(h===U.WRAP_POLYGON){const{start:e=[0,0],lineTo:s}=c;if(!s)return;let o=[];o.push(new ha(e[0],e[1]));for(let t=0;t<s.length;t++){const e=s[t];o.push(new ha(e[0],e[1]))}if(0!==a){const e=(new da).rotate(a);for(let t=0;t<o.length;t++){const n=o[t];o[t]=e.applyPoint(n)}}return Yc(o,n,t,r)}if(0===a)return Gc(s,o,i,l,n,t,r,c);const u=jc(a,i,l,s,o);if(h===U.WRAP_SQUARE){const{left:e,width:s,top:o,height:i}=u;return Gc(o,i,e,s,n,t,r,c)}return Yc(u.points,n,t,r)}function jc(e,t,n,r,s){const o=(new da).rotate(e),i=new ha(t,r),l=new ha(t,r+s),a=new ha(t+n,r),c=new ha(t+n,r+s);return o.makeBoundingBoxFromPoints([i,l,a,c])}function Yc(e,t,n,r){const s=new Ca(e),o=s.intersection([new ha(0,t),new ha(r,t)]),i=s.intersection([new ha(0,t+n),new ha(r,t+n)]);if(!o&&!i)return;const l=function(e,t=0){const n=[];for(let r=0;r<e.length;r++){const s=e[r];0===t?n.push(s.x):n.push(s.y)}return{max:Math.max(...n),min:Math.min(...n)}}([...e,...o||[],...i||[]]);return{left:l.min,width:l.max}}function Gc(e,t,n,r,s,o,i,l){const{layoutType:a,wrapText:c=F.BOTH_SIDES,distL:h=0,distR:u=0,distT:d=0,distB:g=0}=l,f=e-(a===U.WRAP_SQUARE?d:0);if(f+(t+(a===U.WRAP_SQUARE?g:0))<s||f>o+s)return;let m=n-h,p=r+u,b=function(e,t,n,r){let s=0;e===F.LEFT?s=1:e===F.RIGHT?s=2:e===F.LARGEST&&(s=t>r-t-n?1:2);return s}(c,m,p,i);return 1===b?p=i-m:2===b&&(m=0,p=n+r+u),{left:m,width:p}}function Xc(e,t){return{spanGroup:[],width:t,left:e,paddingLeft:0,isFull:!1,st:0,ed:0}}function $c(e,t){return 0===e&&!0===t}function Qc(e,t,n,r){if(r)if(r.has(e)){const n=r.get(e);null==n||n.elements.push(t)}else r.set(e,{elements:[t],blockId:e,top:n})}function Kc(e,t){const n=e.parent;if(null!=n){const e=null==n.divides[0].spanGroup[0],r=t[0],s=r.content||" ";if(e&&" "===s){const e=r.width;r.width=0;for(let n of t)n!==r&&(n.left-=e)}}e.spanGroup.push(...t)}function Zc(e,t,n,r,s=0,o=!1){if($c(s,o))if(r.bulletSkeleton){const{bulletSkeleton:i,paragraphStyle:l={}}=r,{gridType:a=x.LINES,charSpace:c=0,defaultTabStop:h=1}=n,{snapToGrid:u=vt.TRUE}=l,d=ic(c,h,a,u);!function(e,t,n){const{hanging:r,indentStart:s}=e,{hanging:o,indentStart:i}=t;void 0===r&&(e.hanging=o);void 0===s&&(e.indentStart=oc(i||0,n)-oc(o||0,n))}(l,i,d);Jc([Oc(e[0],i,d),...e],t,n,r,s,o)}else Jc(e,t,n,r,s,o);else qc(e,t,n,r,s,o);return[...t]}function qc(e,t,n,r,s=0,o=!1,i){var l,a;const c=$a(t),h=tc(c);if(h){const u=function(e){const t=e.length;let n=0;for(let r=0;r<t;r++){n+=e[r].width}return n}(e),d=h.divide,g=null==(l=null==d?void 0:d.spanGroup)?void 0:l[d.spanGroup.length-1],f=(null==g?void 0:g.width)||0,m=(null==g?void 0:g.left)||0,p=qa(c);if(f+m+u>d.width){Wc(d,!0);const l=Ja(d);u>p?rc(c)?(Kc(d,e),function(e=[]){for(let t=0;t<e.length;t++){bc(e[t],!0)}}(null==(a=null==l?void 0:l.parent)?void 0:a.columns)):th(e,t,n,r,s,o,i):l&&u>l.width?(bc(l,!0),sc(l)?(console.log(e),Kc(d,e)):eh(e,t,n,r,s,o,i)):h.isLast?Jc(e,t,n,r,s,o,i):qc(e,t,n,r,s,o,i)}else{const i=d.parent,l=function(e){const t=e.length;let n,r=-1/0;for(let s=0;s<t;s++){const t=e[s],{ba:o,bd:i}=t.bBox;r<o+i&&(n={boundingBoxAscent:o,boundingBoxDescent:i}),r=o+i}return n}(e);if(i&&l){const{paragraphLineGapDefault:a,linePitch:c,lineSpacing:h,spacingRule:u,snapToGrid:d,gridType:g}=ac(n,r),{boundingBoxAscent:f,boundingBoxDescent:m}=l,p=f+m,{contentHeight:b}=nh(p,a,c,g,h,u,d);if(i.contentHeight<b){const l=function(e){const t=e.divides,n=t.length,r=[];for(let s=0;s<n;s++){const e=t[s];r.push(...e.spanGroup)}return r}(i),a=l.length;let c=[],h=1;l[0].spanType===hl.LIST&&a>2?(c=[l[0],l[1]],h=2):c=[l[0]];const u=i.parent;null==u||u.lines.pop(),Jc(c,t,n,r,s,o,f+m);for(let e=h;e<l.length;e++)qc([l[e]],t,n,r,s,o);return void qc(e,t,n,r,s,o)}}Mc(e,f+m);for(let t of e)t.parent=d;Kc(d,e)}}else Jc(e,t,n,r,s,o,i)}function Jc(e,t,n,r,s=0,o=!1,i){var l,a,c,h,u;let d=$a(t),g=ec(d);if(g&&g.column||(th(e,t,n,r,s),d=$a(t),g=ec(d)),!g)return;const f=g.column,m=Za(f),{ba:p,bd:b}=e[0].bBox,_=i||p+b,{paragraphStyle:v={},paragraphAffectSkeDrawings:C,skeHeaders:T,skeFooters:w,blockAnchor:y,blockId:S}=r,{namedStyleType:E=V.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:R=lt.UNSPECIFIED,direction:I,spaceAbove:A=0,spaceBelow:x=0,borderBetween:O,borderTop:M,borderBottom:N,borderLeft:k,borderRight:L,indentFirstLine:D=0,hanging:P=0,indentStart:B=0,indentEnd:H=0,tabStops:F=[],keepLines:z=vt.FALSE,keepNext:U=vt.FALSE,wordWrap:W=vt.FALSE,widowControl:j=vt.FALSE,shading:Y}=v,{paragraphLineGapDefault:G,linePitch:X,lineSpacing:$,spacingRule:Q,snapToGrid:K,gridType:Z}=ac(n,r),q=$c(s,o),{paddingTop:J,paddingBottom:ee,contentHeight:te,lineSpacingApply:ne}=nh(_,G,X,Z,$,Q,K),{marginTop:re,spaceBelowApply:se}=function(e=0,t=0,n=0,r,s){let o=0,i=0;if(!r)return{marginTop:o,spaceBelowApply:i};if(o=oc(t,e),i=oc(n,e),s){const{spaceBelowApply:e}=s;e>o&&(o=0,s.lineHeight+=e,s.marginBottom=e)}return{marginTop:o,spaceBelowApply:i}}(ne,A,x,q,m),oe=re+J+te+ee;let ie=f.parent;ie||(ie=Qa(d));const le=((null==m?void 0:m.lineHeight)||0)+((null==m?void 0:m.top)||0),{width:ae,headerId:ce,footerId:he}=d,ue=null==(a=null==(l=null==T?void 0:T.get(ce))?void 0:l.get(ae))?void 0:a.skeDrawings,de=null==(h=null==(c=null==w?void 0:w.get(he))?void 0:c.get(ae))?void 0:h.skeDrawings;!function(e,t,n,r,s){var o;if(!s)return;const i=null==(o=n.parent)?void 0:o.parent;if(!i)return;const l=new Map,a=function(e){const t=e.parent;if(!t)return!1;const n=null==t?void 0:t.columns;if(!n)return!1;for(let r=n.length-1;r>=0;r--){const e=n[r].lines,t=e.length;if(!(t<=0))for(let n=t-1;n>=0;n--){if(e[n].paragraphStart)return!1}}return!0}(n);s.forEach((s=>{if(!s)return;const{initialState:o,drawingOrigin:c}=s;if(o||!c)return;const{objectProperties:h}=c,{positionH:u,positionV:d,size:g,angle:f}=h,{width:m=0,height:p=0}=g;s.aLeft=gc(u,n,i,m,a)||0,s.aTop=fc(d,i,e,t,p,r,a)||0,s.width=m,s.height=p,s.angle=f,s.initialState=!0,l.set(s.objectId,s)})),i.skeDrawings=new Map([...i.skeDrawings,...l])}(le,oe,f,null==(u=null==y?void 0:y.get(S))?void 0:u.top,C);const ge=zc(oe,le,s,d.skeDrawings,ue,de);if(oe+ge>ie.height&&f.lines.length>0&&d.sections.length>0)return bc(f,!0),void eh(e,t,n,r,s,o,i);const fe=m?m.lineIndex+1:0,{charSpace:me,defaultTabStop:pe}=cc(n,r),be=ic(me,pe,Z,K),{paddingLeft:_e,paddingRight:ve,changeBulletWidth:Ce}=function(e,t=0,n=0,r=0,s=0,o){const{spanType:i=hl.LETTER,bBox:l}=e;let a=oc(t,o),c=oc(n,o),h=oc(r,o),u=oc(s,o),d=h,g=u,f={state:!1,hangingNumber:0};if(i===hl.LIST){const{width:e}=l;a>0?d+=a:c>0&&c>e&&(f.state=!0,f.hangingNumber=c)}else d+=c;return{paddingLeft:d,paddingRight:g,changeBulletWidth:f}}(e[0],D,P,B,H,be);Ce.state&&(e[0].width=Ce.hangingNumber);const Te=Fc(S,al.PARAGRAPH,{lineHeight:oe,contentHeight:te,lineTop:ge,paddingLeft:_e,paddingRight:ve,paddingTop:J,paddingBottom:ee,marginTop:re,spaceBelowApply:se},f.width,fe,s,o,d.skeDrawings,ue,de);f.lines.push(Te),Te.parent=f,Qc(S,Te,le,y),qc(e,t,n,r,s,o,i)}function eh(e,t,n,r,s=0,o=!1,i){!0===nc($a(t))?th(e,t,n,r,s,o,i):Jc(e,t,n,r,s,o,i)}function th(e,t,n,r,s=0,o=!1,i){const l=$a(t),{skeHeaders:a,skeFooters:c}=r;t.push(ch(n,{skeHeaders:a,skeFooters:c},null==l?void 0:l.pageNumber)),eh(e,t,n,r,s,o,i)}function nh(e,t,n,r,s,o,i){let l=t,a=t;if(r===x.DEFAULT||i===vt.FALSE)return o===Y.AUTO?{paddingTop:l,paddingBottom:a,contentHeight:s*e,lineSpacingApply:e}:{paddingTop:l,paddingBottom:a,contentHeight:Math.max(s,e),lineSpacingApply:s};let c=0;return c=o===Y.AUTO?s*n:s,e+2*t<c&&(l=a=(c-e)/2),{paddingTop:l,paddingBottom:a,contentHeight:e,lineSpacingApply:c}}function rh(e,t=0,n,r,s,o){const{ct:i="",ts:l={},tab:a=!1}=e,c=Vl(l,o),{paragraphStyle:h={}}=s,{gridType:u=x.LINES,charSpace:d=0,documentTextStyle:g={},defaultTabStop:f=10.5,pageSize:m={width:1/0,height:1/0},marginLeft:p=0,marginRight:b=0}=n,{namedStyleType:_=V.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:v=lt.UNSPECIFIED,lineSpacing:C=1,spacingRule:T=Y.AUTO,snapToGrid:w=vt.TRUE,direction:y,spaceAbove:S=0,spaceBelow:E=0,borderBetween:R,borderTop:I,borderBottom:A,borderLeft:O,borderRight:M,indentFirstLine:N=0,hanging:k=0,indentStart:L=0,indentEnd:D=0,tabStops:P=[],keepLines:B=vt.FALSE,keepNext:H=vt.FALSE,wordWrap:F=vt.FALSE,widowControl:z=vt.FALSE,shading:U}=h;let W=[r];const j=m.width||1/0-p-b,G={fontStyle:c,textStyle:__spreadValues(__spreadValues({},g),l),charSpace:d,gridType:u,snapToGrid:w,pageWidth:j};if(a){return W=Zc([Ac(G,ic(d,f,u,w))],W,n,s,t,!0),W}const X=i.split("");for(let x=0;x<X.length;x++){const e=X[x],r=0===x,o=Nc(e,x,X,G);let i=[];if(o){const{charIndex:e,spanGroup:t}=o;x=e,i=t}else{const t=Rc(e,G);i.push(t)}W=Zc(i,W,n,s,t,r)}return uc(W,(e=>{!function(e,t){if(t===lt.UNSPECIFIED||t===lt.LEFT)return;const{divides:n}=e,r=n.length;for(let s=0;s<r;s++){const e=n[s],{width:r,spanGroup:o}=e,i=mc(e);r!==1/0&&(t===lt.CENTER?e.paddingLeft=(r-i)/2:t===lt.RIGHT?e.paddingLeft=r-i:lt.JUSTIFIED)}}(e,v)})),W}function sh(e,t,n,r,s,o){const{pageNumberStart:i,pageSize:l={w:1/0,h:1/0},marginRight:a=0,marginLeft:c=0,columnProperties:h=[],columnSeparatorType:u=k.NONE,contentDirection:d,sectionType:g,sectionTypeNext:f,textDirection:m,lists:p,drawings:b={},fontLocale:_}=r,{elements:v,paragraphStyle:C={},bullet:T}=t,{skeHeaders:w,skeFooters:y,skeListLevel:S,blockAnchor:E}=s,R={blockId:e,paragraphStyle:C,skeHeaders:w,skeFooters:y,blockAnchor:E},I=[n];let A=n;const x=new Map,O=wc(T,p,function(e,t){if(!e||!t)return;const{listId:n,nestingLevel:r}=e,s=null==t?void 0:t.get(n);let o=r;o<0&&(o=0);const i=[];for(let l=o;l>=0;l--){const e=null==s?void 0:s[l];i[l]=e||null}return i}(T,S),_,o);return function(e,t,n){if(!e||!t)return;const{listId:r,nestingLevel:s}=e,o=[...(null==n?void 0:n.get(r))||[]];o[s]=t,o.splice(s+1),null==n||n.set(r,o)}(T,O,S),R.bulletSkeleton=O,v.forEach(((e,t)=>{const{eId:n,et:r}=e;if(r===B.DRAWING){const e=b[n];e.layoutType===U.INLINE||x.set(n,function(e){return{objectId:e.objectId,aLeft:0,aTop:0,width:0,height:0,angle:0,initialState:!1,drawingOrigin:e}}(e))}})),v.forEach(((e,t)=>{const{eId:n,et:o}=e;let i=[];if(o===B.TEXT_RUN){const{tr:n,st:s,ed:o}=e;if(!n)return!1;i=rh(n,t,r,A,__spreadProps(__spreadValues({},R),{paragraphAffectSkeDrawings:x}),_)}else if(o===B.PAGE_BREAK)i=[ch(r,s,oh(A),il.PAGE)],x.clear();else if(o===B.COLUMN_BREAK){const e=ec(A);e&&!e.isLast?bc(e.column,!0):i=[ch(r,s,oh(A),il.COLUMN)]}A=function(e,t){const n=e.slice(-1)[0],r=t[0];if(n===r){if(1===t.length)return n;t.shift()}return e.push(...t),e.slice(-1)[0]}(I,i)})),I}function oh(e){return e.pageNumber+1}(Lc=kc||(kc={}))[Lc.BOTH=0]="BOTH",Lc[Lc.LEFT=1]="LEFT",Lc[Lc.RIGHT=2]="RIGHT",(Pc=Dc||(Dc={}))[Pc.X=0]="X",Pc[Pc.Y=1]="Y";function ih(){return[]}function lh(e,t,n,r,s,o){const i=[],l=new Map;for(let a of e){const{paragraph:e,table:c,tableOfContents:h,blockType:u,customBlock:d,blockId:g}=a;if(null==s?void 0:s.get(g))continue;let f=[],m=t;i.length>0&&(m=i[i.length-1]),u===I.PARAGRAPH&&e?f=sh(a.blockId,e,m,n,r,o):u===I.TABLE&&c||u===I.SECTION_BREAK&&h||u===I.CUSTOM&&(f=Ta(a.blockId,d,m,n,r,o)),0===f.length&&(f=[]),ah(i,f),l.set(g,!0)}return{pages:i,renderedBlockIdMap:l}}function ah(e,t){e[e.length-1]===t[0]&&t.splice(0,1),e.push(...t)}function ch(e,t,n=1,r=il.SECTION){var s,o,i,l;const a={sections:[],headerId:"",footerId:"",pageWidth:0,pageHeight:0,pageOrient:me.PORTRAIT,pageNumber:1,pageNumberStart:1,verticalAlign:!1,angle:0,width:0,height:0,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,breakType:il.SECTION,st:0,ed:0,skeDrawings:new Map},{pageNumberStart:c=1,pageSize:h={width:1/0,height:1/0},pageOrient:u=me.PORTRAIT,headerIds:d={},footerIds:g={},useFirstPageHeaderFooter:f,useEvenPageHeaderFooter:m,footers:p,headers:b,columnProperties:_=[],columnSeparatorType:v,marginTop:C=0,marginBottom:T=0,marginHeader:w=0,marginFooter:y=0,marginLeft:S=0,marginRight:E=0,renderConfig:R={}}=e,{skeHeaders:I,skeFooters:A}=t,{width:x=1/0,height:O=1/0}=h;a.pageNumber=n,a.pageNumberStart=c,a.renderConfig=R,a.marginLeft=S,a.marginRight=E,a.breakType=r,a.width=a.pageWidth=x,a.height=a.pageHeight=O,a.pageOrient=u;const{defaultHeaderId:M,evenPageHeaderId:N,firstPageHeaderId:k}=d,{defaultFooterId:L,evenPageFooterId:D,firstPageFooterId:P}=g;let B,H,F=null!=M?M:"",z=null!=L?L:"";n===c&&f?(F=null!=k?k:"",z=null!=P?P:""):n%2==0&&m&&(F=null!=N?N:"",z=null!=D?D:""),F&&((null==(s=I.get(F))?void 0:s.has(x))?B=null==(o=I.get(F))?void 0:o.get(x):b&&(B=hh(b[F],e,t),I.set(F,new Map([[x,B]]))),a.headerId=F),z&&((null==(i=A.get(z))?void 0:i.has(x))?H=null==(l=A.get(z))?void 0:l.get(x):p&&(H=hh(p[z],e,t),A.set(F,new Map([[x,H]]))),a.footerId=z),a.marginTop=uh(C,w,B),a.marginBottom=uh(T,y,H);const U=a.sections,W=U[U.length-1],{marginTop:V,marginBottom:j,marginLeft:Y,marginRight:G}=a,X=x-Y-G,$=O-V-j;let Q=0;W&&(Q=W.top+W.height);const K=pc(_,v,Q,0,X,$-Q);return K.parent=a,U.push(K),a}function hh(e,t,n,r=!0){const{body:s}=e,{lists:o,headers:i,footers:l,fontLocale:a,pageSize:c,marginLeft:h=0,marginRight:u=0,drawings:d,marginTop:g=0,marginBottom:f=0,marginHeader:m=0,marginFooter:p=0}=t,b={lists:o,headers:i,footers:l,pageSize:{width:((null==c?void 0:c.width)||1/0)-h-u,height:1/0},fontLocale:a,drawings:d},{blockElements:_}=s,v=[];_.forEach((e=>{v.push(e)}));const C=ch(b,n),T=lh(v,C,b,n).pages[0];hc([T]);const w=T.sections[0].columns[0],y=w.height||0,{skeDrawings:S,st:E,ed:R}=T,I={lines:w.lines,skeDrawings:S,height:y,st:E,ed:R,marginLeft:h,marginRight:u};return __spreadProps(__spreadValues({},I),r?{marginTop:dh(g,m,y)}:{marginBottom:gh(f,p,y)})}function uh(e,t,n){return n&&0!==n.lines.length?Math.max(e,t,(null==n?void 0:n.height)||0):e}function dh(e,t,n){const r=Math.max(e,t);return n>r?0:r-n}function gh(e,t,n){const r=Math.max(e,t);return n>r?0:r-n}class fh{constructor(e){this._dirty=!0,this._context=e,this._localeInitial()}get dirty(){return this._dirty}getFontLocale(){return this._fontLocale}getContext(){return this._context}makeDirty(e){this._dirty=e}_localeInitial(){if(!this._context)return;const e=this._context.getUniver().getGlobalContext().getLocale(),t=e.getObject("renderFont");t||e.load({en:ki,zh:Ni}),this._fontLocale=t}}(Hc=Bc||(Bc={})).PENDING="pending",Hc.CALCULATING="calculating",Hc.READY="ready",Hc.INVALID="invalid";class mh extends fh{constructor(e,t){super(t),this.onRecalculateChangeObservable=new i,this._renderedBlockIdMap=new Map,this._documentData=e}static create(e,t){return new mh(e,t)}updateDrawing(e,t){const n=this._documentData.drawings;if(!n)return;const r=n[e];if(!r)return;const s=r.objectProperties;s.size.width=t.width,s.size.height=t.height,s.positionH.posOffset=t.left,s.positionV.posOffset=t.top}calculate(e){this.dirty&&(this._skeletonData=this._createSkeleton(e),this.onRecalculateChangeObservable.notifyObservers(this._skeletonData))}getSkeletonData(){return this._skeletonData}getPageSize(){return this._documentData.documentStyle.pageSize}updateDocumentDataPageSize(e,t){const n=this._documentData.documentStyle;if(!n.pageSize)return e=null!=e?e:1/0,t=null!=t?t:1/0,void(n.pageSize={width:e,height:t});void 0!==e&&(n.pageSize.width=e),void 0!==t&&(n.pageSize.height=t)}__getContentMapArr(){const{body:e}=this._documentData;if(!e)return[];const{blockElements:t}=e;if(0===t.length)return[];const n=[];let r={blockElements:[],sectionBreak:void 0};return t.forEach((e=>{const{sectionBreak:t}=e;t?(r.sectionBreak=t,n.push(r),r={blockElements:[],sectionBreak:void 0}):r.blockElements.push(e)})),r.sectionBreak||(r.sectionBreak={columnProperties:[],columnSeparatorType:k.NONE,sectionType:M.SECTION_TYPE_UNSPECIFIED},r.blockElements.length>0&&n.push(r)),n}_createSkeleton(e){var t;const n=this.__getContentMapArr(),r={width:1/0,height:1/0},{documentStyle:s,footers:o,headers:i,lists:l,drawings:a}=this._documentData,{pageNumberStart:c=1,pageSize:h=r,pageOrient:u=me.PORTRAIT,defaultHeaderId:d,defaultFooterId:g,evenPageHeaderId:f,evenPageFooterId:m,firstPageHeaderId:p,firstPageFooterId:b,useFirstPageHeaderFooter:_,useEvenPageHeaderFooter:v,marginTop:C=0,marginBottom:T=0,marginRight:w=0,marginLeft:y=0,marginHeader:S=0,marginFooter:E=0,charSpace:R=0,linePitch:I=15.6,gridType:A=x.LINES,paragraphLineGapDefault:O=0,defaultTabStop:N=10.5,textStyle:L={fs:14},renderConfig:D={horizontalAlign:lt.UNSPECIFIED,verticalAlign:ct.UNSPECIFIED,centerAngle:0,vertexAngle:0,wrapStrategy:ut.UNSPECIFIED}}=s,P=this.__getNullSke();if(0===n.length)return P;const B={footers:o,headers:i,lists:l,drawings:a,charSpace:R,linePitch:I,gridType:A,fontLocale:this.getFontLocale(),paragraphLineGapDefault:O,defaultTabStop:N,documentTextStyle:L},{skeHeaders:H,skeFooters:F,skeListLevel:z,blockAnchor:U}=P,W={skeHeaders:H,skeFooters:F,skeListLevel:z,blockAnchor:U},V=[];P.pages=V;for(let x=0;x<n.length;x++){const e=n[x];if(!e.sectionBreak)continue;const{pageNumberStart:r=c,pageSize:s=h,pageOrient:o=u,marginTop:i=C,marginBottom:l=T,marginRight:a=w,marginLeft:R=y,marginHeader:I=S,marginFooter:A=E,defaultHeaderId:O=d,defaultFooterId:N=g,evenPageHeaderId:L=f,evenPageFooterId:P=m,firstPageHeaderId:H=p,firstPageFooterId:F=b,useFirstPageHeaderFooter:z=_,useEvenPageHeaderFooter:U=v,columnProperties:j=[],columnSeparatorType:Y=k.NONE,contentDirection:G,sectionType:X,textDirection:$,renderConfig:Q=D}=e.sectionBreak,K=n[x+1],Z=null==(t=null==K?void 0:K.sectionBreak)?void 0:t.sectionType,q={defaultHeaderId:O,evenPageHeaderId:L,firstPageHeaderId:H},J={defaultFooterId:N,evenPageFooterId:P,firstPageFooterId:F};null===s.width&&(s.width=1/0),null===s.height&&(s.height=1/0);const ee=__spreadValues({pageNumberStart:r,pageSize:s,pageOrient:o,marginTop:i,marginBottom:l,marginRight:a,marginLeft:R,marginHeader:I,marginFooter:A,headerIds:q,footerIds:J,useFirstPageHeaderFooter:z,useEvenPageHeaderFooter:U,columnProperties:j,columnSeparatorType:Y,contentDirection:G,sectionType:X,sectionTypeNext:Z,textDirection:$,renderConfig:Q},B);let te=$a(V),ne=!1;X===M.CONTINUOUS?(hc(V),this.__addNewSectionByContinuous(te,j,Y),ne=!0):te=ch(ee,W,null==te?void 0:te.pageNumber);const re=this.getContext(),se=lh(e.blockElements,te,ee,W,this._renderedBlockIdMap,re);Z===M.CONTINUOUS&&j.length;const{pages:oe,renderedBlockIdMap:ie}=se;ne&&oe.splice(0,1),V.push(...oe)}return hc(V),P}__addNewSectionByContinuous(e,t,n){const r=e.sections,s=r[r.length-1],{pageWidth:o,pageHeight:i,marginTop:l,marginBottom:a,marginLeft:c,marginRight:h}=e,u=o-c-h,d=i-l-a,g=((null==s?void 0:s.top)||0)+((null==s?void 0:s.height)||0),f=pc(t,n,g,0,u,d-g);f.parent=e,r.push(f)}__getNullSke(){return{pages:[],left:0,top:0,st:0,skeHeaders:new Map,skeFooters:new Map,skeListLevel:new Map,blockAnchor:new Map}}}class ph extends Sa{constructor(){super(...arguments),this._extensions=new Map}get extensions(){return this._extensions}register(...e){for(let t of e)t.parent=this,this._extensions.set(t.uKey,t)}unRegister(...e){for(let t of e)this._extensions.delete(t)}getExtensionsByOrder(){const e=Array.from(this._extensions.values());return e.sort(Ar),e}getExtensionByKey(e){return this._extensions.get(e)}draw(e,t){}}class bh extends ph{constructor(e,t,n=!1){super(e),this._skeleton=t,this._allowCache=n,this._allowCache&&(this._cacheCanvas=new Aa),this.onIsAddedToParentObserver.add((e=>{var t;null==(t=null==e?void 0:e.getEngine())||t.onTransformChangeObservable.add((e=>{this.resizeCacheCanvas()})),this.resizeCacheCanvas()}))}getSkeleton(){return this._skeleton}setSkeleton(e){this._skeleton=e}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(!this._skeleton)return;const n=this.transform.getMatrix();e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._draw(e,t),e.restore()}getParentScale(){if(!this.parent)return{scaleX:1,scaleY:1};let{scaleX:e=1,scaleY:t=1}=this.parent;return this.parent.classType===el.SCENE&&(e=this.parent.ancestorScaleX||1,t=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:t}}_getBounding(e){}_draw(e,t){}}class _h{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return ea(e)}}const vh=Qo.create(),Ch=Qo.create(),Th=Qo.create(),wh=Qo.create();var yh,Sh;(Sh=yh||(yh={}))[Sh.SPAN=0]="SPAN",Sh[Sh.LINE=1]="LINE";class Eh extends _h{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}wh.add(new class extends Eh{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:s,content:o,fontStyle:i,bBox:l}=n;let{spanPointWithFont:a=ha.create(0,0)}=this.extensionOffset;if(!s)return void(null!=o&&e.fillText(o,a.x,a.y));if(null==o)return;this._preFontString!==(null==i?void 0:i.fontString)&&(e.font=this._preFontString=(null==i?void 0:i.fontString)||"");const{cl:c,va:h}=s,u=kn(c)||Qi;if(u&&this._preFontColor!==u&&(e.fillStyle=u),h===bt.SUBSCRIPT||h===bt.SUPERSCRIPT){let e=l.spo;h===bt.SUPERSCRIPT&&(e=-l.sbo),a.y+=e}e.fillText(o,a.x,a.y)}clearCache(){this._preFontString="",this._preFontColor=""}});wh.add(new class extends Eh{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const s=null==(r=n.parent)?void 0:r.parent;if(!s)return;const{lineHeight:o=0}=s,{ts:i,width:l,content:a}=n;if(!i)return;const{bg:c}=i;if(!c)return;const h=kn(c),{spanStartPoint:u=ha.create(0,0)}=this.extensionOffset;h&&(e.fillStyle=h,e.fillRect(u.x-.5,u.y,l+1,o))}clearCache(){this._preBackgroundColor=""}});wh.add(new class extends Eh{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const s=null==(r=n.parent)?void 0:r.parent;if(!s)return;const{asc:o=0,lineHeight:i=0}=s,{ts:l,left:a,width:c,bBox:h}=n;if(!l)return;const{sp:u}=h,d=ea(t),{ul:g,st:f,ol:m}=l,{originTranslate:p=ha.create(0,0),centerPoint:b=ha.create(0,0),alignOffset:_=ha.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:C=0,vertexAngle:T=0}=v;if(g){const{s:t,cl:n,t:r}=g;if(t===vt.TRUE){e.beginPath();const t=kn(n)||Qi;e.strokeStyle=t,this._setLineType(e,r||ot.SINGLE);const s=Wl(i+1-.5,d),o=pa(p.addByPoint(a,s),b,C,T,_),l=pa(p.addByPoint(a+c,s),b,C,T,_);e.moveTo(o.x,o.y),e.lineTo(l.x,l.y),e.stroke()}}if(f){const{s:t,cl:n,t:r}=f;if(t===vt.TRUE){e.beginPath();const t=kn(n)||Qi;e.strokeStyle=t,this._setLineType(e,r||ot.SINGLE);const s=Wl(u-.5,d),o=pa(p.addByPoint(a,s),b,C,T,_),i=pa(p.addByPoint(a+c,s),b,C,T,_);e.moveTo(o.x,o.y),e.lineTo(i.x,i.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===vt.TRUE){e.beginPath();const t=kn(n)||Qi;e.strokeStyle=t,this._setLineType(e,r||ot.SINGLE);const s=Wl(-1.5,d),o=pa(p.addByPoint(a,s),b,C,T,_),i=pa(p.addByPoint(a+c,s),b,C,T,_);e.moveTo(o.x,o.y),e.lineTo(i.x,i.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===ot.DASH_DOT_DOT_HEAVY||t===ot.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===ot.DASH_DOT_HEAVY||t===ot.DOT_DASH?e.setLineDash([2,5,2]):t===ot.DOTTED||t===ot.DOTTED_HEAVY?e.setLineDash([2]):t===ot.DASH||t===ot.DASHED_HEAVY?e.setLineDash([3]):t===ot.DASH_LONG||t===ot.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===ot.WAVY_HEAVY||e===ot.DASHED_HEAVY||e===ot.DOTTED_HEAVY||e===ot.DASH_DOT_HEAVY||e===ot.DASH_LONG_HEAVY||e===ot.DASH_DOT_DOT_HEAVY?t=2:e===ot.THICK&&(t=3),t}});wh.add(new class extends Eh{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const s=null==(r=n.parent)?void 0:r.parent;if(!s)return;const{asc:o=0,lineHeight:i=0}=s,{ts:l,left:a,width:c}=n;if(!l)return;const{bd:h}=l;if(!h)return;const u=this._getScale(t),d=this._createBorderCache(h),{spanStartPoint:g=ha.create(0,0)}=this.extensionOffset;for(let f of d.keys()){const t=d.get(f);if(!t)continue;const{s:n,cl:r}=t,s=kn(r)||Qi;n!==this._preBorderStyle&&(fa(e,n),e.lineWidth=ma(n)/u,this._preBorderStyle=n),s!==this._preBorderColor&&(e.strokeStyle=s||Qi,this._preBorderColor=s),ga(e,f,{startX:g.x,startY:g.y,endX:g.x+c,endY:g.y+i})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t:t,b:n,l:r,r:s}=e,o=new Map;return t&&o.set(Ki.TOP,t),n&&o.set(Ki.BOTTOM,n),r&&o.set(Ki.LEFT,r),s&&o.set(Ki.RIGHT,s),o}});class Rh{constructor(){this._translateX=0,this._translateY=0,this._translateSaveList=[]}get x(){return this._translateX}get y(){return this._translateY}reset(){this.translateBy(0,0),this._translateSaveList=[]}translateBy(e=0,t=0){this._translateX=e,this._translateY=t}translate(e=0,t=0){this._translateX+=e,this._translateY+=t}translateSave(){this._translateSaveList.push({x:this._translateX,y:this._translateY})}translateRestore(){const e=this._translateSaveList.pop();e&&(this._translateX=e.x,this._translateY=e.y)}translatePagePadding(e){const{marginTop:t=0,marginBottom:n=0,marginLeft:r=0,marginRight:s=0}=e;this.translate(r,t)}restorePagePadding(e){const{marginTop:t=0,marginBottom:n=0,marginLeft:r=0,marginRight:s=0}=e;this.translate(-r,-t)}translatePage(e,t=dl.VERTICAL,n=0,r=0,s=0,o=0){const{sections:i,marginTop:l=0,marginBottom:a=0,marginLeft:c=0,marginRight:h=0,pageWidth:u,pageHeight:d,width:g,height:f,pageNumber:m=1,renderConfig:p={}}=e;let b=0,_=0;return t===dl.VERTICAL?b=d+r:t===dl.HORIZONTAL&&(_=u+n),this.translate(_,b),{x:_,y:b}}translateSection(e){const{top:t=0}=e;return this.translate(0,t),{x:0,y:t}}translateColumn(e){const{left:t}=e;return this.translate(t,0),{x:t,y:0}}translateLine(e,t=!1){const{top:n,marginBottom:r=0,marginTop:s=0,paddingTop:o=0,paddingBottom:i=0}=e,l=n+(!0===t?s:0)+o;return this.translate(0,l),{x:0,y:l}}translateDivide(e){const{left:t,paddingLeft:n}=e,r=t+n;return this.translate(r,0),{x:r,y:0}}translateSpan(e){const{left:t}=e;return this.translate(t,0),{x:t,y:0}}}var Ih,Ah,xh,Oh;(Ah=Ih||(Ih={}))[Ah.NORMAL=0]="NORMAL",Ah[Ah.START=1]="START",Ah[Ah.END=2]="END",(Oh=xh||(xh={}))[Oh.page=0]="page",Oh[Oh.section=1]="section",Oh[Oh.column=2]="column",Oh[Oh.line=3]="line",Oh[Oh.divide=4]="divide",Oh[Oh.span=5]="span";const Mh={page:0,section:1,column:2,line:3,divide:4,span:5};class Nh{constructor(e,t,n,r){this._scene=e,this.startNodePosition=t,this.endNodePosition=n,this.segmentId=r,this._current=!1,this._Liquid=new Rh,this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}getRange(){const e=this._rangeList,t=e[0],n=e[e.length-1];let r=1===e.length&&t.isCollapse;return{cursorStart:t.cursorStart,cursorEnd:n.cursorEnd,isStartBack:t.isStartBack,isEndBack:n.isEndBack,isCollapse:r}}getRangeList(){return this._rangeList}getAnchor(){return this._anchorShape}activeStatic(){var e;null==(e=this._anchorShape)||e.setProps({stroke:Al(Li.black,1)})}deactivateStatic(){var e;null==(e=this._anchorShape)||e.setProps({stroke:Al(Li.black,0)})}isActive(){return!0===this._current}activate(){this._current=!0}deactivate(){this._current=!1}isEmpty(){return null==this.startNodePosition&&null==this.endNodePosition}isCollapsed(){return null!=this.startNodePosition&&null==this.endNodePosition||!!this.isSamePosition()}isRange(){const e=this.startNodePosition,t=this.endNodePosition;return null!=e&&null!=t&&!this.isSamePosition()}dispose(){var e,t;null==(e=this._rangeShape)||e.dispose(),this._rangeShape=null,null==(t=this._anchorShape)||t.dispose(),this._anchorShape=null}isIntersection(e){const t=this.getRange(),n=e.getRange(),r=this._getCursorPosition(t.cursorStart,t.isStartBack),s=this._getCursorPosition(t.cursorEnd,t.isEndBack),o=this._getCursorPosition(n.cursorStart,n.isStartBack);return!(r>this._getCursorPosition(n.cursorEnd,n.isEndBack)||s<o)}refresh(e){var t,n;const r=this.startNodePosition,s=this.endNodePosition;if(null==(t=this._anchorShape)||t.hide(),null==(n=this._rangeShape)||n.hide(),this.isEmpty())return;if(this.isCollapsed()){const t=this._getRangePointData(r,r,e),{pointGroup:n,cursorList:s}=t;return this._setRangeList(s),void(n.length>0&&this._createAndUpdateAnchor(n,e.left,e.top))}const o=this._getRangePointData(r,s,e),{pointGroup:i,cursorList:l}=o;this._setRangeList(l),i.length>0&&this._createAndUpdateRange(i,e.left,e.top)}getStart(){if(null==this.startNodePosition)return this.endNodePosition;if(null==this.endNodePosition)return this.startNodePosition;const{start:e}=this._compareNodePosition(this.startNodePosition,this.endNodePosition);return e}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}_compareNodePositionLogic(e,t){return!(e.page>t.page)&&(e.page<t.page||!(e.section>t.section)&&(e.section<t.section||!(e.column>t.column)&&(e.column<t.column||!(e.line>t.line)&&(e.line<t.line||!(e.divide>t.divide)&&(e.divide<t.divide||!(e.span>t.span)&&(e.span,t.span,!0))))))}_compareNodePosition(e,t){return this._compareNodePositionLogic(e,t)?{start:e,end:t}:{start:t,end:e}}_setNodePositionState(e=0,t,n,r){this._currentStartState[e]=r===t?1:0,this._currentEndState[e]=r===n?2:0}_checkPreviousNodePositionState(e,t=!0){let n,r=e;for(;r>=0;){const e=xh[r];let s;if(s=t?this._currentStartState[e]:this._currentEndState[e],void 0===s)return;if(void 0===n&&(n=s),s!==n)return 0;r--}return n}_getSelectionRuler(e,t,n,r,s){let o=0,i=r;const l=xh[e],a=xh[e+1];if(null===a||null===l)return{start_next:o,end_next:i};const c=t[l],h=n[l];this._setNodePositionState(l,c,h,s);const u=this._checkPreviousNodePositionState(e),d=this._checkPreviousNodePositionState(e,!1);return 1===u&&(o=t[a]),2===d&&(i=n[a]),{start_next:o,end_next:i}}_pushToPoints(e){const{startX:t,startY:n,endX:r,endY:s}=e,o=[];return o.push({x:t,y:n}),o.push({x:r,y:n}),o.push({x:r,y:s}),o.push({x:t,y:s}),o.push({x:t,y:n}),o}isSamePosition(){const e=this.startNodePosition,t=this.endNodePosition;if(null==e||null==t)return!1;const n=Object.keys(Mh);for(let r of n){if(e[r]!==t[r])return!1}return e.isBack===t.isBack}_createAndUpdateRange(e,t,n){if(this._rangeShape)return this._rangeShape.translate(t,n),this._rangeShape.updatePointGroup(e),void this._rangeShape.show();const r=new za("__TestSelectionRange__"+C.generateRandomId(6),{pointsGroup:e,fill:Al(Li.black,.2),left:t,top:n,evented:!1});this._rangeShape=r,this._scene.addObject(r,2)}_getAnchorBounding(e){const t=e[0],n=t[0],r=t[2],{x:s,y:o}=n,{x:i,y:l}=r;return{left:s,top:o,width:i-s,height:l-o}}_createAndUpdateAnchor(e,t,n){const r=this._getAnchorBounding(e),{left:s,top:o,width:i,height:l}=r;if(this._anchorShape)return this._anchorShape.transformByState({left:s+t,top:o+n,height:l}),void this._anchorShape.show();const a=new Ha("__TestSelectionAnchor__"+C.generateRandomId(6),{left:s+t,top:o+n,height:l,strokeWidth:1,stroke:Al(Li.black),evented:!1});this._anchorShape=a,this._scene.addObject(a,2)}_getRangePointData(e,t,n){const r=[],s=[];if(null==e||null==t)return{pointGroup:r,cursorList:s};const{start:o,end:i}=this._compareNodePosition(e,t);return this._selectionIterator(o,i,n,((e,t,n,l,a,c)=>{var h;const{lineHeight:u}=c,{spanGroup:d,st:g}=a,{x:f,y:m}=this._Liquid;let p;const b=d[e],_=d[t],v=(null==b?void 0:b.left)||0,C=(null==b?void 0:b.width)||0,T=(null==_?void 0:_.left)||0,w=(null==_?void 0:_.width)||0;let y=(null==b?void 0:b.spanType)===hl.LIST,S=(null==(h=d[0])?void 0:h.spanType)===hl.LIST,E=e+g,R=t+g;const I=o.span!==e||!n||o.isBack,A=!(i.span!==t||!l)&&i.isBack,x=o===i;if(0===e&&t===d.length-1)R-=S?1:0,p={startX:f+v+(y?C:0),startY:m,endX:f+T+w,endY:m+u};else{E-=S&&!y?1:0,R-=S&&!y?1:0,p={startX:f+v+(I&&!y?0:C),startY:m,endX:f+T+(A?0:w),endY:m+u}}r.push(this._pushToPoints(p)),s.push({isStartBack:I,isEndBack:A,cursorStart:E,cursorEnd:R,isCollapse:x})})),{pointGroup:r,cursorList:s}}_selectionIterator(e,t,n,r){const s=n.getSkeleton();if(!s)return[];this._Liquid.reset();const o=s.getSkeletonData().pages,{page:i}=e,{page:l}=t;this._resetCurrentNodePositionState();for(let a=0;a<=i-1;a++){const e=o[a];this._Liquid.translatePage(e,n.pageLayoutType,n.pageMarginLeft,n.pageMarginTop)}for(let a=i;a<=l;a++){const s=o[a],c=s.sections,{start_next:h,end_next:u}=this._getSelectionRuler(Mh.page,e,t,c.length-1,a);this._Liquid.translateSave(),this._Liquid.translatePagePadding(s);for(let n=h;n<=u;n++){const o=c[n],d=o.columns,{start_next:g,end_next:f}=this._getSelectionRuler(Mh.section,e,t,d.length-1,n);this._Liquid.translateSection(o);for(let c=g;c<=f;c++){const m=d[c],p=m.lines,{start_next:b,end_next:_}=this._getSelectionRuler(Mh.column,e,t,p.length-1,c);this._Liquid.translateColumn(m);for(let d=b;d<=_;d++){const v=p[d],{divides:C,type:T,lineHeight:w=0}=v,{start_next:y,end_next:S}=this._getSelectionRuler(Mh.line,e,t,C.length-1,d);this._Liquid.translateSave(),this._Liquid.translateLine(v);for(let p=y;p<=S;p++){const T=C[p];this._Liquid.translateSave(),this._Liquid.translateDivide(T);const w=T.spanGroup,{start_next:E,end_next:R}=this._getSelectionRuler(Mh.divide,e,t,w.length-1,p);let I=!1,A=!1;a===i&&n===h&&c===g&&d===b&&p===y&&(I=!0),a===l&&n===u&&c===f&&d===_&&p===S&&(A=!0),r&&r(E,R,I,A,T,v,m,o,s),this._Liquid.translateRestore()}this._Liquid.translateRestore()}}}this._Liquid.translateRestore(),this._Liquid.translatePage(s,n.pageLayoutType,n.pageMarginLeft,n.pageMarginTop)}}_setRangeList(e){0!==e.length&&(this._rangeList=e)}_getCursorPosition(e,t){return e-(!0===t?1:0)}}class kh{constructor(e){var t;this._documents=e,this.onKeydownObservable=new i,this.onInputObservable=new i,this.onCompositionstartObservable=new i,this.onCompositionupdateObservable=new i,this.onCompositionendObservable=new i,this._textSelectionList=[],this._viewPortObserverMap=new Map,this._isIMEInputApply=!1,this._initialDom(),this.activeViewport=null==(t=this._documents)?void 0:t.getFirstViewport(),this._documents&&this.changeDocuments(this._documents)}set activeViewport(e){this._attachScrollEvent(e),this._activeViewport=e}static create(e){return new kh(e)}getActiveTextSelection(){const e=this._textSelectionList;for(let t of e)if(t.isActive())return t}getTextSelectionList(){return this._textSelectionList}add(e){this._addTextSelection(e)}remain(){const e=this.getActiveTextSelection();if(null==e)return;const t=this._textSelectionList.indexOf(e);return this._textSelectionList.splice(t,1)[0]}sync(){this._syncDomToSelection()}active(e,t){this._container.style.left=`${e}px`,this._container.style.top=`${t}px`,this._cursor.style.animation="univer_cursor_blinkStyle 1s steps(1) infinite",this._cursor.style.display="revert",setTimeout((()=>{this._input.focus()}),0)}deactivate(){this._container.style.left="0px",this._container.style.top="0px",this._cursor.style.animation="",this._cursor.style.display="none",this._input.blur()}changeDocuments(e){var t;this._documents&&this._detachEvent(this._documents),this._documents=e,this._skeletonObserver=null==(t=e.getSkeleton())?void 0:t.onRecalculateChangeObservable.add((e=>{this._deleteAllTextSelection()})),this._attachSelectionEvent(this._documents)}dispose(){this._documents&&this._detachEvent(this._documents),this._container.remove()}_initialDom(){const e=document.createElement("div");e.style.position="absolute",e.style.position="absolute",e.style.left="0px",e.style.top="0px";const t=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div");t.appendChild(n),e.appendChild(t),e.appendChild(r),this._container=e,this._inputParent=t,this._input=n,this._cursor=r,this._initialInput(),this._initialCursorDom(),this._attachInputEvent(),document.body.appendChild(e)}_initialInput(){this._inputParent.style.cssText="\n            position:absolute;\n            height:1px;\n            width:1px;\n            overflow: hidden;\n        ",this._input.contentEditable="true",this._input.style.cssText="\n            position: absolute; \n            overflow: hidden; \n            opacity: 1; \n            background: #000; \n            color: transparent; \n            outline: none; \n            z-index: -2; \n            caret-color: transparent; \n            white-space: pre-wrap; \n            user-select: text;\n        "}_initialCursorDom(){if(this._cursor.style.cssText="\n            visibility: visible;\n            position: absolute;\n            background: #000;\n            left: 0;\n            top: 0;\n            width: 1px;\n            height: 20px;\n            opacity: 0;\n            z-index: 0;\n            pointer-events: none;\n            display: none\n        ",!la("keyframes univer_cursor_blinkStyle")){ia(["\n                @-webkit-keyframes univer_cursor_blinkStyle {\n                    0% {\n                        opacity: 1;\n                    }\n                \n                    13% {\n                        opacity: 0;\n                    }\n\n                    50% {\n                        opacity: 0;\n                    }\n\n                    63% {\n                        opacity: 1;\n                    }\n                \n                    100% {\n                        opacity: 1;\n                    }\n                }\n            ","\n                @keyframes univer_cursor_blinkStyle {\n                    0% {\n                        opacity: 1;\n                    }\n                \n                    13% {\n                        opacity: 0;\n                    }\n\n                    50% {\n                        opacity: 0;\n                    }\n\n                    63% {\n                        opacity: 1;\n                    }\n                \n                    100% {\n                        opacity: 1;\n                    }\n                }\n            "])}}_getSkeletonData(){var e,t;return null==(t=null==(e=this._documents)?void 0:e.getSkeleton())?void 0:t.getSkeletonData()}_getNodePosition(e){var t;if(!1===e)return;const{node:n,ratioX:r,ratioY:s}=e,o=null==(t=this._documents)?void 0:t.findPositionBySpan(n);return null!=o?__spreadProps(__spreadValues({},o),{isBack:r<.5}):void 0}_interactTextSelection(e){const t=[];let n=!1;this._textSelectionList.forEach((r=>{if(r===e)return!0;e.isIntersection(r)?(n=!0,r.dispose()):t.push(r)})),n&&(t.push(e),this._textSelectionList=t)}_deleteAllTextSelection(){this._textSelectionList.forEach((e=>{e.dispose()})),this._textSelectionList=[]}_deactivateTextSelection(){this._textSelectionList.forEach((e=>{e.deactivate()}))}_addTextSelection(e){this._deactivateTextSelection(),e.activate(),this._textSelectionList.push(e)}_updateTextSelection(e){if(!this._documents)return;let t=this._textSelectionList.pop();t||(t=new Nh(this._documents.getScene(),e)),this._deleteAllTextSelection(),t.activate(),t.startNodePosition=e,t.endNodePosition=null,this._textSelectionList=[t]}_isEmptyTextSelection(){return 0===this._textSelectionList.length}_getCanvasOffset(){var e,t;const n=null==(e=this._documents)?void 0:e.getEngine(),r=null==(t=null==n?void 0:n.getCanvas())?void 0:t.getCanvasEle();if(!r)return{left:0,top:0};const{top:s,left:o}=function(e){let t=e.getBoundingClientRect(),n=document.body,r=document.documentElement,s=window.pageYOffset||r.scrollTop||n.scrollTop,o=window.pageXOffset||r.scrollLeft||n.scrollLeft,i=r.clientTop||n.clientTop,l=r.clientLeft||n.clientLeft;return{top:t.top+s-i,left:t.left+o-l}}(r);return{left:o,top:s}}_syncDomToSelection(){var e;const t=this.getActiveTextSelection(),n=null==t?void 0:t.getAnchor();if(!n||n&&!n.visible)return;const{height:r,left:s,top:o}=n,i=null==(e=this._activeViewport)?void 0:e.getAbsoluteVector(ha.FromArray([s,o]));this._cursor.style.height=`${r}px`;let{left:l,top:a}=this._getCanvasOffset();l+=(null==i?void 0:i.x)||0,a+=(null==i?void 0:i.y)||0,this.active(l,a)}_moving(e,t,n){const{scrollX:r,scrollY:s}=Ea(n);if(!this._documents)return;const o=this._documents.findNodeByCoord(e,t),i=this._getNodePosition(o);if(console.log("endNode",o,i,{moveOffsetX:e,moveOffsetY:t,_viewportScrollY:this._viewportScrollY,scrollX:r}),!i)return;const l=this.getActiveTextSelection();l&&(l.endNodePosition=i,l.refresh(this._documents),this._interactTextSelection(l))}_attachScrollEvent(e){if(!e)return;const t=e.viewPortKey;if(this._viewPortObserverMap.has(t))return;const n=e.onScrollBeforeObserver.add((e=>{if(!e.viewport)return;const t=this.getActiveTextSelection();null==t||t.activeStatic(),this._cursor.style.display="none"})),r=e.onScrollStopObserver.add((e=>{const t=e.viewport;if(!t)return;const n=t.getBounding(),r=this.getActiveTextSelection(),s=null==r?void 0:r.getAnchor();if(s&&(!s||s.visible)){if(n){const{minX:e,maxX:t,minY:r,maxY:o}=Ra(s,n);if(s.strokeWidth<e||t<0||s.strokeWidth<r||o<0)return}this._syncDomToSelection(),null==r||r.deactivateStatic(),this._cursor.style.display="revert"}}));this._viewPortObserverMap.set(t,{scrollBefore:n,scrollStop:r})}_attachInputEvent(){this._input.addEventListener("keydown",(e=>{if(this._isIMEInputApply)return;const t=this.getActiveTextSelection(),n=this.getTextSelectionList();null!=this._documents&&(this._input.innerHTML="",this.onKeydownObservable.notifyObservers({event:e,content:"",document:this._documents,activeSelection:t,selectionList:n}))})),this._input.addEventListener("input",(e=>{if(this._isIMEInputApply)return;const t=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),r=this.getTextSelectionList();null!=this._documents&&this.onInputObservable.notifyObservers({event:e,content:t,document:this._documents,activeSelection:n,selectionList:r})})),this._input.addEventListener("compositionstart",(e=>{this._isIMEInputApply=!0;const t=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),r=this.getTextSelectionList();null!=this._documents&&this.onCompositionstartObservable.notifyObservers({event:e,content:t,document:this._documents,activeSelection:n,selectionList:r})})),this._input.addEventListener("compositionend",(e=>{this._isIMEInputApply=!1;const t=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),r=this.getTextSelectionList();null!=this._documents&&this.onCompositionendObservable.notifyObservers({event:e,content:t,document:this._documents,activeSelection:n,selectionList:r})})),this._input.addEventListener("compositionupdate",(e=>{const t=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),r=this.getTextSelectionList();null!=this._documents&&this.onCompositionupdateObservable.notifyObservers({event:e,content:t,document:this._documents,activeSelection:n,selectionList:r})}))}_attachSelectionEvent(e){this._moveInObserver=e.onPointerEnterObserver.add((()=>{e.cursor=Yi.TEXT})),this._moveOutObserver=e.onPointerLeaveObserver.add((()=>{e.cursor=Yi.DEFAULT,t.resetCursor()}));const t=e.getScene();this._downObserver=e.onPointerDownObserver.add(((e,n)=>{const{offsetX:r,offsetY:s}=e;if(!this._documents)return;this.activeViewport=this._documents.getActiveViewportByCoord(r,s);const o=this._documents.findNodeByCoord(r,s),i=this._getNodePosition(o);if(console.log("startNode",o,i,r,s),!i)return void this._deleteAllTextSelection();if(e.ctrlKey||this._isEmptyTextSelection()){const e=new Nh(this._documents.getScene(),i);this._addTextSelection(e)}else this._updateTextSelection(i);this._activeSelectionRefresh(),this._syncDomToSelection(),t.disableEvent();const l=La.create(t);l.startScroll(r,s);const{scrollX:a,scrollY:c}=Ea(l);this._viewportScrollX=a,this._viewportScrollY=c,this._moveObserver=t.onPointerMoveObserver.add((e=>{const{offsetX:n,offsetY:r}=e;this._moving(n,r,l),l.scrolling(n,r,(()=>{this._moving(n,r,l)})),t.setCursor(Yi.TEXT)})),this._upObserver=t.onPointerUpObserver.add((e=>{t.onPointerMoveObserver.remove(this._moveObserver),t.onPointerUpObserver.remove(this._upObserver),t.enableEvent(),l.stopScroll()}))}))}_detachEvent(e){var t;e.onPointerEnterObserver.remove(this._moveInObserver),e.onPointerLeaveObserver.remove(this._moveOutObserver),e.onPointerDownObserver.remove(this._downObserver),null==(t=e.getSkeleton())||t.onRecalculateChangeObservable.remove(this._skeletonObserver),this.onKeydownObservable.clear(),this.onInputObservable.clear(),this.onCompositionstartObservable.clear(),this.onCompositionupdateObservable.clear(),this.onCompositionendObservable.clear()}_activeSelectionRefresh(){if(!this._documents)return;const e=this.getActiveTextSelection();null==e||e.refresh(this._documents)}}class Lh extends bh{constructor(e,t,n){super(e,t,null==n?void 0:n.allowCache),this.isCalculateSkeleton=!0,this.onPageRenderObservable=new i,this._hasEditor=!1,void 0===(null==n?void 0:n.pageMarginLeft)?this.pageMarginLeft=17:this.pageMarginLeft=null==n?void 0:n.pageMarginLeft,void 0===(null==n?void 0:n.pageMarginTop)?this.pageMarginTop=14:this.pageMarginTop=null==n?void 0:n.pageMarginTop,this.pageLayoutType=(null==n?void 0:n.pageLayoutType)||dl.VERTICAL,this._drawLiquid=new Rh,this._findLiquid=new Rh,this._hasEditor=(null==n?void 0:n.hasEditor)||!1,this._initialDefaultExtension(),this._addSkeletonChangeObserver(t),this.makeDirty(!0)}get hasEditor(){return this._hasEditor}static create(e,t,n){return new Lh(e,t,n)}calculatePagePosition(){const e=this.getScene();let t=null==e?void 0:e.getParent();const{width:n,height:r,pageMarginLeft:s,pageMarginTop:o}=this;if(null==t)return;const{width:i,height:l}=t;let a=0,c=0,h=0,u=0;return i>n?(a=i/2-n/2,h=i-30):(a=s,h=n+2*s),l>r?(c=l/2-r/2,u=l-30):(c=o,u=r+2*o),e.resize(h,u+200),this.translate(a,c),{docsLeft:a,docsTop:c}}getFirstViewport(){return this.getScene().getViewports()[0]}getActiveViewportByCoord(e,t){return this.getScene().getActiveViewportByCoord(ha.FromArray([e,t]))}getEngine(){return this.getScene().getEngine()}enableEditor(){this._hasEditor||(this._editor=kh.create(this),this._hasEditor=!0)}disableEditor(){var e;null==(e=this._editor)||e.dispose(),this._hasEditor=!1}getEditorInputEvent(){if(!this._hasEditor)return;const{onInputObservable:e,onCompositionstartObservable:t,onCompositionupdateObservable:n,onCompositionendObservable:r,onKeydownObservable:s}=this._editor;return{onInputObservable:e,onCompositionstartObservable:t,onCompositionupdateObservable:n,onCompositionendObservable:r,onKeydownObservable:s}}remainActiveSelection(){if(this._hasEditor)return this._editor.remain()}addSelection(e){if(this._hasEditor)return this._editor.add(e)}syncSelection(){if(this._hasEditor)return this._editor.sync()}draw(e,t){const n=this.getSkeleton();if(!n)return;this._drawLiquid.reset();const r=n.getSkeletonData(),{pages:s}=r,o=this.getParentScale(),i=this.getExtensionsByOrder(),l=ea(o);for(let h of i)h.clearCache();let a=0,c=0;for(let h=0,u=s.length;h<u;h++){const t=s[h],{sections:n,marginTop:r=0,marginBottom:u=0,marginLeft:d=0,marginRight:g=0,width:f,height:m,renderConfig:p={}}=t,{verticalAlign:b=ct.TOP,horizontalAlign:_=lt.LEFT,centerAngle:v=0,vertexAngle:C=0,wrapStrategy:T=ut.UNSPECIFIED,isRotateNonEastAsian:w=vt.FALSE}=p,y=this._horizontalHandler(f,d,g,_),S=this._verticalHandler(m,r,u,b),E=ha.create(y,S),R=Ll(v),I=Ll(C),A=I-R;this.onPageRenderObservable.notifyObservers({page:t,pageLeft:c,pageTop:a,ctx:e}),this._startRotation(e,A);for(let s of n){const{columns:t}=s;this._drawLiquid.translateSection(s);for(let n of t){const{lines:t,width:s}=n;this._drawLiquid.translateColumn(n);const a=t.length;let c,h=null;if(0!==I){const{rotateTranslateXList:e,rotatedHeight:n,rotatedWidth:o,fixOffsetX:i,fixOffsetY:l,rotateTranslateY:a}=_a(t,s,I);let f=o;n>this.height&&T!==ut.WRAP&&(T===ut.OVERFLOW||I>0)&&(f=this.height/Math.tan(Math.abs(I)));const m=this._horizontalHandler(f,d,g,_);let p=this._verticalHandler(n,r,u,b)-l;n>this.height&&(p=I<0?this.height-(n+l):-l),c=ha.create(m+i,p),this._drawLiquid.translate(0,-a),h=e}else c=E;for(let n=0;n<a;n++){const r=t[n],{divides:s,asc:a=0,type:u,lineHeight:d=0}=r;let g=a;const f=g*Math.sin(R),m=g*Math.cos(R);if(u===al.BLOCK)for(let t of i)t.type===yh.LINE&&(t.extensionOffset={alignOffset:c,renderConfig:p},t.draw(e,o,r));else{this._drawLiquid.translateSave(),this._drawLiquid.translateLine(r,!0),h&&this._drawLiquid.translate(h[n]);const t=s.length;for(let n=0;n<t;n++){const t=s[n],{spanGroup:r}=t;this._drawLiquid.translateSave(),this._drawLiquid.translateDivide(t);for(let n of r){if(!n.content||0===n.content.length)continue;const{width:t,left:r}=n,{x:s,y:a}=this._drawLiquid,h=ha.create(Wl(s,l),Wl(a,l)),u=ha.create(Wl(t/2,l),Wl(d/2,l)),g=pa(h.addByPoint(Wl(r,l),0),u,R,I,c),b=pa(h.addByPoint(Wl(r+f,l),Wl(m,l)),u,R,I,c),_={originTranslate:h,spanStartPoint:g,spanPointWithFont:b,centerPoint:u,alignOffset:c,renderConfig:p};for(let l of i)l.type===yh.SPAN&&(l.extensionOffset=_,l.draw(e,o,n))}this._drawLiquid.translateRestore()}this._drawLiquid.translateRestore()}}}}this._resetRotation(e,A);const{x:x,y:O}=this._drawLiquid.translatePage(t,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop);c+=x,a+=O}}changeSkeleton(e){return this._disposeSkeletonChangeObserver(this.getSkeleton()),this.setSkeleton(e),this._addSkeletonChangeObserver(e),this}findPositionBySpan(e){var t;const n=e.parent,r=null==n?void 0:n.parent,s=null==r?void 0:r.parent,o=null==s?void 0:s.parent,i=null==o?void 0:o.parent,l=null==(t=this.getSkeleton())?void 0:t.getSkeletonData();if(!(n&&s&&o&&i&&l))return;return{span:n.spanGroup.indexOf(e),divide:r.divides.indexOf(n),line:s.lines.indexOf(r),column:o.columns.indexOf(s),section:i.sections.indexOf(o),page:l.pages.indexOf(i)}}findNodeByCharIndex(e){const t=this.getSkeleton();if(!t)return;const n=t.getSkeletonData().pages;for(let r of n){const{sections:t,st:n,ed:s}=r;if(!(e<n||e>s))for(let r of t){const{columns:t,st:n,ed:s}=r;if(!(e<n||e>s))for(let r of t){const{lines:t,st:n,ed:s}=r;if(!(e<n||e>s))for(let r of t){const{divides:t,lineHeight:n,st:s,ed:o}=r,i=t.length;if(!(e<s||e>o))for(let r=0;r<i;r++){const n=t[r],{spanGroup:s,st:o,ed:i}=n;if(e<o||e>i)continue;const l=s[e-o];if(l)return l}}}}}}findNodeByCoord(e,t){const n=this.getScene().transformToSceneCoord(ha.FromArray([e,t]));if(!n)return!1;const r=this._getInverseCoord(n);let{x:s,y:o}=r;const i=this.getSkeleton();if(!i)return!1;this._findLiquid.reset();const l=i.getSkeletonData().pages;for(let a=0,c=l.length;a<c;a++){const e=l[a],{startX:t,startY:n,endX:r,endY:i}=this._getPageBoundingBox(e);if(!(s>=t&&s<=r&&o>=n&&o<=i)){this._translatePage(e);continue}this._findLiquid.translatePagePadding(e);const c=e.sections;for(let l of c){const{columns:e,height:t}=l;this._findLiquid.translateSection(l);const{y:n}=this._findLiquid;if(o>=n&&o<=n+t)for(let r of e){const{lines:e,width:t}=r;this._findLiquid.translateColumn(r);const{x:n}=this._findLiquid;if(!(s>=n&&s<=n+t))continue;const i=e.length;for(let r=0;r<i;r++){const t=e[r],{divides:n,type:i,lineHeight:l=0}=t;if(i!==al.BLOCK){this._findLiquid.translateSave(),this._findLiquid.translateLine(t);const{y:e}=this._findLiquid,r=e,i=e+l;if(!(o>=r&&o<=i)){this._findLiquid.translateRestore();continue}const a=n.length;for(let t=0;t<a;t++){const e=n[t],{spanGroup:l,width:a}=e;this._findLiquid.translateSave(),this._findLiquid.translateDivide(e);const{x:c}=this._findLiquid;if(s>=c&&s<=c+a){for(let e of l){if(!e.content||0===e.content.length)continue;const{width:t,left:n}=e,l=c+n,a=c+n+t;if(s>=l&&s<=a)return{node:e,ratioX:s/(l+a),ratioY:o/(r+i)}}this._findLiquid.translateRestore()}else this._findLiquid.translateRestore()}this._findLiquid.translateRestore()}}}}this._findLiquid.restorePagePadding(e),this._translatePage(e)}return!1}_draw(e,t){this.draw(e,t)}_horizontalHandler(e,t,n,r){let s=0;return s=r===lt.CENTER?(this.width-e)/2:r===lt.RIGHT?this.width-e-n:t,s}_verticalHandler(e,t,n,r){let s=0;return s=r===ct.MIDDLE?(this.height-e)/2:r===ct.BOTTOM?this.height-e-n:t,s}_startRotation(e,t){e.rotate(t||0)}_resetRotation(e,t){e.rotate(-t||0)}_initialDefaultExtension(){wh.getData().forEach((e=>{this.register(e)}))}_addSkeletonChangeObserver(e){e&&(this._skeletonObserver=e.onRecalculateChangeObservable.add((e=>{const t=e.pages;let n=0,r=0;for(let s=0,o=t.length;s<o;s++){const e=t[s],{pageWidth:i,pageHeight:l}=e;this.pageLayoutType===dl.VERTICAL?(r+=l,s!==o-1&&(r+=this.pageMarginTop),n=Math.max(n,i)):this.pageLayoutType===dl.HORIZONTAL&&(n+=i,s!==o-1&&(n+=this.pageMarginLeft),r=Math.max(r,l))}this.resize(n,r),this.calculatePagePosition()})))}_disposeSkeletonChangeObserver(e){e&&e.onRecalculateChangeObservable.remove(this._skeletonObserver)}_getPageBoundingBox(e){const{pageWidth:t,pageHeight:n}=e;let{x:r,y:s}=this._findLiquid,o=-1,i=-1;return this.pageLayoutType===dl.VERTICAL?(o=t,i=s+n):this.pageLayoutType===dl.HORIZONTAL&&(o=r+t,i=n),{startX:r,startY:s,endX:o,endY:i}}_translatePage(e){this._findLiquid.translatePage(e,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop)}}const Dh=["text","richText"];class Ph extends Sa{constructor(e,t,n){super(t),this._allowCache=!1,(null==n?void 0:n.richText)?this._documentData=n.richText:n&&(this._fs=n.fs,this._ff=n.ff,this._it=n.it,this._bl=n.bl,this._ul=n.ul,this._st=n.st,this._ol=n.ol,this._bg=n.bg,this._bd=n.bd,this._cl=n.cl,this._documentData=this.convertToDocumentData(n.text||"")),this._allowCache&&(this._cacheCanvas=new Aa,this.onTransformChangeObservable.add((()=>{this.resizeCacheCanvas()}))),this._context=e,this._documentSkeleton=mh.create(this._documentData,this._context),this._documents=new Lh(`${this.oKey}_DOCUMENTS`,this._documentSkeleton,{pageMarginLeft:0,pageMarginTop:0}),this._initialProps(n),this.onTransformChangeObservable.add((e=>{const{type:t,value:n,preValue:r}=e;if(t===Cl.resize||t===Cl.all){this._documentSkeleton.updateDocumentDataPageSize(this.width),this._documentSkeleton.makeDirty(!0),this._documentSkeleton.calculate();const e=this.getDocsSkeletonPageSize();this.height=(null==e?void 0:e.height)||this.height,this._setTransForm()}}))}get documentData(){return this._documentData}getDocsSkeletonPageSize(){var e;const t=null==(e=this._documentSkeleton)?void 0:e.getSkeletonData();if(!t)return;const{pages:n}=t,r=n[n.length-1],{width:s,height:o}=r;return{width:s,height:o}}setProps(e){if(!e)return;const t=Object.keys(e);return 0!==t.length?(t.forEach((t=>{if(void 0===e[t])return!0;-1===Dh.indexOf(t)&&(this[`_${t}`]=e[t])})),this.makeDirty(!0),this):void 0}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{minX:e,maxX:n,minY:r,maxY:s}=Ra(this,t);if(this.width+this.strokeWidth<e||n<0||this.height+this.strokeWidth<r||s<0)return this}const n=this.transform.getMatrix();if(e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const e=this._cacheCanvas.getContext();this._cacheCanvas.clear(),e.save(),e.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(e),e.restore()}this._applyCache(e)}else this._draw(e);return e.restore(),this.makeDirty(!1),this}getContext(){return this._context}toJson(){const e={};return Dh.forEach((t=>{this[t]&&(e[t]=this[t])})),__spreadValues(__spreadValues({},super.toJson()),e)}_draw(e){this._documents.render(e)}convertToDocumentData(e){const t=e.length;return{id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:t,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:t,et:B.TEXT_RUN,tr:{ct:e,ts:{fs:this._fs||14,ff:this._ff,it:this._it,bl:this._bl,ul:this._ul,st:this._st,ol:this._ol,bg:this._bg,bd:this._bd,cl:this._cl}}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0}}}}_initialProps(e){this._documentSkeleton.updateDocumentDataPageSize(null==e?void 0:e.width,null==e?void 0:e.height),this._documentSkeleton.calculate();const t=this.getDocsSkeletonPageSize();this.transformByState({width:(null==t?void 0:t.width)||0,height:(null==t?void 0:t.height)||0,left:(null==e?void 0:e.left)||0,top:(null==e?void 0:e.top)||0,angle:null==e?void 0:e.angle}),this.setProps(e),this.makeDirty(!0)}_applyCache(e){if(!e||!this._cacheCanvas)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,r=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,r,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}}var Bh,Hh;(Hh=Bh||(Bh={})).RESIZE_LT="__SpreadsheetTransformerResizeLT__",Hh.RESIZE_CT="__SpreadsheetTransformerResizeCT__",Hh.RESIZE_RT="__SpreadsheetTransformerResizeRT__",Hh.RESIZE_LM="__SpreadsheetTransformerResizeLM__",Hh.RESIZE_RM="__SpreadsheetTransformerResizeRM__",Hh.RESIZE_LB="__SpreadsheetTransformerResizeLB__",Hh.RESIZE_CB="__SpreadsheetTransformerResizeCB__",Hh.RESIZE_RB="__SpreadsheetTransformerResizeRB__",Hh.OUTLINE="__SpreadsheetTransformerOutline__",Hh.ROTATE_LINE="__SpreadsheetTransformerRotateLine__",Hh.ROTATE="__SpreadsheetTransformerRotate__",Hh.GROUP="__SpreadsheetTransformer__";const Fh=[Bh.RESIZE_LT,Bh.RESIZE_CT,Bh.RESIZE_RT,Bh.RESIZE_LM,Bh.RESIZE_RM,Bh.RESIZE_LB,Bh.RESIZE_CB,Bh.RESIZE_RB];var zh,Uh,Wh,Vh,jh,Yh,Gh,Xh;(Uh=zh||(zh={}))[Uh.MOVE_START=0]="MOVE_START",Uh[Uh.MOVING=1]="MOVING",Uh[Uh.MOVE_END=2]="MOVE_END";class $h{constructor(e,t){this._scene=e,this.hoverEnabled=!1,this.resizeEnabled=!0,this.rotateEnabled=!0,this.rotationSnaps=[],this.rotationSnapTolerance=5,this.rotateAnchorOffset=50,this.rotateSize=10,this.rotateCornerRadius=10,this.borderEnabled=!0,this.borderStroke="rgb(97, 97, 97)",this.borderStrokeWidth=1,this.borderDash=[],this.borderSpacing=10,this.anchorFill="rgb(255,255,255)",this.anchorStroke="rgb(185,185,185)",this.anchorStrokeWidth=1,this.anchorSize=10,this.anchorCornerRadius=10,this.keepRatio=!0,this.centeredScaling=!1,this.enabledAnchors=[1,1,1,1,1,1,1,1],this.flipEnabled=!1,this.ignoreStroke=!1,this.onChangeStartObservable=new i,this.onChangingObservable=new i,this.onChangeEndObservable=new i,this.onClearControlObservable=new i,this.onCreateControlObservable=new i,this._transformerControlMap=new Map,this._selectedObjectMap=new Map,this._initialProps(t)}getScene(){return this._scene}attachTo(e){if(e.isTransformer)return this.hoverEnabled&&(this.hoverEnterFunc&&e.onPointerEnterObserver.add(this.hoverEnterFunc),this.hoverLeaveFunc&&e.onPointerLeaveObserver.add(this.hoverLeaveFunc)),e.onPointerDownObserver.add(((t,n)=>{const{offsetX:r,offsetY:s}=t;this._startOffsetX=r,this._startOffsetY=s;const o=this._getTopScene();if(!o)return;this._addCancelObserver(o),o.disableEvent();const i=La.create(o);i.startScroll(r,s);const{scrollX:l,scrollY:a}=Ea(i);this._viewportScrollX=l,this._viewportScrollY=a,this._updateActiveObjectList(e,t),this._moveObserver=o.onPointerMoveObserver.add((e=>{const{offsetX:t,offsetY:n}=e;this._moving(t,n,i),this._hiddenControl(),i.scrolling(t,n,(()=>{this._moving(t,n,i)}))})),this._upObserver=o.onPointerUpObserver.add((e=>{o.onPointerMoveObserver.remove(this._moveObserver),o.onPointerUpObserver.remove(this._upObserver),o.enableEvent(),this._updateControl(),i.stopScroll(),this.onChangeEndObservable.notifyObservers({objects:this._selectedObjectMap,type:2})})),n.stopPropagation()})),e}dispose(){this._moveObserver=null,this._upObserver=null,this._transformerControlMap.forEach((e=>{e.dispose()})),this._selectedObjectMap.forEach((e=>{e.dispose()})),this.onChangeStartObservable.clear(),this.onChangingObservable.clear(),this.onChangeEndObservable.clear()}_initialProps(e){if(!e)return;const t=Object.keys(e);0!==t.length&&t.forEach((t=>{if(void 0===e[t])return!0;this[t]=e[t]}))}_updateControlChildren(){this._updateControlIterator(((e,t)=>{const{left:n,top:r,width:s,height:o,scaleX:i,scaleY:l}=t.getState();e.getObjects().forEach((e=>{const t=e.oKey,n=this._checkTransformerType(t);if(!n)return!0;if(n===Bh.OUTLINE)e.transformByState(this._getOutlinePosition(s,o,i,l));else{const{left:t,top:r}=this._getRotateAnchorPosition(n,o,s,i,l);e.transformByState({left:t,top:r})}})),e.transformByState({left:n,top:r})}))}_anchorMoving(e,t,n,r){const{scrollX:s,scrollY:o}=Ea(r),i=t-this._viewportScrollX+s,l=n-this._viewportScrollY+o,a=i-this._startOffsetX,c=l-this._startOffsetY;this._selectedObjectMap.forEach((t=>{const{left:n,top:r,width:s,height:o}=t,i={};switch(e){case Bh.RESIZE_LT:i.left=n+a,i.top=r+c,i.width=s-a,i.height=o-c;break;case Bh.RESIZE_CT:i.top=r+c,i.height=o-c;break;case Bh.RESIZE_RT:i.top=r+c,i.width=s+a,i.height=o-c;break;case Bh.RESIZE_LM:i.left=n+a,i.width=s-a;break;case Bh.RESIZE_RM:i.width=a+s;break;case Bh.RESIZE_LB:i.left=n+a,i.width=s-a,i.height=o+c;break;case Bh.RESIZE_CB:i.height=c+o;break;case Bh.RESIZE_RB:i.width=a+s,i.height=c+o}t.transformByState(i)})),this._updateControlChildren(),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:a,moveY:c,type:1}),this._startOffsetX=i,this._startOffsetY=l}_attachEventToAnchor(e,t=Bh.RESIZE_LT){e.onPointerDownObserver.add(((e,n)=>{const{offsetX:r,offsetY:s}=e;this._startOffsetX=r,this._startOffsetY=s;const o=this._getTopScene();if(null==o)return;o.disableEvent();const i=La.create(o);i.startScroll(r,s);const{scrollX:l,scrollY:a}=Ea(i);this._viewportScrollX=l,this._viewportScrollY=a;const c=this._getRotateAnchorCursor(t);this._moveObserver=o.onPointerMoveObserver.add((e=>{const{offsetX:n,offsetY:r}=e;this._anchorMoving(t,n,r,i),i.scrolling(n,r,(()=>{this._anchorMoving(t,n,r,i)})),o.setCursor(c)})),this._upObserver=o.onPointerUpObserver.add((e=>{o.onPointerMoveObserver.remove(this._moveObserver),o.onPointerUpObserver.remove(this._upObserver),o.enableEvent(),o.resetCursor(),i.stopScroll()})),n.stopPropagation()}))}_attachEventToRotate(e){e.onPointerDownObserver.add(((e,t)=>{const{offsetX:n,offsetY:r}=e;this._startOffsetX=n,this._startOffsetY=r;const s=this._getTopScene();null!=s&&(s.disableEvent(),this._viewportScrollX=scrollX,this._viewportScrollY=scrollY,this._moveObserver=s.onPointerMoveObserver.add((e=>{})),this._upObserver=s.onPointerUpObserver.add((e=>{s.onPointerMoveObserver.remove(this._moveObserver),s.onPointerUpObserver.remove(this._upObserver),s.enableEvent()})),t.stopPropagation())}))}_getOutlinePosition(e,t,n,r){return{left:-this.borderSpacing-this.borderStrokeWidth,top:-this.borderSpacing-this.borderStrokeWidth,width:e+2*this.borderSpacing,height:t+2*this.borderSpacing}}_getRotateAnchorCursor(e){let t=Yi.NORTH_WEST_RESIZE;switch(e){case Bh.ROTATE:case Bh.ROTATE_LINE:t=Yi.MOVE;break;case Bh.RESIZE_LT:break;case Bh.RESIZE_CT:t=Yi.NORTH_RESIZE;break;case Bh.RESIZE_RT:t=Yi.NORTH_EAST_RESIZE;break;case Bh.RESIZE_LM:t=Yi.WEST_RESIZE;break;case Bh.RESIZE_RM:t=Yi.EAST_RESIZE;break;case Bh.RESIZE_LB:t=Yi.SOUTH_WEST_RESIZE;break;case Bh.RESIZE_CB:t=Yi.SOUTH_RESIZE;break;case Bh.RESIZE_RB:t=Yi.SOUTH_EAST_RESIZE}return t}_getRotateAnchorPosition(e,t,n,r,s){let o=-this.anchorSize/2,i=-this.anchorSize/2;switch(e){case Bh.ROTATE:o=n/2-this.rotateSize/2,i=-this.rotateAnchorOffset-this.borderSpacing-2*this.borderStrokeWidth-this.rotateSize;break;case Bh.ROTATE_LINE:o=n/2,i=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth;break;case Bh.RESIZE_LT:o+=-this.borderSpacing-this.borderStrokeWidth,i+=-this.borderSpacing-this.borderStrokeWidth;break;case Bh.RESIZE_CT:o+=n/2,i+=-this.borderSpacing-this.borderStrokeWidth;break;case Bh.RESIZE_RT:o+=n+this.borderSpacing-this.borderStrokeWidth,i+=-this.borderSpacing-this.borderStrokeWidth;break;case Bh.RESIZE_LM:o+=-this.borderSpacing-this.borderStrokeWidth,i+=t/2;break;case Bh.RESIZE_RM:o+=n+this.borderSpacing-this.borderStrokeWidth,i+=t/2;break;case Bh.RESIZE_LB:o+=-this.borderSpacing-this.borderStrokeWidth,i+=t+this.borderSpacing-this.borderStrokeWidth;break;case Bh.RESIZE_CB:o+=n/2,i+=t+this.borderSpacing-this.borderStrokeWidth;break;case Bh.RESIZE_RB:o+=n+this.borderSpacing-this.borderStrokeWidth,i+=t+this.borderSpacing-this.borderStrokeWidth}return{left:o,top:i}}_createResizeAnchor(e,t,n){let{height:r,width:s,scaleX:o,scaleY:i}=t.getState();const{left:l,top:a}=this._getRotateAnchorPosition(e,r,s,o,i),c=this._getRotateAnchorCursor(e),h=new Ha(`${e}_${n}`,{zIndex:n-1,fill:this.anchorFill,stroke:this.anchorStroke,strokeWidth:this.anchorStrokeWidth,width:this.anchorSize,height:this.anchorSize,radius:this.anchorCornerRadius,left:l,top:a});return this._attachHover(h,c,Yi.DEFAULT),h}_checkTransformerType(e){return e.indexOf(Bh.OUTLINE)>-1?Bh.OUTLINE:e.indexOf(Bh.ROTATE)>-1?Bh.ROTATE:e.indexOf(Bh.ROTATE_LINE)>-1?Bh.ROTATE_LINE:e.indexOf(Bh.RESIZE_LT)>-1?Bh.RESIZE_LT:e.indexOf(Bh.RESIZE_CT)>-1?Bh.RESIZE_CT:e.indexOf(Bh.RESIZE_RT)>-1?Bh.RESIZE_RT:e.indexOf(Bh.RESIZE_LM)>-1?Bh.RESIZE_LM:e.indexOf(Bh.RESIZE_RM)>-1?Bh.RESIZE_RM:e.indexOf(Bh.RESIZE_LB)>-1?Bh.RESIZE_LB:e.indexOf(Bh.RESIZE_CB)>-1?Bh.RESIZE_CB:e.indexOf(Bh.RESIZE_RB)>-1?Bh.RESIZE_RB:void 0}_updateControlIterator(e){this._transformerControlMap.forEach(((t,n)=>{const r=this._selectedObjectMap.get(n);if(!r)return!0;e(t,r)}))}_updateControl(){this._updateControlIterator(((e,t)=>{const{left:n,top:r}=t.getState();e.transformByState({left:n,top:r}),e.show(),e.makeDirty(!0)}))}_hiddenControl(){this._transformerControlMap.forEach((e=>{e.hide(),e.makeDirty(!0)}))}_attachHover(e,t,n){e.onPointerEnterObserver.add((()=>{e.cursor=t})),e.onPointerLeaveObserver.add((()=>{e.cursor=n}))}_clearControl(){this._transformerControlMap.forEach((e=>{e.dispose()})),this._transformerControlMap.clear(),this.onClearControlObservable.notifyObservers(null)}_createControl(e){let{left:t,top:n,height:r,width:s,angle:o,scaleX:i,scaleY:l,skewX:a,skewY:c,flipX:h,flipY:u}=e.getState();const d=e.oKey,g=this._selectedObjectMap.size,f=[];if(this.borderEnabled){const e=new Ha(`${Bh.OUTLINE}_${g}`,__spreadValues({zIndex:g-1,evented:!1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke},this._getOutlinePosition(s,r,i,l)));f.push(e)}if(this.resizeEnabled){const{left:e,top:t}=this._getRotateAnchorPosition(Bh.ROTATE_LINE,r,s,i,l),n=new Ha(`${Bh.ROTATE_LINE}_${g}`,{zIndex:g-1,evented:!1,left:e,top:t,height:this.rotateAnchorOffset,width:1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke}),{left:o,top:a}=this._getRotateAnchorPosition(Bh.ROTATE,r,s,i,l),c=this._getRotateAnchorCursor(Bh.ROTATE),h=new Ha(`${Bh.ROTATE}_${g}`,{zIndex:g-1,left:o,top:a,height:this.rotateSize,width:this.rotateSize,radius:this.rotateCornerRadius,strokeWidth:2*this.borderStrokeWidth,stroke:this.borderStroke});this._attachEventToRotate(h),this._attachHover(h,c,Yi.DEFAULT),f.push(n,h)}if(this.resizeEnabled)for(let b=0,_=this.enabledAnchors.length;b<_;b++){if(1!==this.enabledAnchors[b])continue;const t=Fh[b],n=this._createResizeAnchor(t,e,g);this._attachEventToAnchor(n,t),f.push(n)}const m=new ka(`${Bh.GROUP}_${g}`,...f);m.zIndex=g,m.evented=!1,m.transformByState({left:t,top:n});const p=this.getScene();return p.addObject(m,2),console.log(p,e),this._transformerControlMap.set(d,m),this.onCreateControlObservable.notifyObservers(m),m}_getTopScene(){var e;return null==(e=this.getScene().getEngine())?void 0:e.activeScene}_moving(e,t,n){const{scrollX:r,scrollY:s}=Ea(n),o=e-this._viewportScrollX+r,i=t-this._viewportScrollY+s,l=o-this._startOffsetX,a=i-this._startOffsetY;this._selectedObjectMap.forEach((e=>{e.translate(l+e.left,a+e.top)})),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:l,moveY:a,type:1}),this._startOffsetX=o,this._startOffsetY=i}_updateActiveObjectList(e,t){this._selectedObjectMap.has(e.oKey)||(t.ctrlKey||(this._selectedObjectMap.clear(),this._clearControl()),this._selectedObjectMap.set(e.oKey,e),this._createControl(e))}_addCancelObserver(e){e.onPointerDownObserver.remove(this._cancelFocusObserver),this._cancelFocusObserver=e.onPointerDownObserver.add((t=>{this._selectedObjectMap.clear(),this._clearControl(),e.onPointerDownObserver.remove(this._cancelFocusObserver)}))}}class Qh{constructor(e,t,n){var r;if(this._parent=t,this.onPointerDownObserver=new i,this.onPointerMoveObserver=new i,this.onPointerUpObserver=new i,this.onDblclickObserver=new i,this.onMouseWheelObserver=new i,this.onKeyDownObservable=new i,this.onKeyUpObservable=new i,this.onTransformChangeObservable=new i,this._layers=[],this._sceneKey="",this._viewports=[],this._width=100,this._height=100,this._scaleX=1,this._scaleY=1,this._transform=new da,this._isFirstDirty=!0,this._evented=!0,this._cursor=Yi.DEFAULT,this._transformerOpenState=!1,this._sceneKey=e,n&&this.transformByState(n),this._parent.classType===el.ENGINE){const t=this._parent;t.addScene(this),t.hasActiveScene()||t.setActiveScene(e),this._inputManager=new Na(this)}else if(this._parent.classType===el.SCENE_VIEWER){this._parent.addSubScene(this)}null==(r=this._parent)||r.onTransformChangeObservable.add((e=>{this._resetViewportSize(),this._setTransForm()}))}get classType(){return el.SCENE}get transform(){return this._transform}get width(){return this._width}get height(){return this._height}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){const e=this.getParent();let t=1;return e.classType===el.SCENE_VIEWER&&(t=e.ancestorScaleX),this._scaleX*t}get ancestorScaleY(){const e=this.getParent();let t=1;return e.classType===el.SCENE_VIEWER&&(t=e.ancestorScaleY),this._scaleY*t}get cursor(){return this._cursor}get sceneKey(){return this._sceneKey}get evented(){return this._evented}set transform(e){this._transform=e}set cursor(e){this.setCursor(e)}set width(e){this._width=e}set height(e){this._height=e}set scaleX(e){this._scaleX=e}set scaleY(e){this._scaleY=e}attachControl(e=!0,t=!0,n=!0,r=!0){var s;if(this._parent.classType===el.ENGINE)return null==(s=this._inputManager)||s.attachControl(e,t,n,r),this}detachControl(){var e;return null==(e=this._inputManager)||e.detachControl(),this}makeDirty(e=!0){var t;return this._viewports.forEach((t=>{t.makeDirty(e)})),this._parent.classType===el.SCENE_VIEWER&&(null==(t=this._parent)||t.makeDirty(e)),this}makeDirtyNoParent(e=!0){return this._viewports.forEach((t=>{t.makeDirty(e)})),this}isDirty(){for(let e=0;e<this._viewports.length;e++){if(!0===this._viewports[e].isDirty())return!0}return!1}resetCursor(){this.setCursor(Yi.DEFAULT)}setCursor(e){this._cursor=e;const t=this.getEngine();if(!t)return;t.getCanvas().getCanvasEle().style.cursor=e}resize(e,t){const n=this.width;void 0!==e&&(this.width=e);const r=this.height;return void 0!==t&&(this.height=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Cl.resize,value:{width:this.width,height:this.height},preValue:{width:n,height:r}}),this}scale(e,t){const n=this.scaleX;void 0!==e&&(this.scaleX=e);const r=this.scaleY;return void 0!==t&&(this.scaleY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Cl.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:r}}),this}scaleBy(e,t){const n=this.scaleX;void 0!==e&&(this.scaleX+=e);const r=this.scaleY;return void 0!==t&&(this.scaleY+=t),this.scaleX=Ul(this.scaleX,1),this.scaleY=Ul(this.scaleY,1),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Cl.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:r}}),this}transformByState(e){const t=Object.keys(e),n={};0!==t.length&&(t.forEach((t=>{void 0!==e[t]&&(n[t]=this[t],this[t]=e[t])})),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Cl.all,value:e,preValue:n}))}getParent(){return this._parent}getEngine(){if(this._parent.classType===el.ENGINE)return this._parent;let e=this._parent;for(;e;){if(e.classType===el.ENGINE)return e;e=null==e?void 0:e.getParent()}return null}getLayers(){return this._layers}getLayer(e=1){for(let t of this._layers)if(t.zIndex===e)return t;return this._createDefaultLayer(e)}getLayerMaxZIndex(){let e=Number.MIN_VALUE;for(let t=0;t<this._layers.length;t++){const n=this._layers[t];n.zIndex>=e&&(e=n.zIndex)}return e}addLayer(...e){this._layers.push(...e)}addObject(e,t=1){var n;return null==(n=this.getLayer(t))||n.addObject(e),this}setObjectBehavior(e){e.parent||(e.parent=this),this.onTransformChangeObservable.add((t=>{e.scaleCacheCanvas()})),e.onIsAddedToParentObserver.notifyObservers(this)}addObjects(e,t=1){var n;return null==(n=this.getLayer(t))||n.addObjects(e),this}removeObject(e){if(null==e)return;const t=this.getLayers();for(let n of t)n.removeObject(e);return this}removeObjects(e){if(null==e)return;const t=this.getLayers();for(let n of t)n.removeObjects(e);return this}getAllObjects(){const e=[];this._layers.sort(Ar);for(let t of this._layers)e.push(...t.getObjectsByOrder());return e}getAllObjectsByOrder(e=!1){const t=[],n=e?xr:Ar;this._layers.sort(n);for(let r of this._layers)t.push(...r.getObjectsByOrder().sort(n));return t}getAllObjectsByOrderForPick(e=!1){const t=[],n=e?xr:Ar;this._layers.sort(n);for(let r of this._layers)t.push(...r.getObjectsByOrderForPick().sort(n));return t}getObject(e){for(let t of this._layers){const n=t.getObjectsByOrder();for(let t of n)if(t.oKey===e)return t}}fuzzyMathObjects(e){for(let t of this._layers){const n=t.getObjectsByOrder();for(let t of n)t.oKey.indexOf(e)>-1&&n.push(t)}return[]}addViewport(...e){return this._viewports.push(...e),this}removeViewport(){}getViewports(){return this._viewports}getViewport(e){for(let t of this._viewports)if(t.viewPortKey===e)return t}changeObjectOrder(){}renderObjects(e,t){return this.getAllObjectsByOrder().forEach((n=>{n.render(e,t)})),this}render(e){var t,n;this.isDirty()&&(!e&&(null==(t=this.getEngine())||t.getCanvas().clear()),null==(n=this.getViewports())||n.forEach((t=>t.render(e))))}enableEvent(){this._evented=!0}disableEvent(){this._evented=!1}async requestRender(e){return new Promise(((t,n)=>{this.render(e),Ol(t)}))}openTransformer(e){this._transformer||(this._transformer=new $h(this,e)),this._transformerOpenState=!0}closeTransformer(e=!1){e&&(this._transformer=null),this._transformerOpenState=!1}applyTransformer(e){var t;this._transformerOpenState&&(null==(t=this._transformer)||t.attachTo(e))}getTransformer(){return this._transformer}getActiveViewportByRelativeCoord(e){return this._viewports.find((t=>t.isHit(e)))}getActiveViewportByCoord(e){return e=this.getRelativeCoord(e),this.getActiveViewportByRelativeCoord(e)}getRelativeCoord(e){let t=this.getParent();const n=[];for(;t;)t.classType!==el.SCENE&&t.classType!==el.SCENE_VIEWER||n.push(t),t=(null==t?void 0:t.getParent)&&(null==t?void 0:t.getParent());n.reverse();for(let r of n)if(r.classType===el.SCENE){const t=r.getActiveViewportByCoord(e);if(t){const n=t.actualScrollX||0,r=t.actualScrollY||0;e=e.addByPoint(n,r)}}else if(r.classType===el.SCENE_VIEWER){e=r.transform.clone().invert().applyPoint(e)}return e}transformToSceneCoord(e){const t=this.getActiveViewportByCoord(e);return null==t?void 0:t.getRelativeVector(e)}clearLayer(){this._layers=[]}clearViewports(){this._viewports=[]}dispose(){var e;this.getLayers().forEach((e=>{e.dispose()})),this.getViewports().forEach((e=>{e.dispose()})),this.clearLayer(),this.clearViewports(),this.detachControl(),null==(e=this._transformer)||e.dispose(),this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onDblclickObserver.clear(),this.onMouseWheelObserver.clear(),this.onKeyDownObservable.clear(),this.onKeyUpObservable.clear()}pick(e){let t=this.getActiveViewportByCoord(e);if(t||(t=this._viewports[0]),!this._evented||!t)return;const n=t.pickScrollBar(e);if(n)return n;const r=t.getRelativeVector(e);let s=null;const o=this.getAllObjectsByOrderForPick().reverse(),i=o.length;for(let l=0;l<i;l++){const e=o[l];if(!e.visible||!e.evented||e.classType===el.GROUP)continue;let t=r;if(e.isInGroup&&e.parent.classType===el.GROUP){const{cumLeft:n,cumTop:r}=this._getGroupCumLeftRight(e);t=t.clone().add(ha.FromArray([-n,-r]))}if(e.isHit(t)){if(e.classType===el.SCENE_VIEWER){const n=e.pick(t);s=n||e.getActiveSubScene()}else s=e;break}if(e.classType===el.SCENE_VIEWER&&e.allowSelectedClipElement()){const n=e.pick(t);if(n){s=n;break}}}return s||this._parent.classType!==el.ENGINE?s:this}on(e,t){return this[`on${e}Observer`].add(t.bind(this))}off(e,t){this[`on${e}Observer`].remove(t)}remove(e){this[`on${e}Observer`].clear()}triggerKeyDown(e){this.onKeyDownObservable.notifyObservers(e)}triggerKeyUp(e){this.onKeyUpObservable.notifyObservers(e)}triggerPointerUp(e){var t,n;return!(!(null==(t=this.onPointerUpObserver.notifyObservers(e))?void 0:t.stopPropagation)&&this._parent.classType===el.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerPointerUp(e),!1)}triggerMouseWheel(e){var t,n;return!(!(null==(t=this.onMouseWheelObserver.notifyObservers(e))?void 0:t.stopPropagation)&&this._parent.classType===el.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerMouseWheel(e),!1)}triggerPointerMove(e){var t,n;return!(!(null==(t=this.onPointerMoveObserver.notifyObservers(e))?void 0:t.stopPropagation)&&this._parent.classType===el.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerPointerMove(e),!1)}triggerDblclick(e){var t,n;return!(!(null==(t=this.onDblclickObserver.notifyObservers(e))?void 0:t.stopPropagation)&&this._parent.classType===el.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerDblclick(e),!1)}triggerPointerDown(e){var t,n;return!(!(null==(t=this.onPointerDownObserver.notifyObservers(e))?void 0:t.stopPropagation)&&this._parent.classType===el.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerPointerDown(e),!1)}triggerPointerOut(e){var t;return this._parent.classType!==el.SCENE_VIEWER||(null==(t=this._parent)||t.triggerPointerOut(e),!1)}triggerPointerLeave(e){var t;return this._parent.classType!==el.SCENE_VIEWER||(null==(t=this._parent)||t.triggerPointerLeave(e),!1)}triggerPointerOver(e){var t;return this._parent.classType!==el.SCENE_VIEWER||(null==(t=this._parent)||t.triggerPointerOver(e),!1)}triggerPointerEnter(e){var t;return this._parent.classType!==el.SCENE_VIEWER||(null==(t=this._parent)||t.triggerPointerEnter(e),!1)}_createDefaultLayer(e=1){const t=Oa.create(this,[],e);return this.addLayer(t),t}_resetViewportSize(){this.getViewports().forEach((e=>{e.resetSize()}))}_setTransForm(){const e=da.create().composeMatrix({scaleX:this.scaleX,scaleY:this.scaleY});this.transform=e,this.getViewports().forEach((e=>{e.resizeScrollBar()})),this.makeDirty(!0)}_getGroupCumLeftRight(e){let t=e.parent,n=0,r=0;for(;t.classType===el.GROUP;){const{left:e,top:s}=t;n+=e,r+=s,t=t.parent}return{cumLeft:n,cumTop:r}}}class Kh extends Sa{constructor(e,t){super(e),this._subScenes=new Map,this._allowSelectedClipElement=!1,this._initialProps(t)}get classType(){return el.SCENE_VIEWER}render(e,t){var n;if(!this.visible)return this.makeDirty(!1),this;if(t){const{minX:e,maxX:n,minY:r,maxY:s}=Ra(this,t);if(this.width+this.strokeWidth<e||n<0||this.height+this.strokeWidth<r||s<0)return this}const r=this.transform.getMatrix();return e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),null==(n=this._activeSubScene)||n.makeDirtyNoParent(!0).render(e),e.restore(),this.makeDirty(!1),this}getSubScenes(){return this._subScenes}getActiveSubScene(){return this._activeSubScene}getSubScene(e){for(let[t,n]of this._subScenes)if(t===e)return n}addSubScene(e){this._activeSubScene=e,this._subScenes.set(e.sceneKey,e),this.makeDirty()}removeSubScene(e){const t=this._subScenes.get(e);this._subScenes.delete(e),this._activeSubScene===t&&(this._activeSubScene=this._subScenes.values().next().value),this.makeDirty()}activeSubScene(e){if(null==e)return;const t=this._subScenes.get(e);this._activeSubScene!==t&&(this._activeSubScene=t,this.makeDirty())}enableSelectedClipElement(){this._allowSelectedClipElement=!0}disableSelectedClipElement(){this._allowSelectedClipElement=!1}allowSelectedClipElement(){return this._allowSelectedClipElement}pick(e){var t;if(void 0===this._activeSubScene)return;const n=this.transform.clone().invert().applyPoint(e);return null==(t=this._activeSubScene)?void 0:t.pick(n)}dispose(){super.dispose(),this._subScenes.forEach((e=>{e.dispose()}))}_initialProps(e){if(!e)return;const t=Object.keys(e);if(0===t.length)return;const n={};let r=!1;t.forEach((t=>{if(void 0===e[t])return!0;n[t]=e[t],r=!0})),r&&this.transformByState(n),this.makeDirty(!0)}}(Vh=Wh||(Wh={}))[Vh.scrollTo=0]="scrollTo",Vh[Vh.scrollBy=1]="scrollBy";class Zh{constructor(e,t,n){var r;this.scrollX=0,this.scrollY=0,this.onMouseWheelObserver=new i,this.onScrollAfterObserver=new i,this.onScrollBeforeObserver=new i,this.onScrollStopObserver=new i,this._dirty=!0,this._topOrigin=0,this._leftOrigin=0,this._bottomOrigin=0,this._rightOrigin=0,this._top=0,this._left=0,this._bottom=0,this._right=0,this._isWheelPreventDefaultX=!1,this._isWheelPreventDefaultY=!1,this._allowCache=!1,this._preScrollX=0,this._preScrollY=0,this._renderClipState=!0,this._viewPortKey=e,this._scene=t,this.top=(null==n?void 0:n.top)||0,this.left=(null==n?void 0:n.left)||0,this.bottom=(null==n?void 0:n.bottom)||0,this.right=(null==n?void 0:n.right)||0,(null==n?void 0:n.width)&&(this.width=null==n?void 0:n.width,this._widthOrigin=this.width),(null==n?void 0:n.height)&&(this.height=null==n?void 0:n.height,this._heightOrigin=this.height),this._allowCache&&(this._cacheCanvas=new Aa),this._isWheelPreventDefaultX=(null==n?void 0:n.isWheelPreventDefaultX)||!1,this._isWheelPreventDefaultY=(null==n?void 0:n.isWheelPreventDefaultY)||!1,this._resizeCacheCanvasAndScrollBar(),null==(r=this._scene)||r.getParent().onTransformChangeObservable.add((()=>{this._resizeCacheCanvasAndScrollBar()}))}get scene(){return this._scene}get width(){return this._width}get height(){return this._height}get viewPortKey(){return this._viewPortKey}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get bottomOrigin(){return this._bottomOrigin}get rightOrigin(){return this._rightOrigin}get top(){return this._top}get left(){return this._left}get bottom(){return this._bottom}get right(){return this._right}set width(e){this._width=e}set height(e){this._height=e}set top(e){var t,n;this._topOrigin=e,this._top=xl(e,null==(n=null==(t=this._scene)?void 0:t.getParent())?void 0:n.height)}set left(e){var t;this._leftOrigin=e,this._left=xl(e,null==(t=this.scene.getParent())?void 0:t.width)}set bottom(e){var t;this._bottomOrigin=e,this._bottom=xl(e,null==(t=this.scene.getParent())?void 0:t.height)}set right(e){var t;this._rightOrigin=e,this._right=xl(e,null==(t=this.scene.getParent())?void 0:t.width)}resetSize(){this._resizeCacheCanvasAndScrollBar(!0)}setScrollBar(e){this._scrollBar&&console.warn("Old scrollBar will be replaced "),this._scrollBar=e,this._resizeCacheCanvasAndScrollBar()}resize(e){const t=Object.keys(e);0!==t.length&&(this._width=void 0,this._height=void 0,t.forEach((t=>{void 0!==e[t]&&(this[t]=e[t])})),this._resizeCacheCanvasAndScrollBar())}resizeScrollBar(){this._resizeCacheCanvasAndScrollBar()}makeDirty(e=!0){this._dirty=e}isDirty(){return this._dirty}scrollTo(e){return this._scroll(0,e)}scrollBy(e){return this._scroll(1,e)}getBarScroll(e,t){let n=e,r=t;if(this._scrollBar){n*=this._scrollBar.ratioScrollX,r*=this._scrollBar.ratioScrollY;const{scaleX:e,scaleY:t}=this.scene;n=Math.round(n)*e,r=Math.round(r)*t}else void 0!==this.scrollX&&(n=this.scrollX),void 0!==this.scrollY&&(r=this.scrollY);return{x:n,y:r}}getActualScroll(e,t){let n=e,r=t;if(this._scrollBar){n/=this._scrollBar.ratioScrollX,r/=this._scrollBar.ratioScrollY;const{scaleX:e,scaleY:t}=this.scene;n=Math.round(n)/e,r=Math.round(r)/t}else void 0!==this.actualScrollX&&(n=this.actualScrollX),void 0!==this.actualScrollY&&(r=this.actualScrollY);return{x:n,y:r}}transformScroll(){let e=this.scrollX,t=this.scrollY;return this.getActualScroll(e,t)}getScrollBar(){return this._scrollBar}updateScroll(e){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY;const{scrollX:t,scrollY:n,actualScrollX:r,actualScrollY:s}=e;return void 0!==t&&(this.scrollX=t),void 0!==n&&(this.scrollY=n),void 0!==r&&(this.actualScrollX=r),void 0!==s&&(this.actualScrollY=s),this}getScrollBarTransForm(e=!1){const t=da.create();return!e&&this._allowCache||t.multiply(da.create([1,0,0,1,this._left,this._top])),t}render(e){var t;const n=e||(null==(t=this._scene.getEngine())?void 0:t.getCanvas().getContext());if(!this.isDirty()&&this._allowCache)return void this._applyCache(n);let r=this._scene.transform.clone();r.multiply(da.create([1,0,0,1,-this.actualScrollX||0,-this.actualScrollY||0]));let s=n;if(!s)return;const o=this._getApplyCanvasState();o&&(r.multiply(da.create([1,0,0,1,-this.left/this._scene.scaleX,-this.top/this._scene.scaleY])),s=this._cacheCanvas.getContext(),this._cacheCanvas.clear());const i=r.getMatrix(),l=this.getScrollBarTransForm().getMatrix();s.save(),!o&&this._renderClipState&&(s.beginPath(),s.rect(this.left,this.top,this.width||0,this.height||0),s.clip()),s.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._scene.renderObjects(s,this._calViewportRelativeBounding()),s.restore(),this._scrollBar&&(s.save(),s.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this.drawScrollbar(s),s.restore()),o&&this._applyCache(n),this.makeDirty(!1),this._scrollRendered()}getBounding(){return this._calViewportRelativeBounding()}getRelativeVector(e){const t=this.scene.transform.clone().invert(),n=this.transformScroll();return t.applyPoint(e).add(ha.FromArray([n.x,n.y]))}getAbsoluteVector(e){const t=this.scene.transform.clone(),n=this.transformScroll();return t.applyPoint(e).subtract(ha.FromArray([n.x,n.y]))}onMouseWheel(e,t){if(!this._scrollBar)return;let n;if(e.inputIndex===_l.MouseWheelX){const r=Math.abs(e.deltaX),s=this._scene.width;let o=(this.width||1)/s*r;n=e.deltaX>0?this.scrollBy({x:o}):this.scrollBy({x:-o}),this._scene.getParent().classType===el.SCENE_VIEWER?(null==n?void 0:n.isLimitedX)||t.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():(null==n?void 0:n.isLimitedX)||e.preventDefault()}if(e.inputIndex===_l.MouseWheelY){const r=Math.abs(e.deltaY),s=this._scene.height;let o=(this.height||1)/s*r;e.shiftKey?(n=e.deltaY>0?this.scrollBy({x:o}):this.scrollBy({x:-o}),this._scene.getParent().classType===el.SCENE_VIEWER?(null==n?void 0:n.isLimitedX)||t.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():(null==n?void 0:n.isLimitedX)||e.preventDefault()):(n=e.deltaY>0?this.scrollBy({y:o}):this.scrollBy({y:-o}),this._scene.getParent().classType===el.SCENE_VIEWER?(null==n?void 0:n.isLimitedY)||t.stopPropagation():this._isWheelPreventDefaultY?e.preventDefault():(null==n?void 0:n.isLimitedY)||e.preventDefault())}e.inputIndex,_l.MouseWheelZ}isHit(e){const{width:t,height:n}=this._getViewPortSize();return e.x>=this.left&&e.x<=this.left+t&&e.y>=this.top&&e.y<=this.top+n}pickScrollBar(e){if(!this._scrollBar)return;const t=this.getScrollBarTransForm(!0).invert().applyPoint(e);return this._scrollBar.pick(t)}openClip(){this._renderClipState=!0}closeClip(){this._renderClipState=!1}dispose(){var e;this.onMouseWheelObserver.clear(),this.onScrollAfterObserver.clear(),this.onScrollBeforeObserver.clear(),this.onScrollStopObserver.clear(),null==(e=this._scrollBar)||e.dispose()}_resizeCacheCanvasAndScrollBar(e=!1){var t;const{width:n,height:r}=this._getViewPortSize(e);this.width=n,this.height=r;const s=this._scene.width*this._scene.scaleX,o=this._scene.height*this._scene.scaleY;null==(t=this._scrollBar)||t.resize(n,r,s,o),this.makeDirty(!0)}_getViewPortSize(e=!1){var t;const n=null==(t=this._scene)?void 0:t.getParent();let r,s;if(e||void 0===this._widthOrigin){const e=n.width;r=(n.classType===el.SCENE_VIEWER?e*n.scaleX:e)-(this._left+this._right)}else r=this._widthOrigin;if(e||void 0===this._heightOrigin){const e=n.height;s=(n.classType===el.SCENE_VIEWER?e*n.scaleY:e)-(this._top+this._bottom)}else s=this._heightOrigin;return{width:r,height:s}}_getApplyCanvasState(){return this._allowCache&&this._renderClipState}_scrollRendered(){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY}_limitedScroll(){var e,t;if(!this._scrollBar)return;const n=(null==(e=this._scrollBar)?void 0:e.limitX)||1/0,r=(null==(t=this._scrollBar)?void 0:t.limitY)||1/0;let s=!0,o=!0;return this.scrollX<0?this.scrollX=0:this.scrollX>n?this.scrollX=n:s=!1,this.scrollY<0?this.scrollY=0:this.scrollY>r?this.scrollY=r:o=!1,{isLimitedX:s,isLimitedY:o}}_triggerScrollStop(e,t,n){window.clearTimeout(this._scrollStopNum),this._scrollStopNum=window.setTimeout((()=>{var r,s;this.onScrollStopObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:t,y:n,actualScrollX:e.x,actualScrollY:e.y,limitX:null==(r=this._scrollBar)?void 0:r.limitX,limitY:null==(s=this._scrollBar)?void 0:s.limitY})}),0)}_scroll(e,t){var n,r,s,o;const{x:i,y:l}=t;void 0!==i&&(1===e?this.scrollX+=i:this.scrollX=i),void 0!==l&&(1===e?this.scrollY+=l:this.scrollY=l);const a=this._limitedScroll();this.onScrollBeforeObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:i,y:l,limitX:null==(n=this._scrollBar)?void 0:n.limitX,limitY:null==(r=this._scrollBar)?void 0:r.limitY}),this._scrollBar?this._scrollBar.makeDirty(!0):this.makeDirty(!0);const c=this.transformScroll();return this.actualScrollX=c.x,this.actualScrollY=c.y,this.onScrollAfterObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:i,y:l,actualScrollX:c.x,actualScrollY:c.y,limitX:null==(s=this._scrollBar)?void 0:s.limitX,limitY:null==(o=this._scrollBar)?void 0:o.limitY}),this._triggerScrollStop(c,i,l),a}_calViewportRelativeBounding(){var e,t,n,r;let s=null!=(t=null==(e=this._scrollBar)?void 0:e.ratioScrollX)?t:1,o=null!=(r=null==(n=this._scrollBar)?void 0:n.ratioScrollY)?r:1,i=this.left,l=(this.width||0)+this.left,a=this.top,c=(this.height||0)+this.top,h=0,u=0;null!=this._preScrollX&&(h=(this._preScrollX-this.scrollX)/s),null!=this._preScrollY&&(u=(this._preScrollY-this.scrollY)/o);const d={tl:ha.FromArray([i,a]),tr:ha.FromArray([l,a]),bl:ha.FromArray([i,c]),br:ha.FromArray([l,c]),dx:h,dy:u};return d.tl=this.getRelativeVector(d.tl),d.tr=this.getRelativeVector(d.tr),d.bl=this.getRelativeVector(d.bl),d.br=this.getRelativeVector(d.br),d}drawScrollbar(e){if(!this._scrollBar)return;const t=this._scene.getParent();(t.classType===el.SCENE_VIEWER||t.classType===el.ENGINE)&&this._scrollBar.render(e)}_applyCache(e){if(!e)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,r=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,r,this.left,this.top,this.width||0,this.height||0)}}(Yh=jh||(jh={}))[Yh.OFF=0]="OFF",Yh[Yh.ON=1]="ON";class qh extends ph{constructor(e,t){super(e),this._skeleton=t}getSkeleton(){return this._skeleton}updateSkeleton(e){this._skeleton=e}render(e,t){if(!this.visible)return this.makeDirty(!1),this;e.save(),this._draw(e,t),e.restore()}getParentScale(){let{scaleX:e=1,scaleY:t=1}=this.parent;return this.parent.classType===el.SCENE_VIEWER&&(e=this.parent.ancestorScaleX||1,t=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:t}}_getBounding(e,t,n){const r=e.length,s=t.length;if(!n)return{startRow:0,endRow:r-1,startColumn:0,endColumn:s-1};let o=-1,i=-1,l=-1,a=-1;return o=u(e,n.tl.y),i=u(e,n.bl.y),-1===o&&(o=0),-1===i&&(i=r-1),i>=r&&(i=r-1),l=u(t,n.tl.x),a=u(t,n.tr.x),-1===l&&(l=0),-1===a&&(a=s-1),a>=s&&(a=s-1),{startRow:o-1,endRow:i+1,startColumn:l-1,endColumn:a+1}}_draw(e,t){}}class Jh extends qh{_draw(e,t){this.draw(e,t)}}(Xh=Gh||(Gh={}))[Xh.GRID=0]="GRID";class eu extends _h{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,s){return na(e,t,n,r,s)}}class tu extends eu{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:s,dataMergeCache:o,stylesCache:i}=n,{background:l}=i;if(!n)return;const{rowHeightAccumulation:a,columnTotalWidth:c,columnWidthAccumulation:h,rowTotalHeight:u}=n;if(!a||!h||void 0===c||void 0===u)return;e.save();const{scaleX:d=1,scaleY:g=1}=t;l&&Object.keys(l).forEach((t=>{const n=l[t];e.fillStyle=t||Al([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:s,endY:i,startX:l,endX:c}=this.getCellIndex(t,n,a,h,o);if(r)return!0;s=Wl(s,g),i=Wl(i,g),l=Wl(l,d),c=Wl(c,d),e.moveTo(l,s),e.lineTo(l,i),e.lineTo(c,i),e.lineTo(c,s)}))})),e.closePath(),e.fill()})),e.restore()}}vh.add(new tu);class nu extends eu{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:s,columnTitleHeight:o,dataMergeCache:i,stylesCache:l,overflowCache:a}=n,{border:c}=l;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:u,columnWidthAccumulation:d,rowTotalHeight:g}=n;if(!h||!d||void 0===u||void 0===g)return;e.save();const{scaleX:f=1,scaleY:m=1}=t,p=this._getScale(t);let b,_;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:s,startY:o,endY:l,startX:c,endX:u}=this.getCellIndex(t,n,h,d,i);if(s)return!0;o=Wl(o,m),l=Wl(l,m),c=Wl(c,f),u=Wl(u,f);for(let i in r){const{type:s,style:h,color:d}=r[i];this._getOverflowExclusion(a,s,t,n)||(h!==b&&(fa(e,h),e.lineWidth=ma(h)/p,b=h),d!==_&&(e.strokeStyle=d||Qi,_=d),ga(e,s,{startX:c,startY:o,endX:u,endY:l}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let s=!1;return t===Ki.TOP||t===Ki.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:o}=n;return t===Ki.LEFT&&e>r&&e<=o||t===Ki.RIGHT&&e>=r&&e<o?(s=!0,!1):void 0}))})),s}}vh.add(new nu);class ru extends eu{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:s=0,columnTitleHeight:o=0,dataMergeCache:i,overflowCache:l,stylesCache:a,showGridlines:c}=n,{startRow:h,endRow:u,startColumn:d,endColumn:g}=r;if(!n||c===vt.FALSE)return;const{rowHeightAccumulation:f,columnTotalWidth:m,columnWidthAccumulation:p,rowTotalHeight:b}=n;if(!f||!p||void 0===m||void 0===b)return;e.save();const _=this._getScale(t);e.beginPath(),e.lineWidth=1/_,e.strokeStyle=Al([217,217,217]);let v=Wl(m,_),C=Wl(b,_);const T=p.length,w=f.length;for(let y=h-1;y<=u;y++){if(y<0||y>w-1)continue;const t=Wl(f[y],_);e.moveTo(0,t),e.lineTo(v,t)}for(let y=d;y<=g;y++){if(y<0||y>T-1)continue;const t=Wl(p[y],_);e.moveTo(t,0),e.lineTo(t,C)}e.stroke(),e.closePath(),this._clearRectangle(e,_,f,p,i),this._clearRectangle(e,_,f,p,l),e.restore()}_clearRectangle(e,t,n,r,s){null==s||s.forEach(((s,o)=>{null==o||o.forEach(((s,o)=>{const{startRow:i,endRow:l,startColumn:a,endColumn:c}=o,h=Wl(n[i-1]||0,t),u=Wl(n[l],t),d=Wl(r[a-1]||0,t),g=Wl(r[c],t);e.clearRect(d,h,g-d,u-h),e.beginPath(),e.moveTo(d,h),e.lineTo(g,h),e.lineTo(g,u),e.lineTo(d,u),e.lineTo(d,h),e.stroke(),e.closePath()}))}))}}vh.add(new ru);class su extends eu{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:s,columnTitleHeight:o,stylesCache:i,dataMergeCache:l,overflowCache:a}=n,{font:c}=i;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:u,columnWidthAccumulation:d,rowTotalHeight:g}=n;if(!h||!d||void 0===u||void 0===g)return;e.save();const f=this._getScale(t),{scaleX:m=1,scaleY:p=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:s,isMergedMainCell:o,startY:i,endY:c,startX:u,endX:g,mergeInfo:b}=this.getCellIndex(t,n,h,d,l);if(s)return!0;i=Wl(i,p),c=Wl(c,p),u=Wl(u,m),g=Wl(g,m);const _=g-u,v=c-i,C=a.getValue(t,n),{horizontalAlign:T}=r;if(e.save(),e.beginPath(),C){const{startColumn:r,startRow:s,endColumn:o,endRow:l}=C;r===o&&r===n?e.rect(u,i,_,v):T===lt.CENTER?this._clipRectangle(e,s,l,r,o,f,h,d):T===lt.RIGHT?this._clipRectangle(e,s,t,r,n,f,h,d):this._clipRectangle(e,t,l,n,o,f,h,d)}else e.rect(u,i,_,v);e.clip(),e.translate(u,i),this._renderDocuments(e,r,u,i,g,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,s,o,i,l){const a=this.getDocuments(),{documentSkeleton:c,angle:h,verticalAlign:u,horizontalAlign:d,wrapStrategy:g,content:f}=t,m=s-n,p=o-r;g===ut.WRAP&&0===h&&(c.updateDocumentDataPageSize(m),c.calculate()),c.makeDirty(!1),a.resize(m,p),a.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,s,o,i,l){const a=Wl(i[t-1]||0,o),c=Wl(i[n],o),h=Wl(l[r-1]||0,o),u=Wl(l[s],o);e.rect(h,a,u-h,c-a)}}vh.add(new su);class ou extends eu{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:s=0,columnTitleHeight:o=0}=n,{startRow:i,endRow:l,startColumn:a,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:u,columnWidthAccumulation:d,rowTotalHeight:g}=n;if(!h||!d||void 0===u||void 0===g)return;const f=this._getScale(t);e.fillStyle=Al([248,249,250]),e.fillRect(0,0,s,g),e.textAlign="center",e.textBaseline="middle",e.fillStyle=Al([0,0,0]),e.beginPath(),e.lineWidth=1/f,e.strokeStyle=Al([217,217,217]);let m=0;const p=h.length;for(let b=i-1;b<=l;b++){if(b<0||b>p-1)continue;const t=Wl(h[b],f);if(m===t)continue;e.moveTo(0,t),e.lineTo(s,t);const n=m+(t-m)/2;e.fillText(`${b+1}`,s/2,n+1),m=t}e.moveTo(Wl(s,f),0),e.lineTo(Wl(s,f),g),e.stroke()}}Ch.add(new ou);class iu extends eu{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:s=0,columnTitleHeight:o=0}=n,{startRow:i,endRow:l,startColumn:a,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:u,columnWidthAccumulation:d,rowTotalHeight:g}=n;if(!h||!d||void 0===u||void 0===g)return;const f=this._getScale(t);e.fillStyle=Al([248,249,250]),e.fillRect(0,0,u,o),e.textAlign="center",e.textBaseline="middle",e.fillStyle=Al([0,0,0]),e.beginPath(),e.lineWidth=1/f,e.strokeStyle=Al([217,217,217]);let m=0;const p=d.length;for(let _=a-1;_<=c;_++){if(_<0||_>p-1)continue;const t=Wl(d[_],f);if(m===t)continue;e.moveTo(t,0),e.lineTo(t,o);const n=m+(t-m)/2;e.fillText(Sr(_),n,o/2+1),m=t}const b=Wl(o,f);e.moveTo(0,b),e.lineTo(u,b),e.stroke()}}Th.add(new iu);class lu{constructor(e=fu.NORMAL){this._type=e}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get type(){return this._type}get currentCell(){return this._currentCell}isEqual(e){const{startColumn:t,startRow:n,endColumn:r,endRow:s,type:o}=this,{startColumn:i,startRow:l,endColumn:a,endRow:c}=e;return t===i&&n===l&&r===a&&s===c}isInclude(e){const{startColumn:t,startRow:n,endColumn:r,endRow:s,type:o}=this,{startColumn:i,startRow:l,endColumn:a,endRow:c}=e;return!(a<t||i>r||l>s||c<n)}highlightToSelection(){return Mn(this._currentCell)}getValue(){return{selection:{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY},cell:this._currentCell}}setValue(e,t){const{startColumn:n,startRow:r,endColumn:s,endRow:o,startX:i,startY:l,endX:a,endY:c}=e;this._startColumn=n,this._startRow=r,this._endColumn=s,this._endRow=o,this._startX=i,this._startY=l,this._endX=a,this._endY=c,this.setCurrentCell(t)}setCurrentCell(e){e&&(this._currentCell=e)}clearCurrentCell(){this._currentCell=null}}const au="rgb(1,136,251)",cu="rgba(1,136,251, 0.1)",hu=2,uu=6,du=1,gu="rgb(255,255,255)";var fu,mu,pu,bu;(mu=fu||(fu={}))[mu.NORMAL=0]="NORMAL",mu[mu.ROW=1]="ROW",mu[mu.COLUMN=2]="COLUMN",(bu=pu||(pu={})).Selection="__SpreadsheetSelectionShape__",bu.top="__SpreadsheetSelectionTopControl__",bu.bottom="__SpreadsheetSelectionBottomControl__",bu.left="__SpreadsheetSelectionShapeLeftControl__",bu.right="__SpreadsheetSelectionShapeRightControl__",bu.backgroundTop="__SpreadsheetSelectionBackgroundControlTop__",bu.backgroundMiddleLeft="__SpreadsheetSelectionBackgroundControlMiddleLeft__",bu.backgroundMiddleRight="__SpreadsheetSelectionBackgroundControlMiddleRight__",bu.backgroundBottom="__SpreadsheetSelectionBackgroundControlBottom__",bu.fill="__SpreadsheetSelectionFillControl__",bu.lineMain="__SpreadsheetDragLineMainControl__",bu.lineContent="__SpreadsheetDragLineContentControl__",bu.line="__SpreadsheetDragLineControl__";class _u{constructor(e,t){this._scene=e,this._zIndex=t,this._initialize()}get zIndex(){return this._zIndex}get leftControl(){return this._leftControl}get rightControl(){return this._rightControl}get topControl(){return this._topControl}get bottomControl(){return this._bottomControl}get fillControl(){return this._fillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShape}get model(){return this._selectionModel}static create(e,t){return new this(e,t)}static fromJson(e,t,n){const r=_u.create(e,t);return r.update(n),r}_updateControl(){const{startX:e,startY:t,endX:n,endY:r}=this._selectionModel;this.leftControl.resize(void 0,r-t),this.rightControl.transformByState({height:r-t,left:n-e-hu/2}),this.topControl.resize(n-e+hu),this.bottomControl.transformByState({width:n-e+hu,top:r-t-hu/2}),this.fillControl.translate(n-e-uu/2,r-t-uu/2),this._updateBackgroundControl(),this.selectionShape.show(),this.selectionShape.translate(e,t),this.selectionShape.makeDirty(!0)}update(e,t){this._selectionModel.setValue(e,t),this._updateControl()}clearHighlight(){this._selectionModel.clearCurrentCell(),this._updateControl()}getScene(){return this._scene}dispose(){var e,t,n,r,s,o,i,l,a,c;null==(e=this._leftControl)||e.dispose(),null==(t=this._rightControl)||t.dispose(),null==(n=this._topControl)||n.dispose(),null==(r=this._bottomControl)||r.dispose(),null==(s=this._backgroundControlTop)||s.dispose(),null==(o=this._backgroundControlMiddleLeft)||o.dispose(),null==(i=this._backgroundControlMiddleRight)||i.dispose(),null==(l=this._backgroundControlBottom)||l.dispose(),null==(a=this._fillControl)||a.dispose(),null==(c=this._selectionShape)||c.dispose()}getCurrentCellInfo(){const e=this.model.currentCell;if(e){let t;if(e.isMerged){const n=e.mergeInfo;t={startRow:n.startRow,endRow:n.endRow,startColumn:n.startColumn,endColumn:n.endColumn,startX:n.startX,endX:n.endX,startY:n.startY,endY:n.endY}}else{const{row:n,column:r,startX:s,endX:o,startY:i,endY:l}=e;t={startRow:n,endRow:n,startColumn:r,endColumn:r,startX:s,endX:o,startY:i,endY:l}}return t}}_initialize(){this._selectionModel=new lu(0);const e=this._zIndex;this._leftControl=new Ha(pu.left+e,{top:0,left:-hu/2,width:hu,fill:au,zIndex:e}),this._rightControl=new Ha(pu.right+e,{width:hu,fill:au,zIndex:e}),this._topControl=new Ha(pu.top+e,{top:-hu/2,left:-hu/2,height:hu,fill:au,zIndex:e}),this._bottomControl=new Ha(pu.bottom+e,{height:hu,fill:au,left:-hu/2,zIndex:e}),this._backgroundControlTop=new Ha(pu.backgroundTop+e,{fill:cu,zIndex:e-1,evented:!1}),this._backgroundControlBottom=new Ha(pu.backgroundBottom+e,{fill:cu,zIndex:e-1,evented:!1}),this._backgroundControlMiddleLeft=new Ha(pu.backgroundMiddleLeft+e,{fill:cu,zIndex:e-1,evented:!1}),this._backgroundControlMiddleRight=new Ha(pu.backgroundMiddleRight+e,{fill:cu,zIndex:e-1,evented:!1});const t=uu-du;this._fillControl=new Ha(pu.fill+e,{width:t,height:t,fill:au,strokeWidth:du,stroke:gu,zIndex:e+1}),this._selectionShape=new ka(pu.Selection+e,this._fillControl,this._leftControl,this._rightControl,this._topControl,this._bottomControl,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom),this._selectionShape.hide(),this._selectionShape.evented=!1,this._selectionShape.zIndex=e;this.getScene().addObject(this._selectionShape)}_updateBackgroundControl(){const{startColumn:e,startRow:t,endColumn:n,endRow:r,startX:s,startY:o,endX:i,endY:l}=this._selectionModel,a=this._selectionModel.highlightToSelection();if(!a)return this._backgroundControlTop.resize(i-s,l-o),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),void this._backgroundControlMiddleRight.resize(0,0);const{startX:c,startY:h,endX:u,endY:d}=a,g=hu/2,f={left:-g,top:-g,width:i-s+2*g,height:h-o+g};f.height<0&&(f.width=0,f.height=0),this._backgroundControlTop.transformByState(f);const m={left:-g,top:h-o,width:c-s+g,height:d-h};m.width<0&&(m.width=0,m.height=0),this._backgroundControlMiddleLeft.transformByState(m);const p={left:u-s-g,top:h-o,width:i-u+2*g,height:d-h};p.width<0&&(p.width=0,p.height=0),this._backgroundControlMiddleRight.transformByState(p);const b={left:-g,top:d-o,width:i-s+2*g,height:l-d+g};b.height<0&&(b.width=0,b.height=0),this._backgroundControlBottom.transformByState(b)}}class vu{constructor(e){this._spreadsheet=e,this.hasSelection=!1,this._selectionControls=[],this._startOffsetX=0,this._startOffsetY=0,this._mainEventInitial()}static create(e){return new vu(e)}addControlToCurrentByRangeData(e,t){const n=this.getCurrentControls();if(!n)return;const r=this._spreadsheet,s=_u.create(this.getScene(),n.length);let o=null;t&&(o=r.getCellByIndex(t.row,t.column));const{startRow:i,startColumn:l,endRow:a,endColumn:c}=e,h=r.getNoMergeCellPositionByIndex(i,l),u=r.getNoMergeCellPositionByIndex(a,c);s.update({startColumn:l,startRow:i,endColumn:c,endRow:a,startY:(null==h?void 0:h.startY)||0,endY:(null==u?void 0:u.endY)||0,startX:(null==h?void 0:h.startX)||0,endX:(null==u?void 0:u.endX)||0},o),n.push(s)}getSpreadsheet(){return this._spreadsheet}getMaxIndex(){return this._spreadsheet.zIndex+1}getScene(){return this._spreadsheet.getScene()}getSkeleton(){return this._spreadsheet.getSkeleton()}getRowAndColumnCount(){const e=this.getSkeleton();return{rowCount:(null==e?void 0:e.getRowCount())||1e3,columnCount:(null==e?void 0:e.getColumnCount())||50}}getCurrentControls(){return this._selectionControls}getCurrentControl(){const e=this.getCurrentControls();if(e&&e.length>0)for(const t of e){if(t.model.currentCell)return t}}clearSelectionControls(){let e=this.getCurrentControls();if(e.length>0){for(let t of e)t.dispose();e.length=0}}getActiveRangeList(){const e=this.getCurrentControls();if(e&&e.length>0){return null==e?void 0:e.map((e=>{const t=e.model;return{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}))}}getActiveRange(){const e=this.getCurrentControls(),t=e&&e[e.length-1].model;return t&&{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}getActiveSelection(){const e=this.getCurrentControls();return e&&e[e.length-1]}dispose(){this.clearSelectionControls(),this._moveObserver=null,this._upObserver=null}_moving(e,t,n){const r=this._spreadsheet,{startRow:s,startColumn:o,endRow:i,endColumn:l}=this._startSelectionRange,a=r.getScrollXYByRelativeCoords(ha.FromArray([this._startOffsetX,this._startOffsetY])),c=Mn(r.calculateCellIndexByPosition(e,t,a));if(!c)return!1;const{startRow:h,startColumn:u,endColumn:d,endRow:g}=c,f=Math.min(h,s),m=Math.min(u,o),p=Math.max(g,i),b=Math.max(d,l),_=r.getSelectionBounding(f,m,p,b);if(!_)return!1;const{startRow:v,startColumn:C,endRow:T,endColumn:w}=_,y=r.getNoMergeCellPositionByIndex(v,C),S=r.getNoMergeCellPositionByIndex(T,w),E={startColumn:C,startRow:v,endColumn:w,endRow:T,startY:(null==y?void 0:y.startY)||0,endY:(null==S?void 0:S.endY)||0,startX:(null==y?void 0:y.startX)||0,endX:(null==S?void 0:S.endX)||0},{startRow:R,endRow:I,startColumn:A,endColumn:x}=(null==n?void 0:n.model)||{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1};A===C&&R===v&&x===w&&I===T||n&&n.update(E)}_endSelection(e){var t,n;e.onPointerMoveObserver.remove(this._moveObserver),e.onPointerUpObserver.remove(this._upObserver),e.enableEvent(),null==(t=this._scrollTimer)||t.stopScroll();const r=null==(n=e.getEngine())?void 0:n.activeScene;null==r||r.onPointerDownObserver.remove(this._cancelDownObserver),null==r||r.onPointerUpObserver.remove(this._cancelUpObserver)}_addCancelObserver(){var e;const t=this.getScene(),n=null==(e=t.getEngine())?void 0:e.activeScene;null!=n&&n!==t&&(n.onPointerDownObserver.remove(this._cancelDownObserver),n.onPointerUpObserver.remove(this._cancelUpObserver),this._cancelDownObserver=n.onPointerDownObserver.add((e=>{this._endSelection(t)})),this._cancelUpObserver=n.onPointerUpObserver.add((e=>{this._endSelection(t)})))}_mainEventInitial(){const e=this._spreadsheet;e.onPointerDownObserver.add(((t,n)=>{const{offsetX:r,offsetY:s}=t,o=this.getScene(),i=o.getRelativeCoord(ha.FromArray([r,s])),{x:l,y:a}=i;this._startOffsetX=l,this._startOffsetY=a;const c=e.getScrollXYByRelativeCoords(i),h=e.calculateCellIndexByPosition(l,a,c),u=Mn(h);if(!u)return!1;const{startRow:d,startColumn:g,endColumn:f,endRow:m,startY:p,endY:b,startX:_,endX:v}=u,C={startColumn:g,startRow:d,endColumn:f,endRow:m,startY:p,endY:b,startX:_,endX:v};this._startSelectionRange=C;let T=this.getCurrentControl(),w=this.getCurrentControls();if(!w)return!1;for(let e of w){if(2===t.button&&e.model.isInclude(C))return void(T=e);if(e.model.isEqual(C)){T=e;break}t.shiftKey||e.clearHighlight()}if(w.length>0&&!t.ctrlKey&&!t.shiftKey){for(let e of w)e.dispose();w.length=0}const y=T&&T.model.currentCell;if(T&&t.shiftKey&&y){const{row:t,column:n}=y,r=e.getNoMergeCellPositionByIndex(t,n),s=e.getNoMergeCellPositionByIndex(m,f),o={startColumn:n,startRow:t,endColumn:C.startColumn,endRow:C.startRow,startY:(null==r?void 0:r.startY)||0,endY:(null==s?void 0:s.endY)||0,startX:(null==r?void 0:r.startX)||0,endX:(null==s?void 0:s.endX)||0};T.update(o,y)}else T=_u.create(o,w.length+this.getMaxIndex()),T.update(C,h),w.push(T);this.hasSelection=!0,o.disableEvent(),this._endSelection(o);const S=La.create(this.getScene());S.startScroll(l,a),this._scrollTimer=S,this._addCancelObserver(),this._moveObserver=o.onPointerMoveObserver.add((e=>{const{offsetX:t,offsetY:n}=e,{x:r,y:s}=o.getRelativeCoord(ha.FromArray([t,n]));this._moving(r,s,T),S.scrolling(r,s,(()=>{this._moving(r,s,T)}))})),this._upObserver=o.onPointerUpObserver.add((e=>{this._endSelection(o)})),n.stopPropagation()}))}}class Cu extends qh{constructor(e,t,n=!0){super(e,t),this._allowCache=n,this._cacheOffsetX=0,this._cacheOffsetY=0,this._hasSelection=!1,this._documents=new Lh("__SHEET_EXTENSION_FONT_DOCUMENT_INSTANCE__",void 0,{pageMarginLeft:0,pageMarginTop:0}),this._allowCache&&(this._cacheCanvas=new Aa),this.onIsAddedToParentObserver.add((e=>{var t;null==(t=null==e?void 0:e.getEngine())||t.onTransformChangeObservable.add((e=>{this.resizeCacheCanvas()})),this.resizeCacheCanvas(),this._addMakeDirtyToScroll()})),this._initialDefaultExtension(),this.makeDirty(!0)}get borderAuxiliaryExtension(){return this._borderAuxiliaryExtension}get backgroundExtension(){return this._backgroundExtension}get borderExtension(){return this._borderExtension}get fontExtension(){return this._fontExtension}getDocuments(){return this._documents}draw(e,t){const n=this.getSkeleton();if(!n)return;const r=this.getParentScale();n.calculate(t);const s=ea(r),{rowTitleWidth:o,columnTitleHeight:i}=n;e.translate(Wl(o,s)-.5/s,Wl(i,s)-.5/s),this._calculateOverflow();const l=this.getExtensionsByOrder();for(let a of l)a.draw(e,r,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:r,columnTitleHeight:s}=n;return t.x>r&&t.y>s}getNoMergeCellPositionByIndex(e,t){const n=this.getSkeleton();if(!n)return;const{rowHeightAccumulation:r,columnWidthAccumulation:s,rowTitleWidth:o,columnTitleHeight:i}=n,{scaleX:l=1,scaleY:a=1}=this.getParentScale();let{startY:c,endY:h,startX:u,endX:d}=ta(e,t,r,s);return c=Wl(c+i,a),h=Wl(h+i,a),u=Wl(u+o,l),d=Wl(d+o,l),{startY:c,endY:h,startX:u,endX:d}}calculateCellIndexByPosition(e,t,n){const r=this.getSkeleton();if(!r)return;const{x:s,y:o}=n,{rowHeightAccumulation:i,columnWidthAccumulation:l,rowTitleWidth:a,columnTitleHeight:c,dataMergeCacheAll:h}=r;e+=s-a;let d=u(i,t+=o-c),g=u(l,e);if(-1===d){d=i[i.length-1]<=t?i.length-1:0}if(-1===g){g=l[l.length-1]<=e?l.length-1:0}const{scaleX:f=1,scaleY:m=1}=this.getParentScale();let{isMerged:p,startY:b,endY:_,startX:v,endX:C,mergeInfo:T,isMergedMainCell:w}=na(d,g,i,l,h);return b=Wl(b+c,m),_=Wl(_+c,m),v=Wl(v+a,f),C=Wl(C+a,f),T=sa(T,a,c,f,m),{row:d,column:g,startY:b,endY:_,startX:v,endX:C,isMerged:p,isMergedMainCell:w,mergeInfo:T}}getCellByIndex(e,t){const n=this.getSkeleton();if(!n)return;const{scaleX:r=1,scaleY:s=1}=this.getParentScale(),{rowHeightAccumulation:o,columnWidthAccumulation:i,rowTitleWidth:l,columnTitleHeight:a,dataMergeCacheAll:c}=n;let{isMerged:h,startY:u,endY:d,startX:g,endX:f,mergeInfo:m,isMergedMainCell:p}=na(e,t,o,i,c);return u=Wl(u+a,s),d=Wl(d+a,s),g=Wl(g+l,r),f=Wl(f+l,r),m=sa(m,l,a,r,s),{row:e,column:t,startY:u,endY:d,startX:g,endX:f,isMerged:h,isMergedMainCell:p,mergeInfo:m}}getScrollXYByRelativeCoords(e){let t=0,n=0;const r=this.getParent().getActiveViewportByRelativeCoord(e);if(r){t+=r.actualScrollX||0,n+=r.actualScrollY||0}return{x:t,y:n}}getAncestorScrollXY(e,t){let n=this.getParent(),r=0,s=0,o=ha.FromArray([e,t]);for(;n;){if(n.classType===el.SCENE){const e=n.getActiveViewportByCoord(o);if(e){r+=e.actualScrollX||0,s+=e.actualScrollY||0}}n=(null==n?void 0:n.getParent)&&(null==n?void 0:n.getParent())}return{x:r,y:s}}getSelectionBounding(e,t,n,r){var s;return null==(s=this.getSkeleton())?void 0:s.getMergeBounding(e,t,n,r)}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(this._allowCache){if(this._cacheOffsetX=0,this._cacheOffsetY=0,this.isDirty()){let n=t;const r=this._cacheCanvas.getContext();if(n){const{dx:e=0,dy:t=0}=n;this._cacheOffsetX=e,this._cacheOffsetY=t}this._cacheCanvas.clear(),r.save(),r.setTransform(e.getTransform()),this._draw(r,n),r.restore(),this._boundsCache=t}this._applyCache(e)}else e.save(),this._draw(e,t),e.restore();return this.makeDirty(!1),this}resizeCacheCanvas(){const e=this._getAncestorSize();if(!e||null==this._cacheCanvas)return;const{width:t,height:n}=e,r=this.getSkeleton();r&&(r.rowTitleWidth,r.columnTitleHeight),this._cacheCanvas.setSize(t,n),this.makeDirty(!0)}enableSelection(){this._hasSelection||(this._selection=vu.create(this),this._hasSelection=!0)}disableSelection(){var e;null==(e=this._selection)||e.dispose(),this._hasSelection=!1}getDocsSkeletonPageSize(e,t=0){const n=null==e?void 0:e.getSkeletonData();if(!n)return;const{pages:r}=n,s=r[r.length-1];if(0===t){const{width:e,height:t}=s;return{width:e,height:t}}let o=0,i=0;const l=ba(t),a=[];dc([s],(e=>{const{lines:n,width:r,spaceWidth:s}=e,{rotatedHeight:o,rotatedWidth:l}=_a(n,r,t);i+=o,a.push({rotatedWidth:l,spaceWidth:s})}));const c=Math.tan(t),h=Math.sin(t),u=a.length;for(let d=0;d<u;d++){const{rotatedWidth:e,spaceWidth:t}=a[d];0===d&&(o+=e),(l===qi.UP&&0===d||l===qi.DOWN&&d===u-1)&&(o+=(e+t/h)/c)}return{width:o,height:i}}_applyCache(e){e&&(e.save(),e.setTransform(1,0,0,1,0,0),e.drawImage(this._cacheCanvas.getCanvasEle(),0,0),e.restore())}_draw(e,t){this.draw(e,t)}_getAncestorSize(){const e=this._getAncestorParent();if(e){if(e.classType===el.ENGINE){const t=e.getCanvas();return{width:t.getWidth(),height:t.getHeight()}}return e.classType===el.SCENE_VIEWER?{width:e.width,height:e.height}:void 0}}_getAncestorParent(){let e=this.parent;for(;e;){if(e.classType===el.ENGINE||e.classType===el.SCENE_VIEWER)return e;e=(null==e?void 0:e.getParent)&&(null==e?void 0:e.getParent())}}_initialDefaultExtension(){vh.getData().sort(Ar).forEach((e=>{this.register(e)})),this._borderAuxiliaryExtension=this.getExtensionByKey("DefaultBorderAuxiliaryExtension"),this._backgroundExtension=this.getExtensionByKey("DefaultBackgroundExtension"),this._borderExtension=this.getExtensionByKey("DefaultBorderExtension"),this._fontExtension=this.getExtensionByKey("DefaultFontExtension")}_addMakeDirtyToScroll(){this._hasScrollViewportOperator(this,(e=>{e.onScrollBeforeObserver.add((()=>{this.makeDirty(!0)}))}))}_hasScrollViewportOperator(e,t){let n=e.getParent();for(;n;){if(n.classType===el.SCENE){const e=n.getViewports();this._getHasScrollViewports(e);for(let n of e)n&&t(n)}n=(null==n?void 0:n.getParent)&&(null==n?void 0:n.getParent())}}_getHasScrollViewports(e){const t=[];for(let n of e){n.getScrollBar()&&t.push(n)}return t}_calculateOverflow(){const e=new p,t=this.getSkeleton();if(!t)return;const n=t.getColumnCount(),{stylesCache:r,rowHeightAccumulation:s,columnWidthAccumulation:o,dataMergeCache:i}=t,{font:l}=r;l&&Object.keys(l).forEach((r=>{l[r].forEach(((r,l)=>{l.forEach(((l,a)=>{let{documentSkeleton:c,angle:h=0,verticalAlign:u,horizontalAlign:d,wrapStrategy:g}=a;const f=t.getCellData().getValue(r,l),m=this.getSkeleton();if(!m)return!0;const{t:p=Tt.STRING}=f||{};if(g===ut.OVERFLOW&&p!==Tt.NUMBER&&p!==Tt.BOOLEAN&&d!==lt.JUSTIFIED){let a=this.getDocsSkeletonPageSize(c,h);if(!a)return!0;if(0!==h){let{startY:e,endY:t,startX:n,endX:c}=na(r,l,s,o,i);const u=c-n,d=t-e;a.height>d&&(a={width:d/Math.tan(Math.abs(h))+u,height:d})}const u=t.getOverflowPosition(a,d,r,l,n),{startColumn:g,endColumn:f}=u;e.setValue(r,l,{startRow:r,endRow:r,startColumn:g,endColumn:f})}else if(g===ut.WRAP&&0!==h){let{startY:t,endY:n}=na(r,l,s,o,i);const a=n-t;c.updateDocumentDataPageSize(a),c.calculate();const u=this.getDocsSkeletonPageSize(c,h);if(!u)return!0;const{startColumn:g,endColumn:f}=m.getOverflowPosition(u,d,r,l,m.getColumnCount());e.setValue(r,l,{startRow:r,endRow:r,startColumn:g,endColumn:f})}}))}))})),t.setOverflowCache(e)}_differentBounds(e){if(!this._boundsCache)return e;const{tl:t,tr:n,bl:r,br:s,dx:o,dy:i}=e,{tl:l,tr:a,bl:c,br:h,dx:u,dy:d}=this._boundsCache,g={tl:t,tr:n,bl:r,br:s,dx:0,dy:0};return t.x===l.x?(t.y>l.y?(g.tl=c,g.tr=h):(g.bl=l,g.br=a),g.dy=l.y-t.y):t.y===l.y&&(t.x>l.x?(g.tl=a,g.bl=h):(g.tr=l,g.br=c),g.dx=l.x-t.x),g}_checkSheetDifferentBounds(e,t){const{tl:n,tr:r,bl:s,br:o}=e,{tl:i,tr:l,bl:a,br:c}=t;return n.x===i.x&&r.x===l.x&&s.x===a.x&&o.x===c.x?n.y>=i.y&&n.y<=a.y||s.y>=i.y&&s.y<=a.y:n.y===i.y&&r.y===l.y&&s.y===a.y&&o.y===c.y&&(n.x>=i.x&&n.x<=l.x||r.x>=i.x&&(r.x,l.x),!0)}}class Tu extends Jh{constructor(e,t){super(e,t),this._initialDefaultExtension(),this.makeDirty(!0)}get rowTitleLayoutExtension(){return this._rowTitleLayoutExtension}draw(e,t){const n=this.getSkeleton();if(!n)return;const r=this.getParentScale();n.calculate(t);const s=ea(r),{columnTitleHeight:o}=n;e.translate(-.5/s,Wl(o,s)-.5/s);const i=this.getExtensionsByOrder();for(let l of i)l.draw(e,r,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:r,columnTitleHeight:s}=n;return t.x>=0&&t.x<=r&&t.y>s}_initialDefaultExtension(){Ch.getData().forEach((e=>{this.register(e)})),this._rowTitleLayoutExtension=this.getExtensionByKey("DefaultRowTitleLayoutExtension")}}class wu extends Jh{constructor(e,t){super(e,t),this._initialDefaultExtension(),this.makeDirty(!0)}get columnTitleLayoutExtension(){return this._columnTitleLayoutExtension}draw(e,t){const n=this.getSkeleton();if(!n)return;const r=this.getParentScale();n.calculate(t);const s=ea(r),{rowTitleWidth:o}=n;e.translate(Wl(o,s)-.5/s,-.5/s);const i=this.getExtensionsByOrder();for(let l of i)l.draw(e,r,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:r,columnTitleHeight:s}=n;return t.x>r&&t.y>=0&&t.y<=s}_initialDefaultExtension(){Th.getData().forEach((e=>{this.register(e)})),this._columnTitleLayoutExtension=this.getExtensionByKey("DefaultColumnTitleLayoutExtension")}}class yu extends fh{constructor(e,t,n,r){super(r),this._config=e,this._cellData=t,this._styles=n,this._rowTitleWidth=0,this._columnTitleHeight=0,this.updateLayout(),this.updateDataMerge()}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowTitleWidth(){return this._rowTitleWidth}get columnTitleHeight(){return this._columnTitleHeight}get rowColumnSegment(){return this._rowColumnSegment}get dataMergeCache(){return this._dataMergeCache}get stylesCache(){return this._stylesCache}get overflowCache(){return this._overflowCache}get showGridlines(){return this._showGridlines}get dataMergeCacheAll(){return this._dataMergeCacheAll}static create(e,t,n,r){return new yu(e,t,n,r)}getWorksheetConfig(){return this._config}getCellData(){return this._cellData}getsStyles(){return this._styles}setOverflowCache(e){this._overflowCache=e}calculate(e){if(!this._config)return;if(this.updateLayout(),!this._rowHeightAccumulation||!this._columnWidthAccumulation)return;const{mergeData:t}=this._config;return this._rowColumnSegment=this.getRowColumnSegment(e),this._dataMergeCache=t&&this._getMergeCells(t,this._rowColumnSegment),this._stylesCache=this._calculateStylesCache(),this}updateLayout(){if(!this.dirty)return;const{rowData:e,columnData:t,defaultRowHeight:n,defaultColumnWidth:r,rowCount:s,columnCount:o,rowTitle:i,columnTitle:l,showGridlines:a}=this._config,{rowTotalHeight:c,rowHeightAccumulation:h}=this._generateRowMatrixCache(s,e,n),{columnTotalWidth:u,columnWidthAccumulation:d}=this._generateColumnMatrixCache(o,t,r);return this._rowTitleWidth=i.hidden!==vt.TRUE?i.width:0,this._columnTitleHeight=l.hidden!==vt.TRUE?l.height:0,this._rowTotalHeight=c,this._rowHeightAccumulation=h,this._columnTotalWidth=u,this._columnWidthAccumulation=d,this._showGridlines=a,this.makeDirty(!0),this}updateDataMerge(){const{mergeData:e}=this._config;this._dataMergeCacheAll=e&&this._getMergeCells(e)}getRowColumnSegment(e){return this._getBounding(this._rowHeightAccumulation,this._columnWidthAccumulation,e)}getMergeBounding(e,t,n,r){const s=this._dataMergeCacheAll;if(!s)return{startRow:e,startColumn:t,endRow:n,endColumn:r};let o=!0,i=new p;for(;o;)o=!1,s.forEach(((s,l)=>{l.forEach(((l,a)=>{if(!a||i.getValue(s,l))return!0;const{startRow:c,startColumn:h,endRow:u,endColumn:d}=a;oa({left:t,top:e,right:r,bottom:n},{left:h,top:c,right:d,bottom:u})&&(e=Math.min(e,c),t=Math.min(t,h),n=Math.max(n,u),r=Math.max(r,d),i.setValue(s,l,!0),o=!0)}))}));return{startRow:e,startColumn:t,endRow:n,endColumn:r}}appendToOverflowCache(e,t,n,r){this._overflowCache.setValue(e,t,{startRow:e,endRow:e,startColumn:n,endColumn:r})}getColumnCount(){return this._columnWidthAccumulation.length}getRowCount(){return this._rowHeightAccumulation.length}getOverflowPosition(e,t,n,r,s){const{width:o,height:i}=e;let l=r,a=r;return t===lt.CENTER?(l=this._getOverflowBound(n,r,0,o/2),a=this._getOverflowBound(n,r,s-1,o/2)):t===lt.RIGHT?l=this._getOverflowBound(n,r,0,o):a=this._getOverflowBound(n,r,s-1,o),{startColumn:l,endColumn:a}}_getBounding(e,t,n){const r=e.length,s=t.length;if(!n)return{startRow:0,endRow:r-1,startColumn:0,endColumn:s-1};let o=-1,i=-1,l=-1,a=-1;return o=u(e,n.tl.y-this.columnTitleHeight),i=u(e,n.bl.y-this.columnTitleHeight),-1===o&&(o=0),-1===i&&(i=r-1),i>=r&&(i=r-1),l=u(t,n.tl.x-this.rowTitleWidth),a=u(t,n.tr.x-this.rowTitleWidth),-1===l&&(l=0),-1===a&&(a=s-1),a>=s&&(a=s-1),{startRow:o-1,endRow:i+1,startColumn:l-1,endColumn:a+1}}_generateRowMatrixCache(e,t,n){let r=0;const s=[],o=new f(t);for(let i=0;i<e;i++){let e=n;if(null!=o.get(i)){const t=o.get(i);if(!t)continue;null!=t.h?e=t.h:null!=t.ah&&(e=t.ah),t.hd===vt.TRUE&&(e=0)}r+=e,s.push(r)}return{rowTotalHeight:r,rowHeightAccumulation:s}}_generateColumnMatrixCache(e,t,n){let r=0;const s=[],o=new f(t);for(let i=0;i<e;i++){let e=n;if(null!=o.get(i)){const t=o.get(i);if(!t)continue;null!=t.w&&(e=t.w),t.hd===vt.TRUE&&(e=0)}r+=e,s.push(r)}return{columnTotalWidth:r,columnWidthAccumulation:s}}_getOverflowBound(e,t,n,r){let s=0;if(t>n){const o=this._columnWidthAccumulation.length-1;for(let i=t;i>=n;i--){const n=i;if(!Nn(this._cellData.getValue(e,n))&&n!==t||this._intersectMergeRange(e,n))return n===t?n:n+1>o?o:n+1;const{startX:l,endX:a}=ta(e,n,this.rowHeightAccumulation,this.columnWidthAccumulation);if(s+=a-l,r<s)return n}return t}for(let o=t;o<=n;o++){const n=o;if(!Nn(this._cellData.getValue(e,n))&&n!==t||this._intersectMergeRange(e,n))return n===t?n:n-1<0?0:n-1;const{startX:i,endX:l}=ta(e,n,this.rowHeightAccumulation,this.columnWidthAccumulation);if(s+=l-i,r<s)return n}return n}_intersectMergeRange(e,t){const n=this.dataMergeCache;let r=!1;return null==n||n.forEach(((n,s)=>{null==s||s.forEach(((n,s)=>{const{startRow:o,endRow:i,startColumn:l,endColumn:a}=s;if(e>=o&&e<=i&&t>=l&&t<=a)return r=!0,!1}))})),r}_calculateStylesCache(){const e={background:{},font:{},border:new p},t=this.getFontLocale(),n=this._dataMergeCache,r=this._rowColumnSegment,s=this.columnWidthAccumulation,o=this._styles,i=this._cellData,{startRow:l,endRow:a,startColumn:c,endColumn:h}=r;for(let u=l;u<=a;u++){for(let n=c;n<=h;n++)this.__setCellCache(u,n,{cache:e,styles:o,cellData:i,skipBackgroundAndBorder:!1},t);for(let n=0;n<c;n++)this.__setCellCache(u,n,{cache:e,styles:o,cellData:i,skipBackgroundAndBorder:!0},t);for(let n=h+1;n<s.length;n++)this.__setCellCache(u,n,{cache:e,styles:o,cellData:i,skipBackgroundAndBorder:!0},t)}return n&&n.forEach(((n,r)=>{r.forEach(((r,s)=>{if(!s)return!0;this.__setCellCache(n,r,{cache:e,styles:o,cellData:i,skipBackgroundAndBorder:!1},t)}))})),e}__setCellCache(e,t,n,r){const{cache:s,skipBackgroundAndBorder:o=!1,styles:i,cellData:l}=n;if(!l)return!0;const a=l.getValue(e,t);if(!a)return!0;const c=i&&i.getStyleByCell(a);if(!o&&c&&c.bg&&c.bg.rgb){const n=c.bg.rgb;s.background[n]||(s.background[n]=new p);s.background[n].setValue(e,t,n)}!o&&c&&c.bd&&(this.___setBorderProps(e,t,Ki.TOP,c,s),this.___setBorderProps(e,t,Ki.BOTTOM,c,s),this.___setBorderProps(e,t,Ki.LEFT,c,s),this.___setBorderProps(e,t,Ki.RIGHT,c,s));const h=a.m||a.v;let u,d="document";const g=this._getOtherStyle(c),f=g.textRotation||{a:0,v:vt.FALSE},m=g.horizontalAlign||lt.UNSPECIFIED,b=g.verticalAlign||ct.UNSPECIFIED,_=g.wrapStrategy||ut.UNSPECIFIED;if(a.p){s.font[d]||(s.font[d]=new p);let{a:e=0,v:t=vt.FALSE}=f,n=0,r=e;t===vt.TRUE&&(n=90,r=90),u=this._updateRenderConfigAndHorizon(a.p,m,{horizontalAlign:m,verticalAlign:b,centerAngle:n,vertexAngle:r,wrapStrategy:_})}else if(h){const e=this._getFontFormat(c);d=Vl(e,r).fontString,s.font[d]||(s.font[d]=new p),u=this._getDocumentDataByStyle(h.toString(),e,g)}const v=s.font[d];let{a:C,v:T=vt.FALSE}=f;if(T===vt.TRUE&&(C=90),u){const n=mh.create(u,this.getContext());0!==C&&_===ut.WRAP||n.calculate(),v.setValue(e,t,{documentSkeleton:n,angle:C,verticalAlign:b,horizontalAlign:m,wrapStrategy:_,content:null==h?void 0:h.toString()})}}_updateRenderConfigAndHorizon(e,t,n){var r;if(!n)return;if(!(null==(r=e.body)?void 0:r.blockElements))return;e.documentStyle||(e.documentStyle={}),e.documentStyle.renderConfig=n;const s=e.body.blockElements;for(let o of s)if(o.blockType===I.PARAGRAPH){if(!o.paragraph)continue;o.paragraph.paragraphStyle||(o.paragraph.paragraphStyle={}),o.paragraph.paragraphStyle.horizontalAlign=t}return e}_getDocumentDataByStyle(e,t,n){const r=e.length-1,{textRotation:s={a:0,v:vt.FALSE},textDirection:o=rt.UNSPECIFIED,paddingData:i={t:0,r:2,b:0,l:2},horizontalAlign:l=lt.UNSPECIFIED,verticalAlign:a=ct.UNSPECIFIED,wrapStrategy:c=ut.UNSPECIFIED}=n,{a:h=0,v:u=vt.FALSE}=s,{t:d,r:g,b:f,l:m}=i;D.NORMAL;let p=0,b=h;u===vt.TRUE&&(p=90,b=90,D.TBRL);return{id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:r,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{horizontalAlign:l},elements:[{eId:"oneElement",st:0,ed:r,et:B.TEXT_RUN,tr:{ct:e,ts:t}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:d,marginBottom:f,marginRight:g,marginLeft:m,renderConfig:{horizontalAlign:l,verticalAlign:a,centerAngle:p,vertexAngle:b,wrapStrategy:c}}}}___setBorderProps(e,t,n,r,s){var o;const i=null==(o=r.bd)?void 0:o[n];if(!i||!s.border)return!0;const l=kn(i.cl)||Qi,a=s.border;a.getValue(e,t)||a.setValue(e,t,{[n]:{}}),a.getValue(e,t)[n]={type:n,style:i.s,color:l}}_getFontFormat(e){if(!e)return{};const{ff:t,fs:n,it:r,bl:s,ul:o,st:i,ol:l,cl:a,bg:c,bd:h}=e;return{ff:t,fs:n,it:r,bl:s,ul:o,st:i,ol:l,cl:a}}_getOtherStyle(e){if(!e)return{};const{tr:t,td:n,ht:r,vt:s,tb:o,pd:i}=e;return{textRotation:t,textDirection:n,horizontalAlign:r,verticalAlign:s,wrapStrategy:o,paddingData:i}}_getMergeCells(e,t){const n=this.columnWidthAccumulation.length-1;if(t)t={startRow:t.startRow,endRow:t.endRow,endColumn:n,startColumn:0};else{t={startRow:0,startColumn:0,endRow:this.rowHeightAccumulation.length-1,endColumn:n}}const{startRow:r,startColumn:s,endRow:o,endColumn:i}=t,l=new p;for(let a=0;a<e.length;a++){const{startRow:t,endRow:n,startColumn:c,endColumn:h}=e[a];for(let e=r;e<=o;e++){let r=!1;for(let o=s;o<=i;o++)if(e>=t&&e<=n&&o>=c&&o<=h){l.setValue(t,c,{startRow:t,endRow:n,startColumn:c,endColumn:h}),r=!0;break}if(r)break}}return l}}function Su(e,t,n){e.onPointerEnterObserver.add((n=>{t(e,n)})),e.onPointerLeaveObserver.add((t=>{n(e,t)}))}var Eu,Ru;(Ru=Eu||(Eu={})).LEFT="__slideNavigationLeft__",Ru.RIGHT="__slideNavigationRight__";const Iu="M512 1024C229.248 1024 0 794.752 0 512S229.248 0 512 0s512 229.248 512 512-229.248 512-512 512z m200.746667-478.506667l1.749333-1.664 30.165333-30.165333-330.496-330.581333a42.837333 42.837333 0 0 0-60.288 0 42.538667 42.538667 0 0 0 0 60.330666l270.08 270.165334-270.08 269.952a42.496 42.496 0 0 0 0 60.288c16.64 16.64 43.861333 16.469333 60.288 0.042666l298.581334-298.368z";class Au extends Kh{constructor(){super(...arguments),this.onSlideChangePageByNavigationObservable=new i,this._navigationEnabled=!1}activeFirstPage(){const e=this.getSubScenes().keys().next().value;null!=e&&this.changePage(e)}addPage(e){const t=e.sceneKey;null==this.getSubScene(t)&&(this.addSubScene(e),this.addNavigation())}changePage(e){null!==e&&(this.removeNavigation(),this.activeSubScene(e),this.addNavigation())}hasPage(e){return this.getSubScene(e)}addNavigation(){const e=this.getActiveSubScene();if(null==e||!1===this._navigationEnabled)return;const t=new Ya(Eu.LEFT,{data:Iu,width:60,height:60,left:90,top:(this.height-30)/2,fill:this._getArrowColor(),flipX:!0}),n=new Ya(Eu.RIGHT,{data:Iu,width:60,height:60,left:this.width-90,top:(this.height-30)/2,fill:this._getArrowColor()}),r=(e,t)=>{e.setCursor(Yi.POINTER),e.setProps({fill:this._getArrowColor(!0)})},s=(e,t)=>{e.setCursor(Yi.DEFAULT),e.setProps({fill:this._getArrowColor()})};Su(t,r,s),Su(n,r,s),this._addNavTrigger(t,n),e.addObjects([t,n],7)}removeNavigation(){var e,t;const n=this.getActiveSubScene();null!=n&&!1!==this._navigationEnabled&&(null==(e=n.getObject(Eu.LEFT))||e.dispose(),null==(t=n.getObject(Eu.RIGHT))||t.dispose())}enableNav(){this._navigationEnabled=!0}disableNav(){this._navigationEnabled=!1}hiddenNav(){var e,t;const n=this.getActiveSubScene();null!=n&&!1!==this._navigationEnabled&&(null==(e=n.getObject(Eu.LEFT))||e.hide(),null==(t=n.getObject(Eu.RIGHT))||t.hide())}showNav(){var e,t;const n=this.getActiveSubScene();null!=n&&!1!==this._navigationEnabled&&(null==(e=n.getObject(Eu.LEFT))||e.show(),null==(t=n.getObject(Eu.RIGHT))||t.show())}renderToThumb(e,t,n=1,r=1){const s=this.getSubScene(t);null!=s&&(e.save(),e.scale(n,r),s.makeDirtyNoParent(!0).render(e),e.restore())}_getSubScenesIndex(e){if(null==e)return;const t=Array.from(this.getSubScenes()),n=t.length;let r=0;for(let i=0;i<n;i++){const[n]=t[i];if(e===n){r=i;break}}let s=r+1,o=r-1;return s=s>=n?0:s,o=o<0?n-1:o,{nextScene:t[s][1],previousScene:t[o][1]}}_addNavTrigger(e,t){e.onPointerDownObserver.add((()=>{var e;const t=this._getSubScenesIndex(null==(e=this.getActiveSubScene())?void 0:e.sceneKey),n=null==t?void 0:t.previousScene.sceneKey;this.changePage(n),this.onSlideChangePageByNavigationObservable.notifyObservers(n)})),t.onPointerDownObserver.add((()=>{var e;const t=this._getSubScenesIndex(null==(e=this.getActiveSubScene())?void 0:e.sceneKey),n=null==t?void 0:t.nextScene.sceneKey;this.changePage(n),this.onSlideChangePageByNavigationObservable.notifyObservers(n)}))}_getArrowColor(e=!1){return Al(Li.white,e?.8:.5)}}class xu extends Fo{constructor(){super(Ut.BASE_RENDER),this._engine=new xa}static create(){return new xu}installTo(e){e.install(this)}getEngine(){return this._engine}}var Ou,Mu,Nu=Object.freeze(Object.defineProperty({__proto__:null,zh:Ni,en:ki,RGB_PAREN:"rgb(",RGBA_PAREN:"rgba(",COLORS:Li,get SHAPE_TYPE(){return Di},get EVENT_TYPE(){return Pi},get LINK_VIEW_PORT_TYPE(){return Hi},MIDDLE_CELL_POS_MAGIC_NUMBER:1,DEFAULT_FONTFACE_PLANE:zi,DEFAULT_SKELETON_HEADER:Wi,DEFAULT_SKELETON_FOOTER:Vi,DEFAULT_MEASURE_TEXT:"0",DEFAULT_OFFSET_SPACING:1,DEFAULT_DOCUMENT_FONTSIZE:ji,get CURSOR_TYPE(){return Yi},get DOCUMENT_CONTEXT_CLIP_TYPE(){return Xi},COLOR_BLACK_RGB:Qi,get BORDER_TYPE(){return Ki},get ORIENTATION_TYPE(){return qi},get RENDER_CLASS_TYPE(){return el},FontCache:rl,get SkeletonType(){return sl},get BreakType(){return il},get LineType(){return al},get SpanType(){return hl},get PageLayoutType(){return dl},get DeviceInputEventType(){return fl},EventConstants:wl,get DeviceType(){return pl},get PointerInput(){return _l},get TRANSFORM_CHANGE_OBSERVABLE_TYPE(){return Cl},PerformanceMonitor:yl,RollingAverage:Sl,INITIAL_MATRIX:ua,Transform:da,drawLineByBorderType:ga,setLineType:fa,getLineWidth:ma,calculateRectRotate:pa,getRotateOrientation:ba,getRotateOffsetAndFarthestHypotenuse:_a,Vector2:ha,INITIAL_Path2:va,Path2:Ca,getColor:Al,toPx:xl,requestNewFrame:Ol,cancelRequestFrame:Ml,createCanvasElement:Nl,createImageElement:()=>document.createElement("img"),radToDeg:kl,degToRad:Ll,getPointerPrefix:Dl,IsSafari:Pl,generateRandomKey:Bl,getValueType:Hl,isFunction:Fl,isDate:function(e){return"[object Date]"===Hl(e)},isRegExp:function(e){return"[object RegExp]"===Hl(e)},isArray:function(e){return"[object Array]"===Hl(e)},isString:zl,isNumber:function(e){return"[object Number]"===Hl(e)},isObject:function(e){return"[object Object]"===Hl(e)},precisionTo:Ul,fixLineWidthByScale:Wl,getFontStyleString:Vl,isSupportBoundingBox:function(e){return null!=e.measureText("").actualBoundingBoxAscent},hasChineseText:jl,hasJapaneseText:Yl,hasKoreanText:function(e){return!!/[^a-zA-Z0-9\p{Hangul}]/gi.exec(e)},hasCJK:Gl,hasWrappableText:function(e){return jl(e)||Yl(e)},hasAllLatin:function(e){return!!/[\u0000-\u024F]/gi.exec(e)},hasBasicLatin:function(e){return!!/[\u0000-\u007F]/gi.exec(e)},hasLatinOneSupplement:function(e){return!!/[\u0080-\u00FF]/gi.exec(e)},hasLatinExtendedA:function(e){return!!/[\u0100-\u017F]/gi.exec(e)},hasLatinExtendedB:function(e){return!!/[\u0180-\u024F]/gi.exec(e)},hasArabic:Xl,hasTibetan:$l,hasSpaceAndTab:Ql,getDPI:Zl,ptToPx:ql,pxToPt:Jl,ptToMM:function(e){return e*(Zl()/25.4)},pxToInch:function(e){return e*Zl()},getScale:ea,getCellPositionByIndex:ta,getCellByIndex:na,mergeCellHandler:ra,mergeInfoOffset:sa,isRectIntersect:oa,injectStyle:ia,checkStyle:la,pxToNum:aa,getSizeForDom:ca,BlockPlugin:class extends Fo{dealWidthCustomBlock(e,t,n,r,s){return[]}onMapping(e){}onMounted(e){}onDestroy(){}},BulletPlugin:class extends Fo{dealWidthCustomBulletOrderedSymbol(e,t,n){return""}onMapping(e){}onMounted(e){}onDestroy(){}},dealWidthCustomBlock:Ta,dealWidthCustomBulletOrderedSymbol:wa,CustomObject:class extends Sa{constructor(e,t=(e=>{}),n){super(e),this._render=t,this._isHitCustom=n}toJson(){return __spreadValues({},super.toJson())}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(t&&!this.isInGroup){const{minX:e,maxX:n,minY:r,maxY:s}=Ra(this,t);if(this.width+this.strokeWidth<e||n<0||this.height+this.strokeWidth<r||s<0)return this}const n=this.transform.getMatrix();return e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._render(e),e.restore(),this.makeDirty(!1),this}isHit(e){return this._isHitCustom?this._isHitCustom(e):super.isHit(e)}},Engine:xa,BASE_OBJECT_ARRAY:ya,BaseObject:Sa,Layer:Oa,Scene:Qh,SceneViewer:Kh,Viewport:Zh,getDevicePixelRatio:Ia,Canvas:Aa,SceneCanvas:class extends Aa{constructor(e={width:0,height:0}){super(e),this.setSize(e.width,e.height)}},HitCanvas:class extends Aa{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.setSize(e.width,e.height)}},InputManager:Na,Group:ka,SHAPE_OBJECT_ARRAY:Da,Shape:Pa,RECT_OBJECT_ARRAY:Ba,Rect:Ha,Control:class{},Drawing:class{},Selection:class{},REGULAR_POLYGON_OBJECT_ARRAY:Fa,RegularPolygon:za,ScrollBar:Wa,Picture:Va,PATH_OBJECT_ARRAY:ja,Path:Ya,CIRCLE_OBJECT_ARRAY:Ga,Circle:Xa,RICHTEXT_OBJECT_ARRAY:Dh,RichText:Ph,Skeleton:fh,ComponentExtension:_h,SpreadsheetExtensionRegistry:vh,SheetRowTitleExtensionRegistry:Ch,SheetColumnTitleExtensionRegistry:Th,DocumentsSpanAndLineExtensionRegistry:wh,RenderComponent:ph,createSkeletonColumn:function(e=0,t,n=k.NONE,r=1/0){const{left:s,width:o,spaceWidth:i}=function(e=0,t,n){let r=0,s=0,o=0;for(let i=0;i<=e;i++){const{width:e,paddingEnd:l}=t[i];i===t.length-1?(r=n===1/0?n-r:e,s=0):(s=l,r=e,o+=r+s)}return{width:r,spaceWidth:s,left:o-r-s}}(e,t,r);return{lines:[],left:s,width:o,height:0,spaceWidth:i,separator:n,st:0,ed:0,drawingLRIds:[],isFull:!1}},createSkeletonLine:Fc,calculateLineTopByDrawings:zc,setDivideFullState:Wc,setLineMarginBottom:function(e,t){e.marginBottom=t},updateDivideInLine:function(e){},isParagraphStart:$c,createAndUpdateBlockAnchor:Qc,addSpanToDivide:Kc,createSkeletonPage:ch,createSkeletonSection:pc,setColumnFullState:bc,createSkeletonWordSpan:Rc,createSkeletonLetterSpan:Ic,createSkeletonTabSpan:Ac,createSkeletonBulletSpan:Oc,setSpanGroupLeft:Mc,setSpanLeft:function(e,t=0){e.left=t},Liquid:Rh,getLastPage:$a,getLastSection:Qa,getLastColumn:function(e){const t=Qa(e).columns;return null==t?void 0:t[t.length-1]},getLastLine:Ka,getLastLineByColumn:Za,getPageContentWidth:qa,getPreLine:function(e){const t=e.parent,n=null==t?void 0:t.lines.indexOf(e);if(n&&-1!==n&&!(n-1<0))return null==t?void 0:t.lines[n-1]},getColumnByDivide:Ja,getLastNotFullColumnInfo:ec,getLastNotFullDivideInfo:tc,getNextDivide:function(e,t){const n=e.divides.indexOf(t);if(-1!==n)return e.divides[n+1]},getLastRemainingDivide:function(e){if(e)for(let t=0;t<e.divides.length;t++){const n=e.divides[t],r=e.divides[t+1];if(0===n.spanGroup.length)return n;if(!r||0===r.spanGroup.length)return n}},getLastSpan:function(e){var t;const n=null==(t=tc(e))?void 0:t.divide.spanGroup;return null==n?void 0:n[n.length-1]},isColumnFull:nc,isBlankPage:rc,isBlankColumn:sc,reCalculateLineDivide:function(){},getNumberUnitValue:oc,getCharSpaceApply:ic,validationGrid:lc,getLineHeightConfig:ac,getCharSpaceConfig:cc,updateBlockIndex:hc,spanIterator:function(e,t){for(let n of e){const{sections:e}=n;for(let n of e){const{columns:e}=n;for(let n of e){const{lines:e}=n;for(let n of e){const{divides:e,lineHeight:r}=n,s=e.length;for(let n=0;n<s;n++){const r=e[n],{spanGroup:s}=r;for(let e of s)t&&Fl(t)&&t(e)}}}}}},lineIterator:uc,columnIterator:dc,getPositionHorizon:gc,getPositionVertical:fc,getPositionHorizonBySpan:function(e,t){},getSpanGroupWidth:mc,dealWidthBullet:wc,getDefaultBulletSke:yc,getBulletOrderedSymbol:vc,dealWidthInlineDrawing:function(e,t,n,r,s,o){return[]},composeCharForLanguage:Nc,calculateParagraphLayout:Zc,dealWidthParagraph:sh,dealWidthTextRun:rh,TableOfContents:class{},dealWithBlockError:ih,dealWithBlocks:lh,dealWidthBlocksByMultiColumnAndContinuous:function(){},get DocumentSkeletonState(){return Bc},DocumentSkeleton:mh,Documents:Lh,DocumentHorizonBar:class{},DocumentVerticalBar:class{},get ShowGridlinesState(){return jh},SheetComponent:qh,SpreadsheetTitle:Jh,get SHEET_EXTENSION_TYPE(){return Gh},SheetExtension:eu,Background:tu,Border:nu,BorderAuxiliary:ru,Font:su,RowTitleLayout:ou,ColumnTitleLayout:iu,Spreadsheet:Cu,SpreadsheetRowTitle:Tu,SpreadsheetColumnTitle:wu,SpreadsheetSkeleton:yu,get SLIDE_NAVIGATION_KEY(){return Eu},Slide:Au,RenderEngine:xu,ScrollTimer:La},Symbol.toStringTag,{value:"Module"}));function ku(e){e.deleteObserve("onDragAndDropStartObserver"),e.deleteObserve("onDragAndDroppingObserver"),e.deleteObserve("onDragAndDropEndEndObserver"),e.deleteObserve("onFillStartObserver"),e.deleteObserve("onFillingObserver"),e.deleteObserve("onFillEndObserver"),e.deleteObserve("onChangeSelectionObserver"),e.deleteObserve("onChangeCurrentSheetObserver")}function Lu(e){e.pushToObserve("onDragAndDropStartObserver"),e.pushToObserve("onDragAndDroppingObserver"),e.pushToObserve("onDragAndDropEndEndObserver"),e.pushToObserve("onFillStartObserver"),e.pushToObserve("onFillingObserver"),e.pushToObserve("onFillEndObserver"),e.pushToObserve("onChangeSelectionObserver"),e.pushToObserve("onChangeCurrentSheetObserver")}class Du{constructor(){this.viewKey=""}getScene(){return this._scene}getPlugin(){return this._plugin}getContext(){return this._plugin.getContext()}updateToSheet(e){}initialize(e,t){return this._scene=e,this._plugin=t,this._initialize(),this}_initialize(){}}(Mu=Ou||(Ou={})).MAIN_SCENE="mainScene",Mu.VIEW_MAIN="viewMain",Mu.VIEW_TOP="viewTop",Mu.VIEW_LEFT="viewLeft",Mu.VIEW_LEFT_TOP="viewLeftTop",Mu.SHEET_VIEW="sheetView",Mu.DRAG_LINE_VIEW="dragLineView";const Pu=Qo.create(),Bu={selections:{}};var Hu,Fu,zu;function Uu(e,t){const n=e.getContext().getPluginManager().getRequirePluginByName(Ut.SPREADSHEET).getSelectionManager(),r=n.getCurrentModelsValue();return n.setModels(t),r}!function(e){e.SET_SELECTION_VALUE_ACTION="SetSelectionValueAction"}(Hu||(Hu={}));class Wu extends Ur{constructor(e,t,n){super(e,t,n),this._doActionData=__spreadValues({},e);const r=this.do();this._oldActionData=__spreadProps(__spreadValues({},e),{selections:r}),this.validate()}do(){const{selections:e}=this._doActionData,t=Uu(this.getWorkSheet(),e);return this._observers.notifyObservers({type:Dr.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData,t=this.do();this._oldActionData={actionName:Hu.SET_SELECTION_VALUE_ACTION,sheetId:e,selections:t}}undo(){const{selections:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Hu.SET_SELECTION_VALUE_ACTION,sheetId:t,selections:Uu(n,e)},this._observers.notifyObservers({type:Dr.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Wu.NAME="SetSelectionValueAction",zr.register(Wu.NAME,Wu);class Vu{constructor(e){this._range=e}getRange(){return this._range}getRect(){return this._rect}setRect(e){this._rect=e}setRange(e){this._range=e}}class ju{constructor(e){this._sheetId=e,this._antLineList=[]}deleteAntLineById(e){const t=this._antLineList.findIndex((t=>t.getRange().id===e));t>-1&&this._antLineList.splice(t,1)}addAntLine(e){this._antLineList.push(e)}getSheetId(){return this._sheetId}getAntLineList(){return this._antLineList}getAntLineById(e){const t=this._antLineList.findIndex((t=>t.getRange().id===e));if(t>-1)return this._antLineList[t]}}(zu=Fu||(Fu={})).Selection="__SelectionDragShape__",zu.top="__TopDragControl__",zu.bottom="__BottomDragControl__",zu.left="__LeftDragControl__",zu.right="__RightDragControl__";class Yu{constructor(e){this._control=e,this._startOffsetX=0,this._startOffsetY=0,this._zIndex=e.zIndex+1,this._model=e.model,this._initialize()}static create(e){return new Yu(e)}dragEventInitial(){}dragDown(e,t){const n=this._control.getPlugin().getMainComponent(),r=this._model.getValue().selection;this._model=new Ju($u.NORMAL,this._control.getPlugin()),this._model.setValue(r),this._updateControl();const{offsetX:s,offsetY:o}=e;this._startOffsetX=s,this._startOffsetY=o;const i=n.getAncestorScrollXY(this._startOffsetX,this._startOffsetY);let l=null;switch(t){case Fe.LEFT:l=n.calculateCellIndexByPosition(s+Xu.strokeWidth,o,i);break;case Fe.TOP:l=n.calculateCellIndexByPosition(s,o+Xu.strokeWidth,i);break;case Fe.RIGHT:l=n.calculateCellIndexByPosition(s-Xu.strokeWidth,o,i);break;case Fe.BOTTOM:l=n.calculateCellIndexByPosition(s,o-Xu.strokeWidth,i)}const a=Mn(l);if(!a)return!1;const{startRow:c,startColumn:h,endColumn:u,endRow:d,startY:g,endY:f,startX:m,endX:p}=a,b={startColumn:h,startRow:c,endColumn:u,endRow:d,startY:g,endY:f,startX:m,endX:p};this._oldSelectionRange=b,this._cellPositionOffset={top:b.startRow-this._model.startRow,bottom:this._model.endRow-b.endRow,left:b.startColumn-this._model.startColumn,right:this._model.endColumn-b.endColumn};const _=this._control.getScene();_.disableEvent();const v=La.create(_);v.startScroll(s,o),this._moveObserver=_.onPointerMoveObserver.add((e=>{this.dragMoving(e);const{offsetX:t,offsetY:n}=e;v.scrolling(t,n,(()=>{this.dragMoving(e)}))})),this._upObserver=_.onPointerUpObserver.add((e=>{this.dragUp(),_.onPointerMoveObserver.remove(this._moveObserver),_.onPointerUpObserver.remove(this._upObserver),_.enableEvent(),v.stopScroll()}))}dragMoving(e){const t=this._control.getPlugin().getMainComponent(),{offsetX:n,offsetY:r,clientX:s,clientY:o}=e,i=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),l=Mn(t.calculateCellIndexByPosition(n,r,i));if(!l)return!1;const{startRow:a,startColumn:c,endColumn:h,endRow:u,startX:d,startY:g,endX:f,endY:m}=l,p={startColumn:c,startRow:a,endColumn:h,endRow:u,startY:g||0,endY:m||0,startX:d||0,endX:f||0},{startRow:b,endRow:_,startColumn:v,endColumn:C}=this._oldSelectionRange;if(v!==c||b!==a||C!==h||_!==u){this._oldSelectionRange=p;const{left:e,right:n,top:r,bottom:s}=this._cellPositionOffset,o=a-r,i=u+s,l=c-e,d=h+n;if(o<0||i<0||l<0||d<0)return;const g={startRow:o,endRow:i,startColumn:l,endColumn:d},f=t.getNoMergeCellPositionByIndex(g.startRow,g.startColumn),m=t.getNoMergeCellPositionByIndex(g.endRow,g.endColumn),b=Object.assign(g,{startY:(null==f?void 0:f.startY)||0,endY:(null==m?void 0:m.endY)||0,startX:(null==f?void 0:f.startX)||0,endX:(null==m?void 0:m.endX)||0});this._model.setValue(b),this._updateControl()}}dragUp(){const e=this._control.getPlugin().getMainComponent();this.hide();const{selection:t}=this._model.getValue(),n=e.getCellByIndex(t.startRow,t.startColumn);this._control.update(t,n)}_updateControl(){const{startX:e,startY:t,endX:n,endY:r}=this._model;this._leftDragControl.resize(void 0,r-t),this._rightDragControl.transformByState({height:r-t,left:n-e-Xu.strokeWidth/2}),this._topDragControl.resize(n-e+Xu.strokeWidth),this._bottomDragControl.transformByState({width:n-e+Xu.strokeWidth,top:r-t-Xu.strokeWidth/2}),this._selectionDragShape.show(),this._selectionDragShape.translate(e,t),this._selectionDragShape.makeDirty(!0)}hide(){this._selectionDragShape.hide(),this._selectionDragShape.makeDirty(!0)}dispose(){this._leftDragControl.dispose(),this._rightDragControl.dispose(),this._topDragControl.dispose(),this._bottomDragControl.dispose(),this._selectionDragShape.dispose()}remove(){const{leftControl:e,rightControl:t,topControl:n,bottomControl:r}=this._control;e.onPointerEnterObserver.clear(),e.onPointerLeaveObserver.clear(),t.onPointerEnterObserver.clear(),t.onPointerLeaveObserver.clear(),n.onPointerEnterObserver.clear(),n.onPointerLeaveObserver.clear(),r.onPointerEnterObserver.clear(),r.onPointerLeaveObserver.clear()}_initialize(){this._control.getPlugin().getMainComponent();const{leftControl:e,rightControl:t,topControl:n,bottomControl:r,fillControl:s}=this._control;e.onPointerEnterObserver.add((t=>{e.cursor=Yi.MOVE})),e.onPointerLeaveObserver.add((t=>{e.resetCursor()})),t.onPointerEnterObserver.add((e=>{t.cursor=Yi.MOVE})),t.onPointerLeaveObserver.add((e=>{t.resetCursor()})),n.onPointerEnterObserver.add((e=>{n.cursor=Yi.MOVE})),n.onPointerLeaveObserver.add((e=>{n.resetCursor()})),r.onPointerEnterObserver.add((e=>{r.cursor=Yi.MOVE})),r.onPointerLeaveObserver.add((e=>{r.resetCursor()})),r.onPointerDownObserver.add((e=>{this.dragDown(e,Fe.BOTTOM)})),r.onPointerUpObserver.add((e=>{r.resetCursor()}));const o=this._zIndex;this._leftDragControl=new Ha(Fu.left+o,{top:0,left:-Xu.strokeWidth/2,width:2*Xu.strokeWidth,fill:Xu.strokeColor,zIndex:o}),this._rightDragControl=new Ha(Fu.right+o,{width:2*Xu.strokeWidth,fill:Xu.strokeColor,zIndex:o}),this._topDragControl=new Ha(Fu.top+o,{top:-Xu.strokeWidth/2,left:-Xu.strokeWidth/2,height:2*Xu.strokeWidth,fill:Xu.strokeColor,zIndex:o}),this._bottomDragControl=new Ha(Fu.bottom+o,{height:2*Xu.strokeWidth,fill:Xu.strokeColor,left:-Xu.strokeWidth/2,zIndex:o}),this._selectionDragShape=new ka(Fu.Selection+o,this._leftDragControl,this._rightDragControl,this._topDragControl,this._bottomDragControl),this._selectionDragShape.evented=!1,this._selectionDragShape.zIndex=o;this._control.getScene().addObject(this._selectionDragShape)}}class Gu{constructor(e){this._control=e,this._initialize()}static create(e){return new Gu(e)}remove(){const{fillControl:e}=this._control;e.onPointerEnterObserver.clear(),e.onPointerLeaveObserver.clear()}_initialize(){const{fillControl:e}=this._control;this._control.getPlugin(),e.onPointerEnterObserver.add((t=>{e.cursor=Yi.CROSSHAIR})),e.onPointerLeaveObserver.add((t=>{e.resetCursor()}))}}const Xu={strokeColor:"rgb(1,136,251)",backgroundColor:"rgba(1,136,251, 0.1)",strokeWidth:2,fillSideLength:6,fillStrokeLength:1,fillStrokeColor:"rgb(255,255,255)"};var $u,Qu,Ku,Zu;!function(e){e[e.NORMAL=0]="NORMAL",e[e.ROW=1]="ROW",e[e.COLUMN=2]="COLUMN"}($u||($u={})),function(e){e.Selection="__SpreadsheetSelectionShape__",e.top="__SpreadsheetSelectionTopControl__",e.bottom="__SpreadsheetSelectionBottomControl__",e.left="__SpreadsheetSelectionShapeLeftControl__",e.right="__SpreadsheetSelectionShapeRightControl__",e.backgroundTop="__SpreadsheetSelectionBackgroundControlTop__",e.backgroundMiddleLeft="__SpreadsheetSelectionBackgroundControlMiddleLeft__",e.backgroundMiddleRight="__SpreadsheetSelectionBackgroundControlMiddleRight__",e.backgroundBottom="__SpreadsheetSelectionBackgroundControlBottom__",e.fill="__SpreadsheetSelectionFillControl__",e.lineMain="__SpreadsheetDragLineMainControl__",e.lineContent="__SpreadsheetDragLineContentControl__",e.line="__SpreadsheetDragLineControl__"}(Qu||(Qu={}));class qu{constructor(e,t){this._manager=e,this._zIndex=t,this._initialize()}get zIndex(){return this._zIndex}get leftControl(){return this._leftControl}get rightControl(){return this._rightControl}get topControl(){return this._topControl}get bottomControl(){return this._bottomControl}get fillControl(){return this._fillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShape}get model(){return this._selectionModel}static create(e,t){return new this(e,t)}static fromJson(e,t,n){const r=qu.create(e,t);return r.update(n),r}_updateControl(){const{startX:e,startY:t,endX:n,endY:r}=this._selectionModel;this.leftControl.resize(void 0,r-t),this.rightControl.transformByState({height:r-t,left:n-e-Xu.strokeWidth/2}),this.topControl.resize(n-e+Xu.strokeWidth),this.bottomControl.transformByState({width:n-e+Xu.strokeWidth,top:r-t-Xu.strokeWidth/2}),this.fillControl.translate(n-e-Xu.fillSideLength/2,r-t-Xu.fillSideLength/2),this._updateBackgroundControl(),this._updateDragAndFill(),this.selectionShape.show(),this.selectionShape.translate(e,t),this.selectionShape.makeDirty(!0)}update(e,t){this._selectionModel.setValue(e,t),this._updateControl()}clearHighlight(){this._selectionModel.clearCurrentCell(),this._updateControl()}dispose(){var e,t,n,r,s,o,i,l,a,c;null==(e=this._leftControl)||e.dispose(),null==(t=this._rightControl)||t.dispose(),null==(n=this._topControl)||n.dispose(),null==(r=this._bottomControl)||r.dispose(),null==(s=this._backgroundControlTop)||s.dispose(),null==(o=this._backgroundControlMiddleLeft)||o.dispose(),null==(i=this._backgroundControlMiddleRight)||i.dispose(),null==(l=this._backgroundControlBottom)||l.dispose(),null==(a=this._fillControl)||a.dispose(),null==(c=this._selectionShape)||c.dispose(),this._selectionDragAndDrop.dispose()}getScene(){return this._manager.getScene()}getPlugin(){return this._manager.getPlugin()}getCurrentCellInfo(){const e=this.model.currentCell;if(e){let t;if(e.isMerged){const n=e.mergeInfo;t={startRow:n.startRow,endRow:n.endRow,startColumn:n.startColumn,endColumn:n.endColumn,startX:n.startX,endX:n.endX,startY:n.startY,endY:n.endY}}else{const{row:n,column:r,startX:s,endX:o,startY:i,endY:l}=e;t={startRow:n,endRow:n,startColumn:r,endColumn:r,startX:s,endX:o,startY:i,endY:l}}return t}}_initialize(){this._selectionModel=new Ju(0,this._manager.getPlugin());const e=this._zIndex;this._leftControl=new Ha(Qu.left+e,{top:0,left:-Xu.strokeWidth/2,width:Xu.strokeWidth,fill:Xu.strokeColor,zIndex:e}),this._rightControl=new Ha(Qu.right+e,{width:Xu.strokeWidth,fill:Xu.strokeColor,zIndex:e}),this._topControl=new Ha(Qu.top+e,{top:-Xu.strokeWidth/2,left:-Xu.strokeWidth/2,height:Xu.strokeWidth,fill:Xu.strokeColor,zIndex:e}),this._bottomControl=new Ha(Qu.bottom+e,{height:Xu.strokeWidth,fill:Xu.strokeColor,left:-Xu.strokeWidth/2,zIndex:e}),this._backgroundControlTop=new Ha(Qu.backgroundTop+e,{fill:Xu.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlBottom=new Ha(Qu.backgroundBottom+e,{fill:Xu.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlMiddleLeft=new Ha(Qu.backgroundMiddleLeft+e,{fill:Xu.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlMiddleRight=new Ha(Qu.backgroundMiddleRight+e,{fill:Xu.backgroundColor,zIndex:e-1,evented:!1});const t=Xu.fillSideLength-Xu.fillStrokeLength;this._fillControl=new Ha(Qu.fill+e,{width:t,height:t,fill:Xu.strokeColor,strokeWidth:Xu.fillStrokeLength,stroke:Xu.fillStrokeColor,zIndex:e+1}),this._selectionShape=new ka(Qu.Selection+e,this._fillControl,this._leftControl,this._rightControl,this._topControl,this._bottomControl,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom),this._selectionShape.hide(),this._selectionShape.evented=!1,this._selectionShape.zIndex=e,this._selectionDragAndDrop=Yu.create(this),this._selectionControlFill=Gu.create(this);this.getScene().addObject(this._selectionShape)}_updateBackgroundControl(){const{startColumn:e,startRow:t,endColumn:n,endRow:r,startX:s,startY:o,endX:i,endY:l}=this._selectionModel,a=this._selectionModel.highlightToSelection();if(!a)return this._backgroundControlTop.resize(i-s,l-o),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),void this._backgroundControlMiddleRight.resize(0,0);const{startX:c,startY:h,endX:u,endY:d}=a,g=Xu.strokeWidth/2,f={left:-g,top:-g,width:i-s+2*g,height:h-o+g};f.height<0&&(f.width=0,f.height=0),this._backgroundControlTop.transformByState(f);const m={left:-g,top:h-o,width:c-s+g,height:d-h};m.width<0&&(m.width=0,m.height=0),this._backgroundControlMiddleLeft.transformByState(m);const p={left:u-s-g,top:h-o,width:i-u+2*g,height:d-h};p.width<0&&(p.width=0,p.height=0),this._backgroundControlMiddleRight.transformByState(p);const b={left:-g,top:d-o,width:i-s+2*g,height:l-d+g};b.height<0&&(b.width=0,b.height=0),this._backgroundControlBottom.transformByState(b)}_updateDragAndFill(){this._selectionModel.highlightToSelection()||(this._selectionDragAndDrop.remove(),this._fillControl.resize(0,0),this._selectionControlFill.remove())}}class Ju{constructor(e=$u.NORMAL,t){this._type=e,this._plugin=t}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get type(){return this._type}get currentCell(){return this._currentCell}isEqual(e){const{startColumn:t,startRow:n,endColumn:r,endRow:s,type:o}=this,{startColumn:i,startRow:l,endColumn:a,endRow:c}=e;return t===i&&n===l&&r===a&&s===c}isInclude(e){const{startColumn:t,startRow:n,endColumn:r,endRow:s,type:o}=this,{startColumn:i,startRow:l,endColumn:a,endRow:c}=e;return!(a<t||i>r||l>s||c<n)}highlightToSelection(){return Mn(this._currentCell)}getValue(){return{selection:{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY},cell:this._currentCell}}setValue(e,t){const{startColumn:n,startRow:r,endColumn:s,endRow:o,startX:i,startY:l,endX:a,endY:c}=e;this._startColumn=n,this._startRow=r,this._endColumn=s,this._endRow=o,this._startX=i,this._startY=l,this._endX=a,this._endY=c,this.setTypeByData(),this.setCurrentCell(t)}setCurrentCell(e){e&&(this._currentCell=e)}clearCurrentCell(){this._currentCell=null}setTypeByData(){const e=this._plugin.getWorkbook().getActiveSheet().getConfig().rowCount,t=this._plugin.getWorkbook().getActiveSheet().getConfig().columnCount;return 0===this._startRow&&this._endRow===e-1?this._type=$u.COLUMN:0===this._startColumn&&this._endColumn===t-1?this._type=$u.ROW:this._type=$u.NORMAL}}(Zu=Ku||(Ku={})).lineMain="__SpreadsheetDragLineMain__",Zu.lineContent="__SpreadsheetDragLineContent__",Zu.line="__SpreadsheetDragLine__";const ed="rgb(1,136,251)",td=1,nd=5;var rd,sd,od,id,ld,ad,cd;(sd=rd||(rd={}))[sd.VERTICAL=0]="VERTICAL",sd[sd.HORIZONTAL=1]="HORIZONTAL";class hd{constructor(e){this._manager=e}getDragLine(){return this._dragLine}create(e){const{direction:t,end:n,dragUp:r,start:s}=e;this._direction=t,this._end=n,this._start=s,this._dragUp=r;const o=this._manager.getSheetView().getSpreadsheetColumnTitle().getSkeleton();if(t){const e=null==o?void 0:o.rowTitleWidth,t=null==o?void 0:o.columnTotalWidth;this._dragLineControlMain=new Ha(Ku.lineMain,{width:e,height:5,top:this._end-5,fill:ed}),this._dragLineControlContent=new Ha(Ku.lineContent,{width:t,height:1,top:this._end-1,left:e,fill:ed})}else{const e=null==o?void 0:o.columnTitleHeight,t=null==o?void 0:o.rowTotalHeight;this._dragLineControlMain=new Ha(Ku.lineMain,{width:nd,height:e,left:this._end-5,fill:ed}),this._dragLineControlContent=new Ha(Ku.lineContent,{width:td,height:t,top:e,left:this._end-1,fill:ed})}this._dragLine=new ka(Ku.line,this._dragLineControlMain,this._dragLineControlContent),this._dragLine.hide(),this._dragLine.evented=!1;this._manager.getScene().addObject(this._dragLine,3)}dragDown(e){const t=this._manager.getScene();t.disableEvent(),this._state={distance:this._direction?e.clientY:e.clientX},this._dragLine.show(),this._moveObserver=t.onPointerMoveObserver.add((e=>{this.dragMoving(e)})),this._upObserver=t.onPointerUpObserver.add((e=>{this.dragUp(e),t.onPointerMoveObserver.remove(this._moveObserver),t.onPointerUpObserver.remove(this._upObserver),t.enableEvent()}))}dragMoving(e){if(this._direction){if(this._dragLine.cursor=Yi.ROW_RESIZE,e.clientY<this._state.distance&&this._state.distance-e.clientY>=this._end-this._start-5)return;this._dragLine.transformByState({top:e.clientY-this._state.distance})}else{if(this._dragLine.cursor=Yi.COLUMN_RESIZE,e.clientX<this._state.distance&&this._state.distance-e.clientX>=this._end-this._start-5)return;this._dragLine.transformByState({left:e.clientX-this._state.distance})}}dragUp(e){let t;this._direction?(t=e.clientY-this._state.distance,e.clientY<this._state.distance&&this._state.distance-e.clientY>=this._end-this._start-5&&(t=null)):(t=e.clientX-this._state.distance,e.clientX<this._state.distance&&this._state.distance-e.clientX>=this._end-this._start-5&&(t=null)),this._dragUp(t,e),this._dragLine.dispose()}}class ud{constructor(e){this._startOffsetX=0,this._startOffsetY=0,this._index=0,this._currentWidth=0,this._manager=e,this._leftTopWidth=this._manager.getSheetView().getSpreadsheetLeftTopPlaceholder().getState().width,this._content=new Ha("HighLightContent",{width:0,height:this._manager.getSheetView().getSpreadsheetSkeleton().columnTitleHeight,left:0,fill:"rgb(220,220,220,0.5)"}),this._Item=new Ha("HighLightItem",{width:5,height:this._manager.getSheetView().getSpreadsheetSkeleton().columnTitleHeight,left:0,fill:"rgb(220,220,220,0.5)"}),this._highlightItem=new ka("HighLightColumnTitle",this._content,this._Item),this._highlightItem.hide();this._manager.getScene().addObject(this._highlightItem,3),this._initialize()}pointerDown(e){var t,n;const r=this._manager.getMainComponent(),{offsetX:s,offsetY:o}=e;this._startOffsetX=s,this._startOffsetY=o;const i=r.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),l=this._manager.getPlugin().getSheetContainerControl().getContentRef(),a=e.clientX+i.x-this._leftTopWidth-l.current.getBoundingClientRect().left,c=null!=(n=null==(t=r.getSkeleton())?void 0:t.columnWidthAccumulation)?n:[];for(let h=0;h<(null==c?void 0:c.length);h++)if(c[h]>=a){this._index=h;break}if(this._currentWidth=c[0],this._index&&(this._currentWidth=c[this._index]-c[this._index-1]),c[this._index]-a<=5){const t=c[this._index]+this._leftTopWidth,n=(this._index?c[this._index-1]:0)+this._leftTopWidth;this._manager.getDragLineControl().create({direction:rd.VERTICAL,end:t,start:n,dragUp:(e,t)=>{this.setColumnWidth(e),this.highlightColumnTitle(t)}}),this._manager.getDragLineControl().dragDown(e)}this.highlightColumn()}setColumnWidth(e){const t=this._manager.getPlugin().getContext().getWorkBook().getActiveSheet();null===e?t.setColumnWidth(this._index,1,5):t.setColumnWidth(this._index,1,e+this._currentWidth),this.highlightColumn()}highlightColumn(){this._manager.clearSelectionControls();const e=this._manager.getPlugin().getWorkbook().getActiveSheet();this._manager.addControlToCurrentByRangeData({startRow:0,startColumn:this._index,endColumn:this._index,endRow:e.getRowCount()-1},{row:0,column:this._index})}highlightColumnTitle(e){var t,n;const r=this._manager.getMainComponent(),{offsetX:s,offsetY:o}=e;this._startOffsetX=s,this._startOffsetY=o;const i=r.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),l=this._manager.getPlugin().getSheetContainerControl().getContentRef(),a=e.clientX+i.x-this._leftTopWidth-l.current.getBoundingClientRect().left,c=null!=(n=null==(t=r.getSkeleton())?void 0:t.columnWidthAccumulation)?n:[];for(let u=0;u<(null==c?void 0:c.length);u++)if(c[u]>=a){this._index=u;break}this._currentWidth=c[0];let h=this._leftTopWidth;this._index&&(this._currentWidth=c[this._index]-c[this._index-1],h=this._leftTopWidth+c[this._index-1]),this._content.transformByState({width:this._currentWidth-5}),this._Item.transformByState({left:this._currentWidth-5}),this._highlightItem.transformByState({width:this._currentWidth,left:h}),this._highlightItem.show()}_initialize(){this._highlightItem.onPointerEnterObserver.add((e=>{this._highlightItem.show()})),this._highlightItem.onPointerMoveObserver.add((e=>{this._highlightItem.show()})),this._highlightItem.onPointerLeaveObserver.add((e=>{this._highlightItem.hide()})),this._Item.onPointerEnterObserver.add((e=>{this._Item.cursor=Yi.COLUMN_RESIZE})),this._Item.onPointerLeaveObserver.add((e=>{this._Item.resetCursor()})),this._Item.onPointerDownObserver.add((e=>{this.pointerDown(e)}))}}class dd{constructor(e){this._startOffsetX=0,this._startOffsetY=0,this._index=0,this._currentHeight=0,this._manager=e,this._leftTopHeight=this._manager.getSheetView().getSpreadsheetLeftTopPlaceholder().getState().height;const t=this._manager.getSheetView().getSpreadsheetSkeleton().rowTitleWidth;this._content=new Ha("RowTitleContent",{width:t,height:0,top:0,fill:"rgb(220,220,220,0.5)"}),this._Item=new Ha("RowTitleItem",{width:t,height:5,top:0,fill:"rgb(220,220,220,0.5)"}),this._highlightItem=new ka("RowTitleGroup",this._content,this._Item),this._highlightItem.hide();this._manager.getScene().addObject(this._highlightItem,3),this._initialize()}pointerDown(e){var t,n;const r=this._manager.getMainComponent(),{offsetX:s,offsetY:o}=e;this._startOffsetX=s,this._startOffsetY=o;const i=r.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),l=this._manager.getPlugin().getSheetContainerControl().getContentRef(),a=e.clientY+i.y-this._leftTopHeight-l.current.getBoundingClientRect().top,c=null!=(n=null==(t=r.getSkeleton())?void 0:t.rowHeightAccumulation)?n:[];for(let h=0;h<(null==c?void 0:c.length);h++)if(c[h]>=a){this._index=h;break}if(this._currentHeight=c[0],this._index&&(this._currentHeight=c[this._index]-c[this._index-1]),c[this._index]-a<=5){const t=c[this._index]+this._leftTopHeight,n=(this._index?c[this._index-1]:0)+this._leftTopHeight;this._manager.getDragLineControl().create({direction:rd.HORIZONTAL,end:t,start:n,dragUp:this.setRowHeight.bind(this)}),this._manager.getDragLineControl().dragDown(e)}this.highlightRow()}setRowHeight(e){const t=this._manager.getPlugin().getContext().getWorkBook().getActiveSheet();null===e?t.setRowHeights(this._index,1,5):t.setRowHeights(this._index,1,e+this._currentHeight),this.highlightRow()}highlightRow(){this._manager.clearSelectionControls();const e=this._manager.getPlugin().getWorkbook().getActiveSheet();this._manager.addControlToCurrentByRangeData({startRow:this._index,startColumn:0,endColumn:e.getColumnCount()-1,endRow:this._index},{row:this._index,column:0})}highlightRowTitle(e){var t,n;const r=this._manager.getMainComponent(),{offsetX:s,offsetY:o}=e;this._startOffsetX=s,this._startOffsetY=o;const i=r.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),l=this._manager.getPlugin().getSheetContainerControl().getContentRef(),a=e.clientY+i.y-this._leftTopHeight-l.current.getBoundingClientRect().top,c=null!=(n=null==(t=r.getSkeleton())?void 0:t.rowHeightAccumulation)?n:[];for(let u=0;u<(null==c?void 0:c.length);u++)if(c[u]>=a){this._index=u;break}this._currentHeight=c[0];let h=this._leftTopHeight;this._index&&(this._currentHeight=c[this._index]-c[this._index-1],h=this._leftTopHeight+c[this._index-1]),this._content.transformByState({height:this._currentHeight-5}),this._Item.transformByState({top:this._currentHeight-5}),this._highlightItem.transformByState({height:this._currentHeight,top:h}),this._highlightItem.show()}_initialize(){this._highlightItem.onPointerEnterObserver.add((e=>{this._highlightItem.show()})),this._highlightItem.onPointerMoveObserver.add((e=>{this._highlightItem.show()})),this._highlightItem.onPointerLeaveObserver.add((e=>{this._highlightItem.hide()})),this._Item.onPointerEnterObserver.add((e=>{this._Item.cursor=Yi.ROW_RESIZE})),this._Item.onPointerLeaveObserver.add((e=>{this._Item.resetCursor()})),this._Item.onPointerDownObserver.add((e=>{this.pointerDown(e)}))}}class gd{constructor(e){this._sheetView=e,this.hasSelection=!1,this._selectionControls=[],this._selectionModels=new Map,this._startOffsetX=0,this._startOffsetY=0,this._plugin=this._sheetView.getPlugin(),this._initialize(),this._initializeObserver()}getSheetView(){return this._sheetView}getScene(){return this._sheetView.getScene()}getContext(){return this._sheetView.getContext()}getMainComponent(){return this._mainComponent}updateToSheet(e){this._worksheet=e;const t=this.getWorksheetId();if(t){this._selectionModels.get(t)||this._selectionModels.set(t,[])}}getCurrentControls(){return this._selectionControls}getCurrentControl(){const e=this.getCurrentControls();if(e&&e.length>0)for(const t of e){if(t.model.currentCell)return t}}getCurrentModels(){const e=this.getWorksheetId();if(!e)return;return this._selectionModels.get(e)||this._selectionModels.set(e,[]),this._selectionModels.get(e)}getCurrentCellModel(){const e=this.getCurrentModels();if(e&&e.length>0)for(const t of e){const e=t.currentCell;if(e)return e}}getCurrentModel(){const e=this.getCurrentModels();if(e&&e.length>0)for(const t of e){if(t.currentCell)return t}}getCurrentModelsValue(){const e=this.getCurrentModels();if(!e)return[];const t=[];for(let n of e)t.push(n.getValue());return t}renderCurrentControls(e=!0,t){const n=this.getWorksheetId();if(n){if(this._selectionControls)for(let e of this._selectionControls)e.dispose();const r=t||this._selectionModels.get(n);this._selectionControls=[],null==r||r.forEach((e=>{const t=e.currentCell,n=this._mainComponent,r=qu.create(this,this._selectionControls.length);let s=null;t&&(s=n.getCellByIndex(t.row,t.column));const{startRow:o,startColumn:i,endRow:l,endColumn:a}=e,c=n.getNoMergeCellPositionByIndex(o,i),h=n.getNoMergeCellPositionByIndex(l,a);r.update({startColumn:i,startRow:o,endColumn:a,endRow:l,startY:(null==c?void 0:c.startY)||0,endY:(null==h?void 0:h.endY)||0,startX:(null==c?void 0:c.startX)||0,endX:(null==h?void 0:h.endX)||0},s),this._selectionControls.push(r)})),e&&this.setSelectionModel()}}getPlugin(){return this._plugin}getWorksheetId(){var e;return null==(e=this._worksheet)?void 0:e.getSheetId()}addControlToCurrentByRangeData(e,t){const n=this.getCurrentControls();if(!n)return;const r=this._mainComponent,s=qu.create(this,n.length);let o=null;t&&(o=r.getCellByIndex(t.row,t.column));const{startRow:i,startColumn:l,endRow:a,endColumn:c}=e,h=r.getNoMergeCellPositionByIndex(i,l),u=r.getNoMergeCellPositionByIndex(a,c);s.update({startColumn:l,startRow:i,endColumn:c,endRow:a,startY:(null==h?void 0:h.startY)||0,endY:(null==u?void 0:u.endY)||0,startX:(null==h?void 0:h.startX)||0,endX:(null==u?void 0:u.endX)||0},o),n.push(s),this.setSelectionModel()}clearSelectionControls(){let e=this.getCurrentControls();if(e.length>0){for(let t of e)t.dispose();e.length=0}}setSelectionModel(e){if(!this._worksheet)return;e||(e=this._selectionControls.map((e=>e.model.getValue())));const t=this._worksheet.getContext().getWorkBook(),n=t.getCommandManager();let r={sheetId:this._worksheet.getSheetId(),actionName:Wu.NAME,selections:e};r=Kr.make(r).removeUndo().getAction();const s=new Wr({WorkBookUnit:t},r);n.invoke(s)}updateSelectionModel(e,t,n){const r=this.getWorksheetId();if(!this._worksheet||!r)return;const s=this._selectionModels.get(r),o=[];null==s||s.forEach(((r,s)=>{s===n?o.push({selection:e,cell:t}):o.push(r.getValue())}));const i=this._worksheet.getContext().getWorkBook(),l=i.getCommandManager();let a={sheetId:this._worksheet.getSheetId(),actionName:Hu.SET_SELECTION_VALUE_ACTION,selections:o};a=Kr.make(a).removeUndo().getAction();const c=new Wr({WorkBookUnit:i},a);l.invoke(c)}setModels(e){const t=this.getWorksheetId();if(!t)return;const n=e.map((({selection:e,cell:t})=>{const n=new Ju($u.NORMAL,this._plugin);return n.setValue(e,t),n}));this._selectionModels.set(t,n)}move(e){var t,n;const r=this.getCurrentCellModel();if(!r)return;let{startRow:s,startColumn:o,endRow:i,endColumn:l}=r.mergeInfo,{row:a,column:c}=r;const h=(null==(t=this._worksheet)?void 0:t.getRowCount())||1e3,u=(null==(n=this._worksheet)?void 0:n.getColumnCount())||50;switch(e){case Fe.TOP:r.isMerged||r.isMergedMainCell?a=--s:a--,a<0&&(a=0);break;case Fe.BOTTOM:r.isMerged||r.isMergedMainCell?a=++i:a++,a>h&&(a=h);break;case Fe.LEFT:r.isMerged||r.isMergedMainCell?c=--o:c--,c<0&&(c=0);break;case Fe.RIGHT:r.isMerged||r.isMergedMainCell?c=++l:c++,c>u&&(c=u)}const d=Mn(this._mainComponent.getCellByIndex(a,c));if(!d)return;const{startRow:g,endRow:f,startColumn:m,endColumn:p}=d,b=this._mainComponent.getSelectionBounding(g,m,f,p);if(!b)return;const{startRow:_,startColumn:v,endRow:C,endColumn:T}=b;let w={startRow:_,endRow:C,startColumn:v,endColumn:T},y={row:g,column:m};this.clearSelectionControls(),this.addControlToCurrentByRangeData(w,y),this.updatePreviousSelection()}setCurrentCell(e){var t;const{rangeData:n,sheetId:r}=e,{startRow:s,startColumn:o}=n;if(r!==this.getWorksheetId()){const e=null==(t=this._worksheet)?void 0:t.getIndex();if(null==e)return;this._plugin.getWorkbook().activateSheetByIndex(e)}const i=Mn(this._mainComponent.getCellByIndex(s,o));if(!i)return;const{startRow:l,endRow:a,startColumn:c,endColumn:h}=i,u=this._mainComponent.getSelectionBounding(l,c,a,h);if(!u)return;const{startRow:d,startColumn:g,endRow:f,endColumn:m}=u;let p={startRow:d,endRow:f,startColumn:g,endColumn:m},b={row:l,column:c};this.clearSelectionControls(),this.addControlToCurrentByRangeData(p,b),this.updatePreviousSelection()}moving(e,t,n=!1){var r;const s=this._mainComponent,{offsetX:o,offsetY:i,clientX:l,clientY:a}=e,{startRow:c,startColumn:h,endRow:u,endColumn:d}=this._startSelectionRange,g=s.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),f=Mn(s.calculateCellIndexByPosition(o,i,g));if(!f)return!1;const{startRow:m,startColumn:p,endColumn:b,endRow:_}=f,v=Math.min(m,c),C=Math.min(p,h),T=Math.max(_,u),w=Math.max(b,d),y=s.getSelectionBounding(v,C,T,w);if(!y)return!1;const{startRow:S,startColumn:E,endRow:R,endColumn:I}=y,A=s.getNoMergeCellPositionByIndex(S,E),x=s.getNoMergeCellPositionByIndex(R,I),O={startColumn:E,startRow:S,endColumn:I,endRow:R,startY:(null==A?void 0:A.startY)||0,endY:(null==x?void 0:x.endY)||0,startX:(null==A?void 0:A.startX)||0,endX:(null==x?void 0:x.endX)||0},{startRow:M,endRow:N,startColumn:k,endColumn:L}=(null==t?void 0:t.model)||Mt,{row:D,column:P}=(null==t?void 0:t.model.currentCell)||Nt;if(k===E&&M===S&&L===I&&N===R||(t&&t.update(O),t&&(null==(r=this._plugin.getObserver("onChangeSelectionObserver"))||r.notifyObservers(t))),n)if(this._previousSelection){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._previousSelection.selection||Mt,{row:s,column:o}=this._previousSelection.cell||Nt;n===E&&e===S&&r===I&&t===R&&s===D&&o===P||this.setSelectionModel()}else this.setSelectionModel()}up(e,t){this.moving(e,t,!0),this.updatePreviousSelection()}updatePreviousSelection(){let e=this.getCurrentControl();if(!e)return;const{startRow:t,endRow:n,startColumn:r,endColumn:s}=e.model,{row:o,column:i}=e.model.currentCell||Nt;this._previousSelection={selection:{startRow:t,endRow:n,startColumn:r,endColumn:s},cell:{row:o,column:i}}}getActiveRangeListData(){const e=this.getCurrentModels();if(e&&e.length>0){return null==e?void 0:e.map((e=>({startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn})))}}getActiveRangeList(){var e;const t=this.getActiveRangeListData();return t&&(null==(e=this._worksheet)?void 0:e.getRangeList(t))}getActiveRangeData(){const e=this.getCurrentModels();if(e&&e.length>0)for(const t of e)if(t.currentCell)return{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}getActiveRange(){var e;const t=this.getActiveRangeData();return t&&(null==(e=this._worksheet)?void 0:e.getRange(t))}getCurrentCellData(){const e=this.getCurrentModels();if(e&&e.length>0)for(const t of e){const e=t.currentCell;if(e)return{startRow:e.row,startColumn:e.column,endRow:e.row,endColumn:e.column}}}getCurrentCell(){var e;const t=this.getCurrentCellData();return t&&(null==(e=this._worksheet)?void 0:e.getRange(t))}getDragLineControl(){return this._dragLineControl}_initialize(){this._mainComponent=this._sheetView.getSpreadsheet(),this._rowComponent=this._sheetView.getSpreadsheetRowTitle(),this._columnComponent=this._sheetView.getSpreadsheetColumnTitle(),this._leftTopComponent=this._sheetView.getSpreadsheetLeftTopPlaceholder(),this._mainEventInitial(),this._rowEventInitial(),this._columnEventInitial(),this._leftTopEventInitial(),this._worksheet=this.getContext().getWorkBook().getActiveSheet(),this._initModels(),this._dragLineControl=new hd(this),this._columnTitleControl=new ud(this),this._rowTitleControl=new dd(this)}_mainEventInitial(){const e=this._mainComponent;e.onPointerDownObserver.add((t=>{var n;const{offsetX:r,offsetY:s}=t;this._startOffsetX=r,this._startOffsetY=s;const o=e.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),i=e.calculateCellIndexByPosition(r,s,o),l=Mn(i);if(!l||!this._worksheet)return!1;const{startRow:a,startColumn:c,endColumn:h,endRow:u,startY:d,endY:g,startX:f,endX:m}=l,p={startColumn:c,startRow:a,endColumn:h,endRow:u,startY:d,endY:g,startX:f,endX:m};this._startSelectionRange=p;let b=this.getCurrentControl(),_=this.getCurrentControls();if(!_)return!1;for(let e of _){if(2===t.button&&e.model.isInclude(p))return void(b=e);if(e.model.isEqual(p)){b=e;break}t.shiftKey||e.clearHighlight()}if(_.length>0&&!t.ctrlKey&&!t.shiftKey){for(let e of _)e.dispose();_.length=0}const v=b&&b.model.currentCell;if(b&&t.shiftKey&&v){const{row:t,column:n}=v,r=e.getNoMergeCellPositionByIndex(t,n),s=e.getNoMergeCellPositionByIndex(u,h),o={startColumn:n,startRow:t,endColumn:p.startColumn,endRow:p.startRow,startY:(null==r?void 0:r.startY)||0,endY:(null==s?void 0:s.endY)||0,startX:(null==r?void 0:r.startX)||0,endX:(null==s?void 0:s.endX)||0};b.update(o,v)}else b=qu.create(this,_.length),b.update(p,i),_.push(b);this.hasSelection=!0;const C=this.getScene();C.disableEvent();const T=La.create(this.getScene());T.startScroll(r,s),null==(n=this._plugin.getObserver("onChangeSelectionObserver"))||n.notifyObservers(b),this._moveObserver=C.onPointerMoveObserver.add((e=>{this.moving(e,b);const{offsetX:t,offsetY:n}=e;T.scrolling(t,n,(()=>{this.moving(e,b)}))})),this._upObserver=C.onPointerUpObserver.add((e=>{this.up(e,b),C.onPointerMoveObserver.remove(this._moveObserver),C.onPointerUpObserver.remove(this._upObserver),C.enableEvent(),T.stopScroll()}))}))}_rowEventInitial(){this._rowComponent.onPointerEnterObserver.add((e=>{}))}_columnEventInitial(){this._columnComponent.onPointerEnterObserver.add((e=>{}))}_leftTopEventInitial(){this._leftTopComponent.onPointerDownObserver.add((e=>{}))}_initModels(){const e=this._plugin.getConfig().selections;Object.keys(e).forEach((t=>{const n=e[t],r=[];n.forEach((e=>{const{startColumn:t,startRow:n,endColumn:s,endRow:o}=e.selection,i=e.cell,l=new Ju($u.NORMAL,this._plugin),a=i?{row:i.row,column:i.column,isMerged:!1,isMergedMainCell:!1,startY:0,endY:0,startX:0,endX:0,mergeInfo:{startColumn:t,startRow:n,endColumn:s,endRow:o,startY:0,endY:0,startX:0,endX:0}}:null;l.setValue({startColumn:t,startRow:n,endColumn:s,endRow:o,startY:0,endY:0,startX:0,endX:0},a),r.push(l)})),this._selectionModels.set(t,r)}))}_initControls(){const e=this._plugin.getConfig().selections;Object.keys(e).forEach((t=>{const n=e[t],r=[];n.forEach((e=>{const t=e.selection,n=e.cell,s=this._mainComponent,o=qu.create(this,r.length);let i=null;n&&(i=s.getCellByIndex(n.row,n.column));const{startRow:l,startColumn:a,endRow:c,endColumn:h}=t,u=s.getNoMergeCellPositionByIndex(l,a),d=s.getNoMergeCellPositionByIndex(c,h);o.model.setValue({startColumn:a,startRow:l,endColumn:h,endRow:c,startY:(null==u?void 0:u.startY)||0,endY:(null==d?void 0:d.endY)||0,startX:(null==u?void 0:u.startX)||0,endX:(null==d?void 0:d.endX)||0},i),r.push(o)}))}))}_initializeObserver(){var e;this._plugin.getContext().getContextObserver("onAfterChangeActiveSheetObservable").add((()=>{this.renderCurrentControls()})),null==(e=this._worksheet)||e.getContext().getContextObserver("onSheetRenderDidMountObservable").add((()=>{this.renderCurrentControls()}))}}(id=od||(od={})).MAIN="__SpreadsheetRender__",id.ROW="__SpreadsheetRowTitle__",id.COLUMN="__SpreadsheetColumnTitle__",id.LEFT_TOP="__SpreadsheetLeftTopPlaceholder__";class fd extends Du{constructor(){super(...arguments),this.viewKey=Ou.SHEET_VIEW}getSelectionManager(){return this._selectionManager}getSelectionControls(){return this._selectionManager.getCurrentControls()}getSpreadsheetSkeleton(){return this._spreadsheetSkeleton}getSpreadsheet(){return this._spreadsheet}getSpreadsheetRowTitle(){return this._spreadsheetRowTitle}getSpreadsheetColumnTitle(){return this._spreadsheetColumnTitle}getSpreadsheetLeftTopPlaceholder(){return this._spreadsheetLeftTopPlaceholder}updateToSheet(e){const t=this.getScene(),n=this._buildSkeleton(e),{rowTotalHeight:r,columnTotalWidth:s,rowTitleWidth:o,columnTitleHeight:i}=n;this._spreadsheetSkeleton=n,this._spreadsheet.updateSkeleton(n),this._spreadsheetRowTitle.updateSkeleton(n),this._spreadsheetColumnTitle.updateSkeleton(n),this._spreadsheetLeftTopPlaceholder.transformByState({width:o,height:i}),t.transformByState({width:this._columnWidthByTitle(e)+s,height:this._rowHeightByTitle(e)+r}),this._updateViewport(o,i),this._selectionManager.updateToSheet(e)}_initialize(){const e=this.getScene(),t=this.getContext().getWorkBook();let n=t.getActiveSheet();n||(n=t.getSheets()[0]);const r=this._buildSkeleton(n),{rowTotalHeight:s,columnTotalWidth:o,rowTitleWidth:i,columnTitleHeight:l}=r,a=new Cu(od.MAIN,r),c=new Tu(od.ROW,r),h=new wu(od.COLUMN,r),u=new Ha(od.LEFT_TOP,{zIndex:2,left:-1,top:-1,width:i,height:l,fill:Al([248,249,250]),stroke:Al([217,217,217]),strokeWidth:1});this._spreadsheetSkeleton=r,this._spreadsheet=a,this._spreadsheetRowTitle=c,this._spreadsheetColumnTitle=h,this._spreadsheetLeftTopPlaceholder=u,e.addObjects([a],0),e.addObjects([c,h,u],2),e.transformByState({width:this._columnWidthByTitle(n)+o,height:this._rowHeightByTitle(n)+s}),this._updateViewport(i,l),this._selectionManager=new gd(this)}_updateViewport(e,t){const n=this.getScene(),r=e*n.scaleX,s=t*n.scaleY,o=n.getViewport(Ou.VIEW_MAIN),i=n.getViewport(Ou.VIEW_TOP),l=n.getViewport(Ou.VIEW_LEFT),a=n.getViewport(Ou.VIEW_LEFT_TOP);null==o||o.resize({left:r,top:s}),null==i||i.resize({left:r,height:s}),null==l||l.resize({top:s,width:r}),null==a||a.resize({width:r,height:s})}_buildSkeleton(e){const t=this.getContext(),n=t.getWorkBook(),r=e.getConfig();return yu.create(r,e.getCellMatrix(),n.getStyles(),t)}_rowHeightByTitle(e){const t=null==e?void 0:e.getConfig();return(null==t?void 0:t.columnTitle.height)||0}_columnWidthByTitle(e){const t=null==e?void 0:e.getConfig();return(null==t?void 0:t.rowTitle.width)||0}}Pu.add(new class{create(e,t){return(new fd).initialize(e,t)}}),function(e){e.MAIN="__SpreadsheetRender__Test",e.ROW="__SpreadsheetRowTitle__Test",e.COLUMN="__SpreadsheetColumnTitle__Test",e.LEFT_TOP="__SpreadsheetLeftTopPlaceholder__Test"}(ld||(ld={})),function(e){e.MAIN_SCENE="mainScene_Test",e.VIEW_MAIN="viewMain_Test",e.VIEW_TOP="viewTop_Test",e.VIEW_LEFT="viewLeft_Test",e.VIEW_LEFT_TOP="viewLeftTop_Test",e.SHEET_VIEW="sheetView_Test",e.DRAG_LINE_VIEW="dragLineView_Test"}(ad||(ad={})),re.COLUMN,oe.PARAGRAPH,U.WRAP_SQUARE,vt.FALSE,F.BOTH_SIDES,E.START,E.START,E.START,E.START,y.ROMAN,E.START,y.ROMAN,E.START,y.ROMAN,I.PARAGRAPH,B.TEXT_RUN,B.TEXT_RUN,bt.SUPERSCRIPT,B.TEXT_RUN,B.TEXT_RUN,B.DRAWING,B.TEXT_RUN,B.TEXT_RUN,I.PARAGRAPH,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,I.PARAGRAPH,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,I.PARAGRAPH,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,I.PARAGRAPH,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN,B.TEXT_RUN;class md{constructor(e,t){this._engine=e,this._plugin=t,this._views=[],this._initialize()}getView(e){for(let t of this._views)if(t.viewKey===e)return t}getSheetView(){return this.getView(Ou.SHEET_VIEW)}updateToSheet(e){for(let t of this._views)t.updateToSheet(e)}_initialize(){const e=this._engine,t=this._plugin.getContext(),n=this._plugin.getWorkbook();let r=n.getActiveSheet();r||(r=n.getSheets()[0]);const s=r.getConfig(),o=s.rowTitle,i=s.columnTitle,l=new Qh(Ou.MAIN_SCENE,e,{width:1500,height:1e3});l.openTransformer(),this._scene=l;const a=new Zh(Ou.VIEW_MAIN,l,{left:o.width,top:i.height,bottom:0,right:0,isWheelPreventDefaultX:!0}),c=new Zh(Ou.VIEW_TOP,l,{left:o.width,top:0,height:i.height,right:0,isWheelPreventDefaultX:!0}),h=new Zh(Ou.VIEW_LEFT,l,{left:0,top:i.height,bottom:0,width:o.width,isWheelPreventDefaultX:!0}),u=new Zh(Ou.VIEW_LEFT_TOP,l,{left:0,top:0,width:o.width,height:i.height,isWheelPreventDefaultX:!0});a.onScrollAfterObserver.add((e=>{const{scrollX:t,scrollY:n,actualScrollX:r,actualScrollY:s}=e;c.updateScroll({scrollX:t,actualScrollX:r}).makeDirty(!0),h.updateScroll({scrollY:n,actualScrollY:s}).makeDirty(!0)})),t.getContextObserver("onZoomRatioSheetObservable").add((e=>{this._plugin,this._scene.scale(e.zoomRatio,e.zoomRatio)})),l.addViewport(a,h,c,u).attachControl(),l.on(Pi.wheel,((e,n)=>{const r=e;if(r.ctrlKey){const e=Math.abs(r.deltaX);let n=e<40?.2:e<80?.4:.2;if(n*=r.deltaY>0?-1:1,l.scaleX<1&&(n/=2),l.scaleX+n>4)l.scale(4,4);else if(l.scaleX+n<.1)l.scale(.1,.1);else{const e=t.getWorkBook().getActiveSheet(),n=r.deltaY>0?.1:-.1;e.setZoomRatio(e.getZoomRatio()+n),r.preventDefault()}}else a.onMouseWheel(r,n)})),new Wa(a),l.addLayer(Oa.create(l,[],0),Oa.create(l,[],2)),this._viewLoader(l,this._plugin),e.runRenderLoop((()=>{l.render();const t=document.getElementById("app");t&&(t.innerText=`fps:${Math.round(e.getFps()).toString()}`)}))}_viewLoader(e,t){Pu.getData().forEach((n=>{this._views.push(n.create(e,t))}))}}(cd||(cd={})).AntLine="__AntLineShape__";class pd{constructor(e){this._plugin=e}setCurrentEditRangeData(){const e=this._plugin.getSelectionManager().getCurrentCellModel();if(!e)return;let t,n;if(e.isMerged){const r=e.mergeInfo;t=r.startRow,n=r.startColumn}else t=e.row,n=e.column;this.currentEditRangeData={startRow:t,startColumn:n,endRow:t,endColumn:n}}getCurrentEditRangeData(){return this.currentEditRangeData}setCurrentEditRangeValue(e){const{startRow:t,startColumn:n,endRow:r,endColumn:s}=this.currentEditRangeData;this._plugin.getContext().getWorkBook().getActiveSheet().getRange(t,n,r,s).setRangeData(e)}getSelectionValue(){const e=this._plugin.getSelectionManager().getActiveRange();if(!e)return"";const t=e&&e.getDisplayValue();return"string"==typeof t?t:"object"==typeof t&&null!==t?Ln(t):""}getSelectionStyle(){var e;return null==(e=this._plugin.getSelectionManager().getActiveRange())?void 0:e.getTextStyle()}setSelectionValue(e){const t=this._plugin.getSelectionManager().getActiveRange();t&&("string"==typeof e&&t.setValue(e),"object"==typeof e&&t.setRangeData({p:e}))}handleBackSpace(){}handleDirection(e){}}class bd{constructor(e){this._plugin=e}getPlugin(){return this._plugin}listenEventManager(){this._getCoreObserver("onUIChangeObservable").add((({name:e,value:t})=>{switch(e){case"changeZoom":{const e=this._plugin.getContext().getWorkBook();e&&e.getActiveSheet().setZoomRatio(t);break}}}))}_getCoreObserver(e){return this._plugin.getGlobalContext().getObserverManager().requiredObserver(e,"core")}}class _d{constructor(e){this.insertRow=()=>{const e=this._getSelections();if(1===(null==e?void 0:e.length)){const t=this._plugin.getContext().getWorkBook().getActiveSheet();null==t||t.insertRowBefore(e[0].startRow,e[0].endRow-e[0].startRow+1)}},this.deleteRow=()=>{const e=this._getSelections();if(1===(null==e?void 0:e.length)){const t=this._plugin.getContext().getWorkBook().getActiveSheet();null==t||t.deleteRows(e[0].startRow,e[0].endRow-e[0].startRow+1)}},this.insertColumn=()=>{const e=this._getSelections();if(1===(null==e?void 0:e.length)){this._plugin.getContext().getWorkBook().getActiveSheet().insertColumnBefore(e[0].startColumn,e[0].endColumn-e[0].startColumn+1)}},this.deleteColumn=()=>{const e=this._getSelections();if(1===(null==e?void 0:e.length)){this._plugin.getContext().getWorkBook().getActiveSheet().deleteColumns(e[0].startColumn,e[0].endColumn-e[0].startColumn+1)}},this.clearContent=()=>{const e=this._getSelections();if(1===(null==e?void 0:e.length)){this._plugin.getContext().getWorkBook().getActiveSheet().getRange(e[0]).clear()}},this.deleteCellLeft=()=>{const e=this._getSelections();if(1===(null==e?void 0:e.length)){this._plugin.getContext().getWorkBook().getActiveSheet().getRange(e[0]).deleteCells(0)}},this.deleteCellTop=()=>{const e=this._getSelections();if(1===(null==e?void 0:e.length)){this._plugin.getContext().getWorkBook().getActiveSheet().getRange(e[0]).deleteCells(1)}},this._plugin=e}listenEventManager(){this._plugin.getContext().getUniver().getGlobalContext().getObserverManager().requiredObserver("onUIChangeObservable","core").add((e=>{switch(e.name){case"insertRow":this.insertRow();break;case"insertColumn":this.insertColumn();break;case"deleteRow":this.deleteRow();break;case"deleteColumn":this.deleteColumn();break;case"moveTop":this.deleteCellTop();break;case"moveLeft":this.deleteCellLeft();break;case"clearContent":this.clearContent();break;case"setRowHeight":this.setRowHeight(e.value);break;case"setColumnWidth":this.setColumnWidth(e.value)}}))}setColumnWidth(e){const t=this._getSelections();if(1===(null==t?void 0:t.length)){this._plugin.getContext().getWorkBook().getActiveSheet().setColumnWidth(t[0].startColumn,t[0].endColumn-t[0].startColumn+1,Number(e))}}setRowHeight(e){const t=this._getSelections();if(1===(null==t?void 0:t.length)){this._plugin.getContext().getWorkBook().getActiveSheet().setRowHeights(t[0].startRow,t[0].endRow-t[0].startRow+1,Number(e))}}_getSelections(){var e;const t=null==(e=this._plugin)?void 0:e.getSelectionManager().getCurrentControls();return null==t?void 0:t.map((e=>{const t=e.model;return{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}))}}class vd{constructor(e){this._plugin=e}listenEventManager(){this._getCoreObserver("onUIChangeObservable").add((({name:e,value:t})=>{switch(e){case"deleteSheet":{const e=this._plugin.getContext().getWorkBook();e&&e.removeSheetBySheetId(t);break}case"copySheet":{const e=this._plugin.getContext().getWorkBook(),t=e.getActiveSheet(),n=this._plugin.getContext().getGenName(),r=this._plugin.getGlobalContext().getLocale(),s=t.copy(n.onlyName(`${t.getName()} ${r.get("BaseSheetLocale.CopyName")}`));e&&e.insertSheet(e.getActiveSheetIndex()+1,s.getConfig());break}case"renameSheet":{const{sheetId:e,sheetName:n}=t,r=this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getSheetBySheetId(e);r&&n!==r.getName()&&r.setName(n);break}case"addSheet":{const e=this._plugin.getContext().getWorkBook();e.insertSheet();const t=e.getSheetSize(),n=e.getSheets()[t-1];n&&n.activate();break}case"unHideSheet":{const e=this._plugin.getContext().getWorkBook().getSheetBySheetId(t);e&&e.showSheet();break}case"hideSheet":{const e=this._plugin.getContext().getWorkBook().getSheetBySheetId(t);e&&e.hideSheet();break}case"changeSheetColor":{const{color:e,sheetId:n}=t,r=this._plugin.getContext().getWorkBook().getSheetBySheetId(n);r&&r.setTabColor(e);break}}}))}_getCoreObserver(e){return this._plugin.getGlobalContext().getObserverManager().requiredObserver(e,"core")}}class Cd{constructor(e){this._plugin=e,this._initialize()}_initialize(){zr.getCommandObservers().add((({actions:e})=>{const t=this._plugin;if(!t)return;if(!e||0===e.length)return;const n=e[0];if(t.context.getWorkBook().getUnitId()!==n.getWorkBook().getUnitId())return;const r=n.getWorkBook().getActiveSheet();if(r)try{const e=t.getCanvasView();e&&(e.updateToSheet(r),t.getMainComponent().makeDirty(!0),t.getSelectionManager().renderCurrentControls(!1))}catch(s){console.info(s)}}))}}class Td{constructor(e){this._plugin=e,this._initialize()}listenEventManager(){this._plugin.getContext().getUniver().getGlobalContext().getObserverManager().requiredObserver("onUIChangeObservable","core").add((e=>{switch(e.name){case"undo":this.setUndo();break;case"redo":this.setRedo()}})),this._plugin.getContext().getUniver().getGlobalContext().getObserverManager().requiredObserver("onUIChangeObservable","core").add((e=>{switch(e.name){case"fontSize":this.setFontSize(e.value);break;case"textRotation":this.setTextRotation(e.value);break;case"wrapStrategy":this.setWrapStrategy(e.value);break;case"verticalAlignment":this.setVerticalAlignment(e.value);break;case"horizontalAlignment":this.setHorizontalAlignment(e.value)}})),this._plugin.getContext().getUniver().getGlobalContext().getObserverManager().requiredObserver("onUIChangeObservable","core").add((e=>{switch(e.name){case"borderInfo":this.setBorder(e.value)}})),this._plugin.getContext().getUniver().getGlobalContext().getObserverManager().requiredObserver("onUIChangeObservable","core").add((e=>{switch(e.name){case"fontFamily":this.setFontFamily(e.value);break;case"fontColor":this.setFontColor(e.value);break;case"background":this.setBackground(e.value);break;case"merge":this.setMerge(e.value)}})),this._plugin.getContext().getUniver().getGlobalContext().getObserverManager().requiredObserver("onUIChangeObservable","core").add((e=>{switch(e.name){case"fontWeight":this.setFontWeight(e.value);break;case"fontStyle":this.setFontStyle(e.value);break;case"strikeThrough":this.setStrikeThrough(e.value);break;case"underLine":this.setUnderline(e.value)}}))}_initialize(){}setRedo(){this._plugin.getContext().getCommandManager().redo()}setUndo(){this._plugin.getContext().getCommandManager().undo()}setFontColor(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setFontColor(e)}setBackground(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setBackground(e)}setFontSize(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setFontSize(e)}setFontFamily(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setFontFamily(e)}setFontWeight(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setFontWeight(e)}setFontStyle(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setFontStyle(e)}setStrikeThrough(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setStrikeThrough(e)}setUnderline(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setUnderline(e)}setMerge(e){const t=this._plugin.getSelectionManager().getActiveRange();switch(e){case"all":null==t||t.merge();break;case"vertical":null==t||t.mergeVertically();break;case"horizontal":null==t||t.mergeAcross();break;case"cancel":null==t||t.breakApart()}}setHorizontalAlignment(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setHorizontalAlignment(e)}setVerticalAlignment(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setVerticalAlignment(e)}setWrapStrategy(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setWrapStrategy(e)}setTextRotation(e){var t,n;"v"===e?null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setVerticalText(1):null==(n=this._plugin.getSelectionManager().getActiveRangeList())||n.setTextRotation(e)}setBorder(e){const t=this._plugin.getSelectionManager().getCurrentControls();t&&t.length>0&&(null==t||t.forEach((t=>{const n=t.model,r={startRow:n.startRow,startColumn:n.startColumn,endRow:n.endRow,endColumn:n.endColumn};this._plugin.getContext().getWorkBook().getActiveSheet().getRange(r).setBorderByType(e.type,e.color,e.style)})))}}class wd{constructor(e){this._plugin=e}}class yd extends Yr{execute(){this.actionDataList.forEach((e=>{if(null!=e.operation&&!Kr.hasExtension(e))return!1;if(e.actionName===be.INSERT_ROW_ACTION){const{sheetId:t,rowCount:n,rowIndex:r}=e,s=C.deepClone(this._plugin.getWorkbook().getConfig().namedRanges);for(let e=0;e<s.length;e++){const o=s[e].range.rangeData;if(r>o.endRow)continue;r>=o.startRow&&r<=o.endRow||(o.startRow+=n),o.endRow+=n;const i={actionName:be.SET_NAMED_RANGE_ACTION,namedRange:s[e],sheetId:t};this.push(i)}}}))}}class Sd extends Gr{get zIndex(){return 3}create(e){return new yd(e,this._plugin)}}var Ed={BaseSheetLocale:{CopyName:""}},Rd={BaseSheetLocale:{CopyName:"Copy"}};class Id extends Fo{constructor(e){super(Ut.SPREADSHEET),this._config=Object.assign(Bu,e)}static create(e){return new Id(e)}installTo(e){e.installPlugin(this)}initialize(e){this.context=e,this.getGlobalContext().getLocale().load({en:Rd,zh:Ed}),Lu(this),this.initConfig(),this.initController(),this.initCanvasView(),this.registerExtension()}getConfig(){return this._config}initConfig(){const e=this._config;if(!e.selections){const t=this.getContext().getWorkBook().getActiveSheet().getSheetId();e.selections={[t]:[{selection:Mt}]}}}initController(){this._sheetContainerController=new Cd(this),this._cellEditorController=new pd(this),this._formulaBarController=new wd(this),this._sheetBarControl=new vd(this),this._toolbarControl=new Td(this),this._rightMenuControl=new _d(this),this._countBarController=new bd(this)}initCanvasView(){const e=this.getGlobalContext().getPluginManager().getRequirePluginByName(Ut.BASE_RENDER).getEngine();this._canvasEngine=e,null==this._canvasView&&(this._canvasView=new md(e,this))}onMounted(e){this.initialize(e)}onDestroy(){super.onDestroy(),ku(this);this.context.getCommandManager().getActionExtensionManager().getRegister().delete(this._namedRangeActionExtensionFactory)}registerExtension(){const e=this.context.getCommandManager().getActionExtensionManager().getRegister();this._namedRangeActionExtensionFactory=new Sd(this),e.add(this._namedRangeActionExtensionFactory)}listenEventManager(){this._countBarController.listenEventManager(),this._sheetBarControl.listenEventManager(),this._toolbarControl.listenEventManager(),this._rightMenuControl.listenEventManager()}getCanvasEngine(){return this._canvasEngine}getCanvasView(){return this._canvasView}getMainScene(){return this._canvasEngine.getScene(Ou.MAIN_SCENE)}getSheetView(){return this.getCanvasView().getSheetView()}getSelectionManager(){var e;return null==(e=this.getSheetView())?void 0:e.getSelectionManager()}getCurrentControls(){var e;return null==(e=this.getSelectionManager())?void 0:e.getCurrentControls()}getSelectionShape(){return this._canvasEngine}getMainComponent(){return this.getSheetView().getSpreadsheet()}getLeftTopComponent(){return this.getSheetView().getSpreadsheetLeftTopPlaceholder()}getRowComponent(){return this.getSheetView().getSpreadsheetRowTitle()}getColumnComponent(){return this.getSheetView().getSpreadsheetColumnTitle()}getSpreadsheetSkeleton(){return this.getSheetView().getSpreadsheetSkeleton()}getWorkbook(){return this.context.getWorkBook()}getRightMenuControl(){return this._rightMenuControl}getToolbarControl(){return this._toolbarControl}getSheetBarControl(){return this._sheetBarControl}getCellEditorController(){return this._cellEditorController}getFormulaBarController(){return this._formulaBarController}getSheetContainerControl(){return this._sheetContainerController}getCountBarController(){return this._countBarController}}var Ad=Object.freeze(Object.defineProperty({__proto__:null,SheetPlugin:Id,AntLine:Vu,AntLineModel:ju,SelectionModel:Ju,AntLineControl:class{constructor(e){this._plugin=e,this._antLineModelList=[],e.getContext().getContextObserver("onAfterChangeActiveSheetObservable").add((()=>{this._activeSheetId=e.getWorkbook().getActiveSheet().getSheetId(),this._makeUpdateSceneAntLineRect()})),e.getContext().getContextObserver("onSheetRenderDidMountObservable").add((()=>{this._activeSheetId=e.getWorkbook().getActiveSheet().getSheetId(),this._makeUpdateSceneAntLineRect()}))}removeSheetAntLine(e=this._activeSheetId){this._removeAntLineModelBySheetId(e),this._makeUpdateSceneAntLineRect()}addAntLineToSheet(e,t=this._activeSheetId){const n=this._findAntLineModelBySheetId(t,new ju(t));n.addAntLine(new Vu(e)),this._saveOrUpdateAntLineModel(n),this._makeUpdateSceneAntLineRect()}getSheetView(){return this._plugin.getCanvasView().getSheetView()}getWorkBook(){return this._plugin.getWorkbook()}getSheetViewScene(){return this._plugin.getCanvasView().getSheetView().getScene()}_removeAntLineModelBySheetId(e){const t=this._antLineModelList.findIndex((t=>t.getSheetId()!==e));t>-1&&this._antLineModelList.splice(t,1)}_findAntLineModelBySheetId(e,t){var n;return null!=(n=this._antLineModelList.find((t=>t.getSheetId()===e)))?n:t}_saveOrUpdateAntLineModel(e){for(let t=0;t<this._antLineModelList.length;t++){if(this._antLineModelList[t].getSheetId()===e.getSheetId())return void(this._antLineModelList[t]=e)}this._antLineModelList.push(e)}_createAntLineRectBySheetIdAndRange(e,t){let n=this.getWorkBook().getSheetBySheetId(e);if(null==n)throw new Error(`not found sheet from id: ${e}`);let r=n.getConfig().rowTitle.width,s=n.getConfig().columnTitle.height,o=n.getRowManager(),i=n.getColumnManager(),l=0,a=0;for(let u=t.startRow;u<t.endRow;u++)l+=o.getRowHeight(u);for(let u=t.startColumn;u<t.endColumn;u++)a+=i.getColumnWidth(u);let c=0,h=0;for(let u=0;u<=t.startRow-1;u++)h+=o.getRowHeight(u);for(let u=0;u<=t.startColumn-1;u++)c+=i.getColumnWidth(u);return new Ha(cd.AntLine,{stroke:"red",strokeWidth:2,left:c+r,top:h+s,height:l,width:a,strokeDashArray:[5],evented:!1})}_deleteSceneAllAntLineRect(){for(let e=0;e<this._antLineModelList.length;e++){let t=this._antLineModelList[e].getAntLineList();for(let e=0;e<t.length;e++){let n=t[e].getRect();n&&this.getSheetViewScene().removeObject(n)}}}_makeUpdateSceneAntLineRect(){this._deleteSceneAllAntLineRect();for(let e=0;e<this._antLineModelList.length;e++){let t=this._antLineModelList[e],n=t.getAntLineList();if(t.getSheetId()===this._activeSheetId)for(let e=0;e<n.length;e++){let r=n[e],s=this._createAntLineRectBySheetIdAndRange(t.getSheetId(),r.getRange());r.setRect(s),console.log(s),this.getSheetViewScene().addObject(s)}}}},CellEditorController:pd,CountBarController:bd,RightMenuController:_d,SelectionControlDragAndDrop:Yu,SelectionControlFill:Gu,DEFAULT_SELECTION_CONFIG:Xu,get SELECTION_TYPE(){return $u},SelectionControl:qu,SelectionManager:gd,SheetBarControl:vd,SheetContainerController:Cd,SpreadsheetAction:class{},ToolbarController:Td,DEFAULT_SPREADSHEET_PLUGIN_DATA:Bu,get ACTION_NAMES(){return Hu},uninstall:ku,install:Lu,BaseView:Du,get CANVAS_VIEW_KEY(){return Ou},CanvasViewRegistry:Pu,CanvasView:md},Symbol.toStringTag,{value:"Module"}));const xd="SheetUI",Od={InsertRow:!0,InsertColumn:!0,AddRowTop:!1,AddRowBottom:!1,AddColumnLeft:!1,AddColumnRight:!1,DeleteRow:!0,DeleteColumn:!0,HideRow:!1,ShowRow:!1,RowHeight:!1,HideColumn:!1,ShowColumn:!1,ColumnWidth:!1,DeleteCell:!0,ClearContent:!0,Matrix:!1},Md={undo:!0,redo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0,mergeCell:!0},Nd={outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0,formulaBar:!0,rightMenu:!0,countBar:!0,sheetBar:!0},kd={layout:{sheetContainerConfig:Nd,rightMenuConfig:Od,toolbarConfig:Md}};var Ld={spreadsheetLabel:"",spreadsheetRightLabel:" Sheets",spreadsheet:{one:"",two:"",three:""},toolbar:{undo:"",redo:"",paintFormat:"",currencyFormat:"",percentageFormat:"",numberDecrease:"",numberIncrease:"",moreFormats:"",font:"",fontSize:"",bold:" (Ctrl+B)",italic:" (Ctrl+I)",strikethrough:" (Alt+Shift+5)",underline:"",textColor:{main:"",right:""},resetColor:"",customColor:"",alternatingColors:"",confirmColor:"",cancelColor:"",collapse:"",fillColor:{main:"",right:""},border:{main:"",right:""},mergeCell:{main:"",right:""},horizontalAlignMode:{main:"",right:""},verticalAlignMode:{main:"",right:""},textWrapMode:{main:"",right:""},textRotateMode:{main:"",right:""},freezeTopRow:"",sortAndFilter:"",findAndReplace:"",sum:"",autoSum:"",moreFunction:"",conditionalalFormat:"",comment:"",pivotTable:"",chart:"",screenshot:"",splitColumn:"",insertImage:"",insertLink:"",dataValidation:"",protection:"",clearText:"",noColorSelectedText:"",toolMore:"",toolLess:"",toolClose:"",toolMoreTip:"",moreOptions:"",cellFormat:"",print:"",borderMethod:{top:"",bottom:"",left:"",right:""},more:""},defaultFmt:{Automatic:{text:"",value:"General",example:""},Number:{text:"",value:"##0.00",example:"1000.12"},Percent:{text:"",value:"#0.00%",example:"12.21%"},PlainText:{text:"",value:"@",example:""},Scientific:{text:"",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"",value:"(0.00)",example:"(1200.09)"},Thousand:{text:"",value:"w",example:"120002500"},Currency:{text:"",value:"0.00",example:"1200.09"},Digit:{text:"2",value:"w0.00",example:"22500.55"},Date:{text:"",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"24H",value:"hh:mm",example:"15:00"},DateTime:{text:"",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"",moreDateTime:"",moreNumber:"",titleCurrency:"",decimalPlaces:"",titleDateTime:"",titleNumber:""},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"",SimSun:"",SimHei:"",Kaiti:"",FangSong:"",NSimSun:"",STXinwei:"",STXingkai:"",STLiti:"",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"",layoutBtn:"",pageBtn:"",menuItemPrint:"(Ctrl+P)",menuItemAreas:"",menuItemRows:"",menuItemColumns:""},align:{left:"",center:"",right:"",top:"",middle:"",bottom:""},button:{confirm:"",cancel:"",close:"",update:"Update",delete:"Delete",insert:"",prevPage:"",nextPage:"",total:""},punctuation:{tab:"Tab ",semicolon:"",comma:"",space:""},colorPicker:{collapse:"",customColor:"",change:"",confirmColor:"",cancelColor:""},borderLine:{borderTop:"",borderBottom:"",borderLeft:"",borderRight:"",borderNone:"",borderAll:"",borderOutside:"",borderInside:"",borderHorizontal:"",borderVertical:"",borderColor:"",borderSize:""},merge:{all:"",vertical:"",horizontal:"",cancel:"",overlappingError:"",partiallyError:""},textWrap:{overflow:"",wrap:"",clip:""},textRotate:{none:"",angleUp:"",angleDown:"",vertical:"",rotationUp:"90",rotationDown:"90"},sheetConfig:{delete:"",copy:"",rename:"",changeColor:"",hide:"",unhide:"",moveLeft:"",moveRight:"",resetColor:"",cancelText:"",chooseText:"",tipNameRepeat:"",noMoreSheet:"",confirmDelete:"",redoDelete:"Ctrl+Z",noHide:", sheet",chartEditNoOpt:"",sheetNameSpecCharError:"31' :\r\n[ ] : \\ ? * /",sheetNameCannotIsEmptyError:"!"},rightClick:{copy:"",copyAs:"",cut:"",paste:"",insert:"",delete:"",insertRow:"",insertColumn:"",deleteCell:"",deleteSelected:"",hide:"",hideSelected:"",showHide:"",toTopAdd:"",toBottomAdd:"",toLeftAdd:"",toRightAdd:"",deleteSelectedRow:"",deleteSelectedColumn:"",hideSelectedRow:"",showHideRow:"",rowHeight:"",hideSelectedColumn:"",showHideColumn:"",columnWidth:"",to:"",left:"",right:"",top:"",bottom:"",moveLeft:"",moveUp:"",add:"",row:"",column:"",width:"",height:"",number:"",confirm:"",orderAZ:"A-Z",orderZA:"Z-A",clearContent:"",matrix:"",sortSelection:"",filterSelection:"",chartGeneration:"",firstLineTitle:"",untitled:"",array1:"",array2:"",array3:"",diagonal:"",antiDiagonal:"",diagonalOffset:"",offset:"",boolean:"",flip:"",upAndDown:"",leftAndRight:"",clockwise:"",counterclockwise:"",transpose:"",matrixCalculation:"",plus:"",minus:"",multiply:"",divided:"",power:"",root:"",log:"log",delete0:"0",removeDuplicate:"",byRow:"",byCol:"",generateNewMatrix:""},info:{tooltip:"",notChangeMerge:"",detailUpdate:"",detailSave:"",row:"",column:"",loading:"",copy:"",return:"",rename:"",tips:"",noName:"",wait:"",add:"",addLast:"",backTop:"",pageInfo:"${total}${totalPage}${currentPage}",nextPage:"",tipInputNumber:"",tipInputNumberLimit:"1-100",tipRowHeightLimit:"0 ~ 545",tipColumnWidthLimit:"0 ~ 2038",pageInfoFull:"${total}${totalPage}"}},Dd={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"(0.00)",example:"(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"120002500"},Currency:{text:"Currency",value:"0.00",example:"1200.09"},Digit:{text:"2",value:"w0.00",example:"22500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Pagebreakpreview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:"The name cannot contain:[ ] :  ? * / ' \"",sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",cut:"Cut",paste:"Paste",insert:"Insert",insertRow:"InsertRow",insertColumn:"InsertColumn",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",toTopAdd:"Towards Top Add",toBottomAdd:"Towards Bottom Add",toLeftAdd:"Towards Left Add",toRightAdd:"Towards Right Add",deleteSelectedRow:"Delete selected row",deleteSelectedColumn:"Delete selected column",hideSelectedRow:"Hide selected row",showHideRow:"Show selected row",rowHeight:"Row height",hideSelectedColumn:"Hide selected column",showHideColumn:"Show hide column",columnWidth:"Column width",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{tooltip:"Tooltip",notChangeMerge:"You cannot make partial changes to the merged cells",detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}${totalPage} pagecurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}${totalPage} pageAll data displayed"}};function Pd(e){e.pushToObserve("onRichTextKeyDownObservable"),e.pushToObserve("onRichTextKeyUpObservable"),e.pushToObserve("onUIDidMount")}var Bd,Hd,Fd,zd,Ud,Wd,Vd,jd,Yd={},Gd=[],Xd=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function $d(e,t){for(var n in t)e[n]=t[n];return e}function Qd(e){var t=e.parentNode;t&&t.removeChild(e)}function Kd(e,t,n){var r,s,o,i={};for(o in t)"key"==o?r=t[o]:"ref"==o?s=t[o]:i[o]=t[o];if(arguments.length>2&&(i.children=arguments.length>3?Bd.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(o in e.defaultProps)void 0===i[o]&&(i[o]=e.defaultProps[o]);return Zd(e,i,r,s,null)}function Zd(e,t,n,r,s){var o={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==s?++Fd:s};return null==s&&null!=Hd.vnode&&Hd.vnode(o),o}function qd(){return{current:null}}function Jd(e){return e.children}function eg(e,t){this.props=e,this.context=t}function tg(e,t){if(null==t)return e.__?tg(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?tg(e):null}function ng(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return ng(e)}}function rg(e){(!e.__d&&(e.__d=!0)&&zd.push(e)&&!sg.__r++||Ud!==Hd.debounceRendering)&&((Ud=Hd.debounceRendering)||Wd)(sg)}function sg(){var e,t,n,r,s,o,i,l;for(zd.sort(Vd);e=zd.shift();)e.__d&&(t=zd.length,r=void 0,s=void 0,i=(o=(n=e).__v).__e,(l=n.__P)&&(r=[],(s=$d({},o)).__v=o.__v+1,fg(l,o,s,n.__n,void 0!==l.ownerSVGElement,null!=o.__h?[i]:null,r,null==i?tg(o):i,o.__h),mg(r,o),o.__e!=i&&ng(o)),zd.length>t&&zd.sort(Vd));sg.__r=0}function og(e,t,n,r,s,o,i,l,a,c){var h,u,d,g,f,m,p,b=r&&r.__k||Gd,_=b.length;for(n.__k=[],h=0;h<t.length;h++)if(null!=(g=n.__k[h]=null==(g=t[h])||"boolean"==typeof g||"function"==typeof g?null:"string"==typeof g||"number"==typeof g||"bigint"==typeof g?Zd(null,g,null,null,g):Array.isArray(g)?Zd(Jd,{children:g},null,null,null):g.__b>0?Zd(g.type,g.props,g.key,g.ref?g.ref:null,g.__v):g)){if(g.__=n,g.__b=n.__b+1,null===(d=b[h])||d&&g.key==d.key&&g.type===d.type)b[h]=void 0;else for(u=0;u<_;u++){if((d=b[u])&&g.key==d.key&&g.type===d.type){b[u]=void 0;break}d=null}fg(e,g,d=d||Yd,s,o,i,l,a,c),f=g.__e,(u=g.ref)&&d.ref!=u&&(p||(p=[]),d.ref&&p.push(d.ref,null,g),p.push(u,g.__c||f,g)),null!=f?(null==m&&(m=f),"function"==typeof g.type&&g.__k===d.__k?g.__d=a=ig(g,a,e):a=ag(e,g,d,b,f,a),"function"==typeof n.type&&(n.__d=a)):a&&d.__e==a&&a.parentNode!=e&&(a=tg(d))}for(n.__e=m,h=_;h--;)null!=b[h]&&("function"==typeof n.type&&null!=b[h].__e&&b[h].__e==n.__d&&(n.__d=cg(r).nextSibling),bg(b[h],b[h]));if(p)for(h=0;h<p.length;h++)pg(p[h],p[++h],p[++h])}function ig(e,t,n){for(var r,s=e.__k,o=0;s&&o<s.length;o++)(r=s[o])&&(r.__=e,t="function"==typeof r.type?ig(r,t,n):ag(n,r,r,s,r.__e,t));return t}function lg(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some((function(e){lg(e,t)})):t.push(e)),t}function ag(e,t,n,r,s,o){var i,l,a;if(void 0!==t.__d)i=t.__d,t.__d=void 0;else if(null==n||s!=o||null==s.parentNode)e:if(null==o||o.parentNode!==e)e.appendChild(s),i=null;else{for(l=o,a=0;(l=l.nextSibling)&&a<r.length;a+=1)if(l==s)break e;e.insertBefore(s,o),i=o}return void 0!==i?i:s.nextSibling}function cg(e){var t,n,r;if(null==e.type||"string"==typeof e.type)return e.__e;if(e.__k)for(t=e.__k.length-1;t>=0;t--)if((n=e.__k[t])&&(r=cg(n)))return r;return null}function hg(e,t,n){"-"===t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||Xd.test(t)?n:n+"px"}function ug(e,t,n,r,s){var o;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||hg(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||hg(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])o=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?r||e.addEventListener(t,o?gg:dg,o):e.removeEventListener(t,o?gg:dg,o);else if("dangerouslySetInnerHTML"!==t){if(s)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==t&&"height"!==t&&"href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(i){}"function"==typeof n||(null==n||!1===n&&-1==t.indexOf("-")?e.removeAttribute(t):e.setAttribute(t,n))}}function dg(e){return this.l[e.type+!1](Hd.event?Hd.event(e):e)}function gg(e){return this.l[e.type+!0](Hd.event?Hd.event(e):e)}function fg(e,t,n,r,s,o,i,l,a){var c,h,u,d,g,f,m,p,b,_,v,C,T,w,y,S=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(a=n.__h,l=t.__e=n.__e,t.__h=null,o=[l]),(c=Hd.__b)&&c(t);try{e:if("function"==typeof S){if(p=t.props,b=(c=S.contextType)&&r[c.__c],_=c?b?b.props.value:c.__:r,n.__c?m=(h=t.__c=n.__c).__=h.__E:("prototype"in S&&S.prototype.render?t.__c=h=new S(p,_):(t.__c=h=new eg(p,_),h.constructor=S,h.render=_g),b&&b.sub(h),h.props=p,h.state||(h.state={}),h.context=_,h.__n=r,u=h.__d=!0,h.__h=[],h._sb=[]),null==h.__s&&(h.__s=h.state),null!=S.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=$d({},h.__s)),$d(h.__s,S.getDerivedStateFromProps(p,h.__s))),d=h.props,g=h.state,h.__v=t,u)null==S.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(null==S.getDerivedStateFromProps&&p!==d&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(p,_),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(p,h.__s,_)||t.__v===n.__v){for(t.__v!==n.__v&&(h.props=p,h.state=h.__s,h.__d=!1),h.__e=!1,t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),v=0;v<h._sb.length;v++)h.__h.push(h._sb[v]);h._sb=[],h.__h.length&&i.push(h);break e}null!=h.componentWillUpdate&&h.componentWillUpdate(p,h.__s,_),null!=h.componentDidUpdate&&h.__h.push((function(){h.componentDidUpdate(d,g,f)}))}if(h.context=_,h.props=p,h.__P=e,C=Hd.__r,T=0,"prototype"in S&&S.prototype.render){for(h.state=h.__s,h.__d=!1,C&&C(t),c=h.render(h.props,h.state,h.context),w=0;w<h._sb.length;w++)h.__h.push(h._sb[w]);h._sb=[]}else do{h.__d=!1,C&&C(t),c=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++T<25);h.state=h.__s,null!=h.getChildContext&&(r=$d($d({},r),h.getChildContext())),u||null==h.getSnapshotBeforeUpdate||(f=h.getSnapshotBeforeUpdate(d,g)),y=null!=c&&c.type===Jd&&null==c.key?c.props.children:c,og(e,Array.isArray(y)?y:[y],t,n,r,s,o,i,l,a),h.base=t.__e,t.__h=null,h.__h.length&&i.push(h),m&&(h.__E=h.__=null),h.__e=!1}else null==o&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=function(e,t,n,r,s,o,i,l){var a,c,h,u=n.props,d=t.props,g=t.type,f=0;if("svg"===g&&(s=!0),null!=o)for(;f<o.length;f++)if((a=o[f])&&"setAttribute"in a==!!g&&(g?a.localName===g:3===a.nodeType)){e=a,o[f]=null;break}if(null==e){if(null===g)return document.createTextNode(d);e=s?document.createElementNS("http://www.w3.org/2000/svg",g):document.createElement(g,d.is&&d),o=null,l=!1}if(null===g)u===d||l&&e.data===d||(e.data=d);else{if(o=o&&Bd.call(e.childNodes),c=(u=n.props||Yd).dangerouslySetInnerHTML,h=d.dangerouslySetInnerHTML,!l){if(null!=o)for(u={},f=0;f<e.attributes.length;f++)u[e.attributes[f].name]=e.attributes[f].value;(h||c)&&(h&&(c&&h.__html==c.__html||h.__html===e.innerHTML)||(e.innerHTML=h&&h.__html||""))}if(function(e,t,n,r,s){var o;for(o in n)"children"===o||"key"===o||o in t||ug(e,o,null,n[o],r);for(o in t)s&&"function"!=typeof t[o]||"children"===o||"key"===o||"value"===o||"checked"===o||n[o]===t[o]||ug(e,o,t[o],n[o],r)}(e,d,u,s,l),h)t.__k=[];else if(f=t.props.children,og(e,Array.isArray(f)?f:[f],t,n,r,s&&"foreignObject"!==g,o,i,o?o[0]:n.__k&&tg(n,0),l),null!=o)for(f=o.length;f--;)null!=o[f]&&Qd(o[f]);l||("value"in d&&void 0!==(f=d.value)&&(f!==e.value||"progress"===g&&!f||"option"===g&&f!==u.value)&&ug(e,"value",f,u.value,!1),"checked"in d&&void 0!==(f=d.checked)&&f!==e.checked&&ug(e,"checked",f,u.checked,!1))}return e}(n.__e,t,n,r,s,o,i,a);(c=Hd.diffed)&&c(t)}catch(E){t.__v=null,(a||null!=o)&&(t.__e=l,t.__h=!!a,o[o.indexOf(l)]=null),Hd.__e(E,t,n)}}function mg(e,t){Hd.__c&&Hd.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(n){Hd.__e(n,t.__v)}}))}function pg(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(r){Hd.__e(r,n)}}function bg(e,t,n){var r,s;if(Hd.unmount&&Hd.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||pg(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){Hd.__e(o,t)}r.base=r.__P=null,e.__c=void 0}if(r=e.__k)for(s=0;s<r.length;s++)r[s]&&bg(r[s],t,n||"function"!=typeof e.type);n||null==e.__e||Qd(e.__e),e.__=e.__e=e.__d=void 0}function _g(e,t,n){return this.constructor(e,n)}function vg(e,t,n){var r,s,o;Hd.__&&Hd.__(e,t),s=(r="function"==typeof n)?null:n&&n.__k||t.__k,o=[],fg(t,e=(!r&&n||t).__k=Kd(Jd,null,[e]),s||Yd,Yd,void 0!==t.ownerSVGElement,!r&&n?[n]:s?null:t.firstChild?Bd.call(t.childNodes):null,o,!r&&n?n:s?s.__e:t.firstChild,r),mg(o,e)}function Cg(e,t){vg(e,t,Cg)}function Tg(e,t,n){var r,s,o,i=$d({},e.props);for(o in t)"key"==o?r=t[o]:"ref"==o?s=t[o]:i[o]=t[o];return arguments.length>2&&(i.children=arguments.length>3?Bd.call(arguments,2):n),Zd(e.type,i,r||e.key,s||e.ref,null)}function wg(e,t){var n={__c:t="__cC"+jd++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,r;return this.getChildContext||(n=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some((function(e){e.__e=!0,rg(e)}))},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n}Bd=Gd.slice,Hd={__e:function(e,t,n,r){for(var s,o,i;t=t.__;)if((s=t.__c)&&!s.__)try{if((o=s.constructor)&&null!=o.getDerivedStateFromError&&(s.setState(o.getDerivedStateFromError(e)),i=s.__d),null!=s.componentDidCatch&&(s.componentDidCatch(e,r||{}),i=s.__d),i)return s.__E=s}catch(l){e=l}throw e}},Fd=0,eg.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=$d({},this.state),"function"==typeof e&&(e=e($d({},n),this.props)),e&&$d(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),rg(this))},eg.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),rg(this))},eg.prototype.render=Jd,zd=[],Wd="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Vd=function(e,t){return e.__v.__b-t.__v.__b},sg.__r=0,jd=0;class yg{constructor(e,t){this._cell=e,this._value=t}getCell(){return this._cell}}class Sg{constructor(){this._data=[]}static create(){return new Sg}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}}const Eg=Sg.create();class Rg{constructor(){this._cellEditExtensionFactoryList=[]}get cellEditExtensionFactoryList(){return this._cellEditExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._cellEditExtensionFactoryList.push(...e),this._cellEditExtensionFactoryList.sort(Ar)}delete(e){const t=this._cellEditExtensionFactoryList.indexOf(e);this._cellEditExtensionFactoryList.splice(t,1)}_initExtensions(){this._cellEditExtensionFactoryList.push(...Eg.getData().sort(Ar))}}class Ig{static create(){return this.register||(this.register=new Rg,this.register.initialize()),this.register}handle(e){var t;const n=null==(t=null==Ig?void 0:Ig.register)?void 0:t.cellEditExtensionFactoryList;if(!n)return;this._cellEditExtensionFactoryList=n;const r=this._checkExtension(e);return r?(r.execute(),r.getCell()):void 0}_checkExtension(e){let t=!1;if(!this._cellEditExtensionFactoryList)return!1;for(let n=0;n<this._cellEditExtensionFactoryList.length;n++){if(t=this._cellEditExtensionFactoryList[n].check(e),!1!==t)break}return t}}class Ag{constructor(e,t){this._cell=e,this._value=t}getCell(){return this._cell}setValue(e){}execute(){}}class xg{constructor(){this._data=[]}static create(){return new xg}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}}const Og=xg.create();class Mg{constructor(){this._cellInputExtensionFactoryList=[]}get cellInputExtensionFactoryList(){return this._cellInputExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._cellInputExtensionFactoryList.push(...e),this._cellInputExtensionFactoryList.sort(Ar)}delete(e){const t=this._cellInputExtensionFactoryList.indexOf(e);this._cellInputExtensionFactoryList.splice(t,1)}_initExtensions(){this._cellInputExtensionFactoryList.push(...Og.getData().sort(Ar))}}class Ng{static create(){return this.register||(this.register=new Mg,this.register.initialize()),this.register}handle(e){var t;const n=null==(t=null==Ng?void 0:Ng.register)?void 0:t.cellInputExtensionFactoryList;if(!n)return;this._cellInputExtensionFactoryList=n;const r=this._checkExtension(e);return r?(r.execute(),r.getCell()):void 0}_checkExtension(e){let t=!1;if(!this._cellInputExtensionFactoryList)return!1;for(let n=0;n<this._cellInputExtensionFactoryList.length;n++){if(t=this._cellInputExtensionFactoryList[n].check(e),!1!==t)break}return t}}class kg{constructor(e,t){this._data=e,this._plugin=t}execute(){}}class Lg{constructor(e){this._plugin=e}get zIndex(){return 0}create(e){return new kg(e,this._plugin)}check(e){return!1}}class Dg{constructor(){this._clipboardExtensionFactoryList=[]}get clipboardExtensionFactoryList(){return this._clipboardExtensionFactoryList}add(...e){this._clipboardExtensionFactoryList.push(...e),this._clipboardExtensionFactoryList.sort(Ar)}delete(e){const t=this._clipboardExtensionFactoryList.indexOf(e);this._clipboardExtensionFactoryList.splice(t,1)}}const Pg=class{static async writeText(e,t){var n;if(Pg.clipboard)return Pg.clipboard.writeText(e).then((()=>!0),(e=>console.dir(e)));null==(n=null==t?void 0:t.clipboardData)||n.setData("text/html",e),null==t||t.preventDefault()}static async write(e,t){var n,r,s;if(Pg.clipboard){const t=new Blob([e.data],{type:null!=(n=e.type)?n:"text/html"}),r=[new ClipboardItem({"text/html":t})];Pg.clipboard.write(r)}null==(s=null==t?void 0:t.clipboardData)||s.setData(null!=(r=e.type)?r:"text/html",e.data),null==t||t.preventDefault(),Pg.localData=e.data}static async readText(){return Pg.clipboard?Pg.clipboard.readText().then((e=>e),(()=>null)):Pg.textArea?new Promise(((e,t)=>{e(Pg.textArea.value)})).then((e=>e)).then((()=>null)):null}static async read(e){var t;if(e){const t=[],n=null==e?void 0:e.clipboardData,r=null==n?void 0:n.types;if(!r)return null;for(let e=0;e<r.length;e++)t.push({type:r[e],result:n.getData(r[e])});return t}if(Pg.clipboard){const e=await Pg.clipboard.read(),t=[];for(const n of e)for(const e of n.types){const r=await n.getType(e),s=new FileReader;"image/png"===e?s.readAsDataURL(r):s.readAsText(r);const o=new Promise(((t,n)=>{s.onload=n=>{const r={type:e,result:s.result};t(r)}})).then((e=>e),(()=>null));t.push(o)}return Promise.all(t)}const n=null!=(t=Pg.localData)?t:null;return Pg.localData=null,n}};let Bg=Pg;Bg.clipboard=window.navigator.clipboard;class Hg{constructor(){this._register=new Dg}getRegister(){return this._register}handle(e){var t;const n=null==(t=this._register)?void 0:t.clipboardExtensionFactoryList;if(!n)return;this._clipboardExtensionFactoryList=n;const r=this._checkExtension(e);r&&r.execute()}pasteResolver(e){return new Promise(((t,n)=>{Bg.read(e).then((e=>{var n,r;if(!e)return[];const s=e.findIndex(((e,t)=>e&&"text/html"===e.type)),o=e.findIndex(((e,t)=>e&&"text/plain"===e.type)),i={};if(s>-1){const t=null==(n=e[s])?void 0:n.result;i.html=t}if(o>-1){const t=null==(r=e[o])?void 0:r.result;i.plain=t}t(i)}))}))}_checkExtension(e){if(!this._clipboardExtensionFactoryList)return!1;let t=!1;for(let n=0;n<this._clipboardExtensionFactoryList.length;n++){if(t=this._clipboardExtensionFactoryList[n].check(e),!1!==t)break}return t}}class Fg{constructor(e,t){this._data=e,this._plugin=t}execute(){}}class zg{constructor(e){this._plugin=e}get zIndex(){return 0}create(e){return new Fg(e,this._plugin)}check(e){return!1}}class Ug{constructor(){this._DragAndDropExtensionFactoryList=[]}get DragAndDropExtensionFactoryList(){return this._DragAndDropExtensionFactoryList}add(...e){this._DragAndDropExtensionFactoryList.push(...e),this._DragAndDropExtensionFactoryList.sort(Ar)}delete(e){const t=this._DragAndDropExtensionFactoryList.indexOf(e);this._DragAndDropExtensionFactoryList.splice(t,1)}}class Wg{constructor(){this._register=new Ug}getRegister(){return this._register}handle(e){var t;const n=null==(t=this._register)?void 0:t.DragAndDropExtensionFactoryList;n&&(this._DragAndDropExtensionFactoryList=n,this._checkExtension(e))}dragResolver(e){return new Promise(((t,n)=>{if(!e.dataTransfer)return;const r=[];e.dataTransfer.items?[...e.dataTransfer.items].forEach(((e,t)=>{if("file"===e.kind){const t=e.getAsFile();t&&r.push({kind:e.kind,type:e.type,file:t})}})):[...e.dataTransfer.files].forEach(((e,t)=>{e&&r.push({kind:"file",type:e.type,file:e})})),t(r)}))}_checkExtension(e){if(!this._DragAndDropExtensionFactoryList)return!1;this._DragAndDropExtensionFactoryList.forEach((t=>{const n=t.check(e);!1!==n&&n.execute()}))}}const Vg=wg({});class jg{constructor(e){this._plugin=e,this._observerManager=this._plugin.getContext().getObserverManager(),this._installObserver()}handleKeyboardAction(e){e.addEventListener("keydown",(e=>{var t;null==(t=this._observerManager.requiredObserver("onKeyDownObservable","core"))||t.notifyObservers(e)})),e.addEventListener("keyup",(e=>{var t;null==(t=this._observerManager.requiredObserver("onKeyUpObservable","core"))||t.notifyObservers(e)})),e.addEventListener("copy",(e=>{var t;null==(t=this._observerManager.requiredObserver("onKeyCopyObservable","core"))||t.notifyObservers(e)})),e.addEventListener("paste",(e=>{var t;null==(t=this._observerManager.requiredObserver("onKeyPasteObservable","core"))||t.notifyObservers(e)})),e.addEventListener("cut",(e=>{var t;null==(t=this._observerManager.requiredObserver("onKeyCutObservable","core"))||t.notifyObservers(e)})),e.addEventListener("compositionstart",(e=>{var t;null==(t=this._observerManager.requiredObserver("onKeyCompositionStartObservable","core"))||t.notifyObservers(e)})),e.addEventListener("compositionupdate",(e=>{var t;null==(t=this._observerManager.requiredObserver("onKeyCompositionUpdateObservable","core"))||t.notifyObservers(e)})),e.addEventListener("compositionend",(e=>{var t;null==(t=this._observerManager.requiredObserver("onKeyCompositionEndObservable","core"))||t.notifyObservers(e)}))}_installObserver(){this._observerManager.addObserver("onKeyDownObservable","core",new i),this._observerManager.addObserver("onKeyUpObservable","core",new i),this._observerManager.addObserver("onKeyCopyObservable","core",new i),this._observerManager.addObserver("onKeyPasteObservable","core",new i),this._observerManager.addObserver("onKeyCutObservable","core",new i),this._observerManager.addObserver("onKeyCompositionStartObservable","core",new i),this._observerManager.addObserver("onKeyCompositionUpdateObservable","core",new i),this._observerManager.addObserver("onKeyCompositionEndObservable","core",new i)}}class Yg{constructor(e){this._plugin=e,this._observerManager=this._plugin.getContext().getObserverManager(),this._installObserver()}handleDragAction(e){e.addEventListener("drop",(e=>{var t;e.preventDefault(),null==(t=this._observerManager.requiredObserver("onDropObservable","core"))||t.notifyObservers(e)})),e.addEventListener("dragover",(e=>{e.preventDefault()}))}_installObserver(){this._observerManager.addObserver("onDropObservable","core",new i)}}class Gg{constructor(e){this._plugin=e,this._observerManager=this._plugin.getContext().getObserverManager(),this._installObserver()}_installObserver(){this._observerManager.addObserver("onUIChangeObservable","core",new i),this._observerManager.addObserver("onAfterChangeUISkinObservable","core",new i),this._observerManager.addObserver("onAfterChangeUILocaleObservable","core",new i),this._observerManager.addObserver("onViewComponentFocusChange","core",new i),this._observerManager.addObserver("onAddSheet","core",new i),this._observerManager.addObserver("onDeleteSheet","core",new i),this._observerManager.addObserver("onHideSheet","core",new i),this._observerManager.addObserver("onUnHideSheet","core",new i),this._observerManager.addObserver("onToLeftSheet","core",new i),this._observerManager.addObserver("onToRightSheet","core",new i),this._observerManager.addObserver("onCopySheet","core",new i),this._observerManager.addObserver("onRemoveSheet","core",new i),this._observerManager.addObserver("onSheetColor","core",new i)}}var Xg,$g,Qg,Kg,Zg=0,qg=[],Jg=[],ef=Hd.__b,tf=Hd.__r,nf=Hd.diffed,rf=Hd.__c,sf=Hd.unmount;function of(e,t){Hd.__h&&Hd.__h($g,e,Zg||t),Zg=0;var n=$g.__H||($g.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:Jg}),n.__[e]}function lf(e){return Zg=1,af(Cf,e)}function af(e,t,n){var r=of(Xg++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):Cf(void 0,t),function(e){var t=r.__N?r.__N[0]:r.__[0],n=r.t(t,e);t!==n&&(r.__N=[n,r.__[1]],r.__c.setState({}))}],r.__c=$g,!$g.u)){var s=function(e,t,n){if(!r.__c.__H)return!0;var s=r.__c.__H.__.filter((function(e){return e.__c}));if(s.every((function(e){return!e.__N})))return!o||o.call(this,e,t,n);var i=!1;return s.forEach((function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(i=!0)}})),!(!i&&r.__c.props===e)&&(!o||o.call(this,e,t,n))};$g.u=!0;var o=$g.shouldComponentUpdate,i=$g.componentWillUpdate;$g.componentWillUpdate=function(e,t,n){if(this.__e){var r=o;o=void 0,s(e,t,n),o=r}i&&i.call(this,e,t,n)},$g.shouldComponentUpdate=s}return r.__N||r.__}function cf(e,t){var n=of(Xg++,3);!Hd.__s&&vf(n.__H,t)&&(n.__=e,n.i=t,$g.__H.__h.push(n))}function hf(e,t){var n=of(Xg++,4);!Hd.__s&&vf(n.__H,t)&&(n.__=e,n.i=t,$g.__h.push(n))}function uf(e){return Zg=5,df((function(){return{current:e}}),[])}function df(e,t){var n=of(Xg++,7);return vf(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function gf(e,t){return Zg=8,df((function(){return e}),t)}function ff(){for(var e;e=qg.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(bf),e.__H.__h.forEach(_f),e.__H.__h=[]}catch(t){e.__H.__h=[],Hd.__e(t,e.__v)}}Hd.__b=function(e){$g=null,ef&&ef(e)},Hd.__r=function(e){tf&&tf(e),Xg=0;var t=($g=e.__c).__H;t&&(Qg===$g?(t.__h=[],$g.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=Jg,e.__N=e.i=void 0}))):(t.__h.forEach(bf),t.__h.forEach(_f),t.__h=[])),Qg=$g},Hd.diffed=function(e){nf&&nf(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==qg.push(t)&&Kg===Hd.requestAnimationFrame||((Kg=Hd.requestAnimationFrame)||pf)(ff)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==Jg&&(e.__=e.__V),e.i=void 0,e.__V=Jg}))),Qg=$g=null},Hd.__c=function(e,t){t.some((function(e){try{e.__h.forEach(bf),e.__h=e.__h.filter((function(e){return!e.__||_f(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Hd.__e(n,e.__v)}})),rf&&rf(e,t)},Hd.unmount=function(e){sf&&sf(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{bf(e)}catch(n){t=n}})),n.__H=void 0,t&&Hd.__e(t,n.__v))};var mf="function"==typeof requestAnimationFrame;function pf(e){var t,n=function(){clearTimeout(r),mf&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);mf&&(t=requestAnimationFrame(n))}function bf(e){var t=$g,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),$g=t}function _f(e){var t=$g;e.__c=e.__(),$g=t}function vf(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function Cf(e,t){return"function"==typeof t?t(e):t}function Tf(e,t){for(var n in t)e[n]=t[n];return e}function wf(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function yf(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t}function Sf(e){this.props=e}(Sf.prototype=new eg).isPureReactComponent=!0,Sf.prototype.shouldComponentUpdate=function(e,t){return wf(this.props,e)||wf(this.state,t)};var Ef=Hd.__b;Hd.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Ef&&Ef(e)};var Rf="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function If(e){function t(t){var n=Tf({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=Rf,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var Af=function(e,t){return null==e?null:lg(lg(e).map(t))},xf={map:Af,forEach:Af,count:function(e){return e?lg(e).length:0},only:function(e){var t=lg(e);if(1!==t.length)throw"Children.only";return t[0]},toArray:lg},Of=Hd.__e;Hd.__e=function(e,t,n,r){if(e.then)for(var s,o=t;o=o.__;)if((s=o.__c)&&s.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),s.__c(e,t);Of(e,t,n,r)};var Mf=Hd.unmount;function Nf(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=Tf({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return Nf(e,t,n)}))),e}function kf(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return kf(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function Lf(){this.__u=0,this.t=null,this.__b=null}function Df(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Pf(){this.u=null,this.o=null}Hd.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),Mf&&Mf(e)},(Lf.prototype=new eg).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var s=Df(r.__v),o=!1,i=function(){o||(o=!0,n.__R=null,s?s(l):l())};n.__R=i;var l=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=kf(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},a=!0===t.__h;r.__u++||a||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(i,i)},Lf.prototype.componentWillUnmount=function(){this.t=[]},Lf.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=Nf(this.__b,n,r.__O=r.__P)}this.__b=null}var s=t.__a&&Kd(Jd,null,e.fallback);return s&&(s.__h=null),[Kd(Jd,null,t.__a?null:e.children),s]};var Bf=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};function Hf(e){return this.getChildContext=function(){return e.context},e.children}function Ff(e){var t=this,n=e.i;t.componentWillUnmount=function(){vg(null,t.l),t.l=null,t.i=null},t.i&&t.i!==n&&t.componentWillUnmount(),e.__v?(t.l||(t.i=n,t.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(e){this.childNodes.push(e),t.i.appendChild(e)},insertBefore:function(e,n){this.childNodes.push(e),t.i.appendChild(e)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.i.removeChild(e)}}),vg(Kd(Hf,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}(Pf.prototype=new eg).__a=function(e){var t=this,n=Df(t.__v),r=t.o.get(e);return r[0]++,function(s){var o=function(){t.props.revealOrder?(r.push(s),Bf(t,e,r)):s()};n?n(o):o()}},Pf.prototype.render=function(e){this.u=null,this.o=new Map;var t=lg(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},Pf.prototype.componentDidUpdate=Pf.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){Bf(e,n,t)}))};var zf="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,Uf=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Wf=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Vf=/[A-Z0-9]/g,jf="undefined"!=typeof document,Yf=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(e)};eg.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(eg.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var Gf=Hd.event;function Xf(){}function $f(){return this.cancelBubble}function Qf(){return this.defaultPrevented}Hd.event=function(e){return Gf&&(e=Gf(e)),e.persist=Xf,e.isPropagationStopped=$f,e.isDefaultPrevented=Qf,e.nativeEvent=e};var Kf,Zf={configurable:!0,get:function(){return this.class}},qf=Hd.vnode;Hd.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){for(var s in r={},n){var o=n[s];if(!("value"===s&&"defaultValue"in n&&null==o||jf&&"children"===s&&"noscript"===t)){var i=s.toLowerCase();"defaultValue"===s&&"value"in n&&null==n.value?s="value":"download"===s&&!0===o?o="":"ondoubleclick"===i?s="ondblclick":"onchange"!==i||"input"!==t&&"textarea"!==t||Yf(n.type)?"onfocus"===i?s="onfocusin":"onblur"===i?s="onfocusout":Wf.test(s)?s=i:-1===t.indexOf("-")&&Uf.test(s)?s=s.replace(Vf,"-$&").toLowerCase():null===o&&(o=void 0):i=s="oninput","oninput"===i&&r[s=i]&&(s="oninputCapture"),r[s]=o}}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=lg(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=lg(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(Zf.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",Zf))}e.$$typeof=zf,qf&&qf(e)};var Jf=Hd.__r;Hd.__r=function(e){Jf&&Jf(e),Kf=e.__c};var em=Hd.diffed;function tm(e){return!!e&&e.$$typeof===zf}Hd.diffed=function(e){em&&em(e);var t=e.props,n=e.__e;null!=n&&"textarea"===e.type&&"value"in t&&t.value!==n.value&&(n.value=null==t.value?"":t.value),Kf=null};function nm(e){e()}var rm={useState:lf,useId:function(){var e=of(Xg++,11);if(!e.__){for(var t=$g.__v;null!==t&&!t.__m&&null!==t.__;)t=t.__;var n=t.__m||(t.__m=[0,0]);e.__="P"+n[0]+"-"+n[1]++}return e.__},useReducer:af,useEffect:cf,useLayoutEffect:hf,useInsertionEffect:hf,useTransition:function(){return[!1,nm]},useDeferredValue:function(e){return e},useSyncExternalStore:function(e,t){var n=t(),r=lf({h:{__:n,v:t}}),s=r[0].h,o=r[1];return hf((function(){s.__=n,s.v=t,yf(s.__,t())||o({h:s})}),[e,n,t]),cf((function(){return yf(s.__,s.v())||o({h:s}),e((function(){yf(s.__,s.v())||o({h:s})}))}),[e]),n},startTransition:nm,useRef:uf,useImperativeHandle:function(e,t,n){Zg=6,hf((function(){return"function"==typeof e?(e(t()),function(){return e(null)}):e?(e.current=t(),function(){return e.current=null}):void 0}),null==n?n:n.concat(e))},useMemo:df,useCallback:gf,useContext:function(e){var t=$g.context[e.__c],n=of(Xg++,9);return n.c=e,t?(null==n.__&&(n.__=!0,t.sub($g)),t.props.value):e.__},useDebugValue:function(e,t){Hd.useDebugValue&&Hd.useDebugValue(t?t(e):e)},version:"17.0.2",Children:xf,render:function(e,t,n){return null==t.__k&&(t.textContent=""),vg(e,t),"function"==typeof n&&n(),e?e.__c:null},hydrate:function(e,t,n){return Cg(e,t),"function"==typeof n&&n(),e?e.__c:null},unmountComponentAtNode:function(e){return!!e.__k&&(vg(null,e),!0)},createPortal:function(e,t){var n=Kd(Ff,{__v:e,i:t});return n.containerInfo=t,n},createElement:Kd,createContext:wg,createFactory:function(e){return Kd.bind(null,e)},cloneElement:function(e){return tm(e)?Tg.apply(null,arguments):e},createRef:qd,Fragment:Jd,isValidElement:tm,findDOMNode:function(e){return e&&(e.base||1===e.nodeType&&e)||null},Component:eg,PureComponent:Sf,memo:function(e,t){function n(e){var n=this.props.ref,r=n==e.ref;return!r&&n&&(n.call?n(null):n.current=null),t?!t(this.props,e)||!r:wf(this.props,e)}function r(t){return this.shouldComponentUpdate=n,Kd(e,t)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r},forwardRef:If,flushSync:function(e,t){return e(t)},unstable_batchedUpdates:function(e,t){return e(t)},StrictMode:Jd,Suspense:Lf,SuspenseList:Pf,lazy:function(e){var t,n,r;function s(s){if(t||(t=e()).then((function(e){n=e.default||e}),(function(e){r=e})),r)throw r;if(!n)throw t;return Kd(n,s)}return s.displayName="Lazy",s.__f=!0,s},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:{current:{readContext:function(e){return Kf.__n[e.__c].props.value}}}}};class sm extends eg{constructor(e){super(e),this.initialize(e)}getContext(){return this.context.context}getLocale(e){if(e)return this.getContext().getLocale().get(e)}initialize(e){}}sm.contextType=Vg;class om extends Sf{constructor(e){super(e),this.initialize(e)}getContext(){return this.context.context}getLocale(e){return this.getContext().getLocale().get(e)}initialize(e){}}om.contextType=Vg;var im={};class lm extends sm{constructor(){super(...arguments),this.canvasRef={current:null}}componentDidMount(){this.drawLine()}drawLine(){const e=this.canvasRef;this.props.drawLine(e)}setLineDash(e,t,n,r,s,o,i){try{"Hair"===t?e.setLineDash([1,2]):t.indexOf("DashDotDot")>-1?e.setLineDash([2,2,5,2,2]):t.indexOf("DashDot")>-1?e.setLineDash([2,5,2]):t.indexOf("Dotted")>-1?e.setLineDash([2]):t.indexOf("Dashed")>-1?e.setLineDash([3]):e.setLineDash([0])}catch(l){console.log(l)}e.beginPath(),t.indexOf("Medium")>-1?("h"===n?(e.moveTo(r,s-.5),e.lineTo(o,i-.5)):(e.moveTo(r-.5,s),e.lineTo(o-.5,i)),e.lineWidth=2):"Thick"===t?(e.moveTo(r,s),e.lineTo(o,i),e.lineWidth=3):(e.moveTo(r,s),e.lineTo(o,i),e.lineWidth=1)}render(){return Kd("canvas",{ref:this.canvasRef,className:im.canvas,width:this.props.width,height:this.props.height})}}class am extends sm{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"Thin","h",0,5,100,5),t.stroke(),t.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return Kd(lm,{ref:this.ref,width:e,height:t,drawLine:e=>this.drawLine(e)})}}class cm extends sm{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"Hair","h",0,5,100,5),t.stroke(),t.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return Kd(lm,{ref:this.ref,width:e,height:t,drawLine:e=>this.drawLine(e)})}}class hm extends sm{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"Dotted","h",0,5,100,5),t.stroke(),t.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return Kd(lm,{ref:this.ref,width:e,height:t,drawLine:e=>this.drawLine(e)})}}class um extends eg{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"Dashed","h",0,5,100,5),t.stroke(),t.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return Kd(lm,{ref:this.ref,width:e,height:t,drawLine:e=>this.drawLine(e)})}}class dm extends sm{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"DashDot","h",0,5,100,5),t.stroke(),t.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return Kd(lm,{ref:this.ref,width:e,height:t,drawLine:e=>this.drawLine(e)})}}class gm extends sm{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"DashDotDot","h",0,5,100,5),t.stroke(),t.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return Kd(lm,{ref:this.ref,width:e,height:t,drawLine:e=>this.drawLine(e)})}}class fm extends sm{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"Medium","h",0,5,100,5),t.stroke(),t.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return Kd(lm,{ref:this.ref,width:e,height:t,drawLine:e=>this.drawLine(e)})}}class mm extends sm{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"MediumDashed","h",0,5,100,5),t.stroke(),t.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return Kd(lm,{ref:this.ref,width:e,height:t,drawLine:e=>this.drawLine(e)})}}class pm extends sm{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"MediumDashDot","h",0,5,100,5),t.stroke(),t.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return Kd(lm,{ref:this.ref,width:e,height:t,drawLine:e=>this.drawLine(e)})}}class bm extends sm{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"MediumDashDotDot","h",0,5,100,5),t.stroke(),t.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return Kd(lm,{ref:this.ref,width:e,height:t,drawLine:e=>this.drawLine(e)})}}class _m extends sm{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"Thick","h",0,5,100,5),t.stroke(),t.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return Kd(lm,{ref:this.ref,width:e,height:t,drawLine:e=>this.drawLine(e)})}}var vm=Object.freeze(Object.defineProperty({__proto__:null,BorderThin:am,BorderHair:cm,BorderDotted:hm,BorderDashed:um,BorderDashDot:dm,BorderDashDotDot:gm,BorderMedium:fm,BorderMediumDashed:mm,BorderMediumDashDot:pm,BorderMediumDashDotDot:bm,BorderThick:_m},Symbol.toStringTag,{value:"Module"}));function Cm(e){return e instanceof Element||e instanceof HTMLDocument}const Tm="object"==typeof HTMLElement?e=>e instanceof HTMLElement:e=>e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName;function wm(e,t){let n=(t=t||document).querySelectorAll(e);return 1===n.length?Array.prototype.slice.call(n)[0]:Array.prototype.slice.call(n)}function ym(e){return(e=e?`${e}-`:"")+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,10)}function Sm(e){let t=[],n=e.getElementsByTagName("*");for(let r=0,s=n.length;r<s;++r){if(1!==n[r].nodeType)continue;let s=n[r].parentNode;s&&1===s.nodeType?s===e&&(t[t.length]=n[r]):s&&s.parentNode===e&&(t[t.length]=n[r])}return t}function Em(...e){if(!e.length)return;let t="";return e.forEach((e=>{if(e instanceof Object)for(let n in e)e[n]&&(t+=` ${n}`);else t+=e?` ${e}`:""})),t}function Rm(e,t){let n=null;return(...r)=>{clearTimeout(n),n=setTimeout((()=>{e(...r)}),t)}}function Im(e){var t,n;if(window.getSelection){let r=document.createRange(),s=e.firstChild;s&&(r.setStart(s,0),r.setEnd(s,s.length),r.startContainer&&xm(r.startContainer)&&(null==(t=window.getSelection())||t.removeAllRanges(),null==(n=window.getSelection())||n.addRange(r)))}}function Am(e,t){var n,r;if(window.getSelection){let s=document.createRange(),o=e.firstChild,i=t.firstChild;o&&i&&(s.setStart(o,0),s.setEnd(i,i.length),s.startContainer&&xm(s.startContainer)&&(null==(n=window.getSelection())||n.removeAllRanges(),null==(r=window.getSelection())||r.addRange(s)))}}function xm(e){return e!==document.body&&document.body.contains(e)}function Om(e){return 0===e.length?e:e.replace(/^\s+|\s+$/gm,"")}function Mm(e){if(Tm(e.current))return e.current;let t=e.current;return t?null==t?void 0:t.base:e.base}function Nm(e){return"string"!=typeof e?e:e.replace(/<script>/g,"&lt;script&gt;").replace(/<\/script>/,"&lt;/script&gt;")}function km(e){const t=window.getSelection();t&&t.selectAllChildren(e),t&&t.collapseToEnd()}function Lm(e,t){for(let n in e)if(n.endsWith("Locale")&&"string"==typeof e[n]){const r=n.indexOf("Locale");e[n.slice(0,r)]=t(e[n])}return e}var Dm="univer-icon";const Pm=e=>{const{spin:t,rotate:n,children:r,name:s,style:o,className:i}=e;let l;o?(l=o,l.transform=n?`rotate(${n}deg)`:""):l=n?{transform:`rotate(${n}deg)`}:{};return Kd("span",{role:"img",className:Em(Dm,{[`${Dm}-${s}`]:s,[`${Dm}-spin`]:t||"loading"===s},i),style:__spreadValues({},l)},r)},Bm=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"loading",style:e.style},Kd("svg",{viewBox:"0 0 1024 1024",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"})));var Hm={AddNumIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6466",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M533.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6467"}),Kd("path",{d:"M682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0V640a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V640a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6468"}),Kd("path",{d:"M367.829333 799.701333l90.538667-90.538666L367.786667 618.666667l-30.165334 30.165333 37.76 37.802667H256v42.666666h121.898667l-40.234667 40.234667 30.165333 30.165333z","p-id":"6469"}),Kd("path",{d:"M490.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6470"}),Kd("path",{d:"M341.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6471"}))),ReduceNumIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6336",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M533.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6337"}),Kd("path",{d:"M341.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6338"}),Kd("path",{d:"M346.496 394.368L256 303.786667 346.496 213.333333l30.165333 30.165334-37.717333 37.802666h119.424v42.666667H336.469333l40.192 40.234667-30.165333 30.165333z","p-id":"6339"}),Kd("path",{d:"M682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM490.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6340"}))),PercentIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6209",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M653.525333 213.333333l36.949334 21.333334-320 554.24-36.949334-21.333334L653.525333 213.333333zM682.666667 469.333333c71.68 0 128 67.626667 128 149.333334S754.346667 768 682.666667 768s-128-67.626667-128-149.333333 56.32-149.333333 128-149.333334z m0 42.666667c-46.165333 0-85.333333 46.976-85.333334 106.666667s39.168 106.666667 85.333334 106.666666c46.165333 0 85.333333-46.976 85.333333-106.666666s-39.168-106.666667-85.333333-106.666667zM341.333333 234.666667c71.68 0 128 67.626667 128 149.333333s-56.32 149.333333-128 149.333333S213.333333 465.706667 213.333333 384s56.32-149.333333 128-149.333333z m0 42.666666C295.168 277.333333 256 324.309333 256 384s39.168 106.666667 85.333333 106.666667c46.165333 0 85.333333-46.976 85.333334-106.666667s-39.168-106.666667-85.333334-106.666667z","p-id":"6210"}))),MoneyIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6082",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M658.816 256l34.986667 24.490667-124.629334 177.92h119.04v42.666666h-149.333333v85.333334h149.333333v42.666666h-149.333333v128h-42.666667v-128h-149.333333v-42.666666h149.333333v-85.333334h-149.333333v-42.666666h119.04L341.333333 280.490667 376.32 256l141.226667 201.728L658.816 256z","p-id":"6083"}))),FxIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M771.072 391.253333a6.698667 6.698667 0 0 0-0.512-9.514666 6.997333 6.997333 0 0 0-4.48-1.749334h-61.354667c-1.962667 0-3.84 0.853333-5.12 2.346667l-103.893333 122.709333a6.698667 6.698667 0 0 1-11.392-1.621333l-53.674667-119.381333a6.656 6.656 0 0 0-6.144-4.010667H381.866667l0.853333-3.968 6.741333-35.712c8.874667-46.933333 32.085333-68.864 72.533334-68.864 15.658667 0 29.994667 1.450667 41.258666 4.010667l11.861334-56.490667a197.888 197.888 0 0 0-46.464-5.12c-87.296 0-132.224 37.418667-148.650667 124.458667l-7.978667 41.813333H229.632a6.698667 6.698667 0 0 0-6.613333 5.376l-9.130667 43.818667a6.826667 6.826667 0 0 0 6.570667 8.106666h79.786666l-75.264 363.52a6.826667 6.826667 0 0 0 6.570667 8.234667H287.573333c3.242667 0 5.973333-2.346667 6.570667-5.418667l75.861333-366.165333h114.773334l57.685333 117.546667a6.570667 6.570667 0 0 1-1.024 7.381333l-152.746667 171.690667a6.826667 6.826667 0 0 0 5.12 11.264h61.44c2.005333 0 3.882667-0.853333 5.162667-2.389334l104.576-123.989333a6.826667 6.826667 0 0 1 11.392 1.493333l55.594667 120.661334a6.741333 6.741333 0 0 0 6.186666 3.968h54.613334a6.784 6.784 0 0 0 6.101333-9.770667L618.325333 567.466667a6.698667 6.698667 0 0 1 1.066667-7.466667l151.722667-168.661333-0.042667-0.042667z","p-id":"5447"}))),AddIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"}),Kd("path",{d:"M554.666667 213.333333v597.333334h-85.333334V213.333333z","p-id":"5320"}))),ReduceIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"})))};const Fm=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M298.666667 213.333333h224a174.208 174.208 0 0 1 141.952 275.242667A174.208 174.208 0 0 1 572.458667 810.666667H298.666667V213.333333z m273.792 348.458667l-174.250667-0.042667v149.333334h174.250667a74.666667 74.666667 0 0 0 6.101333-149.077334l-6.101333-0.213333zM398.208 312.874667v149.333333h124.458667a74.666667 74.666667 0 0 0 6.144-149.077333l-6.144-0.256H398.208z","p-id":"5566"}))),zm=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M469.333333 256h170.666667v42.666667h-170.666667z","p-id":"5693"}),Kd("path",{d:"M573.738667 284.586667l-81.493334 462.208-41.984-7.381334 81.493334-462.208z","p-id":"5694"}),Kd("path",{d:"M384 725.333333h170.666667v42.666667H384z","p-id":"5695"}))),Um=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M298.666667 256h426.666666v42.666667H298.666667z","p-id":"5312"}),Kd("path",{d:"M533.290667 554.666667l0.042666 192h-42.666666l-0.042667-192h42.666667z m0.042666-277.333334l-0.042666 234.666667h-42.666667l0.042667-234.666667h42.666666zM320 256v85.333333h-42.666667V256zM746.666667 256v85.333333h-42.666667V256z","p-id":"5313"}),Kd("path",{d:"M256 469.333333h512v42.666667H256zM426.666667 725.333333h170.666666v42.666667h-170.666666z","p-id":"5314"}))),Wm=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M362.666667 256v298.666667a149.333333 149.333333 0 0 0 298.453333 8.192L661.333333 554.666667V256h42.666667v298.666667a192 192 0 0 1-383.786667 9.045333L320 554.666667V256h42.666667z","p-id":"5319"}),Kd("path",{d:"M256 768m21.333333 0l469.333334 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-469.333334 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5320"}),Kd("path",{d:"M256 256m21.333333 0l128 0q21.333333 0 21.333334 21.333333l0 0q0 21.333333-21.333334 21.333334l-128 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5321"}),Kd("path",{d:"M597.333333 256m21.333334 0l128 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-128 0q-21.333333 0-21.333334-21.333334l0 0q0-21.333333 21.333334-21.333333Z","p-id":"5322"}))),Vm=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5440",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M549.546667 256l194.133333 533.333333h-45.354667l-77.653333-213.333333H421.632l-77.653333 213.333333H298.666667L492.757333 256h56.789334z m-28.416 46.634667L437.162667 533.333333h167.978666l-84.010666-230.698666z","p-id":"5441"})));var jm={BoldIcon:Fm,ItalicIcon:zm,DeleteLineIcon:Um,UnderLineIcon:Wm,TextColorIcon:Vm};const Ym=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5567",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M730.24 562.176l-253.44 253.44-217.173333-217.258667 253.44-253.44 217.173333 217.258667z m-72.405333-0.042667L512.981333 417.28l-180.992 180.992 144.810667 144.853333 181.034667-181.034666z","p-id":"5568"}),Kd("path",{d:"M520.533333 298.666667v230.4H469.333333V349.824H392.533333v179.626667H341.333333V298.666667zM699.733333 554.666667c48.768 0 88.32 37.802667 88.32 84.48 0 46.634667-39.552 84.48-88.32 84.48","p-id":"5569"}))),Gm=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5695",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667zM469.333333 810.666667V256h42.666667v554.666667z","p-id":"5696"}),Kd("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 512h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"5697"}))),Xm=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5823",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M213.333333 256h554.666667v42.666667H213.333333z","p-id":"5824"}),Kd("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM384 512h42.666667v42.666667H384zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 512h42.666666v42.666667H298.666667z","p-id":"5825"}),Kd("path",{d:"M469.333333 512h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"5826"}))),$m=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5952",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M768 810.666667H213.333333v-42.666667h554.666667z","p-id":"5953"}),Kd("path",{d:"M768 640h-42.666667v-42.666667h42.666667zM768 469.333333h-42.666667v-42.666666h42.666667zM768 725.333333h-42.666667v-42.666666h42.666667zM768 554.666667h-42.666667v-42.666667h42.666667zM768 384h-42.666667V341.333333h42.666667z","p-id":"5954"}),Kd("path",{d:"M512 640h-42.666667v-42.666667h42.666667z","p-id":"5955"}),Kd("path",{d:"M256 640H213.333333v-42.666667h42.666667zM256 469.333333H213.333333v-42.666666h42.666667zM256 725.333333H213.333333v-42.666666h42.666667zM256 554.666667H213.333333v-42.666667h42.666667zM256 384H213.333333V341.333333h42.666667zM256 298.666667H213.333333V256h42.666667z","p-id":"5956"}),Kd("path",{d:"M512 469.333333h-42.666667v-42.666666h42.666667zM512 725.333333h-42.666667v-42.666666h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM512 384h-42.666667V341.333333h42.666667z","p-id":"5957"}),Kd("path",{d:"M768 298.666667h-42.666667V256h42.666667zM597.333333 298.666667h-42.666666V256h42.666666zM426.666667 298.666667H384V256h42.666667zM682.666667 298.666667h-42.666667V256h42.666667zM512 298.666667h-42.666667V256h42.666667zM341.333333 298.666667H298.666667V256h42.666666z","p-id":"5958"}),Kd("path",{d:"M597.333333 554.666667h-42.666666v-42.666667h42.666666zM426.666667 554.666667H384v-42.666667h42.666667zM682.666667 554.666667h-42.666667v-42.666667h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM341.333333 554.666667H298.666667v-42.666667h42.666666z","p-id":"5959"}))),Qm=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6085",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M213.333333 810.666667V256h42.666667v554.666667z","p-id":"6086"}),Kd("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667z","p-id":"6087"}),Kd("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6088"}),Kd("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6089"}),Kd("path",{d:"M384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667z","p-id":"6090"}),Kd("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667z","p-id":"6091"}))),Km=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6217",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M768 256v554.666667h-42.666667V256z","p-id":"6218"}),Kd("path",{d:"M597.333333 256v42.666667h-42.666666V256zM426.666667 256v42.666667H384V256zM682.666667 256v42.666667h-42.666667V256zM512 256v42.666667h-42.666667V256zM341.333333 256v42.666667H298.666667V256z","p-id":"6219"}),Kd("path",{d:"M597.333333 512v42.666667h-42.666666v-42.666667z","p-id":"6220"}),Kd("path",{d:"M597.333333 768v42.666667h-42.666666v-42.666667zM426.666667 768v42.666667H384v-42.666667zM682.666667 768v42.666667h-42.666667v-42.666667zM512 768v42.666667h-42.666667v-42.666667zM341.333333 768v42.666667H298.666667v-42.666667zM256 768v42.666667H213.333333v-42.666667z","p-id":"6221"}),Kd("path",{d:"M426.666667 512v42.666667H384v-42.666667zM682.666667 512v42.666667h-42.666667v-42.666667zM512 512v42.666667h-42.666667v-42.666667zM341.333333 512v42.666667H298.666667v-42.666667z","p-id":"6222"}),Kd("path",{d:"M256 256v42.666667H213.333333V256zM256 426.666667v42.666666H213.333333v-42.666666zM256 597.333333v42.666667H213.333333v-42.666667zM256 341.333333v42.666667H213.333333V341.333333zM256 512v42.666667H213.333333v-42.666667zM256 682.666667v42.666666H213.333333v-42.666666z","p-id":"6223"}),Kd("path",{d:"M512 426.666667v42.666666h-42.666667v-42.666666zM512 597.333333v42.666667h-42.666667v-42.666667zM512 341.333333v42.666667h-42.666667V341.333333zM512 512v42.666667h-42.666667v-42.666667zM512 682.666667v42.666666h-42.666667v-42.666666z","p-id":"6224"}))),Zm=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6350",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667zM384 554.666667v-42.666667h42.666667v42.666667zM384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667zM213.333333 298.666667V256h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667z","p-id":"6351"}),Kd("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM213.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM213.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM213.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM213.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM213.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667zM213.333333 384V341.333333h42.666667v42.666667z","p-id":"6352"}),Kd("path",{d:"M469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666zM469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6353"}))),qm=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6479",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667z","p-id":"6480"}),Kd("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"6481"}),Kd("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6482"}),Kd("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6483"}))),Jm=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6609",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6610"}),Kd("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6611"}),Kd("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6612"}))),ep=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6866",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6867"}),Kd("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6868"}))),tp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6994",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM384 512h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM298.666667 512h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"6995"}),Kd("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6996"}))),np=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7122",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"7123"}),Kd("path",{d:"M389.162667 426.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.802667-37.845333-119.466667 0.042666v-42.666666l121.856-0.042667-40.192-40.192 30.165334-30.165333zM645.162667 426.666667L554.666667 517.162667l90.496 90.538666 30.165333-30.165333-37.76-37.845333 119.466667 0.042666v-42.666666l-121.856-0.042667 40.149333-40.192-30.165333-30.165333z","p-id":"7124"})));var rp={FillColorIcon:Ym,FullBorderIcon:Gm,TopBorderIcon:Xm,BottomBorderIcon:$m,LeftBorderIcon:Qm,RightBorderIcon:Km,NoneBorderIcon:Zm,OuterBorderIcon:qm,InnerBorderIcon:Jm,StripingBorderIcon:ep,VerticalBorderIcon:tp,MergeIcon:np};const sp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7250",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m0 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7251"}))),op=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7377",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666zM341.333333 426.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-106.666666 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666zM341.333333 682.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7378"}))),ip=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7504",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-213.333333 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7505"}))),lp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7631",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M298.666667 384h426.666666v42.666667H298.666667zM416 527.829333l90.496-90.496 90.538667 90.496-30.165334 30.165334-37.802666-37.717334v290.090667h-42.666667v-292.565333l-40.234667 40.192-30.165333-30.165334z","p-id":"7632"}))),ap=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7758",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M725.333333 533.333333H298.666667v-42.666666h426.666666zM426.666667 634.496l90.496-90.496 90.538666 90.496-30.165333 30.165333-39.936-39.850666v121.557333h-42.666667v-119.765333l-38.101333 38.058666-30.165333-30.165333zM426.666667 389.162667l90.496 90.538666 90.538666-90.538666-30.165333-30.165334-39.936 39.893334V277.333333h-42.666667v119.765334l-38.101333-38.101334-30.165333 30.165334z","p-id":"7759"}))),cp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7885",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M725.333333 725.333333H298.666667v-42.666666h426.666666zM608 581.504l-90.496 90.496-90.538667-90.496 30.165334-30.165333 37.802666 37.717333V298.965333h42.666667v292.565334l40.234667-40.192 30.165333 30.165333z","p-id":"7886"}))),hp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8217",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M549.546667 213.333333l77.653333 213.333334h0.64l-0.042667 1.621333 53.76 147.712h-45.354666l-38.826667-106.666667h-152.405333l-38.826667 106.666667H360.789333l53.674667-147.498667 0.042667-1.834666h0.64l77.610666-213.333334h56.789334z m-28.416 46.634667L460.458667 426.666667h121.386666l-60.714666-166.698667zM709.162667 618.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.76-37.802667H256v-42.666666h463.232l-40.234667-40.234667 30.165334-30.165333z","p-id":"8218"}))),up=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4524",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M290.944 289.365333l205.738667 95.914667 0.469333-0.426667 1.109333 1.152 142.506667 66.432-32.128 32.085334-102.826667-47.957334-107.818666 107.733334 48 102.912-32.085334 32.042666-66.346666-142.250666-1.28-1.28 0.469333-0.512-96-205.696 40.192-40.149334z m12.885333 53.034667l74.965334 160.810667 85.845333-85.845334L303.786667 342.4zM690.432 463.104h128v128h-42.666667v-53.418667l-325.845333 325.802667-30.165333-30.165333 327.552-327.552h-56.874667v-42.666667z",fill:"#444D5A","p-id":"4525"}))),dp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4659",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M755.968 312.277333l-95.914667 205.738667 0.426667 0.469333-1.152 1.109334-66.432 142.506666-32.085333-32.128 47.957333-102.826666-107.733333-107.818667-102.912 48-32.042667-32.085333 142.250667-66.346667 1.28-1.28 0.512 0.469333 205.696-96 40.149333 40.192z m-53.034667 12.885334l-160.810666 74.965333 85.845333 85.845333 74.965333-160.810666zM582.229333 711.765333v128h-128v-42.666666h53.418667l-325.802667-325.845334 30.165334-30.165333 327.552 327.552v-56.874667h42.666666z",fill:"#444D5A","p-id":"4660"}))),gp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4794",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M636.757333 298.666667l77.653334 213.333333h0.64l-0.042667 1.621333 53.76 147.712h-45.354667l-38.826666-106.666666h-152.405334l-38.826666 106.666666H448l53.674667-147.498666 0.042666-1.834667h0.64l77.610667-213.333333h56.789333z m-28.416 46.634666L547.669333 512h121.386667l-60.714667-166.698667zM394.368 698.496L303.786667 789.034667 213.333333 698.453333l30.165334-30.165333 37.802666 37.76V245.333333h42.666667v463.232l40.234667-40.234666 30.165333 30.165333z",fill:"#444D5A","p-id":"4795"}))),fp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4929",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M192 495.786667l213.333333-77.653334v-0.64l1.621334 0.042667L554.666667 363.776v45.354667l-106.666667 38.826666v152.405334l106.666667 38.826666v45.354667l-147.498667-53.674667-1.834667-0.042666v-0.64l-213.333333-77.610667V495.786667z m46.634667 28.416L405.333333 584.874667v-121.386667l-166.698666 60.714667zM597.333333 336.170667l90.496-90.538667 90.538667 90.538667-30.165333 30.165333-37.802667-37.76V789.333333h-42.666667V326.101333l-40.234666 40.234667L597.333333 336.170667z",fill:"#444D5A","p-id":"4930"}))),mp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5199",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M789.333333 528.213333l-213.333333 77.653334v0.64l-1.621333-0.042667L426.666667 660.224v-45.354667l106.666666-38.826666V423.637333l-106.666666-38.826666V339.456l147.498666 53.674667 1.834667 0.042666v0.64l213.333333 77.610667v56.789333z m-46.634666-28.416L576 439.125333v121.386667l166.698667-60.714667zM384 687.829333l-90.496 90.538667-90.538667-90.538667 30.165334-30.165333 37.802666 37.76V234.666667h42.666667v463.232l40.234667-40.234667 30.165333 30.165333z",fill:"#444D5A","p-id":"5200"}))),pp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8736",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M213.333333 213.333333h85.12v597.333334H213.333333V213.333333z m225.450667 477.44l25.557333-21.333333-72.362666-63.786667 72.362666-63.872-25.557333-21.248-93.610667 80.853334h4.266667-4.266667l93.610667 89.386666z","p-id":"8737"}),Kd("path",{d:"M768 213.333333h42.581333v597.333334H768z","p-id":"8738"}),Kd("path",{d:"M540.928 367.274667H391.978667v42.581333h148.949333c59.605333 0 106.410667 38.314667 106.410667 85.12s-46.805333 85.12-106.410667 85.12H391.978667v42.581333h148.949333c85.12 0 157.482667-55.338667 157.482667-127.701333s-72.362667-127.701333-157.44-127.701333z","p-id":"8739"}))),bp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8608",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M300.288 810.666667H213.333333V213.333333h86.954667v279.978667h441.898667l-91.306667-85.845333 26.624-26.112L810.666667 512l-133.162667 130.688-26.624-26.154667 91.306667-85.845333-441.898667-0.042667z","p-id":"8609"}),Kd("path",{d:"M530.688 213.333333h42.666667v242.688h-42.666667V213.333333z m0 354.688h42.666667V810.666667h-42.666667v-242.688z","p-id":"8610"}))),_p=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8865",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M767.829333 213.333333h42.496v597.333334h-42.496z","p-id":"8866"}),Kd("path",{d:"M767.146667 553.216h-384v-42.496h384v42.496zM213.333333 213.333333h84.992v597.333334H213.333333V213.333333z","p-id":"8867"})));var vp={LeftAlignIcon:sp,CenterAlignIcon:op,RightAlignIcon:ip,TopVerticalIcon:lp,CenterVerticalIcon:ap,BottomVerticalIcon:cp,TextRotateIcon:hp,TextRotateAngleUpIcon:up,BrIcon:pp,OverflowIcon:bp,CutIcon:_p};var Cp={PhotoIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8090",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z","p-id":"8091"}))),LinkIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7962",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M771.584 251.733333c-49.066667-51.2-132.266667-51.2-181.333333 0l-74.666667 76.8c-8.533333 8.533333-8.533333 23.466667 0 32 8.533333 8.533333 21.333333 8.533333 29.866667 0l74.666666-76.8c34.133333-34.133333 87.466667-34.133333 121.6 0 34.133333 34.133333 34.133333 89.6 0 123.733334l-121.6 123.733333c-34.133333 34.133333-87.466667 34.133333-121.6 0-8.533333-8.533333-21.333333-8.533333-29.866666 0-8.533333 8.533333-8.533333 23.466667 0 32 49.066667 51.2 132.266667 51.2 181.333333 0l121.6-123.733333c51.2-53.333333 51.2-136.533333 0-187.733334z","p-id":"7963"}),Kd("path",{d:"M477.184 663.466667l-74.666667 76.8c-34.133333 34.133333-87.466667 34.133333-121.6 0-34.133333-34.133333-34.133333-89.6 0-123.733334l121.6-123.733333c34.133333-34.133333 87.466667-34.133333 121.6 0 8.533333 8.533333 21.333333 8.533333 29.866667 0 8.533333-8.533333 8.533333-23.466667 0-32-49.066667-51.2-132.266667-51.2-181.333333 0l-121.6 123.733333c-51.2 51.2-49.066667 134.4 0 185.6 49.066667 51.2 132.266667 51.2 181.333333 0l74.666667-76.8c8.533333-8.533333 8.533333-23.466667 0-32-8.533333-6.4-21.333333-6.4-29.866667 2.133334z","p-id":"7964"}))),ChartIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7833",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M256 213.333333H213.333333v597.333334h597.333334v-42.666667H256z","p-id":"7834"}),Kd("path",{d:"M490.666667 343.466667V554.666667h185.6c-19.2 72.533333-85.333333 128-164.266667 128-93.866667 0-170.666667-76.8-170.666667-170.666667 0-87.466667 66.133333-157.866667 149.333334-168.533333M512 298.666667c-117.333333 0-213.333333 96-213.333333 213.333333s96 213.333333 213.333333 213.333333 213.333333-96 213.333333-213.333333h-192V298.666667H512z","p-id":"7835"}),Kd("path",{d:"M618.666667 260.266667c83.2 14.933333 134.4 74.666667 147.2 166.4H618.666667V260.266667m-42.666667-46.933334v256H810.666667c0-149.333333-85.333333-256-234.666667-256z","p-id":"7836"})))};const Tp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M737.664 419.328H426.666667v42.666667h311.296l-84.48 84.437333a21.333333 21.333333 0 0 0 30.208 30.165333l120.746666-120.704a21.290667 21.290667 0 0 0 0-30.165333l-120.746666-120.661333a21.333333 21.333333 0 0 0-30.165334 30.165333l84.138667 84.096zM213.333333 632.661333a213.333333 213.333333 0 0 1 213.333334-213.333333v42.666667a170.666667 170.666667 0 0 0-170.666667 170.666666H213.333333z m0 0h42.666667v64a21.333333 21.333333 0 0 1-42.666667 0v-64z","p-id":"5693"}))),wp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M287.018667 419.328h310.997333v42.666667H286.72l84.48 84.437333a21.333333 21.333333 0 1 1-30.208 30.165333l-120.746667-120.704a21.248 21.248 0 0 1 0-30.165333l120.746667-120.661333a21.333333 21.333333 0 0 1 30.165333 30.165333L287.018667 419.328z m524.330666 213.333333a213.333333 213.333333 0 0 0-213.333333-213.333333v42.666667a170.666667 170.666667 0 0 1 170.666667 170.666666h42.666666z m0 0h-42.666666v64a21.333333 21.333333 0 1 0 42.666666 0v-64z","p-id":"5566"}))),yp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5955",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M725.333333 213.333333v85.333334h85.333334v234.666666h-298.666667V597.333333h21.333333v213.333334h-85.333333v-213.333334h21.333333v-106.666666h298.666667V341.333333h-42.666667v85.333334H213.333333V213.333333h512z m-42.666666 42.666667H256v128h426.666667V256z","p-id":"5956"}))),Sp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,className:e.className,name:"nextIcon",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M512 682.666667L170.666667 341.333333h682.666666z","p-id":"5312"}))),Ep=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,className:e.className,name:"rightIcon",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M682.666667 512l-341.333334 341.333333V170.666667z","p-id":"5312"}))),Rp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M268.032 523.434667l60.373333-60.330667 211.2 211.2-60.373333 60.330667z","p-id":"5312"}),Kd("path",{d:"M780.928 312.234667l60.373333 60.330666-331.904 331.861334-60.330666-60.330667z","p-id":"5313"}))),Ip=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},Kd("svg",{width:"1em",height:"1em",fill:"currentColor",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1732"},Kd("path",{d:"M224.45 538.68l575.11-346.21-0.05-68.75-575.03 345.61-0.03 69.35z","p-id":"1733"}),Kd("path",{d:"M224.45 538.68l575.08 356.96v-69.52L224.48 469.33l-0.03 69.35z","p-id":"1734"}))),Ap=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M330.965333 270.634667l422.4 422.4-60.330666 60.330666-422.4-422.4z","p-id":"5319"}),Kd("path",{d:"M753.365333 330.965333l-422.4 422.4-60.330666-60.330666 422.4-422.4z","p-id":"5320"}))),xp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333zM213.333333 213.333333h597.333334v85.333334H213.333333zM213.333333 725.333333h597.333334v85.333334H213.333333z","p-id":"5447"}))),Op=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6513",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M512 219.428571c161.645714 0 307.931429 97.499429 438.857143 292.571429-130.925714 195.072-277.211429 292.571429-438.857143 292.571429S204.068571 707.072 73.142857 512c130.925714-195.072 277.211429-292.571429 438.857143-292.571429z m0 73.142858c-124.123429 0-241.225143 65.462857-365.714286 219.428571 119.661714 147.968 231.424 213.577143 365.714286 219.428571 124.196571 0 241.298286-65.462857 365.714286-219.428571-119.588571-147.968-231.350857-213.577143-365.714286-219.428571z","p-id":"6514"}),Kd("path",{d:"M818.614857 146.285714l51.712 51.712L197.997714 870.4 146.285714 818.688z","p-id":"6515"}),Kd("path",{d:"M512 365.714286a146.285714 146.285714 0 1 1 0 292.571428 146.285714 146.285714 0 0 1 0-292.571428z m0 73.142857a73.142857 73.142857 0 1 0 0 146.285714 73.142857 73.142857 0 0 0 0-146.285714z","p-id":"6516"})));var Mp={BackIcon:Tp,ForwardIcon:wp,FormatIcon:yp,NextIcon:Sp,RightIcon:Ep,CorrectIcon:Rp,LtIcon:Ip,CloseIcon:Ap,MenuIcon:xp,HideIcon:Op};var Np={PivotableIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7578",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M256 362.666667v298.666666l256 149.333334 256-149.333334v-298.666666L512 213.333333 256 362.666667zM725.333333 640l-213.333333 128-213.333333-128V384l213.333333-128 213.333333 128v256z m-189.354666 40.021333a18.645333 18.645333 0 0 1-18.645334 18.645334 18.304 18.304 0 0 1-18.688-18.645334V535.466667l-130.645333-75.349334a18.645333 18.645333 0 0 1 4.565333-34.133333 18.304 18.304 0 0 1 14.08 2.005333l130.688 74.666667 129.578667-74.666667a18.304 18.304 0 0 1 25.386667 6.698667 18.645333 18.645333 0 0 1-6.784 25.386667l-129.536 74.666666v145.237334z","p-id":"7579"}))),SumIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7451",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M774.058667 213.333333v42.666667H310.784l236.288 256-236.330667 256h463.317334v42.666667H213.333333l275.669334-298.666667L213.333333 213.333333z","p-id":"7452"}))),OrderIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6675",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M704 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333zM512 384c11.776 0 21.333333 7.68 21.333333 17.194667v221.610666c0 9.514667-9.472 17.194667-21.333333 17.194667-11.776 0-21.333333-7.68-21.333333-17.194667V401.194667c0-4.565333 2.218667-8.96 6.186666-12.16A24.32 24.32 0 0 1 512 384zM320 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333z m283.562667 368.896a21.333333 21.333333 0 0 1 30.165333 30.165333l-106.666667 106.666667a21.333333 21.333333 0 0 1-30.165333 0l-106.666667-106.666667a21.333333 21.333333 0 0 1 30.165334-30.165333L512 716.501333l91.605333-91.562666z m0.298666-225.834667a21.333333 21.333333 0 0 0 30.165334-30.165333l-106.666667-106.666667a21.333333 21.333333 0 0 0-30.165333 0l-106.666667 106.666667a21.333333 21.333333 0 0 0 30.165333 30.165333l91.562667-91.562666 91.605333 91.562666z","p-id":"6676"}))),OrderDESCIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6548",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M430.848 666.197333H366.592V236.074667a6.656 6.656 0 0 0-6.741333-6.528h-47.36a6.656 6.656 0 0 0-6.741334 6.528v430.122666H241.493333c-5.674667 0-8.874667 6.314667-5.333333 10.538667l94.72 115.2a6.912 6.912 0 0 0 10.624 0l94.72-115.2c3.413333-4.224 0.298667-10.538667-5.376-10.538667zM582.442667 806.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 533.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 486.698667v-39.168h-124.288l124.288-203.093334V213.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6549"}))),OrderASCIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6294",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M430.848 357.76H366.592v430.165333a6.656 6.656 0 0 1-6.741333 6.485334h-47.36a6.656 6.656 0 0 1-6.741334-6.485334V357.76H241.493333c-5.674667 0-8.874667-6.314667-5.333333-10.538667l94.72-115.2a6.912 6.912 0 0 1 10.624 0l94.72 115.2c3.413333 4.224 0.298667 10.538667-5.376 10.538667zM582.442667 486.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 213.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 806.698667v-39.168h-124.288l124.288-203.093334V533.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6295"}))),FilterIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6802",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6803"}))),FilterRankIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6929",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6930"}),Kd("path",{d:"M688.213333 378.410667l-101.546666 101.589333c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334L403.626667 408.32l284.586666-29.909333z","p-id":"6931"}))),CleanIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7193",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M214.016 722.432h593.92v42.410667H214.016v-42.410667z m578.048-312.106667l-180.693333-181.077333A53.376 53.376 0 0 0 573.738667 213.333333a45.653333 45.653333 0 0 0-32.64 13.226667l-313.941334 314.965333c-18.56 18.602667-17.322667 50.261333 2.688 70.4l68.010667 68.096h298.24l198.698667-199.338666c18.56-18.602667 17.322667-50.261333-2.730667-70.357334z m-213.546667 227.242667H315.434667L259.84 581.888c-3.968-4.010667-4.053333-9.088-2.730667-10.453333L430.08 398.08l193.92 193.92-45.44 45.568z","p-id":"7194"}))),CheckIcon:e=>Kd(Pm,{spin:e.spin,className:e.className,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5912",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M764.330667 592.170667l30.165333 30.165333L734.165333 682.666667l60.330667 60.330666-30.165333 30.165334-60.330667-60.330667-60.330667 60.330667-30.165333-30.165334L673.834667 682.666667l-60.330667-60.330667 30.165333-30.165333 60.330667 60.330666 60.330667-60.330666zM725.333333 512v42.666667H256v128h256v42.666666H213.333333v-213.333333h512z m47.829334-209.664l30.165333 30.165333L682.666667 453.12l-30.165334 30.165333-90.496-90.453333 30.165334-30.208 60.330666 60.330667 120.661334-120.661334zM725.333333 256v42.666667H256v128h256v42.666666H213.333333V256h512z","p-id":"5913"})))};const kp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7705",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M352 490.666667a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z","p-id":"7706"}),Kd("path",{d:"M768 298.666667H256c-23.466667 0-42.666667 19.2-42.666667 42.666666v298.666667c0 23.466667 19.2 42.666667 42.666667 42.666667h106.666667v128l128-128H768c23.466667 0 42.666667-19.2 42.666667-42.666667V341.333333c0-23.466667-19.2-42.666667-42.666667-42.666666z m0 320c0 12.8-8.533333 21.333333-21.333333 21.333333H469.333333l-64 64V640h-128c-12.8 0-21.333333-8.533333-21.333333-21.333333v-256c0-12.8 8.533333-21.333333 21.333333-21.333334h469.333334c12.8 0 21.333333 8.533333 21.333333 21.333334v256z","p-id":"7707"}))),Lp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5448",width:"1em",height:"1em"},Kd("path",{d:"M256.426667 256.426667h255.317333v553.130666H256.426667z",fill:"#B5B8BD","p-id":"5449"}),Kd("path",{d:"M809.557333 213.930667v595.626666H213.930667V213.930667h595.626666z m-42.538666 42.538666H256.426667v510.549334h510.549333V256.426667z",fill:"#444D5A","p-id":"5450"}),Kd("path",{d:"M490.453333 256.426667h42.538667v510.592h-42.538667z",fill:"#444D5A","p-id":"5451"}),Kd("path",{d:"M256.426667 532.992v-42.538667h510.592v42.538667z",fill:"#444D5A","p-id":"5452"}),Kd("path",{d:"M256.384 226.261333l264.192 264.192-30.122667 30.08-264.192-264.192 30.122667-30.08z m-30.122667 317.184l30.122667-30.122666 264.192 264.192-30.122667 30.08-264.192-264.149334z",fill:"#444D5A","p-id":"5453"}))),Dp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6039",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 320h-106.666667V768H768v-234.666667z m-405.376 0h-106.666667V768h106.666667v-234.666667z m256.042667 86.784L445.482667 768H618.666667v-147.882667z m0-162.346666l-213.376 179.968v108.885333l213.376-179.072v-109.781333z m0-163.669334l-213.333334 179.029334v108.885333l213.333334-179.072V294.101333zM768 256h-103.936l-2.730667 2.304V490.666667H768V256zM362.666667 256H256v234.666667h106.666667V256z m235.008 0H405.333333v161.408L597.674667 256z","p-id":"6040"}))),Pp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5501",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M544.896 389.717333h110.762667v46.933334c6.698667 6.613333 15.658667 6.613333 22.357333 0l84.949333-55.125334c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386666c-6.741333-6.613333-15.701333-6.613333-22.4 0v41.258666h-133.12l-89.429334 154.453334H343.722667v0.128h-22.698667c-11.178667 0-22.357333 11.050667-22.357333 22.058666 0 11.050667 11.178667 22.058667 22.357333 22.058667h134.101333l-0.085333-0.128h0.426667l89.386666-154.453333h0.042667z m133.12 198.954667a15.061333 15.061333 0 0 0-22.314667 0v43.690667h-66.133333l-67.029333-110.293334-22.357334 44.117334s62.592 103.68 67.072 110.293333h88.448V721.066667a15.061333 15.061333 0 0 0 22.314667 0l84.949333-55.168c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386667h-0.042667z","p-id":"5502"}))),Bp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4859",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M768 430.933333H280.405333l-4.394666-0.554666c-5.461333-0.853333-6.570667-1.749333-12.885334-6.528l-2.986666-5.376c-6.4-11.946667-5.376-13.738667 2.986666-28.885334L440.618667 213.333333l34.218666 34.048-136.362666 135.424H768v48.170667z m-7.594667 163.242667L585.472 768l-34.261333-34.048 136.362666-135.424H258.048v-48.170667h484.096c10.453333 0 19.882667 6.272 23.893333 15.872a25.6 25.6 0 0 1-5.632 27.989334z","p-id":"4860"}))),Hp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4732",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M664.832 634.624l128.554667 128.597333a21.333333 21.333333 0 1 1-30.165334 30.165334l-128.597333-128.597334a256 256 0 1 1 30.165333-30.165333zM469.333333 682.666667a213.333333 213.333333 0 1 0 0-426.666667 213.333333 213.333333 0 0 0 0 426.666667z","p-id":"4733"}))),Fp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4605",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334zM341.333333 383.872H256V768h85.333333V383.872z m426.666667 0H383.872V768H768V383.872z m-149.333333 21.461333a64 64 0 0 1 63.701333 57.856L682.666667 469.333333v64h42.666666v213.333334h-298.666666v-213.333334h42.666666V469.333333a64 64 0 0 1 57.856-63.701333L533.333333 405.333333h85.333334z m64 170.666667h-213.333334v128h213.333334v-128z m-106.666667 21.333333a21.333333 21.333333 0 0 1 21.333333 21.333334v42.666666a21.333333 21.333333 0 1 1-42.666666 0v-42.666666a21.333333 21.333333 0 0 1 21.333333-21.333334z m42.666667-149.333333h-85.333334a21.333333 21.333333 0 0 0-20.992 17.493333L512 469.333333v64h128V469.333333a21.333333 21.333333 0 0 0-13.909333-20.010666l-3.584-0.981334-3.84-0.341333zM768 256H383.872v85.290667L768 341.333333V256zM341.333333 256H256v85.333333l85.333333-0.042666V256z","p-id":"4606"}))),zp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5579",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M618.666667 723.584V661.333333a21.333333 21.333333 0 1 1 42.666666 0v62.250667a128.128 128.128 0 0 0 104.917334-104.917333H704a21.333333 21.333333 0 1 1 0-42.666667h62.250667a128.128 128.128 0 0 0-104.917334-104.874667V533.333333a21.333333 21.333333 0 1 1-42.666666 0v-62.208a128.085333 128.085333 0 0 0-104.874667 104.874667H576a21.333333 21.333333 0 0 1 0 42.666667h-62.208a128.128 128.128 0 0 0 104.874667 104.917333z m149.333333-296.96a213.12 213.12 0 0 0-42.666667-24.874667V277.333333a21.333333 21.333333 0 0 0-21.333333-21.333333h-426.666667a21.333333 21.333333 0 0 0-21.333333 21.333333v341.333334a21.333333 21.333333 0 0 0 21.333333 21.333333h153.6c2.986667 14.848 7.594667 29.098667 13.482667 42.666667H256a42.666667 42.666667 0 0 1-42.666667-42.666667V256a42.666667 42.666667 0 0 1 42.666667-42.666667h469.333333a42.666667 42.666667 0 0 1 42.666667 42.666667v170.666667zM640 768a170.666667 170.666667 0 1 1 0-341.333333 170.666667 170.666667 0 0 1 0 341.333333z","p-id":"5580"}))),Up=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em"},Kd("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"5319"}),Kd("path",{d:"M256 512h256v42.666667H256zM554.666667 256v298.666667h-42.666667V256z","p-id":"5320"}),Kd("path",{d:"M405.333333 256v298.666667h-42.666666V256z","p-id":"5321"}))),Wp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5447",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M256 256h554.666667v42.666667H256z","p-id":"5448"}),Kd("path",{d:"M298.666667 256v554.666667H256V256zM810.666667 256v554.666667h-42.666667V256zM469.333333 256v554.666667h-42.666666V256zM640 256v554.666667h-42.666667V256z","p-id":"5449"}),Kd("path",{d:"M256 426.666667h554.666667v42.666666H256zM256 597.333333h554.666667v42.666667H256zM256 768h554.666667v42.666667H256z","p-id":"5450"}))),Vp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5576",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M810.666667 213.333333v42.666667h-170.709334L640 768h170.666667v42.666667h-213.333334V213.333333h213.333334z m-384 0l-0.042667 554.666667H426.666667v42.666667H213.333333v-42.666667h170.624L384 256H213.333333V213.333333h213.333334z m106.666666 512v85.333334h-42.666666v-85.333334h42.666666z m0-170.666666v85.333333h-42.666666v-85.333333h42.666666z m0-170.666667v85.333333h-42.666666V384h42.666666z m0-170.666667v85.333334h-42.666666V213.333333h42.666666z","p-id":"5577"}))),jp=e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6094",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M913.988 173.68H110.05c-25.671 0-46.676 21.007-46.676 46.679v665.897c0 25.651 20.987 46.638 46.637 46.638H913.95c25.671 0 46.676-21.004 46.676-46.676V220.32c0-25.651-20.988-46.64-46.638-46.64zM339.796 896.142c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V768.023c0-12.014 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.338-21.303-21.353V543.029c0-12.013 9.338-21.354 21.303-21.354h213.627c11.965 0 21.305 9.34 21.305 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V319.596c0-12.013 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118zM639.269 896.14c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V768.023c0-12.014 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.338-21.305-21.353V543.029c0-12.013 9.34-21.354 21.305-21.354h213.626c11.966 0 21.306 9.34 21.306 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V319.596c0-12.013 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118zM941.864 896.14c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V768.023c0-12.014 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.338-21.304-21.353V543.029c0-12.013 9.338-21.354 21.304-21.354h213.626c11.966 0 21.304 9.34 21.304 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V319.596c0-12.013 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z","p-id":"6095"})));var Yp={CommentIcon:kp,FreezeIcon:Lp,conditionalFormatIcon:Dp,DivideIcon:Pp,ReplaceIcon:Bp,SearchIcon:Hp,LockIcon:Fp,LocationIcon:zp,PageIcon:Up,RegularIcon:Wp,LayoutIcon:Vp,TableIcon:jp};var Gp={PrintIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4476",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M743.125333 341.333333c35.669333 0 64.384 28.885333 67.285334 65.024l0.256 6.101334V682.666667h-149.76v-42.666667H768V412.458667c0-14.592-9.514667-26.154667-21.333333-28.16L743.168 384H280.874667c-12.16 0-22.784 10.24-24.576 24.149333l-0.298667 4.266667V640h127.36v42.666667H213.333333V412.458667c0-36.906667 26.794667-67.712 61.653334-70.826667L280.874667 341.333333h462.250666z","p-id":"4477"}),Kd("path",{d:"M682.666667 213.333333H341.333333v170.666667h341.333334V213.333333z m-42.666667 42.666667v85.333333H384V256h256zM682.666667 554.666667v256H341.333333v-256h341.333334z m-42.666667 42.666666H384v170.666667h256v-170.666667z","p-id":"4478"}),Kd("path",{d:"M341.333333 426.666667h128v42.666666H341.333333z","p-id":"4479"}))),ScreenshotIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5374",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M590.848 567.04l-265.386667-306.645333a28.245333 28.245333 0 0 1 3.2-40.149334 29.141333 29.141333 0 0 1 40.789334 3.242667l267.946666 309.674667a124.885333 124.885333 0 0 1 144.213334 34.474666 125.141333 125.141333 0 0 1-16.042667 176.256 125.141333 125.141333 0 0 1-176.341333-14.805333 125.013333 125.013333 0 0 1 1.621333-162.048z m40.149333 18.133333c-18.602667 15.701333-29.312 38.826667-29.312 63.189334 0 45.909333 37.461333 83.157333 83.754667 83.157333a83.413333 83.413333 0 0 0 83.712-83.157333 83.413333 83.413333 0 0 0-83.712-83.114667c-15.189333 0-29.44 4.010667-41.685333 11.008a28.458667 28.458667 0 0 1-12.757334 8.96v-0.042667z m-150.698666-52.565333l-38.229334 44.16a29.653333 29.653333 0 0 1-0.768 0.810667 124.885333 124.885333 0 0 1-6.528 151.509333 125.141333 125.141333 0 0 1-176.341333 14.805333C205.226667 699.306667 198.101333 620.373333 242.346667 567.637333a124.928 124.928 0 0 1 156.416-28.544l38.528-44.501333c9.514667 17.237333 24.746667 30.634667 43.008 37.973333z m105.6-122.026667a85.632 85.632 0 0 0-43.818667-37.12l129.749333-150.016a29.141333 29.141333 0 0 1 40.789334-3.242666 28.245333 28.245333 0 0 1 3.2 40.149333l-129.92 150.186667z m-300.8 301.44c35.413333 29.738667 88.064 25.301333 117.546666-9.813333a83.413333 83.413333 0 0 0-10.666666-117.546667 83.456 83.456 0 0 0-117.589334 9.856 83.456 83.456 0 0 0 10.709334 117.504z","p-id":"5375"}))),PrintAreaIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5706",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM362.666667 725.333333v42.666667h-128v-42.666667h128z m128 0v42.666667h-42.666667v-42.666667h42.666667z m301.696-143.957333a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2zM256 533.333333v128H213.333333v-128h42.666667z m411.477333 85.845334H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333zM768 362.666667v128h-42.666667v-128h42.666667z m-512-42.666667v128H213.333333v-128h42.666667zM768 213.333333v64h-42.666667V256h-64V213.333333H768zM362.666667 213.333333v42.666667H256v21.333333H213.333333V213.333333h149.333334z m213.333333 0v42.666667h-128V213.333333h128z","p-id":"5707"}))),PrintTitleIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5833",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM768 213.333333v277.333334h-42.666667V256H256v469.333333h234.666667v42.666667H213.333333V213.333333h554.666667z m24.362667 368.042667a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2z m-124.885334 37.802667H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333z","p-id":"5834"}),Kd("path",{d:"M341.333333 341.333333h298.666667v42.666667H341.333333zM341.333333 426.666667h170.666667v42.666666H341.333333z",fill:"#444D5A","p-id":"5835"}))),ImageIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5815",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z",fill:"#444D5A","p-id":"5816"})))};var Xp,$p,Qp,Kp,Zp,qp,Jp,eb={Close:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"logo",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4224",width:"1em",height:"1em",fill:"currentColor"},Kd("path",{d:"M119.808 180.053333l60.330667-60.245333 724.053333 724.053333-60.330667 60.330667z","p-id":"4225"}),Kd("path",{d:"M843.946667 119.808l60.245333 60.330667-724.053333 724.053333-60.330667-60.330667z","p-id":"4226"}))),DropDownIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"dropdown",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4519",width:"1em",height:"1em"},Kd("path",{d:"M149.930667 444.330667l60.330666-60.330667 362.069334 362.069333L512 806.4z",fill:"#B5B8BD","p-id":"4520"}),Kd("path",{d:"M813.738667 384l60.330666 60.330667L512 806.4l-60.330667-60.330667z",fill:"#B5B8BD","p-id":"4521"})))},tb=Object.freeze(Object.defineProperty({__proto__:null,LoadingIcon:Bm,LogoIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"logo",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 4864 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8477",fill:"currentColor"},Kd("path",{d:"M1023.168 131.36c0 234.4-190.016 424.416-424.416 424.416 0-234.4 190.016-424.416 424.416-424.416zM131.36 1023.168c0-234.4 190.016-424.416 424.416-424.416 0 234.4-190.016 424.416-424.416 424.416zM929.696 929.696c-182.784 0-330.944-148.16-330.944-330.944 182.752 0 330.944 148.16 330.944 330.944z",fill:"#2D7FF9","p-id":"8478"}),Kd("path",{d:"M494.848 0H0v494.848h494.848z",fill:"#2D7FF9",opacity:".503","p-id":"8479"}),Kd("path",{d:"M558.016 81.376H81.376v476.64h476.64z",fill:"#2D7FF9",opacity:".551","p-id":"8480"}),Kd("path",{d:"M558.304 164.416H164.384v393.92h393.92z",fill:"#2D7FF9",opacity:".805","p-id":"8481"}),Kd("path",{d:"M1678.08 736v-64h-247.04V279.04H1356.8V736h321.28z m177.568 8.96c40.96 0 75.52-17.28 103.68-51.84V736h72.96V405.12h-72.96v202.24c-6.4 23.68-17.28 42.24-32 56.32-14.72 13.44-30.08 20.48-46.08 20.48-25.6 0-43.52-6.4-55.04-18.56-11.52-12.8-16.64-32-16.64-58.88v-201.6h-72.96v206.08c0 88.96 39.68 133.76 119.04 133.76z m407.936 0c42.88 0 77.44-10.88 103.04-32 26.24-21.76 43.52-55.04 51.2-99.84h-72.32c-5.76 48-32.64 72.32-81.28 72.32-28.16 0-49.28-10.24-63.36-30.08-15.36-20.48-22.4-49.28-22.4-85.76 0-35.84 7.68-64 23.04-83.84 15.36-20.48 36.48-30.08 63.36-30.08 21.76 0 39.68 5.12 53.12 15.36 12.8 10.24 21.76 25.6 26.24 46.72h72.32c-6.4-41.6-23.04-72.32-49.28-92.8-25.6-19.2-59.52-28.8-102.4-28.8-51.84 0-92.16 17.28-120.96 51.84-26.88 31.36-40.32 72.32-40.32 122.24 0 51.2 13.44 92.8 40.96 124.8 28.16 33.28 67.84 49.92 119.04 49.92z m292.128-8.96v-115.84l33.28-31.36 115.84 147.2h93.44l-159.36-193.92 146.56-136.96h-94.08l-135.68 131.2V270.08h-72.96V736h72.96z m404.096 126.72l179.2-457.6h-79.36l-83.84 235.52-87.68-235.52h-79.36l131.2 323.2-58.24 134.4h78.08z m357.408-117.76c99.2 0 149.12-35.2 149.12-105.6 0-29.44-13.44-53.12-39.68-69.76-17.92-12.16-46.08-22.4-83.2-31.36-33.28-8.32-55.04-14.72-65.92-19.2-17.92-7.68-26.24-17.28-26.24-27.52 0-12.8 5.12-21.76 16.64-27.52 9.6-5.76 24.32-8.32 43.52-8.32 22.4 0 39.04 3.2 49.92 10.24 10.24 6.4 17.92 18.56 23.04 35.2h71.04c-7.68-70.4-55.68-104.96-142.72-104.96-40.96 0-73.6 8.32-98.56 26.24-25.6 16.64-37.76 40.32-37.76 71.04 0 28.8 12.8 51.2 38.4 67.2 16 10.24 43.52 19.84 82.56 28.8 33.28 7.68 55.04 13.44 65.28 18.56 19.2 8.96 28.8 21.12 28.8 36.48 0 26.88-25.6 40.96-76.8 40.96-24.32 0-41.6-4.48-52.48-12.16-10.88-8.96-18.56-23.68-22.4-44.8h-71.04c7.04 77.44 56.32 116.48 148.48 116.48z m286.976-8.96v-184.96c0-28.16 6.4-50.56 19.84-68.48 12.8-17.92 30.72-26.88 53.76-26.88 24.96 0 43.52 7.68 56.32 23.68 10.88 14.72 16.64 36.48 16.64 64.64v192h72.96v-204.8c0-44.16-9.6-77.44-28.16-99.84-19.84-23.68-49.92-35.2-90.24-35.2-21.12 0-39.68 3.84-55.68 12.16-17.92 8.96-33.28 22.4-45.44 40.96v-179.2h-72.96V736h72.96z m447.648 8.96c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m285.088 209.28c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m310.016 200.32v-60.16h-43.52c-7.68 0-12.8-1.92-16.64-5.76-3.84-4.48-5.12-10.24-5.12-17.92v-186.88h73.6v-60.16h-73.6V298.24l-72.96 30.08v76.8h-59.52v60.16h59.52v186.88c0 26.88 6.4 46.72 19.2 60.8 13.44 15.36 34.56 23.04 63.36 23.04h55.68z",fill:"#7C838C","p-id":"8482"}))),DeleteIcon:e=>Kd(Pm,{spin:e.spin,rotate:e.rotate,name:"logo",style:e.style},Kd("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1214",width:"1em",height:"1em"},Kd("path",{d:"M840 288H688v-56c0-40-32-72-72-72h-208C368 160 336 192 336 232V288h-152c-12.8 0-24 11.2-24 24s11.2 24 24 24h656c12.8 0 24-11.2 24-24s-11.2-24-24-24zM384 288v-56c0-12.8 11.2-24 24-24h208c12.8 0 24 11.2 24 24V288H384zM758.4 384c-12.8 0-24 11.2-24 24v363.2c0 24-19.2 44.8-44.8 44.8H332.8c-24 0-44.8-19.2-44.8-44.8V408c0-12.8-11.2-24-24-24s-24 11.2-24 24v363.2c0 51.2 41.6 92.8 92.8 92.8h358.4c51.2 0 92.8-41.6 92.8-92.8V408c-1.6-12.8-12.8-24-25.6-24z","p-id":"1215"}),Kd("path",{d:"M444.8 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24zM627.2 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24z","p-id":"1216"}))),Math:Hm,Font:jm,Cell:rp,Text:vp,Insert:Cp,Format:Mp,Data:Np,Sheet:Yp,View:Gp,Other:eb,BackIcon:Tp,ForwardIcon:wp,FormatIcon:yp,NextIcon:Sp,RightIcon:Ep,CorrectIcon:Rp,LtIcon:Ip,CloseIcon:Ap,MenuIcon:xp,HideIcon:Op,BoldIcon:Fm,ItalicIcon:zm,DeleteLineIcon:Um,UnderLineIcon:Wm,TextColorIcon:Vm,FillColorIcon:Ym,FullBorderIcon:Gm,TopBorderIcon:Xm,BottomBorderIcon:$m,LeftBorderIcon:Qm,RightBorderIcon:Km,NoneBorderIcon:Zm,OuterBorderIcon:qm,InnerBorderIcon:Jm,StripingBorderIcon:ep,VerticalBorderIcon:tp,MergeIcon:np,LeftAlignIcon:sp,CenterAlignIcon:op,RightAlignIcon:ip,TopVerticalIcon:lp,CenterVerticalIcon:ap,BottomVerticalIcon:cp,TextRotateIcon:hp,TextRotateAngleUpIcon:up,TextRotateAngleDownIcon:dp,TextRotateVerticalIcon:gp,TextRotateRotationUpIcon:fp,TextRotateRotationDownIcon:mp,BrIcon:pp,OverflowIcon:bp,CutIcon:_p,CommentIcon:kp,FreezeIcon:Lp,conditionalFormatIcon:Dp,DivideIcon:Pp,ReplaceIcon:Bp,SearchIcon:Hp,LockIcon:Fp,LocationIcon:zp,PageIcon:Up,RegularIcon:Wp,LayoutIcon:Vp,TableIcon:jp},Symbol.toStringTag,{value:"Module"}));class nb{constructor(){this._componentList=new Map;const e={ForwardIcon:wp,BackIcon:Tp,BoldIcon:Fm,ItalicIcon:zm,DeleteLineIcon:Um,UnderLineIcon:Wm,TextColorIcon:Vm,FillColorIcon:Ym,MergeIcon:np,TopBorderIcon:Xm,BottomBorderIcon:$m,LeftBorderIcon:Qm,RightBorderIcon:Km,NoneBorderIcon:Zm,FullBorderIcon:Gm,OuterBorderIcon:qm,InnerBorderIcon:Jm,StripingBorderIcon:ep,VerticalBorderIcon:tp,LeftAlignIcon:sp,CenterAlignIcon:op,RightAlignIcon:ip,TopVerticalIcon:lp,CenterVerticalIcon:ap,BottomVerticalIcon:cp,OverflowIcon:bp,BrIcon:pp,CutIcon:_p,TextRotateIcon:hp,TextRotateAngleUpIcon:up,TextRotateAngleDownIcon:dp,TextRotateVerticalIcon:gp,TextRotateRotationUpIcon:fp,TextRotateRotationDownIcon:mp,BorderThin:am,BorderHair:cm,BorderDotted:hm,BorderDashed:um,BorderDashDot:dm,BorderDashDotDot:gm,BorderMedium:fm,BorderMediumDashed:mm,BorderMediumDashDot:pm,BorderMediumDashDotDot:bm,BorderThick:_m};for(let t in e)this.register(t,e[t])}register(e,t){this._componentList.set(e,t)}get(e){return this._componentList.get(e)}delete(e){this._componentList.delete(e)}}class rb{constructor(e){this._plugin=e,this.initialize()}initialize(){this.setClipboardExtensionManager(),this.setDragAndDropExtensionManager()}setClipboardExtensionManager(){this._clipboardExtensionManager=new Hg;const e=this._plugin.getGlobalContext().getObserverManager().getObserver("onKeyPasteObservable","core");e&&!e.hasObservers()&&e.add((e=>{this._clipboardExtensionManager.pasteResolver(e).then((e=>{this._clipboardExtensionManager.handle(e)}))}))}setDragAndDropExtensionManager(){this._dragAndDropExtensionManager=new Wg;const e=this._plugin.getGlobalContext().getObserverManager().getObserver("onDropObservable","core");e&&!e.hasObservers()&&e.add((e=>{this._dragAndDropExtensionManager.dragResolver(e).then((e=>{0!==e.length&&this._dragAndDropExtensionManager.handle(e)}))}))}getClipboardExtensionManager(){return this._clipboardExtensionManager}getDragAndDropExtensionManager(){return this._dragAndDropExtensionManager}onMounted(){this.initialize()}onDestroy(){}}function sb(e){var t;let n=e.childNodes;if(0===n.length)return e.textContent;if("DIV"===n[0].nodeName&&(n=n[0].childNodes),1===n.length&&"#text"===n[0].nodeName)return n[0].textContent;const r=[];let s=0;for(let i=0;i<n.length;i++){let e,o=n[`${i}`];"#text"===o.nodeName?(e=null!=(t=o.textContent)?t:"",o=o.parentElement):e=o.innerText;let l=ob(o);ib(e).forEach((e=>{s=+e.length;let t=C.generateRandomId(6);r.push({eId:t,st:0,ed:e.length-1,et:0,tr:{ct:e,ts:l}})}))}const o=C.generateRandomId(6);return{id:C.generateRandomId(6),body:{blockElements:[{blockId:o,st:0,ed:s,blockType:0,paragraph:{elements:r}},{blockId:"b",st:0,ed:0,blockType:I.SECTION_BREAK,sectionBreak:{columnProperties:[],columnSeparatorType:1,sectionType:0}}]},documentStyle:{}}}function ob(e,t=""){var n;let r=null!=(n=e.style.cssText)?n:"";if(r+=t,null==r||0===r.length)return{};r+=t;let s=r.split(";"),o={};return s.forEach((t=>{let n=Om((t=t.toLowerCase()).substr(0,t.indexOf(":"))),s=Om(t.substr(t.indexOf(":")+1));if("font-weight"===n)o.bl="bold"===s?1:0;else if("font-style"===n)o.it="italic"===s?1:0;else if("font-family"===n)o.ff=s;else if("font-size"===n){let e=parseInt(s);r.indexOf("vertical-align")>-1&&(r.indexOf("sub")>-1||r.indexOf("sup")>-1)&&(e*=2),-1!==s.indexOf("px")&&(e=Jl(parseInt(s))),o.fs=e}else"color"===n?o.cl={rgb:s}:"background"===n||"background-color"===n?o.bg={rgb:s}:"text-decoration-line"===n?"underline"===s?(o.ul||(o.ul={s:1}),o.ul.s=1):"line-through"===s?(o.st||(o.st={s:1}),o.st.s=1):"overline"===s&&(o.ol||(o.ol={s:1}),o.ol.s=1):"text-decoration-color"===n?(o.hasOwnProperty("ul")&&(o.ul||(o.ul={s:1,cl:{rgb:s}}),o.ul.cl={rgb:s}),o.hasOwnProperty("st")&&(o.st||(o.st={s:1,cl:{rgb:s}}),o.st.cl={rgb:s}),o.hasOwnProperty("ol")&&(o.ol||(o.ol={s:1,cl:{rgb:s}}),o.ol.cl={rgb:s})):"text-decoration-style"===n?(o.hasOwnProperty("ul")&&(o.ul||(o.ul={s:1,t:Number(s)}),o.ul.t=Number(s)),o.hasOwnProperty("st")&&(o.st||(o.st={s:1,t:Number(s)}),o.st.t=Number(s)),o.hasOwnProperty("ol")&&(o.ol||(o.ol={s:1,t:Number(s)}),o.ol.t=Number(s))):"text-decoration"!==n&&"univer-strike"!==n||(o.st={s:1});if("univer-underline"===n&&(o.ul={s:1}),"vertical-align"===n&&("sub"===s?o.va=1:"super"===s?o.va=2:"top"===s?o.vt=1:"middle"===s?o.vt=2:"bottom"===s?o.vt=3:o.va=0),"transform"===n){const t=s.split(")"),n=t.findIndex((e=>e.includes("rotate")));if(n>-1){const r=t[n].match(/\d+/g);let s=0,i=0;(null==r?void 0:r.length)&&(s=+r[0]),e.dataset.vertical&&(i=+e.dataset.vertical),o.tr={a:s,v:i}}}if("text-align"===n&&(o.ht="left"===s?1:"center"===s?2:"right"===s?3:"justify"===s?4:0),"overflow-wrap"!==n&&"overflowWrap"!==n||"break-word"===s&&(o.tb=3),"border-color"===n&&(o.bd||(o.bd={b:{cl:{rgb:s},s:0},t:{cl:{rgb:s},s:0},l:{cl:{rgb:s},s:0},r:{cl:{rgb:s},s:0}}),o.bd.b.cl.rgb=s,o.bd.t.cl.rgb=s,o.bd.l.cl.rgb=s,o.bd.r.cl.rgb=s),"border-bottom"===n||"border-top"===n||"border-left"===n||"border-right"===n||"border"===n){o.bd||(o.bd={});const e=s.split(" "),t=`${e[0]} ${e[1]}`;e.splice(0,2);const r={cl:{rgb:e.join("")},s:Bn(t)};"border-bottom"===n?o.bd.b="none"===s?null:r:"border-top"===n?o.bd.t="none"===s?null:r:"border-left"===n?o.bd.l="none"===s?null:r:"border-right"===n?o.bd.r="none"===s?null:r:"border"===n&&(o.bd={r:"none"===s?null:r,t:"none"===s?null:r,b:"none"===s?null:r,l:"none"===s?null:r})}})),o}function ib(e){if(""===e)return[e];return e.match(/(?:(\n+.+)|(.+))/g).map((e=>e.replace(/\n/g,"\r\n")))}function lb(e){const t=document.createElement("DIV");let n=[];t.innerHTML=e;let r=t.querySelectorAll("table col");if(!r.length)return[];for(let s=0;s<r.length;s++){const e=r[s],t=e.getAttribute("span");if(t&&+t>1)for(let r=0;r<+t;r++){const t=ab(e.getAttribute("width"),72);n.push(t)}else{const t=ab(e.getAttribute("width"),72);n.push(t)}}return n}function ab(e,t){if(!e)return t;let n;return n=e.includes("pt")?ql(parseFloat(e)):e.includes("px")?parseFloat(e):72*parseFloat(e)/96,n}function cb(e){const t=document.createElement("DIV");let n=[];t.innerHTML=e;let r=t.querySelectorAll("table tr");if(!r.length)return[];for(let s=0;s<r.length;s++){const e=r[s].querySelectorAll("td");let t=ab(e[0].style.height,19);for(let n=0;n<e.length;n++){const r=e[n].getAttribute("rowSpan");if(!(r&&+r>1)){t=ab(e[n].style.height,19);break}}n.push(t)}return n}function hb(e){let t=[];const n=document.createElement("DIV");if(n.innerHTML=e,t=new Array(n.querySelectorAll("table tr").length),!t.length)return[];let r=0;const s=n.querySelectorAll("table tr");s[0].querySelectorAll("td").forEach((e=>{let t=0;const n=e.getAttribute("colSpan");t=null!==n?+n:1,r+=t}));for(let i=0;i<t.length;i++)t[i]=new Array(r);let o=0;return s.forEach((e=>{let n=0;e.querySelectorAll("td").forEach((e=>{var s,i;let l={};if(e.querySelectorAll("span").length||e.querySelectorAll("font").length){const t=sb(e);"string"!=typeof t&&(l.p=t)}let a=e.innerText;0===a.trim().length?(l.v="",l.m=""):(l.v=a,l.m=a);const c=ob(e);for(C.isPlainObject(c)&&(l.s=c);n<r&&null!=t[o][n];)n++;if(n!==r){if(null==t[o][n]){t[o][n]=l;let r=null!=(s=e.getAttribute("rowSpan"))?s:1,a=null!=(i=e.getAttribute("colSpan"))?i:1;if(r>1||a>1){let e={rs:+r-1,cs:+a-1,r:o,c:n};t[o][n].mc=e;for(let s=0;s<r;s++)for(let e=0;e<a;e++)0===s&&0===e||(t[o+s][n+e]={mc:null})}}n++}})),o++})),t}function ub(e){let t=[];document.createElement("DIV").innerHTML=e;let n=e.replace(/\r/g,"").split("\n"),r=n[0].split("\t").length;for(let s=0;s<n.length;s++)n[s].split("\t").length<r||t.push(n[s].split("\t"));for(let s=0;s<t.length;s++)for(let e=0;e<t[s].length;e++)t[s][e].length?t[s][e]={v:t[s][e]||"",m:t[s][e]||""}:t[s][e]=null;return t}function db(e,t){e.length,e[0].length;let n=0,r=0;t&&(n=t.startRow,r=t.startColumn);const s=[];for(let o=0;o<e.length;o++)for(let t=0;t<e[o].length;t++)if(e[o][t]&&"object"==typeof e[o][t]&&"mc"in e[o][t])if(e[o][t].mc){const i=e[o][t].mc,l=i.r+n,a=l+i.rs,c=i.c+r,h=c+i.cs;s.push({startRow:l,endRow:a,startColumn:c,endColumn:h}),delete e[o][t].mc}else e[o][t]=null;return{data:e,mergeData:s}}function gb(e){var t;let n=[];const r=document.createElement("html");r.innerHTML=e;const s=null==(t=r.querySelector("style"))?void 0:t.innerText;if(!s)return;const o=function(e){let t={};const n=e.slice(5,-4),r=null==n?void 0:n.replaceAll("\t","").replaceAll("\n","").split("}");for(let s=0;s<r.length;s++){if(!r[s])continue;const e=r[s].split("{")[0].trim().slice(1),n=r[s].split("{")[1].trim();t[e]=n}return t}(s);if(n=new Array(r.querySelectorAll("table tr").length),!n.length)return[];let i=0;const l=r.querySelectorAll("table tr");l[0].querySelectorAll("td").forEach((e=>{let t=0;const n=e.getAttribute("colSpan");t=null!==n?+n:1,i+=t}));for(let c=0;c<n.length;c++)n[c]=new Array(i);let a=0;return l.forEach((e=>{let t=0;e.querySelectorAll("td").forEach((e=>{var r,s;let l={};if(e.querySelectorAll("span").length||e.querySelectorAll("font").length){const t=sb(e);"string"!=typeof t&&(l.p=t)}let c=e.innerText;0===c.trim().length?(l.v="",l.m=""):(l.v=c,l.m=c);let h="";for(let t in o)e.classList.contains(t)&&(h+=o[t]);const u=ob(e,h);for(C.isPlainObject(u)&&(l.s=u);t<i&&null!=n[a][t];)t++;if(t!==i){if(null==n[a][t]){n[a][t]=l;let o=null!=(r=e.getAttribute("rowSpan"))?r:1,i=null!=(s=e.getAttribute("colSpan"))?s:1;if(o>1||i>1){let e={rs:+o-1,cs:+i-1,r:a,c:t};n[a][t].mc=e;for(let r=0;r<o;r++)for(let e=0;e<i;e++)0===r&&0===e||(n[a+r][t+e]={mc:null})}}t++}})),a++})),n}($p=Xp||(Xp={}))[$p.Button=0]="Button",$p[$p.SingleButton=1]="SingleButton",$p[$p.Select=2]="Select",$p[$p.Container=3]="Container",$p[$p.CellRangeModal=4]="CellRangeModal",$p[$p.Modal=5]="Modal",$p[$p.SiderModal=6]="SiderModal",$p[$p.Layout=7]="Layout",$p[$p.Header=8]="Header",$p[$p.Footer=9]="Footer",$p[$p.Content=10]="Content",$p[$p.Sider=11]="Sider",$p[$p.Demo=12]="Demo",$p[$p.Checkbox=13]="Checkbox",$p[$p.CheckboxGroup=14]="CheckboxGroup",$p[$p.ColorPicker=15]="ColorPicker",$p[$p.ColorPickerCircleButton=16]="ColorPickerCircleButton",$p[$p.Input=17]="Input",$p[$p.Radio=18]="Radio",$p[$p.RadioGroup=19]="RadioGroup",$p[$p.Tab=20]="Tab",$p[$p.TabPane=21]="TabPane",$p[$p.Avatar=22]="Avatar",$p[$p.Tooltip=23]="Tooltip",$p[$p.Ul=24]="Ul",$p[$p.Collapse=25]="Collapse",$p[$p.Panel=26]="Panel",$p[$p.FormatModal=27]="FormatModal",$p[$p.RichText=28]="RichText",$p[$p.NextIcon=29]="NextIcon",$p[$p.RightIcon=30]="RightIcon",$p[$p.OrderIcon=31]="OrderIcon",$p[$p.CommentIcon=32]="CommentIcon",$p[$p.ConditionalFormatIcon=33]="ConditionalFormatIcon",$p[$p.ScreenshotIcon=34]="ScreenshotIcon",$p[$p.CheckIcon=35]="CheckIcon",$p[$p.SearchIcon=36]="SearchIcon",$p[$p.ReplaceIcon=37]="ReplaceIcon",$p[$p.FreezeIcon=38]="FreezeIcon",$p[$p.PivotableIcon=39]="PivotableIcon",$p[$p.FillColorIcon=40]="FillColorIcon",$p[$p.BoldIcon=41]="BoldIcon",$p[$p.FullBorderIcon=42]="FullBorderIcon",$p[$p.TopBorderIcon=43]="TopBorderIcon",$p[$p.BottomBorderIcon=44]="BottomBorderIcon",$p[$p.LeftBorderIcon=45]="LeftBorderIcon",$p[$p.RightBorderIcon=46]="RightBorderIcon",$p[$p.NoneBorderIcon=47]="NoneBorderIcon",$p[$p.OuterBorderIcon=48]="OuterBorderIcon",$p[$p.InnerBorderIcon=49]="InnerBorderIcon",$p[$p.StripingBorderIcon=50]="StripingBorderIcon",$p[$p.VerticalBorderIcon=51]="VerticalBorderIcon",$p[$p.MergeIcon=52]="MergeIcon",$p[$p.SumIcon=53]="SumIcon",$p[$p.OrderDESCIcon=54]="OrderDESCIcon",$p[$p.OrderASCIcon=55]="OrderASCIcon",$p[$p.FilterIcon=56]="FilterIcon",$p[$p.FilterRankIcon=57]="FilterRankIcon",$p[$p.CleanIcon=58]="CleanIcon",$p[$p.DeleteIcon=59]="DeleteIcon",$p[$p.DeleteLineIcon=60]="DeleteLineIcon",$p[$p.UnderLineIcon=61]="UnderLineIcon",$p[$p.ItalicIcon=62]="ItalicIcon",$p[$p.TextColorIcon=63]="TextColorIcon",$p[$p.BackIcon=64]="BackIcon",$p[$p.ForwardIcon=65]="ForwardIcon",$p[$p.FormatIcon=66]="FormatIcon",$p[$p.CorrectIcon=67]="CorrectIcon",$p[$p.LtIcon=68]="LtIcon",$p[$p.CloseIcon=69]="CloseIcon",$p[$p.DropDownIcon=70]="DropDownIcon",$p[$p.MenuIcon=71]="MenuIcon",$p[$p.HideIcon=72]="HideIcon",$p[$p.PhotoIcon=73]="PhotoIcon",$p[$p.LinkIcon=74]="LinkIcon",$p[$p.ChartIcon=75]="ChartIcon",$p[$p.LoadingIcon=76]="LoadingIcon",$p[$p.LogoIcon=77]="LogoIcon",$p[$p.AddNumIcon=78]="AddNumIcon",$p[$p.ReduceNumIcon=79]="ReduceNumIcon",$p[$p.PercentIcon=80]="PercentIcon",$p[$p.MoneyIcon=81]="MoneyIcon",$p[$p.FxIcon=82]="FxIcon",$p[$p.AddIcon=83]="AddIcon",$p[$p.ReduceIcon=84]="ReduceIcon",$p[$p.DivideIcon=85]="DivideIcon",$p[$p.LockIcon=86]="LockIcon",$p[$p.LocationIcon=87]="LocationIcon",$p[$p.PageIcon=88]="PageIcon",$p[$p.RegularIcon=89]="RegularIcon",$p[$p.LayoutIcon=90]="LayoutIcon",$p[$p.TableIcon=91]="TableIcon",$p[$p.ImageIcon=92]="ImageIcon",$p[$p.LeftAlignIcon=93]="LeftAlignIcon",$p[$p.CenterAlignIcon=94]="CenterAlignIcon",$p[$p.RightAlignIcon=95]="RightAlignIcon",$p[$p.TopVerticalIcon=96]="TopVerticalIcon",$p[$p.CenterVerticalIcon=97]="CenterVerticalIcon",$p[$p.BottomVerticalIcon=98]="BottomVerticalIcon",$p[$p.TextRotateIcon=99]="TextRotateIcon",$p[$p.TextRotateAngleUpIcon=100]="TextRotateAngleUpIcon",$p[$p.TextRotateAngleDownIcon=101]="TextRotateAngleDownIcon",$p[$p.TextRotateVerticalIcon=102]="TextRotateVerticalIcon",$p[$p.TextRotateRotationUpIcon=103]="TextRotateRotationUpIcon",$p[$p.TextRotateRotationDownIcon=104]="TextRotateRotationDownIcon",$p[$p.BrIcon=105]="BrIcon",$p[$p.OverflowIcon=106]="OverflowIcon",$p[$p.CutIcon=107]="CutIcon",$p[$p.PrintIcon=108]="PrintIcon",$p[$p.PrintAreaIcon=109]="PrintAreaIcon",$p[$p.PrintTitleIcon=110]="PrintTitleIcon",$p[$p.BorderDashDot=111]="BorderDashDot",$p[$p.BorderDashDotDot=112]="BorderDashDotDot",$p[$p.BorderDashed=113]="BorderDashed",$p[$p.BorderDotted=114]="BorderDotted",$p[$p.BorderHair=115]="BorderHair",$p[$p.BorderMedium=116]="BorderMedium",$p[$p.BorderMediumDashDot=117]="BorderMediumDashDot",$p[$p.BorderMediumDashDotDot=118]="BorderMediumDashDotDot",$p[$p.BorderMediumDashed=119]="BorderMediumDashed",$p[$p.BorderThick=120]="BorderThick",$p[$p.BorderThin=121]="BorderThin",(Kp=Qp||(Qp={})).BUTTON="Button",Kp.CONTAINER="Container",Kp.CELL_RANGE_MODAL="CellRangeModal",Kp.LAYOUT="Layout",Kp.HEADER="Header",Kp.FOOTER="Footer",Kp.CONTENT="Content",Kp.SIDER="Sider",Kp.DEMO="Demo",Kp.SHEET_CONTAINER="SheetContainer",(qp=Zp||(Zp={})).INPUT="input",qp.COLOR="color",qp.DOUBLE="double",qp.JSX="jsx",qp.INPUT_NUMBER="inputNumber",function(e){e.EN="en",e.ZH="zh"}(Jp||(Jp={}));var fb="univer-avatar";var mb="univer-btn";class pb extends sm{constructor(e){var t;super(),this.handleClick=e=>{const{disabled:t,onClick:n,unActive:r=!0}=this.props;t?e.preventDefault():r?null==n||n(e):this.setState({isActive:!this.state.isActive},(()=>{n&&n.call(null,e,this.state.isActive)}))},this.state={isActive:null!=(t=e.active)&&t}}getSizeCls(){const{size:e}=this.props;let t="";switch(e){case"large":t="lg";break;case"small":t="sm"}return t}getClass(){const{isActive:e}=this.state,{type:t,shape:n,danger:r,block:s,loading:o,size:i,className:l}=this.props;return Em(mb,{[`${mb}-${t}`]:t,[`${mb}-${n}`]:n,[`${mb}-${this.getSizeCls()}`]:i,[`${mb}-danger`]:!!r,[`${mb}-block`]:s,[`${mb}-loading`]:o,[`${mb}-active`]:e},l)}componentWillReceiveProps(e){this.setState({isActive:e.active})}render(){const{htmlType:e,disabled:t,style:n,loading:r,children:s}=this.props;return Kd("button",{type:e,onClick:this.handleClick,className:this.getClass(),disabled:t,style:n},r?Kd(Bm,null):"",s)}}var bb="univer-checkbox-wrapper",_b="univer-check-box",vb="univer-checkbox-input",Cb="univer-checkbox-inner",Tb="univer-checkbox-group";class wb extends sm{constructor(){super(...arguments),this.state={classes:this.props.className?`${this.props.className} ${_b}`:_b,check:!0},this.handleStyle=(e,t)=>{let n=Em(_b,{[`${_b}-checked`]:e,[`${_b}-disabled`]:t});this.setState((t=>({classes:n,check:e})))},this.handleChange=e=>{var t,n;const r=e.target;this.handleStyle(r.checked,this.props.disabled),null==(n=(t=this.props).onChange)||n.call(t,e)}}componentWillMount(){this.handleStyle(this.props.checked,this.props.disabled)}componentWillReceiveProps(e){this.handleStyle(e.checked,e.disabled)}render(e,t){const{classes:n,check:r}=t,{value:s,name:o,disabled:i,children:l}=e;return Kd("label",{className:bb},Kd("span",{className:n},Kd("span",{className:Cb}),Kd("input",{type:"checkbox",name:o,checked:r,disabled:i,className:vb,value:s,onChange:this.handleChange})),l&&Kd("span",null,l))}}var yb={panelWrapper:"univer-panel-wrapper",panelHeader:"univer-panel-header",panelHeaderIcon:"univer-panel-header-icon",panelHeaderIconRotate:"univer-panel-header-icon-rotate",panelBody:"univer-panel-body",active:"univer-active"};function Sb(){return(Sb=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Eb(e,t){if(null==e)return{};var n,r,s={},o=Object.keys(e);for(r=0;r<o.length;r++)t.indexOf(n=o[r])>=0||(s[n]=e[n]);return s}function Rb(e){var t=uf(e),n=uf((function(e){t.current&&t.current(e)}));return t.current=e,n.current}var Ib=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),e>n?n:e<t?t:e},Ab=function(e){return"touches"in e},xb=function(e){return e&&e.ownerDocument.defaultView||self},Ob=function(e,t,n){var r=e.getBoundingClientRect(),s=Ab(t)?function(e,t){for(var n=0;n<e.length;n++)if(e[n].identifier===t)return e[n];return e[0]}(t.touches,n):t;return{left:Ib((s.pageX-(r.left+xb(e).pageXOffset))/r.width),top:Ib((s.pageY-(r.top+xb(e).pageYOffset))/r.height)}},Mb=function(e){!Ab(e)&&e.preventDefault()},Nb=rm.memo((function(e){var t=e.onMove,n=e.onKey,r=Eb(e,["onMove","onKey"]),s=uf(null),o=Rb(t),i=Rb(n),l=uf(null),a=uf(!1),c=df((function(){var e=function(e){Mb(e),(Ab(e)?e.touches.length>0:e.buttons>0)&&s.current?o(Ob(s.current,e,l.current)):n(!1)},t=function(){return n(!1)};function n(n){var r=a.current,o=xb(s.current),i=n?o.addEventListener:o.removeEventListener;i(r?"touchmove":"mousemove",e),i(r?"touchend":"mouseup",t)}return[function(e){var t,r=e.nativeEvent,i=s.current;if(i&&(Mb(r),t=r,(!a.current||Ab(t))&&i)){if(Ab(r)){a.current=!0;var c=r.changedTouches||[];c.length&&(l.current=c[0].identifier)}i.focus(),o(Ob(i,r,l.current)),n(!0)}},function(e){var t=e.which||e.keyCode;t<37||t>40||(e.preventDefault(),i({left:39===t?.05:37===t?-.05:0,top:40===t?.05:38===t?-.05:0}))},n]}),[i,o]),h=c[0],u=c[1],d=c[2];return cf((function(){return d}),[d]),rm.createElement("div",Sb({},r,{onTouchStart:h,onMouseDown:h,className:"react-colorful__interactive",ref:s,onKeyDown:u,tabIndex:0,role:"slider"}))})),kb=function(e){return e.filter(Boolean).join(" ")},Lb=function(e){var t=e.color,n=e.left,r=e.top,s=void 0===r?.5:r,o=kb(["react-colorful__pointer",e.className]);return rm.createElement("div",{className:o,style:{top:100*s+"%",left:100*n+"%"}},rm.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:t}}))},Db=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=Math.pow(10,t)),Math.round(n*e)/n},Pb=function(e){var t=e.s,n=e.v,r=e.a,s=(200-t)*n/100;return{h:Db(e.h),s:Db(s>0&&s<200?t*n/100/(s<=100?s:200-s)*100:0),l:Db(s/2),a:Db(r,2)}},Bb=function(e){var t=Pb(e);return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},Hb=function(e){var t=Pb(e);return"hsla("+t.h+", "+t.s+"%, "+t.l+"%, "+t.a+")"},Fb=function(e){var t=e.r,n=e.g,r=e.b,s=e.a,o=Math.max(t,n,r),i=o-Math.min(t,n,r),l=i?o===t?(n-r)/i:o===n?2+(r-t)/i:4+(t-n)/i:0;return{h:Db(60*(l<0?l+6:l)),s:Db(o?i/o*100:0),v:Db(o/255*100),a:s}},zb=rm.memo((function(e){var t=e.hue,n=e.onChange,r=kb(["react-colorful__hue",e.className]);return rm.createElement("div",{className:r},rm.createElement(Nb,{onMove:function(e){n({h:360*e.left})},onKey:function(e){n({h:Ib(t+360*e.left,0,360)})},"aria-label":"Hue","aria-valuenow":Db(t),"aria-valuemax":"360","aria-valuemin":"0"},rm.createElement(Lb,{className:"react-colorful__hue-pointer",left:t/360,color:Bb({h:t,s:100,v:100,a:1})})))})),Ub=rm.memo((function(e){var t=e.hsva,n=e.onChange,r={backgroundColor:Bb({h:t.h,s:100,v:100,a:1})};return rm.createElement("div",{className:"react-colorful__saturation",style:r},rm.createElement(Nb,{onMove:function(e){n({s:100*e.left,v:100-100*e.top})},onKey:function(e){n({s:Ib(t.s+100*e.left,0,100),v:Ib(t.v-100*e.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+Db(t.s)+"%, Brightness "+Db(t.v)+"%"},rm.createElement(Lb,{className:"react-colorful__saturation-pointer",top:1-t.v/100,left:t.s/100,color:Bb(t)})))}));var Wb="undefined"!=typeof window?hf:cf,Vb=new Map,jb=function(e){Wb((function(){var t=e.current?e.current.ownerDocument:document;if(void 0!==t&&!Vb.has(t)){var n=t.createElement("style");n.innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}',Vb.set(t,n);var r="undefined"!=typeof __webpack_nonce__?__webpack_nonce__:void 0;r&&n.setAttribute("nonce",r),t.head.appendChild(n)}}),[])},Yb=function(e){var t=e.className,n=e.hsva,r=e.onChange,s={backgroundImage:"linear-gradient(90deg, "+Hb(Object.assign({},n,{a:0}))+", "+Hb(Object.assign({},n,{a:1}))+")"},o=kb(["react-colorful__alpha",t]),i=Db(100*n.a);return rm.createElement("div",{className:o},rm.createElement("div",{className:"react-colorful__alpha-gradient",style:s}),rm.createElement(Nb,{onMove:function(e){r({a:e.left})},onKey:function(e){r({a:Ib(n.a+e.left)})},"aria-label":"Alpha","aria-valuetext":i+"%","aria-valuenow":i,"aria-valuemin":"0","aria-valuemax":"100"},rm.createElement(Lb,{className:"react-colorful__alpha-pointer",left:n.a,color:Hb(n)})))},Gb=function(e){var t=e.className,n=e.colorModel,r=e.color,s=void 0===r?n.defaultColor:r,o=e.onChange,i=Eb(e,["className","colorModel","color","onChange"]),l=uf(null);jb(l);var a=function(e,t,n){var r=Rb(n),s=lf((function(){return e.toHsva(t)})),o=s[0],i=s[1],l=uf({color:t,hsva:o});cf((function(){if(!e.equal(t,l.current.color)){var n=e.toHsva(t);l.current={hsva:n,color:t},i(n)}}),[t,e]),cf((function(){var t;(function(e,t){if(e===t)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0})(o,l.current.hsva)||e.equal(t=e.fromHsva(o),l.current.color)||(l.current={hsva:o,color:t},r(t))}),[o,e,r]);var a=gf((function(e){i((function(t){return Object.assign({},t,e)}))}),[]);return[o,a]}(n,s,o),c=a[0],h=a[1],u=kb(["react-colorful",t]);return rm.createElement("div",Sb({},i,{ref:l,className:u}),rm.createElement(Ub,{hsva:c,onChange:h}),rm.createElement(zb,{hue:c.h,onChange:h}),rm.createElement(Yb,{hsva:c,onChange:h,className:"react-colorful__last-control"}))},Xb={defaultColor:"rgba(0, 0, 0, 1)",toHsva:function(e){var t=/rgba?\(?\s*(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i.exec(e);return t?Fb({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):{h:0,s:0,v:0,a:1}},fromHsva:function(e){var t=function(e){var t=e.h,n=e.s,r=e.v,s=e.a;t=t/360*6,n/=100,r/=100;var o=Math.floor(t),i=r*(1-n),l=r*(1-(t-o)*n),a=r*(1-(1-t+o)*n),c=o%6;return{r:Db(255*[r,l,i,i,a,r][c]),g:Db(255*[a,r,r,l,i,i][c]),b:Db(255*[i,i,a,r,r,l][c]),a:Db(s,2)}}(e);return"rgba("+t.r+", "+t.g+", "+t.b+", "+t.a+")"},equal:function(e,t){return e.replace(/\s/g,"")===t.replace(/\s/g,"")}},$b=function(e){return rm.createElement(Gb,Sb({},e,{colorModel:Xb}))},Qb=/^#?([0-9A-F]{3,8})$/i,Kb=function(e){var t=e.color,n=void 0===t?"":t,r=e.onChange,s=e.onBlur,o=e.escape,i=e.validate,l=e.format,a=e.process,c=Eb(e,["color","onChange","onBlur","escape","validate","format","process"]),h=lf((function(){return o(n)})),u=h[0],d=h[1],g=Rb(r),f=Rb(s),m=gf((function(e){var t=o(e.target.value);d(t),i(t)&&g(a?a(t):t)}),[o,a,i,g]),p=gf((function(e){i(e.target.value)||d(o(n)),f(e)}),[n,o,i,f]);return cf((function(){d(o(n))}),[n,o]),rm.createElement("input",Sb({},c,{value:l?l(u):u,spellCheck:"false",onChange:m,onBlur:p}))},Zb=function(e){return"#"+e},qb=function(e){var t=e.prefixed,n=e.alpha,r=Eb(e,["prefixed","alpha"]),s=gf((function(e){return e.replace(/([^0-9A-F]+)/gi,"").substring(0,n?8:6)}),[n]),o=gf((function(e){return t=e,r=n,s=Qb.exec(t),3===(o=s?s[1].length:0)||6===o||!!r&&4===o||!!r&&8===o;var t,r,s,o}),[n]);return rm.createElement(Kb,Sb({},r,{escape:s,format:t?Zb:void 0,process:Zb,validate:o}))};var Jb="univer-input";class e_ extends sm{constructor(){super(...arguments),this.ref={current:null},this.setValue=(e,t)=>{this.setState((t=>({value:e})),t)},this.handleChange=e=>{const{onChange:t}=this.props;if(!t)return;const n=e.target;this.setValue(n.value),t(e)},this.handlePressEnter=e=>{const{onPressEnter:t}=this.props;"Enter"===e.key&&(null==t||t(e),this.ref.current.blur())},this.onFocus=e=>{const{onFocus:t}=this.props;null==t||t(e)},this.onClick=e=>{const{onClick:t}=this.props;null==t||t(e)},this.onBlur=e=>{const{onBlur:t}=this.props;null==t||t(e)},this.getValue=()=>this.ref.current.value}initialize(e){this.state={value:e.value,focused:!1}}componentWillMount(){this.props.value&&this.setValue(this.props.value)}componentWillReceiveProps(e){e.value&&e.value!==this.state.value&&this.setValue(e.value)}render(e,t){const{id:n,disabled:r,type:s,placeholder:o,bordered:i=!0,className:l="",readonly:a}=e,{value:c}=t,h=Em(Jb,{[`${Jb}-disable`]:r,[`${Jb}-borderless`]:!i},l);return Kd("input",{type:s,onBlur:this.onBlur,onFocus:this.onFocus,className:h,placeholder:o,disabled:r,ref:this.ref,onChange:this.handleChange,value:c,onClick:this.onClick,readonly:a,id:n,onKeyUp:this.handlePressEnter})}}const t_=e=>{let t,{color:n}=e;if(!n)return null;if(n.indexOf("#")>-1){if(n=qt.hexToRgbString(n),!n)return null;t=n.replace("rgba(","").replace(")","").split(",")}else n.indexOf("rgba")>-1?t=n.replace("rgba(","").replace(")","").split(","):(t=n.replace("rgb(","").replace(")","").split(","),t.push("1"));let r=uf(null);return Kd(e_,{ref:r,type:"text",value:`rgba(${t})`,onChange:()=>{e.onChange(r.current.base.value)}})};var n_={colorPickerPanel:"univer-color-picker-panel",colorPickerPanelSetting:"univer-color-picker-panel-setting",panelInput:"univer-panel-input",panelColor:"univer-panel-color"};class r_ extends sm{initialize(e){this.state={color:e.color||"#000"}}setColor(e){this.setState({color:e}),this.props.onChange(e)}render(){return Kd("div",{className:n_.colorPickerPanel,onClick:e=>e.stopPropagation()},Kd($b,{className:n_.colorPicker,color:this.state.color,onChange:Rm(this.setColor.bind(this),500)}),Kd("div",{className:n_.colorPickerPanelSetting},Kd("div",{className:n_.panelInput},this.props.rgb?Kd(t_,{color:this.state.color,onChange:Rm(this.setColor.bind(this),500)}):Kd(qb,{color:this.state.color,onChange:Rm(this.setColor.bind(this),500)})),Kd("div",{className:n_.panelColor},Kd("div",{style:{background:this.state.color}}),Kd("div",{style:{background:this.props.color}}))))}}var s_="univer-color-picker-outer",o_="univer-color-picker",i_="univer-picker",l_="univer-picker-swatches",a_="univer-picker-swatches-item",c_="univer-picker-swatch",h_="univer-picker-swatch-btn",u_="univer-colorful-warp";let d_=[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]];class g_ extends sm{constructor(){super(...arguments),this.ulRef={current:null},this.onChange=e=>{this.props.onChange&&this.props.onChange(e),this.setState({afterColor:e})},this.onClick=(e,t)=>{this.props.onClick&&this.props.onClick(e,t)},this.onCancel=()=>{this.props.onCancel&&this.props.onCancel()},this.hideSelect=e=>{e&&this.ulRef.current.contains(e.target)||(this.setState((e=>({styles:{display:"none"}}))),document.removeEventListener("click",this.hideSelect,!0))},this.showSelect=e=>{this.setState((e=>({styles:{display:"block"}}))),document.addEventListener("click",this.hideSelect,!0)},this.getOffset=(e,t)=>{const n=e.getBoundingClientRect(),r=this.ulRef.current.getBoundingClientRect(),s=document.documentElement.clientWidth||document.body.clientWidth,o=document.documentElement.clientHeight||document.body.clientHeight;let i=0,l=0;return l=n.top+r.height>o?n.top-r.height:n.top+n.height,i=n.left+r.width>s?s-r.width:n.left,{left:i,top:l}},this.onSwitch=e=>{e.stopImmediatePropagation(),new Promise(((e,t)=>{this.setState({setting:!this.state.setting}),e("end")})).then((()=>{if(this.state.root){const{top:e,left:t}=this.getOffset(this.state.root,this.ulRef.current);this.ulRef.current.style.left=`${t}px`,this.ulRef.current.style.top=`${e}px`}}))}}initialize(e){this.state={presetColors:d_,defaultColor:e.color||"#000",afterColor:e.color||"#000",rgb:!0,setting:!1,styles:{},currentLocale:"",root:null}}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}render(){const e=Object.assign(this.state.styles||{},this.props.style);return Kd("div",{className:`${s_} ${this.props.className}`,ref:this.ulRef,style:__spreadValues({},e)},Kd("div",{className:o_,onClick:e=>{}},Kd("div",{className:i_},Kd("div",{className:l_},this.state.presetColors.map((e=>Kd("div",{className:a_},e.map((e=>Kd("span",{className:c_,style:{background:e}},Kd(uv,{title:e,placement:"top"},Kd("button",{key:e,className:h_,style:{background:e},onClick:t=>{this.props.onClick&&this.props.onClick(e,t)}}))))))))),Kd("div",{onClick:e=>e.stopImmediatePropagation()},Kd(pb,{onClick:this.onSwitch},this.state.setting?this.getLocale("colorPicker.collapse"):this.getLocale("colorPicker.customColor")))),this.state.setting?Kd("div",{className:u_},Kd(r_,{color:this.state.defaultColor,rgb:this.state.rgb,onChange:this.onChange.bind(this)}),Kd("div",null,Kd(pb,{type:"primary",onClick:e=>{var t;null==(t=this.onClick)||t.call(this,this.state.afterColor,e)}},this.getLocale("colorPicker.confirmColor")),Kd(pb,{danger:!0,onClick:e=>{this.onCancel()}},this.getLocale("colorPicker.cancelColor")),Kd(pb,{onClick:e=>{e.stopPropagation(),this.setState({rgb:!this.state.rgb})}},this.getLocale("colorPicker.change")))):null))}}var f_="univer-color-picker-circle-button",m_="univer-color-select-circle",p_="univer-vertical-middle";const b_=If(((e,t)=>{const{children:n,style:r,className:s,onClick:o,onContextMenu:i}=e;return Kd("div",{onContextMenu:i,ref:t,style:r,className:s,onClick:o},n)}));var __="univer-format-modal";var v_="univer-layout-wrapper",C_="univer-layout-wrapper-has-sider",T_="univer-header-wrapper",w_="univer-footer-wrapper",y_="univer-content-wrapper",S_="univer-sider-wrapper";class E_ extends sm{constructor(){super(...arguments),this.ref={current:null},this.state={isAside:!1}}componentDidMount(){if(this.ref.current){let e=Sm(this.ref.current);const t=e instanceof Array?e:[e];for(const n of t)"ASIDE"===n.tagName&&this.setState({isAside:!0})}}render(e,t){const{children:n,style:r,className:s=""}=e,{isAside:o}=t;return Kd("section",{style:r,ref:this.ref,className:o?`${v_} ${C_} ${s}`:`${v_} ${s}`},n)}}const R_=e=>{const{children:t,style:n,className:r=""}=e;return Kd("header",{style:n,className:`${T_} ${r}`},t)},I_=e=>{const{children:t,style:n,className:r=""}=e;return Kd("footer",{style:n,className:`${w_} ${r}`},t)},A_=If(((e,t)=>{const{children:n,style:r,className:s=""}=e;return Kd("main",{ref:t,style:r,className:`${y_} ${s}`},n)})),x_=e=>{const{children:t,style:n,className:r=""}=e;return Kd("aside",{style:n,className:`${S_} ${r}`},t)};var O_="univer-cols-menu",M_="univer-cols-menuitem",N_="univer-cols-menuitem-line",k_="univer-cols-menuitem-disabled";class L_ extends sm{constructor(){super(...arguments),this._MenuRef={current:null},this._refs=[],this.getMenuRef=()=>this._MenuRef,this.handleClick=(e,t,n)=>{var r,s;const{deep:o=0}=this.props;null==(r=t.onClick)||r.call(null,e,t.value,n,o),null==(s=this.props.onClick)||s.call(null,e,t.value,n,o),this.showMenu(!1)},this.showMenu=e=>{this.setState((t=>({show:e})),(()=>{this.getStyle()}))},this.mouseEnter=(e,t)=>{const{menu:n=[]}=this.props;n[t].children&&this._refs[t].showMenu(!0)},this.mouseLeave=(e,t)=>{const{menu:n=[]}=this.props;n[t].children&&this._refs[t].showMenu(!1)},this.getStyle=()=>{var e;const t=this._MenuRef.current;if(!t)return;let n={};const r=t.getBoundingClientRect();let s;const{dom:o,parent:i}=this.props;if(s=o?o.getBoundingClientRect():{left:0,right:document.documentElement.clientWidth,top:0,bottom:document.documentElement.clientHeight},i){t.style.position="fixed";let o=null==(e=t.parentElement)?void 0:e.getBoundingClientRect();if(!o)return;o.right+r.width>s.right?(n.left=o.left-r.width+"px",n.top=`${o.top}px`):(n.left=`${o.right}px`,n.top=`${o.top}px`),r.bottom>s.bottom&&(n.top="auto",n.bottom="5px"),this.setState({posStyle:n})}}}render(){const{className:e="",style:t="",menu:n,deep:r=0}=this.props,{show:s,posStyle:o}=this.state;return Kd("ul",{className:Em(O_,e),style:__spreadProps(__spreadValues(__spreadValues({},t),o),{display:s?"block":"none"}),ref:this._MenuRef},null==n?void 0:n.map(((e,t)=>{var n,s;if(!1!==e.show)return Kd(Jd,null,Kd("li",{className:Em(M_,null!=(n=e.className)?n:"",e.disabled?k_:""),style:null!=(s=e.style)?s:"",onClick:n=>this.handleClick(n,e,t),onMouseEnter:e=>{this.mouseEnter(e,t)},onMouseLeave:e=>{this.mouseLeave(e,t)}},e.label,e.children?Kd(L_,{ref:e=>this._refs[t]=e,menu:e.children,onClick:e.onClick,className:e.className,style:e.style,parent:this,deep:r+1}):Kd(Jd,null)),e.border?Kd("div",{className:N_}):"")})))}initialize(){this.state={show:!1,posStyle:{}}}}var D_="univer-drag-container",P_="univer-drag-dialog",B_="univer-drag-bar-left",H_="univer-drag-bar-right",F_="univer-drag-bar-top",z_="univer-drag-bar-bottom",U_="univer-drag-mask";class W_ extends sm{constructor(){super(...arguments),this.root={current:null}}initialize(){}initDragDialog(){const e=this.root.current,{top:t,left:n}=this.getPosition();e.style.top=t+"px",e.style.left=n+"px";const r=e.querySelector(`.${U_}`),s=e.querySelector(`.${F_}`),o=e.querySelector(`.${z_}`),i=e.querySelector(`.${B_}`),l=e.querySelector(`.${H_}`);function a(t){const n=(t=t||window.event).clientX-e.offsetLeft,s=t.clientY-e.offsetTop;function o(t){let r=(t=t||window.event).clientX-n,o=t.clientY-s;r<100-e.offsetWidth?r=100-e.offsetWidth:r>window.innerWidth-100&&(r=window.innerWidth-100),o<100-e.offsetHeight?o=100-e.offsetHeight:o>window.innerHeight-100&&(o=window.innerHeight-100),e.style.left=r+"px",e.style.top=o+"px",e.style.transform=""}void 0!==e.setCapture&&e.setCapture(),r.style.width="100%",r.style.height="100%",document.body.style.userSelect="none",document.addEventListener("pointermove",o),document.addEventListener("pointerup",(function t(n){document.removeEventListener("pointermove",o),document.removeEventListener("pointerup",t),void 0!==e.releaseCapture&&e.releaseCapture();r.style.width="0",r.style.height="0",document.body.style.userSelect=""}))}s.addEventListener("pointerdown",a),o.addEventListener("pointerdown",a),i.addEventListener("pointerdown",a),l.addEventListener("pointerdown",a)}getPosition(){const e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n=this.root.current.offsetWidth;return{top:(t-this.root.current.offsetHeight)/2,left:(e-n)/2}}componentDidMount(){this.props.isDrag&&this.initDragDialog()}render(){const{isDrag:e,className:t=""}=this.props;return Kd(Jd,null,e?Kd("div",{className:D_},Kd("div",{ref:this.root,className:`${P_} ${t}`},this.props.children,Kd("div",{className:B_}),Kd("div",{className:H_}),Kd("div",{className:F_}),Kd("div",{className:z_}),Kd("div",{className:U_}))):this.props.children)}}var V_="univer-modal-mask",j_="univer-modal-wrapper",Y_="univer-modal-drag",G_="univer-modal-darg-wrapper",X_="univer-modal-header",$_="univer-modal-close",Q_="univer-modal-body",K_="univer-modal-footer";class Z_ extends sm{constructor(){super(...arguments),this.handleClickCancel=e=>{e&&e()},this.showModal=e=>{this.setState((t=>({visible:e})))},this.handleClick=e=>{this.showModal(!1),e&&e()}}initialize(){var e;this.state={visible:null!=(e=this.props.visible)&&e}}componentWillReceiveProps(e){e.visible!==this.state.visible&&this.setState({visible:e.visible})}render(){const{title:e,width:t=500,top:n=0,style:r,children:s,className:o="",group:i=[],isDrag:l=!1,mask:a=!0,footer:c=!0}=this.props,{visible:h}=this.state;return Kd(Jd,null,h?Kd("div",{className:o},a?Kd("div",{className:V_,onClick:e=>{var t,n;null==(n=(t=this.props).onCancel)||n.call(t,e),this.showModal(!1)}}):null,Kd(W_,{isDrag:l,className:Y_},Kd("div",{className:`${l?G_:j_}`,style:__spreadValues({width:`${t}px`},r)},Kd("div",{className:X_},Kd("span",null,e),Kd("span",{className:$_,onClick:e=>{var t,n;null==(n=(t=this.props).onCancel)||n.call(t,e),this.showModal(!1)}},Kd(eb.Close,null))),Kd("div",{className:Q_},s),c?Kd("div",{className:K_},i.map((e=>Kd(pb,{type:e.type,onClick:()=>this.handleClick(e.onClick)},this.getLocale(e.label))))):null))):null)}}var q_="univer-radio-group",J_="univer-radio-wrap",ev="univer-radio-left",tv="univer-circle",nv="univer-active",rv="univer-fork",sv="univer-label";var ov={resizeDialog:"univer-resize-dialog",dialogMove:"univer-dialog-move",moveItem:"univer-move-item",moveTop:"univer-move-top",moveRight:"univer-move-right",moveBottom:"univer-move-bottom",moveLeft:"univer-move-left",dialogResize:"univer-dialog-resize",dialogResizeActive:"univer-dialog-resize-active",resizeItem:"univer-resize-item",resizeLt:"univer-resize-lt",resizeMt:"univer-resize-mt",resizeLm:"univer-resize-lm",resizeRm:"univer-resize-rm",resizeRt:"univer-resize-rt",resizeLb:"univer-resize-lb",resizeMb:"univer-resize-mb",resizeRb:"univer-resize-rb"};var iv="univer-tooltip-Group",lv="univer-tooltip-title",av="univer-tooltip-body",cv="univer-tooltip-triangle";const hv={top:"univer-top",bottom:"univer-bottom",left:"univer-left",right:"univer-right"};class uv extends sm{constructor(){super(...arguments),this.tooltip={current:null}}initialize(e){this.state={placement:e.placement||"top",placementClassName:Em(lv,hv[e.placement||"top"]),top:"",left:"",show:!1}}handleMouseOver(){if(this.tooltip&&this.tooltip.current){let e=this.tooltip.current.getBoundingClientRect(),t=e.height,n=e.width;"bottom"===this.state.placement?this.setState({top:t+10,left:n/2,show:!0}):"left"===this.state.placement?this.setState({top:t/2,left:n+5,show:!0}):"right"===this.state.placement?this.setState({top:t/2,left:-n-10,show:!0}):this.setState({top:-t-20,left:n/2,show:!0})}}handleMouseLeave(){this.setState({show:!1})}render(){return Kd("div",{ref:this.tooltip,className:iv,style:this.props.styles},Kd("div",{className:av,onMouseEnter:this.handleMouseOver.bind(this),onMouseLeave:this.handleMouseLeave.bind(this)},this.props.children),this.props.title?Kd("span",{className:this.state.placementClassName,style:{top:`${this.state.top}px`,left:`${this.state.left}px`,display:""+(this.state.show?"block":"none")}},this.props.title,Kd("span",{className:cv})):null)}}var dv="univer-dropdown",gv="univer-drop-content",fv="univer-drop-icon";class mv extends sm{constructor(){super(...arguments),this.MenuRef={current:null},this.DropRef={current:null},this.IconRef={current:null},this.handleClick=e=>{var t,n,r,s,o;null==(n=(t=this.props).onClick)||n.call(t),null==(s=(r=this.props).onMainClick)||s.call(r);const{icon:i}=this.props;i||null==(o=this.MenuRef.current)||o.showMenu(!0)},this.handleSubClick=()=>{var e;null==(e=this.MenuRef.current)||e.showMenu(!0)},this.hideMenu=()=>{var e;null==(e=this.MenuRef.current)||e.showMenu(!1)},this.hideMenuClick=e=>{var t;this.DropRef.current&&(null==(t=this.DropRef.current)?void 0:t.contains(e.target))||this.hideMenu()}}componentDidMount(){const{placement:e}=this.props;let t={position:"absolute"};e&&"Bottom"!==e?"Top"===e?(t.left=0,t.top="-100%"):"Left"===e?(t.left="-100%",t.top=0):(t.left="100%",t.top=0):(t.left=0,t.top="100%"),this.setState({menuStyle:t}),window.addEventListener("click",this.hideMenuClick,!0)}componentWillUnmount(){window.removeEventListener("click",this.hideMenuClick,!0)}render(){const{children:e,menu:t,showArrow:n,icon:r,tooltip:s}=this.props,{menuStyle:o}=this.state;return Kd("div",{className:dv,ref:this.DropRef},Kd(uv,{title:s,placement:"bottom"},Kd("div",{className:gv,onClick:this.handleClick},e,n?Kd(Mp.NextIcon,null):"")),r?Kd("div",{ref:this.IconRef,className:fv,onClick:this.handleSubClick},r):"",Kd(L_,{onClick:t.onClick,ref:this.MenuRef,menu:t.menu,className:t.className,style:__spreadValues(__spreadValues({},t.style),o)}))}initialize(){this.state={menuStyle:{}}}}var pv="univer-line",bv="univer-vertical";var _v="univer-sider-modal",vv="univer-sider-modal-header",Cv="univer-sider-modal-title",Tv="univer-sider-modal-close",wv="univer-sider-modal-body",yv="univer-sider-modal-body-inner",Sv="univer-sider-modal-footer";var Ev="univer-slider";class Rv extends sm{constructor(){super(...arguments),this.ref={current:null},this.onInput=(e,t)=>{var n;const r=t.target.value;this.changeInputValue(e,r),null==(n=this.props.onChange)||n.call(this,t)},this.onClick=(e,t)=>{var n;const{min:r=0,max:s=100,step:o=1}=this.props,i=t.currentTarget;let l=t.offsetX;const a=i.offsetWidth;if(l<0||l>a)return;let c=l/this.width*(s-r);c%o&&(c+=o-c%o),this.changeInputValue(e,c),null==(n=this.props.onClick)||n.call(this,t,c)},this.changeInputValue=(e,t)=>{let n=this.ref.current,r=n.getElementsByTagName("input")[e].id;n.style.setProperty(`--${r}`,t),e?this.setValue({valueNext:t}):this.setValue({valuePrev:t})},this.setValue=(e,t)=>{this.setState((t=>__spreadValues({},e)),t)}}initialize(e){this.state={valuePrev:0,valueNext:0}}componentWillMount(){this.idPrev=ym("slider"),this.idNext=ym("slider")}componentDidMount(){const{min:e=0,max:t=100,range:n}=this.props;let r=t-e,s=this.ref.current;if(this.width=s.offsetWidth,s.style.cssText+=`--${this.idPrev}: ${this.state.valuePrev}; --${this.idNext}: ${this.state.valueNext}`,document.styleSheets[0].addRule(`.${Ev}::after`,`margin-left: calc((var(--${this.idNext}) - ${e})/${r}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${r}*100%);`),document.styleSheets[0].insertRule(`.${Ev}::after {margin-left: calc((var(--${this.idNext}) - ${e})/${r}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${r}*100%);}`,0),document.styleSheets[0].addRule(`.${Ev}::before`,`margin-left: calc((var(--${this.idPrev}) - ${e})/${r}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${r}*100%);`),document.styleSheets[0].insertRule(`.${Ev}::before {margin-left: calc((var(--${this.idPrev}) - ${e})/${r}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${r}*100%);}`,0),n){let{value:e}=this.props;e=e||[0,0],this.setValue({valuePrev:e[0],valueNext:e[1]})}else{let{value:e}=this.props;e=e||0,this.changeInputValue(0,e)}}render(e,t){const{valuePrev:n,valueNext:r}=t,{step:s=1,min:o=0,max:i=100,range:l=!1}=e;return l?Kd("div",{className:Ev,role:"group","aria-labelledby":"multi-lbl",style:{"--min":o,"--max":i},ref:this.ref},Kd("label",{class:"sr-only",for:this.idPrev}),Kd("input",{id:this.idPrev,type:"range",min:o,value:n,max:i,step:s,onInput:e=>this.onInput(0,e)}),Kd("label",{class:"sr-only",for:this.idNext}),Kd("input",{id:this.idNext,type:"range",min:o,value:r,max:i,step:s,onInput:e=>this.onInput(1,e)})):Kd("div",{className:Ev,role:"group","aria-labelledby":"multi-lbl",style:{"--min":o,"--max":i},ref:this.ref,onClick:e=>this.onClick(0,e)},Kd("label",{class:"sr-only",for:this.idPrev}),Kd("input",{id:this.idPrev,type:"range",min:o,value:n,max:i,step:s,onInput:e=>this.onInput(0,e)}))}}var Iv="univer-tabs",Av="univer-tabs-nav",xv="univer-tabs-nav-wrap",Ov="univer-tabs-nav-list",Mv="univer-tabs-tab",Nv="univer-tabs-tab-active",kv="univer-tabs-content",Lv="univer-tabs-panel",Dv="univer-tabs-panel-active";const Pv=e=>{const{id:t,keys:n,style:r,children:s,active:o}=e;return Kd("div",{id:t&&`${t}-panel-${n}`,role:"tabpanel",style:__spreadValues({},r),className:Em(Lv,o&&Dv)},o&&s)};var Bv="univer-cols-menu",Hv="univer-cols-menu-jsx",Fv="univer-cols-menuitem",zv="univer-line",Uv="univer-cols-menuitem-content",Wv="univer-ul-icon",Vv="univer-submenu-arrow";class jv extends sm{constructor(){super(...arguments),this.refs=[],this.ulRef={current:null},this.filterChildren=e=>{let t;return Array.from(e.children).forEach((e=>{"UL"===e.nodeName&&(t=!0)})),t},this.mouseOver=(e,t)=>{this.refs.forEach((e=>{e.hideSelect()}));const n=e.currentTarget;this.filterChildren(n)&&this.refs[t].showSelect()},this.mouseLeave=(e,t)=>{"jsx"!==(this.refs[t]?this.refs[t].props.children[0].selectType:"")&&this.refs.forEach((e=>{e.hideSelect()}))},this.handleClick=(e,{item:t,index:n,ref:r},s)=>{e.stopImmediatePropagation(),null==s||s.call(this,e,{item:t,index:n,ref:r})},this.handleKeyUp=(e,{item:t,index:n,ref:r},s)=>{e.stopImmediatePropagation(),null==s||s.call(this,e,{item:t,index:n,ref:r})},this.sendParent=()=>this,this.hideSelect=()=>{var e;window.removeEventListener("resize",this.resizeUl),"none"!==(null==(e=this.state.style)?void 0:e.display)&&(this.refs.forEach((e=>{e.hideSelect()})),this.setState((e=>({style:{display:"none"}}))))},this.showSelect=()=>{window.addEventListener("resize",this.resizeUl),this.setState((e=>({style:{display:"inline-block"}})),(()=>{this.getStyle()}))},this.getStyle=()=>{var e;const t=null==(e=this.ulRef.current)?void 0:e.parentElement,n=this.ulRef.current;let r,s={};if(!n||!t)return;const o=n.getBoundingClientRect();let i=null==t?void 0:t.getBoundingClientRect();r=this.getContext().getPluginManager().getPluginByName("spreadsheet").getSheetContainerControl().getContentRef().current.getBoundingClientRect(),r&&i&&("LI"===(null==t?void 0:t.nodeName)?(n.style.position="fixed",i=null==t?void 0:t.getBoundingClientRect(),i.right+o.width>r.right?(s.left=i.left-o.width+"px",s.top=`${i.top}px`):(s.left=`${i.right}px`,s.top=`${i.top}px`)):"DIV"===(null==t?void 0:t.nodeName)&&(i.right+o.width>r.right||i.right+o.width>document.documentElement.clientWidth?(s.right="0",s.left="auto"):(s.left="0",s.right="auto"),o.top>=r.bottom&&(s.top="auto",s.bottom="100%")),this.setState((e=>({posStyle:s}))))},this.showIcon=e=>"selected"in e||"hidden"in e?e.selected?Kd("span",{className:Wv},Kd(Mp.CorrectIcon,{style:{fontSize:"13px"}})):e.hidden?Kd("span",{className:Wv},Kd(Mp.HideIcon,{style:{fontSize:"13px"}})):Kd("span",{className:Wv}):"",this.getIcon=e=>{let t=e;return"string"==typeof t&&/Icon$/.test(t)&&(t=tb[t]),Kd("span",{className:Vv},t)},this.getParent=()=>{var e;return null!=(e=this.props.getParent())?e:null}}componentWillMount(){const{show:e=!1}=this.props;e&&this.setState((e=>({style:{display:"inline-block"}})))}render(e,t){var n;const{children:r,onClick:s,style:o,onKeyUp:i}=e,{posStyle:l}=t,a=Object.assign(null!=(n=this.state.style)?n:{},l,o||{});return(null==r?void 0:r.length)?(r.some(((e,t)=>!!e.selected&&(r.forEach(((e,n)=>{t!==n&&(e.selected=!1)})),!0))),Kd("ul",{className:"jsx"===r[0].selectType?Hv:Bv,style:__spreadValues({},a),ref:this.ulRef},null==r?void 0:r.map(((e,t)=>{var n;let r=e.className?`${Fv} ${e.className}`:Fv;if(!e.hideLi)return Kd("li",{className:r,style:__spreadValues({},e.style),onClick:n=>{n.stopPropagation(),this.handleClick(n,{item:e,index:t,ref:this},e.onClick?e.onClick:s)},onMouseEnter:e=>{this.mouseOver(e,t)},onMouseLeave:e=>{this.mouseLeave(e,t)},onKeyUp:n=>{this.handleKeyUp(n,{item:e,index:t,ref:this},e.onKeyUp?e.onKeyUp:i)}},Kd("div",{className:"jsx"===e.selectType?"":Uv},this.showIcon(e),Kd("div",null,"jsx"===e.selectType?Kd("span",null,Tg(e.label,{onChange:this.getStyle})):Kd("span",null,e.label),e.icon?this.getIcon(e.icon):"")),(null==(n=e.children)?void 0:n.length)?Kd(jv,{children:e.children,onClick:e.onClick,ref:e=>this.refs[t]=e,getParent:this.sendParent}):Kd(Jd,null),e.border?Kd("div",{className:zv}):"")})))):Kd(Jd,null)}initialize(e){this.state={style:{display:"none"},posStyle:{}},this.resizeUl=Rm(this.getStyle,200)}}var Yv="univer-confirm-modal";class Gv extends sm{constructor(e){var t;super(),this.state={show:null!=(t=e.show)&&t}}showModal(e){this.setState({show:e})}handleClick(){const{onClick:e}=this.props;null==e||e(),this.showModal(!1)}getGroup(){return[{label:this.getLocale("button.confirm"),type:"primary",onClick:()=>this.handleClick()},{label:this.getLocale("button.cancel"),onClick:()=>this.showModal(!1)}]}componentWillReceiveProps(e){e.show!==this.props.show&&this.setState({show:e.show})}render(){const{title:e,content:t}=this.props,{show:n}=this.state;return Kd("div",{className:Yv},Kd(Z_,{visible:n,isDrag:!0,title:this.getLocale(e),group:this.getGroup()},this.getLocale(t)))}}var Xv="univer-select-item",$v="univer-select-item-selected",Qv="univer-select-item-content",Kv="univer-select-item-suffix",Zv="univer-select-disabled-item";class qv extends sm{render(){const{selected:e,label:t,suffix:n,disabled:r}=this.props;return Kd("div",{className:Em(Xv,r?Zv:"")},e?Kd("span",{className:$v},Kd(Rp,null)):"",Kd("span",{className:Qv},t),n?Kd("span",{className:Kv},n):"")}}var Jv,eC,tC,nC,rC="univer-select-component",sC="univer-select-single",oC="univer-select-input",iC="univer-select-double",lC="univer-select-label";(eC=Jv||(Jv={}))[eC.SINGLE=0]="SINGLE",eC[eC.INPUT=1]="INPUT",eC[eC.COLOR=2]="COLOR",eC[eC.DOUBLE=3]="DOUBLE",eC[eC.FIX=4]="FIX",eC[eC.DOUBLEFIX=5]="DOUBLEFIX",(nC=tC||(tC={}))[nC.LABEL=0]="LABEL",nC[nC.SUFFIX=1]="SUFFIX";class aC extends Sf{constructor(){super(...arguments),this.handleSelected=e=>{const{children:t=[],hideSelectedIcon:n}=this.props;t.length&&(t.forEach((e=>{e.selected=!1})),null!==e&&(t[e].selected=!0));return this.resetMenu(t,n)},this.getSingle=()=>{const{content:e,menu:t}=this.state,{className:n="",tooltip:r,onMainClick:s}=this.props;return Kd("div",{className:`${sC} ${n}`},Kd(mv,{onMainClick:s,tooltip:r,menu:{menu:t,onClick:this.onClick},showArrow:!0},Kd("div",null,e)))},this.handlePressEnter=(e,t)=>{var n;this.onPressEnter(e),null==(n=t.current)||n.hideMenu()},this.getInput=()=>{const{content:e,menu:t}=this.state,{className:n="",tooltip:r,onMainClick:s}=this.props,o={current:null};return Kd("div",{className:`${oC} ${n}`},Kd(mv,{onMainClick:s,ref:o,tooltip:r,menu:{menu:t,onClick:this.onClick},showArrow:!0},Kd(e_,{onPressEnter:e=>this.handlePressEnter(e,o),onBlur:this.onPressEnter,type:"number",value:e})))},this.getDouble=()=>{const{content:e,menu:t}=this.state,{className:n="",tooltip:r,onClick:s}=this.props;return Kd("div",{className:`${iC} ${n}`},Kd(mv,{onClick:s,tooltip:r,menu:{menu:t,onClick:this.onClick},icon:Kd(Sp,null)},Kd("div",{className:lC},e)))},this.getFix=()=>{const{label:e,className:t="",tooltip:n}=this.props,{menu:r}=this.state;return Kd("div",{className:`${iC} ${t}`},Kd(mv,{tooltip:n,menu:{menu:r,onClick:this.onClick},showArrow:!0},Kd("div",{className:lC},e)))},this.getDoubleFix=()=>{const{label:e,className:t="",tooltip:n,onClick:r}=this.props,{menu:s}=this.state;return Kd("div",{className:`${iC} ${t}`},Kd(mv,{tooltip:n,onClick:r,menu:{menu:s,onClick:this.onClick},icon:Kd(Sp,null)},Kd("div",{className:lC},e)))}}initialize(){var e;const{children:t=[],hideSelectedIcon:n}=this.props,r=this.resetMenu(t,n);this.state={menu:r,color:null!=(e=this.props.defaultColor)?e:"#000",content:"",value:""}}getType(e){switch(e){case 0:return this.getSingle();case 1:return this.getInput();case 3:return this.getDouble();case 4:return this.getFix();case 5:return this.getDoubleFix()}}initData(){const{type:e,display:t,children:n=[],label:r}=this.props;if(0===e||3===e){if(!n.length)return;let e=n.findIndex((e=>e.selected));e<0&&(e=0);const r=this.handleSelected(e),s=n[e];1===t?this.setState({content:s.suffix,menu:r}):this.setState({content:s.label,menu:r}),this.onClick=(...e)=>{var r,s;const o=n[e[2]];if(null==(s=(r=this.props).onClick)||s.call(r,e[1],e[2],e[3]),o.unSelectable)return;const i=this.handleSelected(e[2]);1===t?this.setState({content:n[e[2]].suffix,menu:i}):this.setState({content:n[e[2]].label,menu:i})}}else if(1===e){if(!n.length)return;const e=e=>{if(null!==e){if(""===e)return;let t=n.findIndex((t=>e===t.label)),r=this.handleSelected(t<0?null:t);this.setState({content:e,menu:r})}else{let e=n.findIndex((e=>e.selected));e<0&&(e=0);let t=this.handleSelected(e);const r=n[e];this.setState({content:r.label,menu:t})}};e(r),this.onClick=(...e)=>{var t,r;null==(r=(t=this.props).onClick)||r.call(t,e[1],e[2],e[3]);const s=this.handleSelected(e[2]);this.setState({content:n[e[2]].label,menu:s})},this.onPressEnter=t=>{var n,r;const s=t.currentTarget.value;null==(r=(n=this.props).onPressEnter)||r.call(n,s),e(s)}}else if(2===e){const e=this.handleSelected(null);this.setState({menu:e}),this.onClick=()=>{var e,t;const{color:n}=this.state;null==(t=(e=this.props).onClick)||t.call(e,n)}}else if(4===e||5===e){if(!n.length)return;let e=n.findIndex((e=>e.selected));e<0&&(e=0);const t=n[e],r=this.handleSelected(e);this.setState({menu:r,value:t.value}),this.onClick=(...e)=>{var t,r,s,o;if(e.length){null==(r=(t=this.props).onClick)||r.call(t,e[1],e[2],e[3]);const s=this.handleSelected(e[2]);this.setState({menu:s,value:n[e[2]].value})}else null==(o=(s=this.props).onClick)||o.call(s,this.state.value)}}}componentDidMount(){this.initData()}componentWillReceiveProps(e){}resetMenu(e,t){var n;const r=[];for(let s=0;s<e.length;s++){let o=!1;t||(o=null!=(n=e[s].selected)&&n),r[s]={label:""},r[s].label=Kd(qv,{disabled:e[s].disabled,border:e[s].border,selected:o,label:e[s].label,suffix:e[s].suffix}),r[s].disabled=e[s].disabled,r[s].style=e[s].style,r[s].value=e[s].value,r[s].className=e[s].className,r[s].onClick=e[s].onClick,r[s].border=e[s].border,e[s].children&&(r[s].children=this.resetMenu(e[s].children))}return r}render(){const{type:e=0}=this.props;return Kd("div",{className:rC},this.getType(e))}}var cC="univer-cell-range-modal",hC="univer-cell-modal-icon";var uC=Object.freeze(Object.defineProperty({__proto__:null,BaseCellEditExtension:yg,BaseCellEditExtensionFactory:class{get zIndex(){return 0}create(e,t){return new yg(e,t)}check(e){return!1}},CellEditExtensionManager:Ig,CellEditExtensionRegister:Rg,BaseCellInputExtension:Ag,BaseCellInputExtensionFactory:class{constructor(e){this._plugin=e}get zIndex(){return 0}create(e,t){return new Ag(e,t)}check(e){return!1}},CellInputExtensionManager:Ng,CellInputExtensionRegister:Mg,BaseClipboardExtension:kg,BaseClipboardExtensionFactory:Lg,ClipboardExtensionManager:Hg,ClipboardExtensionRegister:Dg,BaseDragAndDropExtension:Fg,BaseDragAndDropExtensionFactory:zg,DragAndDropExtensionManager:Wg,DragAndDropExtensionRegister:Ug,Clipboard:Bg,AppContext:Vg,KeyboardManager:jg,DragManager:Yg,EventManager:Gg,ComponentManager:nb,RegisterManager:rb,get DescriptionEnum(){return Xp},get ComponentType(){return Qp},get ISelectButton(){return Zp},get LocaleType(){return Jp},isElement:Cm,isDOM:Tm,$$:wm,addClass:function(e,t,n){if("string"!=typeof t)return void t.classList.add(e);n=n||document,Array.prototype.slice.call(n.querySelectorAll(t)).forEach((t=>{t.classList.add(e)}))},removeClass:function(e,t,n){if("string"!=typeof t)return void t.classList.remove(e);n=n||document,Array.prototype.slice.call(n.querySelectorAll(t)).forEach((t=>{t.classList.remove(e)}))},closest:function(e,t){const n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;for(;e;){if(n.call(e,t))return e;e=e.parentElement}return null},randomId:ym,getFirstChildren:Sm,joinClassNames:Em,getNodeindex:e=>[...e.parentNode.children].indexOf(e),debounce:Rm,selectTextContent:Im,selectTextContentCross:Am,isInPage:xm,textTrim:Om,getRefElement:Mm,printableCharacter:function(e){return e>47&&e<58||32===e||13===e||e>64&&e<91||e>95&&e<112||e>185&&e<193||e>218&&e<223},xssDeal:Nm,setLastCaretPosition:km,findLocale:Lm,handleDomToJson:sb,handleStringToStyle:ob,splitSpanText:ib,handleTableColgroup:lb,handleTableRowGroup:cb,handelTableToJson:hb,handlePlainToJson:ub,handleTableMergeData:db,handelExcelToJson:gb,Prompt:Gv,get SelectTypes(){return Jv},Select:aC,CellRange:class extends sm{constructor(e){var t;super(),this.ref={current:null},this.handleOk=e=>{const{onClick:t}=this.props;this.ref.current.getValue(),null==t||t(e),this.showModal(!1)},this.handleChange=e=>{const{onChange:t}=this.props;null==t||t(e)},this.state={value:null!=(t=e.value)?t:"",show:!1},this.group=[{label:"button.confirm",type:"primary",onClick:e.onClick}]}showModal(e){this.setState({show:e})}componentWillReceiveProps(e){e.value!==this.state.value&&this.setState({value:e.value})}render(){const{placeholder:e,title:t,contentPlaceholder:n}=this.props,{value:r,show:s}=this.state;return Kd("div",{className:cC},Kd(e_,{placeholder:e,value:r,onChange:this.handleChange}),Kd("span",{className:hC,onClick:()=>this.showModal(!0)},Kd(Yp.TableIcon,null)),Kd(Z_,{title:t,visible:s,group:this.group},Kd(e_,{readonly:!0,placeholder:n,value:r,ref:this.ref})))}},Avatar:e=>{const{alt:t,shape:n="circle",size:r,src:s,onError:o,style:i,fit:l="fill",children:a,onLoad:c,title:h}=e,u="number"==typeof r?{width:r,height:r,lineHeight:`${r}px`}:{},d=Em(fb,{[`${fb}-${n}`]:n,[`${fb}-image`]:s,[`${fb}-lg`]:"large"===r,[`${fb}-sm`]:"small"===r}),g=l?{objectFit:l}:{};return s?Kd("span",{className:d,style:__spreadValues(__spreadValues(__spreadValues({},u),i),g)},Kd("img",{src:s,title:h,alt:t,onError:o,onLoad:c}),a):Kd("span",{className:d,style:__spreadValues(__spreadValues({},u),i)},a)},Button:pb,Collapse:e=>{const{children:t}=e;return Kd("div",{className:yb.collapseWrapper},t)},Panel:e=>{const{header:t,children:n}=e;let[r,s]=lf(Em(yb.panelBody));return Kd("div",{className:yb.panelWrapper},Kd("div",{className:yb.panelHeader,onClick:()=>{r.includes("active")?s(Em(yb.panelBody)):s(Em(yb.panelBody,yb.active))}},t,Kd("span",{className:`${yb.panelHeaderIcon} ${r.includes("active")?yb.panelHeaderIconRotate:""}`},Kd(Mp.NextIcon,null))),Kd("div",{className:r},n))},Menu:L_,Container:b_,Layout:E_,Header:R_,Footer:I_,Content:A_,Sider:x_,Tooltip:uv,Icon:tb,Input:e_,Separator:e=>{const{mode:t}=e;return Kd("div",{className:`${pv} ${t?bv:""}`})},ColorPicker:g_,Ul:jv,Modal:Z_,Slider:Rv,Radio:class extends sm{render(){return Kd("div",{className:J_},Kd("div",{className:ev},Kd("div",{onClick:this.props.onClick.bind(this,this.props.value)},Kd("div",{className:`${tv} ${this.props.active&&nv}`},Kd("div",{className:rv})),Kd("div",{className:sv},this.props.label)),this.props.children))}},RadioGroup:class extends sm{handleActiveChange(e){this.props.onChange(e)}render(){const{vertical:e,className:t=""}=this.props;return Kd("div",{className:`${e?q_:""} ${t||""}`},this.props.children.map((e=>{let t=this.props.active===e.props.value;return Tg(e,{label:e.props.label,children:e.props.children,value:e.props.value,active:t,onClick:this.handleActiveChange.bind(this)})})))}},FormatModal:class extends sm{constructor(){super(...arguments),this.refs=[],this.ModalRefs=[],this.setValue=(e,t)=>{this.setState((t=>__spreadValues({},e)),t)},this.showModal=(e,t)=>{let n=this.state.data,r=n.findIndex((t=>t.name===e));r>-1&&(n[r].show=t,this.setValue({data:n},(()=>({data:n}))))}}initialize(e){this.state={data:[{name:"format.titleCurrency",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleCurrency",!1)},{name:"format.titleDateTime",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleDateTime",!1)},{name:"format.titleNumber",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleNumber",!1)}]}}setLocale(){const e=this.context.locale;let t=this.state.data;t.forEach((t=>{var n;t.title=e.get(t.name),"format.titleCurrency"===t.name?t.children=e.get("currencyDetail").map((e=>({label:e.name,icon:e.value}))):"format.titleDateTime"===t.name?t.children=e.get("dateFmtList").map((e=>({label:e.name,icon:e.value}))):"format.titleNumber"===t.name&&(t.children=e.get("numFmtList").map((e=>({label:e.name,icon:e.value})))),(null==(n=t.group)?void 0:n.length)&&t.group.forEach((t=>{t.label=e.get(t.locale)}))})),this.setState((e=>({data:t})))}componentWillMount(){var e;this.setLocale(),this._localeObserver=null==(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))?void 0:e.add((()=>{this.setLocale()}))}componentWillUnmount(){}render(e,t){const{data:n}=t;return Kd(Jd,null,n.map(((e,t)=>e.show?Kd(Z_,{title:e.title,className:__,group:e.group,visible:e.show,onCancel:e.onCancel},e.label,Kd(jv,{show:!0,children:e.children,ref:e=>this.refs[t]=e})):Kd(Jd,null))))}},Checkbox:wb,CheckboxGroup:e=>{let{options:t,onChange:n,disabled:r,name:s}=e,o=uf(null);r&&t.forEach((e=>{e.disabled=!0})),s&&t.forEach((e=>{e.name=s}));const i=()=>{var e;if(!n)return;let t=null==(e=o.current)?void 0:e.querySelectorAll("label input"),r=[];null==t||t.forEach((e=>{let t=e;t.checked&&r.push(t.value)})),n(r)};return Kd("div",{className:Tb,ref:o},t.map((e=>Kd(wb,{name:e.name,disabled:e.disabled,checked:e.checked,onChange:i,value:e.value},e.label))))},Tab:class extends om{constructor(){super(...arguments),this.state={active:""},this.setValue=(e,t)=>{this.setState((t=>__spreadValues({},e)),t)},this.parseNavList=()=>{const{active:e}=this.state;return lg(this.props.children).map((t=>{const{tab:n,keys:r}=t.props,s=`${ym("tab")}-${r}`;return Kd("div",e===r?{id:s,onClick:this.handleClick,className:Em(Mv,Nv)}:{id:s,onClick:this.handleClick,className:Mv},n)}))},this.handleClick=e=>{var t,n;const r=e.target.id,s=r.lastIndexOf("-"),o=r.slice(s+1);this.setValue({active:o}),null==(n=(t=this.props).onTabClick)||n.call(t,o,e)}}componentWillMount(){this.setValue({active:this.props.activeKey,children:this.props.children})}render(e,t){const{children:n,type:r="line",className:s=""}=e;return Kd("div",{className:Em(Iv,{[`${Iv}-card`]:"card"===r},s)},Kd("div",{className:Av},Kd("div",{className:xv},Kd("div",{className:Ov},this.parseNavList()))),Kd("div",{className:kv},n.map((e=>Kd(Pv,{keys:e.props.keys,active:e.props.keys===this.state.active},e.props.children)))))}},TabPane:Pv,ColorPickerCircleButton:class extends sm{constructor(){super(...arguments),this.ref={current:null},this.colorRef={current:null},this.handleColorSelectButtonClick=e=>{e.stopImmediatePropagation(),this.colorRef.current.showSelect(this.ref.current)}}render(e){const{color:t,onClick:n,onCancel:r,style:s,colorPickerStyle:o}=e,i=this.getComponentRender().renderFunction("NextIcon");return Kd("div",{style:s,className:f_,ref:this.ref,onClick:this.handleColorSelectButtonClick},Kd("span",{className:`${m_} ${p_}`,style:{backgroundColor:t}}),Kd(i,{className:p_}),Kd(g_,{color:t,onClick:n,onCancel:r,style:o,ref:this.colorRef}))}},BorderLine:vm,SiderModal:class extends sm{initialize(e){this.state={}}close(){this._context.getPluginManager().getPluginByName("spreadsheet").showSiderByName(this.props.pluginName,!1),this.props.closeSide&&this.props.closeSide()}render(e){const{className:t="",style:n}=e;return Kd("div",{className:`${_v} ${t}`,style:__spreadValues({},n)},Kd("div",{className:vv},Kd("h3",{className:Cv},this.props.title),Kd("span",{className:Tv,onClick:()=>this.close()},Kd(eb.Close,null))),Kd("div",{className:wv},Kd("div",{className:yv},this.props.children)),Kd("div",{className:Sv},this.props.footer))}},ResizeDialog:e=>{let{left:t=0,top:n=0,width:r=100,height:s=50,children:o,ratio:i=1}=e;const l=uf(null),a=uf(null);cf((()=>{const e=l.current;e&&(e.style.width=r*i+"px",e.style.height=s*i+"px",e.style.left=t*i+"px",e.style.top=n*i+"px")}),[]);let c=[0,0],h=[0,0],u=!1,d=!1,g=null;const f=()=>{if(!l.current)return;const e=l.current.parentElement;if(!e)return;e.querySelectorAll(`.${ov.dialogResize}`).forEach((e=>{e.classList.remove(ov.dialogResizeActive)}))},m=e=>{if(!l.current||!a.current)return;const t=a.current.classList;l.current.contains(e.target)?t.add(ov.dialogResizeActive):t.contains(ov.dialogResizeActive)&&t.remove(ov.dialogResizeActive)},p=e=>{e.stopPropagation(),f(),m(e)},b=e=>{if(e.stopPropagation(),!l.current)return;const r=l.current.parentElement;if(!r)return;if(!r.contains(e.target))return;if(!u&&!d)return;const s=l.current;if(s){if(h=[e.pageX,e.pageY],t=parseFloat(s.style.left)+h[0]-c[0],t=t<0?0:t,t+l.current.offsetWidth>r.offsetWidth&&(t=r.offsetWidth-l.current.offsetWidth),n=parseFloat(s.style.top)+h[1]-c[1],n=n<0?0:n,n+l.current.offsetHeight>r.offsetHeight&&(n=r.offsetHeight-l.current.offsetHeight),d){let e,o;const i=g.dataset.type;"rm"!==i&&"rb"!==i&&"rt"!==i||(e=parseFloat(s.style.width)+h[0]-c[0],e<10&&(e=10),t+e>r.offsetWidth&&(e=r.offsetWidth-t),s.style.width=`${e}px`),"lm"!==i&&"lb"!==i&&"lt"!==i||(e=parseFloat(s.style.width)-(h[0]-c[0]),e<10&&(e=10),t+e>r.offsetWidth&&(e=r.offsetWidth-t),s.style.width=`${e}px`,s.style.left=`${t}px`),"lb"!==i&&"mb"!==i&&"rb"!==i||(o=parseFloat(s.style.height)+h[1]-c[1],o<10&&(o=10),o+n>r.offsetHeight&&(o=r.offsetHeight-n),s.style.height=`${o}px`),"lt"!==i&&"mt"!==i&&"rt"!==i||(o=parseFloat(s.style.height)-(h[1]-c[1]),o<10&&(o=10),o+n>r.offsetHeight&&(o=r.offsetHeight-n),s.style.height=`${o}px`,s.style.top=`${n}px`)}u&&(s.style.left=`${t}px`,s.style.top=`${n}px`),c=h}},_=e=>{if(window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",_),window.removeEventListener("click",p),e.stopPropagation(),!u&&!d)return;l.current&&(u=!1,d=!1)};return Kd("div",{className:ov.resizeDialog,ref:l},Kd("div",{className:ov.dialogMove,onMouseDown:e=>{window.addEventListener("mousemove",b),window.addEventListener("mouseup",_),window.addEventListener("click",p),e.stopPropagation(),f(),m(e),c=[e.pageX,e.pageY],u=!0}},Kd("div",{className:`${ov.moveItem} ${ov.moveTop}`}),Kd("div",{className:`${ov.moveItem} ${ov.moveRight}`}),Kd("div",{className:`${ov.moveItem} ${ov.moveBottom}`}),Kd("div",{className:`${ov.moveItem} ${ov.moveLeft}`})),Kd("div",{className:ov.dialogResize,onMouseDown:e=>{e.stopPropagation();const t=e.target;t.className.includes(`${ov.resizeItem}`)&&(g=t,c=[e.pageX,e.pageY],d=!0)},ref:a},Kd("div",{"data-type":"lt",className:`${ov.resizeItem} ${ov.resizeLt}`}),Kd("div",{"data-type":"mt",className:`${ov.resizeItem} ${ov.resizeMt}`}),Kd("div",{"data-type":"lm",className:`${ov.resizeItem} ${ov.resizeLm}`}),Kd("div",{"data-type":"rm",className:`${ov.resizeItem} ${ov.resizeRm}`}),Kd("div",{"data-type":"rt",className:`${ov.resizeItem} ${ov.resizeRt}`}),Kd("div",{"data-type":"lb",className:`${ov.resizeItem} ${ov.resizeLb}`}),Kd("div",{"data-type":"mb",className:`${ov.resizeItem} ${ov.resizeMb}`}),Kd("div",{"data-type":"rb",className:`${ov.resizeItem} ${ov.resizeRb}`})),Kd("div",{className:ov.dialogContent},o))},Dropdown:mv,render:vg,Component:sm,forwardRef:If,createRef:qd,PureComponent:om,cloneElement:Tg,useRef:uf,useState:lf,useEffect:cf,toChildArray:lg},Symbol.toStringTag,{value:"Module"}));var dC={successColor:"#52c41a",warningColor:"#faad14",errorColor:"#f5222d",borderRadiusBase:"2px",borderWidthBase:"1px",borderStyleBase:"solid",lineHeightBase:"1.5715",fontWeight:"400",fontSizeBase:"14px",fontSizeLg:"16px",fontSizeSm:"12px",paddingBase:"1em",marginBase:"1em",gray1:"#ffffff",gray2:"#fafafa",gray3:"#f5f5f5",gray4:"#f0f0f0",gray5:"#d9d9d9",gray6:"#bfbfbf",gray7:"#8c8c8c",gray8:"#595959",gray9:"#434343",gray10:"#262626",gray11:"#1f1f1f",gray12:"#141414",gray13:"#000000",gray14:"#efefef",gray15:"#e0e0e0",gray16:"#ececec",gray17:"#cbcbcb",primaryColor:"#0188fb",primaryColorHover:"#5391ff",linkColor:"#1890ff",bg:"#fff",bgHover:"#efefef",fontSize:"14px",headingColor:"#262626",textColor:"#333",textColorSecondary:"#8c8c8c",disabledColor:"#bfbfbf",disabledBg:"#f5f5f5",borderColorBase:"#d9d9d9",boxShadowBase:"0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",borderColorBaseHover:"#bfbfbf"};
/*!
   * css-vars-ponyfill
   * v2.4.8
   * https://jhildenbiddle.github.io/css-vars-ponyfill/
   * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
   * MIT license
   */function gC(){return(gC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}
/*!
   * get-css-data
   * v2.1.0
   * https://github.com/jhildenbiddle/get-css-data
   * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
   * MIT license
   */function fC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={mimeType:t.mimeType||null,onBeforeSend:t.onBeforeSend||Function.prototype,onSuccess:t.onSuccess||Function.prototype,onError:t.onError||Function.prototype,onComplete:t.onComplete||Function.prototype},r=Array.isArray(e)?e:[e],s=Array.apply(null,Array(r.length)).map((function(e){return null}));function o(e){var t="string"==typeof e,n=t&&"<"===e.trim().charAt(0);return t&&!n}function i(e,t){n.onError(e,r[t],t)}function l(e,t){var o=n.onSuccess(e,r[t],t);e=!1===o?"":o||e,s[t]=e,-1===s.indexOf(null)&&n.onComplete(s)}var a=document.createElement("a");r.forEach((function(e,t){if(a.setAttribute("href",e),a.href=String(a.href),Boolean(document.all&&!window.atob)&&a.host.split(":")[0]!==location.host.split(":")[0]){if(a.protocol===location.protocol){var r=new XDomainRequest;r.open("GET",e),r.timeout=0,r.onprogress=Function.prototype,r.ontimeout=Function.prototype,r.onload=function(){var e=r.responseText;o(e)?l(e,t):i(r,t)},r.onerror=function(e){i(r,t)},setTimeout((function(){r.send()}),0)}else console.warn("Internet Explorer 9 Cross-Origin (CORS) requests must use the same protocol (".concat(e,")")),i(null,t)}else{var s=new XMLHttpRequest;s.open("GET",e),n.mimeType&&s.overrideMimeType&&s.overrideMimeType(n.mimeType),n.onBeforeSend(s,e,t),s.onreadystatechange=function(){if(4===s.readyState){var e=s.responseText;s.status<400&&o(e)||0===s.status&&o(e)?l(e,t):i(s,t)}},s.send()}}))}
/**
   * Gets CSS data from <style> and <link> nodes (including @imports), then
   * returns data in order processed by DOM. Allows specifying nodes to
   * include/exclude and filtering CSS data using RegEx.
   *
   * @preserve
   * @param {object}   [options] The options object
   * @param {object}   [options.rootElement=document] Root element to traverse for
   *                   <link> and <style> nodes.
   * @param {string}   [options.include] CSS selector matching <link> and <style>
   *                   nodes to include
   * @param {string}   [options.exclude] CSS selector matching <link> and <style>
   *                   nodes to exclude
   * @param {object}   [options.filter] Regular expression used to filter node CSS
   *                   data. Each block of CSS data is tested against the filter,
   *                   and only matching data is included.
   * @param {boolean}  [options.skipDisabled=true] Determines if disabled
   *                   stylesheets will be skipped while collecting CSS data.
   * @param {boolean}  [options.useCSSOM=false] Determines if CSS data will be
   *                   collected from a stylesheet's runtime values instead of its
   *                   text content. This is required to get accurate CSS data
   *                   when a stylesheet has been modified using the deleteRule()
   *                   or insertRule() methods because these modifications will
   *                   not be reflected in the stylesheet's text content.
   * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
   *                   1) the XHR object, 2) source node reference, and 3) the
   *                   source URL as arguments.
   * @param {function} [options.onSuccess] Callback on each CSS node read. Passes
   *                   1) CSS text, 2) source node reference, and 3) the source
   *                   URL as arguments.
   * @param {function} [options.onError] Callback on each error. Passes 1) the XHR
   *                   object for inspection, 2) soure node reference, and 3) the
   *                   source URL that failed (either a <link> href or an @import)
   *                   as arguments
   * @param {function} [options.onComplete] Callback after all nodes have been
   *                   processed. Passes 1) concatenated CSS text, 2) an array of
   *                   CSS text in DOM order, and 3) an array of nodes in DOM
   *                   order as arguments.
   *
   * @example
   *
   *   getCssData({
   *     rootElement : document,
   *     include     : 'style,link[rel="stylesheet"]',
   *     exclude     : '[href="skip.css"]',
   *     filter      : /red/,
   *     skipDisabled: true,
   *     useCSSOM    : false,
   *     onBeforeSend(xhr, node, url) {
   *       // ...
   *     }
   *     onSuccess(cssText, node, url) {
   *       // ...
   *     }
   *     onError(xhr, node, url) {
   *       // ...
   *     },
   *     onComplete(cssText, cssArray, nodeArray) {
   *       // ...
   *     }
   *   });
   */function mC(e){var t=/\/\*[\s\S]+?\*\//g,n=/(?:@import\s*)(?:url\(\s*)?(?:['"])([^'"]*)(?:['"])(?:\s*\))?(?:[^;]*;)/g,r={rootElement:e.rootElement||document,include:e.include||'style,link[rel="stylesheet"]',exclude:e.exclude||null,filter:e.filter||null,skipDisabled:!1!==e.skipDisabled,useCSSOM:e.useCSSOM||!1,onBeforeSend:e.onBeforeSend||Function.prototype,onSuccess:e.onSuccess||Function.prototype,onError:e.onError||Function.prototype,onComplete:e.onComplete||Function.prototype},s=Array.apply(null,r.rootElement.querySelectorAll(r.include)).filter((function(e){return t=e,n=r.exclude,!(t.matches||t.matchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector).call(t,n);var t,n})),o=Array.apply(null,Array(s.length)).map((function(e){return null}));function i(){if(-1===o.indexOf(null)){o.reduce((function(e,t,n){return""===t&&e.push(n),e}),[]).reverse().forEach((function(e){return[s,o].forEach((function(t){return t.splice(e,1)}))}));var e=o.join("");r.onComplete(e,o,s)}}function l(e,t,n,s){var l=r.onSuccess(e,n,s);c(e=void 0!==l&&!1===Boolean(l)?"":l||e,n,s,(function(e,s){null===o[t]&&(s.forEach((function(e){return r.onError(e.xhr,n,e.url)})),!r.filter||r.filter.test(e)?o[t]=e:o[t]="",i())}))}function a(e,r){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o={};return o.rules=(e.replace(t,"").match(n)||[]).filter((function(e){return-1===s.indexOf(e)})),o.urls=o.rules.map((function(e){return e.replace(n,"$1")})),o.absoluteUrls=o.urls.map((function(e){return pC(e,r)})),o.absoluteRules=o.rules.map((function(e,t){var n=o.urls[t],s=pC(o.absoluteUrls[t],r);return e.replace(n,s)})),o}function c(e,t,n,s){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],l=a(e,n,i);l.rules.length?fC(l.absoluteUrls,{onBeforeSend:function(e,n,s){r.onBeforeSend(e,t,n)},onSuccess:function(e,n,s){var o=r.onSuccess(e,t,n),l=a(e=!1===o?"":o||e,n,i);return l.rules.forEach((function(t,n){e=e.replace(t,l.absoluteRules[n])})),e},onError:function(r,a,h){o.push({xhr:r,url:a}),i.push(l.rules[h]),c(e,t,n,s,o,i)},onComplete:function(r){r.forEach((function(t,n){e=e.replace(l.rules[n],t)})),c(e,t,n,s,o,i)}}):s(e,o)}s.length?s.forEach((function(e,t){var n=e.getAttribute("href"),s=e.getAttribute("rel"),a="link"===e.nodeName.toLowerCase()&&n&&s&&-1!==s.toLowerCase().indexOf("stylesheet"),c=!1!==r.skipDisabled&&e.disabled,h="style"===e.nodeName.toLowerCase();if(a&&!c)if(-1!==n.indexOf("data:text/css")){var u=decodeURIComponent(n.substring(n.indexOf(",")+1));r.useCSSOM&&(u=Array.apply(null,e.sheet.cssRules).map((function(e){return e.cssText})).join("")),l(u,t,e,location.href)}else fC(n,{mimeType:"text/css",onBeforeSend:function(t,n,s){r.onBeforeSend(t,e,n)},onSuccess:function(r,s,o){var i=pC(n);l(r,t,e,i)},onError:function(n,s,l){o[t]="",r.onError(n,e,s),i()}});else if(h&&!c){var d=e.textContent;r.useCSSOM&&(d=Array.apply(null,e.sheet.cssRules).map((function(e){return e.cssText})).join("")),l(d,t,e,location.href)}else o[t]="",i()})):r.onComplete("",[])}function pC(e,t){var n=document.implementation.createHTMLDocument(""),r=n.createElement("base"),s=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(s),r.href=t||document.baseURI||(document.querySelector("base")||{}).href||location.href,s.href=e,s.href}var bC=_C;function _C(e,t,n){e instanceof RegExp&&(e=vC(e,n)),t instanceof RegExp&&(t=vC(t,n));var r=CC(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function vC(e,t){var n=t.match(e);return n?n[0]:null}function CC(e,t,n){var r,s,o,i,l,a=n.indexOf(e),c=n.indexOf(t,a+1),h=a;if(a>=0&&c>0){if(e===t)return[a,c];for(r=[],o=n.length;h>=0&&!l;)h==a?(r.push(h),a=n.indexOf(e,h+1)):1==r.length?l=[r.pop(),c]:((s=r.pop())<o&&(o=s,i=c),c=n.indexOf(t,h+1)),h=a<c&&a>=0?a:c;r.length&&(l=[o,i])}return l}function TC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={preserveStatic:!0,removeComments:!1},r=gC({},n,t),s=[];function o(e){throw new Error("CSS parse error: ".concat(e))}function i(t){var n=t.exec(e);if(n)return e=e.slice(n[0].length),n}function l(){return i(/^{\s*/)}function a(){return i(/^}/)}function c(){i(/^\s*/)}function h(){if(c(),"/"===e[0]&&"*"===e[1]){for(var t=2;e[t]&&("*"!==e[t]||"/"!==e[t+1]);)t++;if(!e[t])return o("end of comment is missing");var n=e.slice(2,t);return e=e.slice(t+2),{type:"comment",comment:n}}}function u(){for(var e,t=[];e=h();)t.push(e);return r.removeComments?[]:t}function d(){for(c();"}"===e[0];)o("extra closing bracket");var t=i(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if(t){var n,r=t[0].trim();/\/\*/.test(r)&&(r=r.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,""));var s=/["']\w*,\w*["']/.test(r);return s&&(r=r.replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,(function(e){return e.replace(/,/g,"")}))),n=/,/.test(r)?r.split(/\s*(?![^(]*\)),\s*/):[r],s&&(n=n.map((function(e){return e.replace(/\u200C/g,",")}))),n}}function g(){if("@"===e[0])return R();i(/^([;\s]*)+/);var t=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=i(/^(\*?[-#/*\\\w.]+(\[[0-9a-z_-]+\])?)\s*/);if(n){if(n=n[0].trim(),!i(/^:\s*/))return o("property missing ':'");var r=i(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),s={type:"declaration",property:n.replace(t,""),value:r?r[0].replace(t,"").trim():""};return i(/^[;\s]*/),s}}function f(){if(!l())return o("missing '{'");for(var e,t=u();e=g();)t.push(e),t=t.concat(u());return a()?t:o("missing '}'")}function m(){c();for(var e,t=[];e=i(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)t.push(e[1]),i(/^,\s*/);if(t.length)return{type:"keyframe",values:t,declarations:f()}}function p(){var e=i(/^@([-\w]+)?keyframes\s*/);if(e){var t=e[1];if(!(e=i(/^([-\w]+)\s*/)))return o("@keyframes missing name");var n,r=e[1];if(!l())return o("@keyframes missing '{'");for(var s=u();n=m();)s.push(n),s=s.concat(u());return a()?{type:"keyframes",name:r,vendor:t,keyframes:s}:o("@keyframes missing '}'")}}function b(){if(i(/^@page */))return{type:"page",selectors:d()||[],declarations:f()}}function _(){var e=i(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);if(e)return{type:"page-margin-box",name:"".concat(e[1],"-").concat(e[2])+(e[3]?"-".concat(e[3]):""),declarations:f()}}function v(){if(i(/^@font-face\s*/))return{type:"font-face",declarations:f()}}function C(){var e=i(/^@supports *([^{]+)/);if(e)return{type:"supports",supports:e[1].trim(),rules:A()}}function T(){if(i(/^@host\s*/))return{type:"host",rules:A()}}function w(){var e=i(/^@media([^{]+)*/);if(e)return{type:"media",media:(e[1]||"").trim(),rules:A()}}function y(){var e=i(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(e)return{type:"custom-media",name:e[1].trim(),media:e[2].trim()}}function S(){var e=i(/^@([-\w]+)?document *([^{]+)/);if(e)return{type:"document",document:e[2].trim(),vendor:e[1]?e[1].trim():null,rules:A()}}function E(){var e=i(/^@(import|charset|namespace)\s*([^;]+);/);if(e)return{type:e[1],name:e[2].trim()}}function R(){if(c(),"@"===e[0]){var t=E()||v()||w()||p()||C()||S()||y()||T()||b()||_();if(t&&!r.preserveStatic){var n=!1;if(t.declarations)n=t.declarations.some((function(e){return/var\(/.test(e.value)}));else n=(t.keyframes||t.rules||[]).some((function(e){return(e.declarations||[]).some((function(e){return/var\(/.test(e.value)}))}));return n?t:{}}return t}}function I(){if(!r.preserveStatic){var t=bC("{","}",e);if(t){var n=/:(?:root|host)(?![.:#(])/.test(t.pre)&&/--\S*\s*:/.test(t.body),s=/var\(/.test(t.body);if(!n&&!s)return e=e.slice(t.end+1),{}}}var i=d()||[],l=r.preserveStatic?f():f().filter((function(e){var t=i.some((function(e){return/:(?:root|host)(?![.:#(])/.test(e)}))&&/^--\S/.test(e.property),n=/var\(/.test(e.value);return t||n}));return i.length||o("selector missing"),{type:"rule",selectors:i,declarations:l}}function A(t){if(!t&&!l())return o("missing '{'");for(var n,r=u();e.length&&(t||"}"!==e[0])&&(n=R()||I());)n.type&&r.push(n),r=r.concat(u());return t||a()?r:o("missing '}'")}return{type:"stylesheet",stylesheet:{rules:A(!0),errors:s}}}function wC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={parseHost:!1,store:{},onWarning:function(){}},r=gC({},n,t),s=new RegExp(":".concat(r.parseHost?"host":"root","$"));return"string"==typeof e&&(e=TC(e,r)),e.stylesheet.rules.forEach((function(e){"rule"===e.type&&e.selectors.some((function(e){return s.test(e)}))&&e.declarations.forEach((function(e,t){var n=e.property,s=e.value;n&&0===n.indexOf("--")&&(r.store[n]=s)}))})),r.store}function yC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r={charset:function(e){return"@charset "+e.name+";"},comment:function(e){return 0===e.comment.indexOf("__CSSVARSPONYFILL")?"/*"+e.comment+"*/":""},"custom-media":function(e){return"@custom-media "+e.name+" "+e.media+";"},declaration:function(e){return e.property+":"+e.value+";"},document:function(e){return"@"+(e.vendor||"")+"document "+e.document+"{"+s(e.rules)+"}"},"font-face":function(e){return"@font-face{"+s(e.declarations)+"}"},host:function(e){return"@host{"+s(e.rules)+"}"},import:function(e){return"@import "+e.name+";"},keyframe:function(e){return e.values.join(",")+"{"+s(e.declarations)+"}"},keyframes:function(e){return"@"+(e.vendor||"")+"keyframes "+e.name+"{"+s(e.keyframes)+"}"},media:function(e){return"@media "+e.media+"{"+s(e.rules)+"}"},namespace:function(e){return"@namespace "+e.name+";"},page:function(e){return"@page "+(e.selectors.length?e.selectors.join(", "):"")+"{"+s(e.declarations)+"}"},"page-margin-box":function(e){return"@"+e.name+"{"+s(e.declarations)+"}"},rule:function(e){var t=e.declarations;if(t.length)return e.selectors.join(",")+"{"+s(t)+"}"},supports:function(e){return"@supports "+e.supports+"{"+s(e.rules)+"}"}};function s(e){for(var s="",o=0;o<e.length;o++){var i=e[o];n&&n(i);var l=r[i.type](i);l&&(s+=l,l.length&&i.selectors&&(s+=t))}return s}return s(e.stylesheet.rules)}function SC(e,t){e.rules.forEach((function(n){n.rules?SC(n,t):n.keyframes?n.keyframes.forEach((function(e){"keyframe"===e.type&&t(e.declarations,n)})):n.declarations&&t(n.declarations,e)}))}_C.range=CC;function EC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={preserveStatic:!0,preserveVars:!1,variables:{},onWarning:function(){}},r=gC({},n,t);return"string"==typeof e&&(e=TC(e,r)),SC(e.stylesheet,(function(e,t){for(var n=0;n<e.length;n++){var s=e[n],o=s.type,i=s.property,l=s.value;if("declaration"===o)if(r.preserveVars||!i||0!==i.indexOf("--")){if(-1!==l.indexOf("var(")){var a=IC(l,r);a!==s.value&&(a=RC(a),r.preserveVars?(e.splice(n,0,{type:o,property:i,value:a}),n++):s.value=a)}}else e.splice(n,1),n--}})),yC(e)}function RC(e){return(e.match(/calc\(([^)]+)\)/g)||[]).forEach((function(t){var n="calc".concat(t.split("calc").join(""));e=e.replace(t,n)})),e}function IC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(-1===e.indexOf("var("))return e;var r=bC("(",")",e);function s(e){var r=e.split(",")[0].replace(/[\s\n\t]/g,""),s=(e.match(/(?:\s*,\s*){1}(.*)?/)||[])[1],o=Object.prototype.hasOwnProperty.call(t.variables,r)?String(t.variables[r]):void 0,i=o||(s?String(s):void 0),l=n||e;return o||t.onWarning('variable "'.concat(r,'" is undefined')),i&&"undefined"!==i&&i.length>0?IC(i,t,l):"var(".concat(l,")")}if(r){if("var"===r.pre.slice(-3)){var o=0===r.body.trim().length;return o?(t.onWarning("var() must contain a non-whitespace string"),e):r.pre.slice(0,-3)+s(r.body)+IC(r.post,t)}return r.pre+"(".concat(IC(r.body,t),")")+IC(r.post,t)}return-1!==e.indexOf("var(")&&t.onWarning('missing closing ")" in the value "'.concat(e,'"')),e}var AC="undefined"!=typeof window,xC=AC&&window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"),OC={group:0,job:0},MC={rootElement:AC?document:null,shadowDOM:!1,include:"style,link[rel=stylesheet]",exclude:"",variables:{},onlyLegacy:!0,preserveStatic:!0,preserveVars:!1,silent:!1,updateDOM:!0,updateURLs:!0,watch:null,onBeforeSend:function(){},onError:function(){},onWarning:function(){},onSuccess:function(){},onComplete:function(){},onFinally:function(){}},NC={cssComments:/\/\*[\s\S]+?\*\//g,cssKeyframes:/@(?:-\w*-)?keyframes/,cssMediaQueries:/@media[^{]+\{([\s\S]+?})\s*}/g,cssUrls:/url\((?!['"]?(?:data|http|\/\/):)['"]?([^'")]*)['"]?\)/g,cssVarDeclRules:/(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^}]*})/g,cssVarDecls:/(?:[\s;]*)(-{2}\w[\w-]*)(?:\s*:\s*)([^;]*);/g,cssVarFunc:/var\(\s*--[\w-]/,cssVars:/(?:(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^;]*;*\s*)|(?:var\(\s*))(--[^:)]+)(?:\s*[:)])/},kC={dom:{},job:{},user:{}},LC=!1,DC=null,PC=0,BC=null,HC=!1;
/**
   * Fetches, parses, and transforms CSS custom properties from specified
   * <style> and <link> elements into static values, then appends a new <style>
   * element with static values to the DOM to provide CSS custom property
   * compatibility for legacy browsers. Also provides a single interface for
   * live updates of runtime values in both modern and legacy browsers.
   *
   * @preserve
   * @param {object}   [options] Options object
   * @param {object}   [options.rootElement=document] Root element to traverse for
   *                   <link> and <style> nodes
   * @param {boolean}  [options.shadowDOM=false] Determines if shadow DOM <link>
   *                   and <style> nodes will be processed.
   * @param {string}   [options.include="style,link[rel=stylesheet]"] CSS selector
   *                   matching <link re="stylesheet"> and <style> nodes to
   *                   process
   * @param {string}   [options.exclude] CSS selector matching <link
   *                   rel="stylehseet"> and <style> nodes to exclude from those
   *                   matches by options.include
   * @param {object}   [options.variables] A map of custom property name/value
   *                   pairs. Property names can omit or include the leading
   *                   double-hyphen (), and values specified will override
   *                   previous values
   * @param {boolean}  [options.onlyLegacy=true] Determines if the ponyfill will
   *                   only generate legacy-compatible CSS in browsers that lack
   *                   native support (i.e., legacy browsers)
   * @param {boolean}  [options.preserveStatic=true] Determines if CSS
   *                   declarations that do not reference a custom property will
   *                   be preserved in the transformed CSS
   * @param {boolean}  [options.preserveVars=false] Determines if CSS custom
   *                   property declarations will be preserved in the transformed
   *                   CSS
   * @param {boolean}  [options.silent=false] Determines if warning and error
   *                   messages will be displayed on the console
   * @param {boolean}  [options.updateDOM=true] Determines if the ponyfill will
   *                   update the DOM after processing CSS custom properties
   * @param {boolean}  [options.updateURLs=true] Determines if relative url()
   *                   paths will be converted to absolute urls in external CSS
   * @param {boolean}  [options.watch=false] Determines if a MutationObserver will
   *                   be created that will execute the ponyfill when a <link> or
   *                   <style> DOM mutation is observed
   * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
   *                   1) the XHR object, 2) source node reference, and 3) the
   *                   source URL as arguments
   * @param {function} [options.onError] Callback after a CSS parsing error has
   *                   occurred or an XHR request has failed. Passes 1) an error
   *                   message, and 2) source node reference, 3) xhr, and 4 url as
   *                   arguments.
   * @param {function} [options.onWarning] Callback after each CSS parsing warning
   *                   has occurred. Passes 1) a warning message as an argument.
   * @param {function} [options.onSuccess] Callback after CSS data has been
   *                   collected from each node and before CSS custom properties
   *                   have been transformed. Allows modifying the CSS data before
   *                   it is transformed by returning any string value (or false
   *                   to skip). Passes 1) CSS text, 2) source node reference, and
   *                   3) the source URL as arguments.
   * @param {function} [options.onComplete] Callback after all CSS has been
   *                   processed, legacy-compatible CSS has been generated, and
   *                   (optionally) the DOM has been updated. Passes 1) a CSS
   *                   string with CSS variable values resolved, 2) an array of
   *                   output <style> node references that have been appended to
   *                   the DOM, 3) an object containing all custom properies names
   *                   and values, and 4) the ponyfill execution time in
   *                   milliseconds.
   * @param {function} [options.onFinally] Callback in modern and legacy browsers
   *                   after the ponyfill has finished all tasks. Passes 1) a
   *                   boolean indicating if the last ponyfill call resulted in a
   *                   style change, 2) a boolean indicating if the current
   *                   browser provides native support for CSS custom properties,
   *                   and 3) the ponyfill execution time in milliseconds.
   * @example
   *
   *   cssVars({
   *     rootElement   : document,
   *     shadowDOM     : false,
   *     include       : 'style,link[rel="stylesheet"]',
   *     exclude       : '',
   *     variables     : {},
   *     onlyLegacy    : true,
   *     preserveStatic: true,
   *     preserveVars  : false,
   *     silent        : false,
   *     updateDOM     : true,
   *     updateURLs    : true,
   *     watch         : false,
   *     onBeforeSend(xhr, node, url) {},
   *     onError(message, node, xhr, url) {},
   *     onWarning(message) {},
   *     onSuccess(cssText, node, url) {},
   *     onComplete(cssText, styleNode, cssVariables, benchmark) {},
   *     onFinally(hasChanged, hasNativeSupport, benchmark)
   *   });
   */
function FC(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="cssVars(): ",n=gC({},MC,e);function r(e,r,s,o){!n.silent&&window.console&&console.error("".concat(t).concat(e,"\n"),r),n.onError(e,r,s,o)}function s(e){!n.silent&&window.console&&console.warn("".concat(t).concat(e)),n.onWarning(e)}function o(e){n.onFinally(Boolean(e),xC,GC()-n.__benchmark)}if(AC){if(n.watch)return n.watch=MC.watch,zC(n),void FC(n);if(!1===n.watch&&DC&&(DC.disconnect(),DC=null),!n.__benchmark){if(LC===n.rootElement)return void UC(e);var i=[].slice.call(n.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])'));if(n.__benchmark=GC(),n.exclude=[DC?'[data-cssvars]:not([data-cssvars=""])':'[data-cssvars="out"]',"link[disabled]:not([data-cssvars])",n.exclude].filter((function(e){return e})).join(","),n.variables=jC(n.variables),i.forEach((function(e){var t="style"===e.nodeName.toLowerCase()&&e.__cssVars.text,n=t&&e.textContent!==e.__cssVars.text;t&&n&&(e.sheet&&(e.sheet.disabled=!1),e.setAttribute("data-cssvars",""))})),!DC){var l=[].slice.call(n.rootElement.querySelectorAll('[data-cssvars="out"]'));l.forEach((function(e){var t=e.getAttribute("data-cssvars-group");(t?n.rootElement.querySelector('[data-cssvars="src"][data-cssvars-group="'.concat(t,'"]')):null)||e.parentNode.removeChild(e)})),PC&&i.length<PC&&(PC=i.length,kC.dom={})}}if("loading"!==document.readyState)if(xC&&n.onlyLegacy){var a=!1;if(n.updateDOM){var c=n.rootElement.host||(n.rootElement===document?document.documentElement:n.rootElement);Object.keys(n.variables).forEach((function(e){var t=n.variables[e];a=a||t!==getComputedStyle(c).getPropertyValue(e),c.style.setProperty(e,t)}))}o(a)}else!HC&&(n.shadowDOM||n.rootElement.shadowRoot||n.rootElement.host)?mC({rootElement:MC.rootElement,include:MC.include,exclude:n.exclude,skipDisabled:!1,onSuccess:function(e,t,n){return!((t.sheet||{}).disabled&&!t.__cssVars)&&((e=((e=e.replace(NC.cssComments,"").replace(NC.cssMediaQueries,"")).match(NC.cssVarDeclRules)||[]).join(""))||!1)},onComplete:function(e,t,r){wC(e,{store:kC.dom,onWarning:s}),HC=!0,FC(n)}}):(LC=n.rootElement,mC({rootElement:n.rootElement,include:n.include,exclude:n.exclude,skipDisabled:!1,onBeforeSend:n.onBeforeSend,onError:function(e,t,n){var s=e.responseURL||YC(n,location.href),o=e.statusText?"(".concat(e.statusText,")"):"Unspecified Error"+(0===e.status?" (possibly CORS related)":"");r("CSS XHR Error: ".concat(s," ").concat(e.status," ").concat(o),t,e,s)},onSuccess:function(e,t,r){if((t.sheet||{}).disabled&&!t.__cssVars)return!1;var s="link"===t.nodeName.toLowerCase(),o="style"===t.nodeName.toLowerCase()&&e!==t.textContent,i=n.onSuccess(e,t,r);return e=void 0!==i&&!1===Boolean(i)?"":i||e,n.updateURLs&&(s||o)&&(e=VC(e,r)),e},onComplete:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],l=gC({},kC.dom,kC.user);if(kC.job={},i.forEach((function(e,o){var i=t[o];if(e.__cssVars=e.__cssVars||{},e.__cssVars.text=i,NC.cssVars.test(i))try{var l=TC(i,{preserveStatic:n.preserveStatic,removeComments:!0});wC(l,{parseHost:Boolean(n.rootElement.host),store:kC.dom,onWarning:s}),e.__cssVars.tree=l}catch(a){r(a.message,e)}})),gC(kC.job,kC.dom),n.updateDOM?(gC(kC.user,n.variables),gC(kC.job,kC.user)):(gC(kC.job,kC.user,n.variables),gC(l,n.variables)),OC.job>0&&Boolean(Object.keys(kC.job).length>Object.keys(l).length||Boolean(Object.keys(l).length&&Object.keys(kC.job).some((function(e){return kC.job[e]!==l[e]})))))XC(n.rootElement),FC(n);else{var a=[],c=[],h=!1;if(n.updateDOM&&OC.job++,i.forEach((function(e,o){var i=!e.__cssVars.tree;if(e.__cssVars.tree)try{EC(e.__cssVars.tree,gC({},n,{variables:kC.job,onWarning:s}));var l=yC(e.__cssVars.tree);if(n.updateDOM){var u=t[o],d=NC.cssVarFunc.test(u);if(e.getAttribute("data-cssvars")||e.setAttribute("data-cssvars","src"),l.length&&d){var g=e.getAttribute("data-cssvars-group")||++OC.group,f=l.replace(/\s/g,""),m=n.rootElement.querySelector('[data-cssvars="out"][data-cssvars-group="'.concat(g,'"]'))||document.createElement("style");h=h||NC.cssKeyframes.test(l),n.preserveStatic&&e.sheet&&(e.sheet.disabled=!0),m.hasAttribute("data-cssvars")||m.setAttribute("data-cssvars","out"),f===e.textContent.replace(/\s/g,"")?(i=!0,m&&m.parentNode&&(e.removeAttribute("data-cssvars-group"),m.parentNode.removeChild(m))):f!==m.textContent.replace(/\s/g,"")&&([e,m].forEach((function(e){e.setAttribute("data-cssvars-job",OC.job),e.setAttribute("data-cssvars-group",g)})),m.textContent=l,a.push(l),c.push(m),m.parentNode||e.parentNode.insertBefore(m,e.nextSibling))}}else e.textContent.replace(/\s/g,"")!==l&&a.push(l)}catch(p){r(p.message,e)}i&&e.setAttribute("data-cssvars","skip"),e.hasAttribute("data-cssvars-job")||e.setAttribute("data-cssvars-job",OC.job)})),PC=n.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])').length,n.shadowDOM)for(var u,d=[].concat(n.rootElement).concat([].slice.call(n.rootElement.querySelectorAll("*"))),g=0;u=d[g];++g)if(u.shadowRoot&&u.shadowRoot.querySelector("style")){var f=gC({},n,{rootElement:u.shadowRoot});FC(f)}n.updateDOM&&h&&WC(n.rootElement),LC=!1,n.onComplete(a.join(""),c,JSON.parse(JSON.stringify(kC.job)),GC()-n.__benchmark),o(c.length)}}}));else document.addEventListener("DOMContentLoaded",(function t(n){FC(e),document.removeEventListener("DOMContentLoaded",t)}))}}function zC(e){function t(e){var t=n(e)&&e.hasAttribute("disabled"),r=(e.sheet||{}).disabled;return t||r}function n(e){return"link"===e.nodeName.toLowerCase()&&-1!==(e.getAttribute("rel")||"").indexOf("stylesheet")}function r(e){return"style"===e.nodeName.toLowerCase()}window.MutationObserver&&(DC&&(DC.disconnect(),DC=null),(DC=new MutationObserver((function(s){s.some((function(s){return function(r){var s=!1;if("attributes"===r.type&&n(r.target)&&!t(r.target)){var o="disabled"===r.attributeName,i="href"===r.attributeName,l="skip"===r.target.getAttribute("data-cssvars"),a="src"===r.target.getAttribute("data-cssvars");o?s=!l&&!a:i&&(l?r.target.setAttribute("data-cssvars",""):a&&XC(e.rootElement,!0),s=!0)}return s}(s)||function(e){var t=!1;if("childList"===e.type){var n=r(e.target),s="out"===e.target.getAttribute("data-cssvars");t=n&&!s}return t}(s)||function(e){var s=!1;return"childList"===e.type&&(s=[].slice.call(e.addedNodes).some((function(e){var s=1===e.nodeType&&e.hasAttribute("data-cssvars"),o=r(e)&&NC.cssVars.test(e.textContent);return!s&&(n(e)||o)&&!t(e)}))),s}(s)||function(t){var n=!1;return"childList"===t.type&&(n=[].slice.call(t.removedNodes).some((function(t){var n=1===t.nodeType,r=n&&"out"===t.getAttribute("data-cssvars"),s=n&&"src"===t.getAttribute("data-cssvars"),o=s;if(s||r){var i=t.getAttribute("data-cssvars-group"),l=e.rootElement.querySelector('[data-cssvars-group="'.concat(i,'"]'));s&&XC(e.rootElement,!0),l&&l.parentNode.removeChild(l)}return o}))),n}(s)}))&&FC(e)}))).observe(document.documentElement,{attributes:!0,attributeFilter:["disabled","href"],childList:!0,subtree:!0}))}function UC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;clearTimeout(BC),BC=setTimeout((function(){e.__benchmark=null,FC(e)}),t)}function WC(e){var t=["animation-name","-moz-animation-name","-webkit-animation-name"].filter((function(e){return getComputedStyle(document.body)[e]}))[0];if(t){for(var n=[].slice.call(e.querySelectorAll("*")),r=[],s="__CSSVARSPONYFILL-KEYFRAMES__",o=0,i=n.length;o<i;o++){var l=n[o];"none"!==getComputedStyle(l)[t]&&(l.style[t]+=s,r.push(l))}document.body.offsetHeight;for(var a=0,c=r.length;a<c;a++){var h=r[a].style;h[t]=h[t].replace(s,"")}}}function VC(e,t){return(e.replace(NC.cssComments,"").match(NC.cssUrls)||[]).forEach((function(n){var r=n.replace(NC.cssUrls,"$1"),s=YC(r,t);e=e.replace(n,n.replace(r,s))})),e}function jC(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=/^-{2}/;return Object.keys(e).reduce((function(n,r){return n[t.test(r)?r:"--".concat(r.replace(/^-+/,""))]=e[r],n}),{})}function YC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.href,n=document.implementation.createHTMLDocument(""),r=n.createElement("base"),s=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(s),r.href=t,s.href=e,s.href}function GC(){return AC&&(window.performance||{}).now?window.performance.now():(new Date).getTime()}function XC(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[].slice.call(e.querySelectorAll('[data-cssvars="skip"],[data-cssvars="src"]'));n.forEach((function(e){return e.setAttribute("data-cssvars","")})),t&&(kC.dom={})}FC.reset=function(){for(var e in OC.job=0,OC.group=0,LC=!1,DC&&(DC.disconnect(),DC=null),PC=0,BC=null,HC=!1,kC)kC[e]={}};var $C="univer-layout-container",QC="univer-content-container-horizontal",KC="univer-content-inner-left-container",ZC="univer-hover-cursor",qC="univer-content-inner-right-container",JC="univer-content-container-vertical",eT="univer-main-content",tT="univer-outer-right-container";var nT="univer-info-detail",rT="univer-sheet-name",sT="univer-info-detail-update",oT="univer-info-detail-save";class iT extends sm{initialize(){this.state={infoList:null}}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}setInfoList(e){this.setState({infoList:e})}render(){const{renameSheet:e}=this.props;if(!this.state.infoList)return;const{back:t,sheet:n,update:r,save:s,rename:o}=this.state.infoList;return Kd(b_,{className:nT},Kd("div",{className:rT},Kd(uv,{title:o.label,placement:"bottom"},Kd(e_,{bordered:!1,value:n.label,onBlur:e}))),Kd("div",{className:sT},r.label),Kd("div",{className:oT},s.label))}}var lT="univer-context-menu",aT="univer-right-menu-center",cT="univer-right-menu-item";class hT extends sm{constructor(){super(...arguments),this.ulRef={current:null},this.root={current:null},this.handleContextMenu=async(e,t,n)=>{e.preventDefault(),this.setState({visible:!0,srcElement:e.target,eventType:e.type},(()=>{new Promise(((e,t)=>{this.ulRef.current.showMenu(!0),e()})).then((()=>{const r=n?t.x:e.clientX,s=n?t.y:e.clientY,o=window.innerWidth,i=window.innerHeight,l=this.ulRef.current.base.offsetWidth,a=this.ulRef.current.base.offsetHeight,c=o-r>l,h=!c,u=i-s>a,d=!u;c&&(this.root.current.style.left=`${r}px`),h&&(this.root.current.style.left=r-l+"px"),u&&(this.root.current.style.top=`${s}px`),d&&(this.root.current.style.top=s-a+"px")}))}))},this.handleClick=e=>{const{visible:t,eventType:n,srcElement:r}=this.state;this.root.current&&("click"===n&&r&&r.contains(e.target)||this.root.current.contains(e.target)||t&&this.setState({visible:!1}))}}initialize(){this.state={visible:!1,srcElement:null,eventType:null,children:[],replace:[]}}resetMenuList(e,t){var n,r;const s=null==(n=this.getContext().getPluginManager().getPluginByName(xd))?void 0:n.getComponentManager();for(let o=0;o<e.length;o++){const n=e[o];if(n.customLabel){const e=null==s?void 0:s.get(n.customLabel.name),t=null!=(r=n.customLabel.props)?r:{};e&&(n.label=Kd(e,__spreadValues({},t)))}else"string"==typeof n.label&&(n.label=this.getLocale(t[o].label));n.children&&(n.children=this.resetMenuList(n.children,t[o].children))}return e}setMenuList(e){this.setState({children:e,replace:JSON.parse(JSON.stringify(e))})}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this),document.addEventListener("click",this.handleClick)}componentWillUnmount(){document.removeEventListener("click",this.handleClick)}showRightMenu(e){this.ulRef.current.showMenu(e)}render(){if(!this.state.children.length)return;const e=__spreadValues({},this.props.style),{visible:t}=this.state;return t&&Kd("div",{ref:this.root,className:lT,style:e,onContextMenu:e=>{e.preventDefault()}},Kd(L_,{ref:this.ulRef,menu:this.resetMenuList(this.state.children,this.state.replace),onClick:this.handleClick}))}}class uT extends sm{handleClick(e){e.stopPropagation()}handleKeyUp(e){const{onKeyUp:t}=this.props;null==t||t(e)}render(){const{prefix:e,suffix:t}=this.props;return Kd("div",null,this.getLocale(e),Kd(e_,{onPressEnter:this.handleKeyUp.bind(this),type:"number",placeholder:"1",onClick:this.handleClick}),this.getLocale(t))}}class dT extends sm{render(){const{label:e}=this.props;return Kd("div",{className:cT},this.getLocale(e),Kd(Mp.RightIcon,null))}}var gT="univer-count-bar",fT="univer-count-zoom",mT="univer-count-slider",pT="univer-count-statistic";class bT extends sm{constructor(){super(...arguments),this.max=400,this.min=0,this.ref={current:null},this.setValue=(e,t)=>{this.setState((t=>__spreadValues({},e)),t)},this.onChange=e=>{let t=e.target;this.props.onChange&&this.props.onChange(t.value),this.setValue({zoom:t.value}),this.ref.current.changeInputValue(0,t.value)},this.handleClick=(e,t)=>{this.setValue({zoom:t})},this.addZoom=()=>{let e=10*(Math.floor(this.state.zoom/10)+1);e>=this.max&&(e=this.max),this.setValue({zoom:e}),this.props.onChange&&this.props.onChange(String(e))},this.reduceZoom=()=>{let e=10*(Math.ceil(this.state.zoom/10)-1);e<=this.min&&(e=this.min),this.setValue({zoom:e}),this.props.onChange&&this.props.onChange(String(e)),this.ref.current.changeInputValue(0,e)}}initialize(e){this.state={zoom:100,content:""}}setZoom(e){e!==this.state.zoom&&(this.setValue({zoom:e}),this.ref.current.changeInputValue(0,e))}componentDidMount(){var e;null==(e=this.getContext().getObserverManager().getObserver("onCountBarDidMountObservable",Ut.SPREADSHEET))||e.notifyObservers(this)}render(e,t){const{zoom:n,content:r}=t;return Kd("div",{className:gT},Kd(pb,{type:"text",className:fT},n),Kd(pb,{type:"text",onClick:this.addZoom},Kd(Hm.AddIcon,null)),Kd("div",{className:mT},Kd(Rv,{ref:this.ref,onChange:this.onChange,value:n,min:this.min,max:this.max,onClick:this.handleClick})),Kd(pb,{type:"text",onClick:this.reduceZoom},Kd(Hm.ReduceIcon,null)),Kd(pb,{type:"text"},Kd(Yp.RegularIcon,null)),Kd("span",{className:pT},r))}}var _T="univer-sheet-bar",vT="univer-sheet-bar-options",CT="univer-sheet-bar-options-button",TT="univer-sheet_bar_scroll_button",wT="univer-slide-tab-bar",yT="univer-slide-tab-active",ST="univer-slide-tab-item",ET="univer-slide-tab-divider",RT="univer-slide-tab-content",IT="univer-slide-tab-title",AT="univer-slide-tab-span",xT="univer-slide-tab-icon",OT="univer-slide-tab-footer",MT="univer-slide-tab-active-bar",NT="univer-sheet-ul",kT="univer-select-color-picker-parent",LT="univer-select-color-picker",DT="univer-sheet-bar-menu",PT="univer-sheet-bar-menu-item",BT="univer-sheet-bar-menu-icon",HT="univer-sheet-bar-menu-svg",FT="univer-sheet-bar-menu-title";class zT extends sm{constructor(){super(...arguments),this.hideMenu=()=>{this.showMenu(!1)}}initialize(){this.state={show:!1}}handleClick(e,t){e.stopPropagation();const{onClick:n}=this.props;t.onClick&&t.onClick(e),null==n||n(e),this.showMenu(!1),window.removeEventListener("click",this.hideMenu,!0)}showMenu(e){this.setState({show:e},(()=>{this.state.show&&window.addEventListener("click",this.hideMenu,!0)}))}render(){const{menu:e,style:t}=this.props,{show:n}=this.state;return Kd("ul",{className:DT,style:__spreadProps(__spreadValues({},t),{display:n?"block":" none"})},e.map((e=>Kd("li",{onClick:t=>this.handleClick(t,e),className:Em(PT)},Kd("span",{className:BT},Kd(UT,{item:e})),Kd("span",{className:FT},e.label)))))}}function UT(e){return e.item.hide?Kd(Op,null):e.item.selected?Kd(Np.CheckIcon,{className:HT}):Kd(Jd,null)}class WT{constructor(e){const t=e.primeval();this._scrollX=t.scrollLeft,this._slideTabBar=e}scrollX(e){const t=this._slideTabBar.primeval();t.scrollLeft=e,this._scrollX=t.scrollLeft}scrollRight(){const e=this._slideTabBar.primeval();e.scrollLeft=e.scrollWidth,this._scrollX=e.scrollLeft}getScrollX(){return this._scrollX}}const VT={easeOutStrong:(e,t,n,r)=>-n*((e=e/r-1)*e*e*e-1)+t,backOut:(e,t,n,r,s)=>(void 0===s&&(s=.7),n*((e=e/r-1)*e*((s+1)*e+s)+1)+t)},jT={loop:!1,begin:0,end:0,duration:300,delay:0,type:"easeOutStrong",receive(e){},success(e){},cancel(e){},complete(e){}};var YT,GT;(GT=YT||(YT={}))[GT.Request=0]="Request",GT[GT.Cancel=1]="Cancel";class XT{constructor(e){this._config=__spreadValues(__spreadValues({},jT),e),this._config.loop&&(this._config.complete=()=>{},this._config.success=()=>{this.request()})}static success(...e){let t=0;return new Promise((n=>{for(let r=0;r<e.length;r++){let s=e[r],o=s._config,i=o.success;o.loop||(o.success=r=>{t++,i&&i.call(s,r),t===e.length&&n()})}}))}request(){0===this._config.delay?(this._status=0,this._start=Date.now(),this._fakeHandle()):(this._delayHandle&&clearTimeout(this._delayHandle),this._delayHandle=setTimeout((()=>{this._status=0,this._start=Date.now(),this._fakeHandle()}),this._config.delay))}cancel(){this._status=1,this._delayHandle&&clearTimeout(this._delayHandle),cancelAnimationFrame(this._handle)}_fakeHandle(){let e=Date.now()-this._start;e=e>=this._config.duration?this._config.duration:e;let t=VT[this._config.type](e,this._config.begin,this._config.end-this._config.begin,this._config.duration,.7).toFixed(2);return this._config.receive(t),1===this._status?(this._config.cancel(t),void this._config.complete(t)):e===this._config.duration?(this._config.success(t),void this._config.complete(t)):void(this._handle=requestAnimationFrame((()=>{this._fakeHandle()})))}}class $T{constructor(e,t){this._slideTabItem=e,this._animate=null,this._translateX=0,this._editMode=!1,this._slideTabBar=t,this._placeholder=null,this._scrollbar=t.getScrollbar(),this.update()}static midline(e){return e.getBoundingRect().x+e.getBoundingRect().width/2}static make(e,t){let n=[];return e.forEach((e=>n.push(new $T(e,t)))),n}isEditMode(){return this._editMode}classList(){return this._slideTabItem.classList}primeval(){return this._slideTabItem}translateX(e){return this._translateX=e,this._slideTabItem.style.transform=`translateX(${e}px)`,this.getTranslateXDirection()}editor(e){if(!1===this._editMode){let t=this.primeval().querySelector("span"),n=s=>{this._editMode=!1,t&&(t.removeAttribute("contentEditable"),t.removeEventListener("blur",n),t.removeEventListener("input",r)),this._slideTabBar.updateItems(),this._slideTabBar.getConfig().onChangeName&&this._slideTabBar.getConfig().onChangeName(s),e&&e(s)},r=()=>{if(t){const e=t.querySelectorAll("br");e.length>0&&(e.forEach((e=>{t&&t.removeChild(e)})),t.blur())}};t&&(t.setAttribute("contentEditable","true"),t.addEventListener("blur",n),t.addEventListener("input",r),this._editMode=!0,QT.keepLastIndex(t))}}animate(){return{translateX:e=>{this._translateX!==e&&(this._animate&&(this._animate.cancel(),this._animate=null),this._animate=new XT({begin:this._translateX,end:e,receive:e=>{this._slideTabItem.style.transform=`translateX(${e}px)`}}),this._translateX=e,this._animate.request())},cancel:()=>{this._animate&&(this._animate.cancel(),this._animate=null)}}}after(e){this._slideTabItem.after(e._slideTabItem||e)}update(){this._midline=$T.midline(this)}disableFixed(){if(this._placeholder){const e=this._slideTabBar.primeval();this._slideTabItem.style.removeProperty("position"),this._slideTabItem.style.removeProperty("left"),this._slideTabItem.style.removeProperty("top"),this._slideTabItem.style.removeProperty("width"),this._slideTabItem.style.removeProperty("height"),this._slideTabItem.style.removeProperty("box-shadow"),this._slideTabItem.style.removeProperty("background"),this._placeholder.after(this._slideTabItem),e.removeChild(this._placeholder),this._placeholder=null}}enableFixed(){const e=document.createElement("div"),t=this.getBoundingRect();this._placeholder=e,this._placeholder.style.width=`${t.width}px`,this._placeholder.style.height=`${t.height}px`,this._placeholder.style.flexShrink="0",this._slideTabItem.style.left=t.x-this.getScrollbar().getScrollX()+"px",this._slideTabItem.style.top=`${t.y}px`,this._slideTabItem.style.width=`${t.width}px`,this._slideTabItem.style.height=`${t.height}px`,this._slideTabItem.style.background=getComputedStyle(this._slideTabItem).background,this._slideTabItem.style.boxShadow="0px 0px 1px 1px rgba(82,82,82,0.1)",this._slideTabItem.style.position="fixed",this._slideTabItem.after(e),document.body.appendChild(this._slideTabItem)}addEventListener(e,t,n){this._slideTabItem.addEventListener(e,t,n)}removeEventListener(e,t,n){this._slideTabItem.removeEventListener(e,t,n)}getScrollbar(){return this._scrollbar}getMidLine(){return this._midline}getBoundingRect(){const e=this._slideTabItem.getBoundingClientRect();return e.x+=this._scrollbar.getScrollX(),e}getWidth(){return this.getBoundingRect().width}getTranslateXDirection(){const e=$T.midline(this);return e>this._midline?1:e<this._midline?-1:0}equals(e){return e&&e._slideTabItem===this._slideTabItem}}class QT{constructor(e){var t,n;if(null==e.slideTabRoot)throw new Error("not found slide-tab-bar root element");const r=e.slideTabRoot.querySelector(`.${null!=(t=e.slideTabBarClassName)?t:"slide-tab-bar"}`),s=e.slideTabRoot.querySelectorAll(`.${null!=(n=e.slideTabBarItemClassName)?n:"slide-tab-item"}`);if(null==r)throw new Error("not found slide-tab-bar");this._config=e,this._activeTabItem=null,this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._activeTabItemIndex=0,this._slideTabBar=r,this._slideScrollbar=new WT(this),this._slideTabItems=$T.make(s,this);let o=0,i=0,l=0;this._downAction=e=>{var t;if(2===e.button)return o=0,l=0,void(i=0);const{pageX:n,pageY:r}=e,s=Date.now();if(s-l<=800&&n===o&&r===i){const t=this._slideTabItems.find((t=>t.equals(new $T(e.currentTarget,this))));t&&t.editor(),l=0,o=0,i=0}else{if(!this._hasEditItem()){if(QT.checkedSkipSlide(e))return o=0,l=0,void(i=0);const n=this._slideTabItems.findIndex((t=>t.equals(new $T(e.currentTarget,this))));n>-1?(this._compareIndex=n,this._downActionX=e.pageX,this._moveActionX=0,this._scrollIncremental=0,this._activeTabItem=this._slideTabItems[n],this._activeTabItemIndex=n,this._config.activeClassNameAutoController&&(this._slideTabItems.forEach((e=>{var t;e.classList().remove(null!=(t=this._config.slideTabBarItemActiveClassName)?t:"slide-tab-active")})),this._activeTabItem.classList().add(null!=(t=this._config.slideTabBarItemActiveClassName)?t:"slide-tab-active")),this._activeTabItem.enableFixed(),this._startAutoScroll()):(this.updateItems(),this._activeTabItemIndex=0,this._downActionX=0,this._scrollIncremental=0,this._compareIndex=0,this._activeTabItem=null)}o=n,i=r,l=s}},this._upAction=e=>{if(this._activeTabItem){this._closeAutoScroll(),this._activeTabItem.disableFixed(),this._sortedItems(),this.updateItems(),this._config.onSlideEnd&&this._activeTabItemIndex!==this._compareIndex&&this._config.onSlideEnd(e);let t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this._activeTabItem.primeval().dispatchEvent(t),this._scrollIncremental=0,this._activeTabItemIndex=0,this._downActionX=0,this._moveActionX=0,this._compareIndex=0,this._activeTabItem=null}},this._moveAction=e=>{this._activeTabItem&&(this._moveActionX=e.pageX-this._downActionX,this._scrollIncremental=0,this._scrollLeft(e),this._scrollRight(e))},this._wheelAction=e=>{e.deltaY,this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+e.deltaY)},this._initialize()}static checkedSkipSlide(e){let t=e.target;for(;null!=t&&t!==document.body;){if(t.getAttribute("data-slide-skip"))return!0;t=t.parentElement}return!1}static keepLastIndex(e){setTimeout((()=>{const t=window.getSelection();t&&(t.selectAllChildren(e),t.collapseToEnd())}))}primeval(){return this._slideTabBar}updateItems(){for(let e=0;e<this._slideTabItems.length;e++)this._slideTabItems[e].animate().cancel(),this._slideTabItems[e].translateX(0),this._slideTabItems[e].update()}getScrollbar(){return this._slideScrollbar}getConfig(){return this._config}getBoundingRect(){return this._slideTabBar.getBoundingClientRect()}getSlideTabItems(){return this._slideTabItems}destroy(){document.removeEventListener("mousemove",this._moveAction),document.removeEventListener("mouseup",this._upAction),document.removeEventListener("wheel",this._wheelAction),this._slideTabItems.forEach((e=>{e.removeEventListener("mousedown",this._downAction)}))}_hasEditItem(){for(let e=0;e<this._slideTabItems.length;e++){if(this._slideTabItems[e].isEditMode())return!0}return!1}_autoScrollFrame(){if(this._activeTabItem)switch(this._compareDirection=this._activeTabItem.translateX(this._moveActionX),this._compareDirection){case 1:this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareRight();break;case 0:this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareIndex=this._activeTabItemIndex;break;case-1:this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareLeft()}this._autoScrollTime=requestAnimationFrame((()=>{this._autoScrollFrame()}))}_startAutoScroll(){null==this._autoScrollTime&&this._autoScrollFrame()}_closeAutoScroll(){this._autoScrollTime&&cancelAnimationFrame(this._autoScrollTime),this._autoScrollTime=null}_scrollLeft(e){const t=this.getBoundingRect(),n=e.pageX-t.x;n<10&&(this._scrollIncremental=-Math.min(.1*Math.abs(n-10),50))}_scrollRight(e){const t=this.getBoundingRect(),n=e.pageX-t.x;n>t.width-10&&(this._scrollIncremental=Math.min(.1*Math.abs(n-(t.width-10)),50))}_sortedItems(){if(null!=this._activeTabItem&&null!=this._activeTabItemIndex&&null!=this._compareIndex&&(this._slideTabItems.splice(this._activeTabItemIndex,1),this._slideTabItems.splice(this._compareIndex,0,this._activeTabItem),this._config.slideTabBarItemAutoSort))for(let e=0;e<this._slideTabItems.length;e++){let t=this._slideTabItems[e],n=this._slideTabItems[e+1];n&&t.after(n)}}_compareLeft(){if(this._activeTabItem&&this._activeTabItemIndex){let e=this._slideTabItems.findIndex((e=>e.equals(this._activeTabItem))),t=this._slideTabItems.length,n=[];for(let s=0;s<e&&!(s>=e);s++)n.push(this._slideTabItems[s]);for(let s=e+1;s<t;s++)this._slideTabItems[s].animate().translateX(0);let r=!0;for(let s=n.length-1;s>=0;s--){let e=n[s];$T.midline(this._activeTabItem)<e.getMidLine()?(e.animate().translateX(this._activeTabItem.getWidth()),this._compareIndex=s,r=!1):(e.animate().translateX(0),r&&(this._compareIndex=this._activeTabItemIndex))}}}_compareRight(){if(this._activeTabItem){let e=this._slideTabItems.findIndex((e=>e.equals(this._activeTabItem))),t=this._slideTabItems.length,n=[];for(let s=e+1;s<t;s++)n.push(this._slideTabItems[s]);for(let s=0;s<e;s++)this._slideTabItems[s].animate().translateX(0);let r=!0;for(let s=0;s<n.length;s++){let t=n[s];$T.midline(this._activeTabItem)>t.getMidLine()?(t.animate().translateX(-this._activeTabItem.getWidth()),this._compareIndex=e+s+1,r=!1):(t.animate().translateX(0),r&&(this._compareIndex=this._activeTabItemIndex))}}}_initialize(){document.addEventListener("mousemove",this._moveAction),document.addEventListener("mouseup",this._upAction),this._slideTabBar.addEventListener("wheel",this._wheelAction),this._slideTabItems.forEach((e=>{e.addEventListener("mousedown",this._downAction)}))}}class KT extends sm{constructor(){super(...arguments),this.ref={current:null},this.ulRef={current:null},this.sheetContainerRef={current:null},this.slideTabRoot={current:null},this.sheetContentRef={current:null},this.sheetBarContentRef={current:null},this.time=0,this.target=null,this.cloneTarget=null,this._renderKey=1,this.setValue=(e,t)=>{let{sheetList:n,menuList:r,sheetUl:s}=e;n&&(n=this.resetLabel(n)),r&&(r=this.resetLabel(r)),s&&(s=this.resetLabel(s)),this.setState((t=>__spreadValues({},e)),t)},this.scrollLeft=e=>{this.slideTabBar.getScrollbar().scrollX(this.slideTabBar.getScrollbar().getScrollX()-50)},this.scrollRight=e=>{this.slideTabBar.getScrollbar().scrollX(this.slideTabBar.getScrollbar().getScrollX()+50)},this.overGrid=()=>{},this.contextMenu=e=>{e.preventDefault(),this.showUlList(e)},this.showSelect=(e,t)=>{e.stopImmediatePropagation();const n=t.current;n&&n.showMenu(!0),window.addEventListener("click",this.hideSelect)},this.hideSelect=e=>{const t=this.ulRef.current;t&&t.showMenu(!1),window.removeEventListener("click",this.hideSelect)},this.showUlList=e=>{new Promise((t=>{e.currentTarget.dataset.id,this.showSelect(e,this.ulRef),t()})).then((()=>{const t=e.currentTarget.closest(`.${ST}`);if(t){const e=t.getBoundingClientRect(),n=`${e.left}px`,r=`${e.height}px`,s=this.ulRef.current.base;s.style.left=n,s.style.bottom=r,s.style.top="auto",s.style.right="auto"}}))},this.reNameSheet=e=>{const t=this.slideTabBar.getSlideTabItems().find((t=>t.primeval().dataset.id===e));t&&t.editor()},this.changeEditable=e=>{const t=e.target;let n;t.contentEditable="true",t.focus(),t.addEventListener("blur",n=r=>{var s,o;null==(o=(s=this.props).changeSheetName)||o.call(s,e),t.contentEditable="false",t.removeEventListener("blur",n)})}}initialize(e){this.state={sheetList:[],sheetUl:[],menuList:[]}}resetLabel(e){var t,n;const r=null==(t=this.getContext().getPluginManager().getPluginByName(xd))?void 0:t.getComponentManager();for(let s=0;s<e.length;s++){const t=e[s];if(t.customLabel){const e=null==r?void 0:r.get(t.customLabel.name);if(e){const r=null!=(n=t.customLabel.props)?n:{};t.label=Kd(e,__spreadValues({},r))}}t.children&&(t.children=this.resetLabel(t.children))}return e}componentDidUpdate(){this.slideTabBar&&this.slideTabBar.destroy(),this.slideTabBar=new QT({slideTabBarClassName:"univer-slide-tab-bar",slideTabBarItemActiveClassName:"univer-slide-tab-active",slideTabBarItemClassName:"univer-slide-tab-item",slideTabBarItemAutoSort:!0,slideTabRoot:this.slideTabRoot.current,onChangeName:e=>{var t,n;null==(n=(t=this.props).changeSheetName)||n.call(t,e)},onSlideEnd:e=>{var t,n;null==(n=(t=this.props).dragEnd)||n.call(t,this.slideTabBar.getSlideTabItems().map((e=>e.primeval())))}})}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}render(e,t){const{sheetList:n,menuList:r,sheetUl:s}=t,{addSheet:o,selectSheet:i}=this.props;if(n.length)return Kd("div",{className:_T,ref:this.slideTabRoot},Kd("div",{className:vT},Kd(pb,{className:CT,onClick:o,type:"text"},Kd(Hm.AddIcon,{style:{fontSize:"20px"}})),Kd(pb,{className:CT,onClick:e=>this.ref.current.showMenu(!0),type:"text"},Kd(xp,{style:{fontSize:"20px"}}),Kd(zT,{onClick:i,menu:r,ref:this.ref}))),Kd("div",{className:wT,ref:this.sheetContainerRef},n.map((e=>Kd("div",{onMouseDown:e.onDown,onClick:e.onClick,onContextMenu:this.contextMenu,"data-id":e.sheetId,key:this._renderKey++,className:`${ST} ${e.selected?yT:""}`},Kd("div",{className:`${RT}`},Kd("div",{className:`${ET}`}),Kd("div",{className:`${IT}`},Kd("span",{className:`${AT}`,style:{padding:"2px 5px 2px 5px"}},e.label)),Kd("div",{className:`${xT}`,"data-slide-skip":"true",style:{lineHeight:1},"data-id":e.sheetId,onClick:this.contextMenu},Kd(Sp,null))),Kd("div",{className:`${OT}`},Kd("div",{className:`${MT}`,style:e.color?{background:e.color}:{}})))))),Kd(L_,{className:NT,menu:s,ref:this.ulRef}),Kd("div",{className:`${vT} ${TT}`},Kd(pb,{type:"text",className:CT,onClick:this.scrollLeft},Kd(Sp,{rotate:90,style:{padding:"5px"}})),Kd(pb,{type:"text",className:CT,onClick:this.scrollRight},Kd(Sp,{rotate:-90,style:{padding:"5px"}}))))}}var ZT="univer-formula-box",qT="univer-formula-bar",JT="univer-formula-icon",ew="univer-formula-grey",tw="univer-formula-black",nw="univer-formula-input",rw="univer-formula-content";class sw extends sm{constructor(){super(...arguments),this.onkeyUp=e=>{},this.printChange=e=>{this.onkeyUp(e.target)}}initialize(e){this.state={namedRanges:[{value:"1",label:"1"}],spanClass:ew,formulaContent:"",fx:null},this.onkeyUp=Rm(this.onkeyUp,300)}setFormulaContent(e){this.setState({formulaContent:e})}setFx(e){this.setState({fx:e})}setNamedRanges(e){this.setState({namedRanges:e})}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}getIcon(e){var t;const n=null==(t=this.getContext().getPluginManager().getPluginByName(xd))?void 0:t.getComponentManager();return Kd(null==n?void 0:n.get(e),null)}render(e,t){const{namedRanges:n,fx:r}=t;return Kd("div",{className:ZT},Kd("div",{className:qT},Kd("div",{className:JT},Kd("span",{className:t.spanClass},Kd(Mp.CloseIcon,null)),Kd("span",{className:t.spanClass},Kd(Mp.CorrectIcon,null)),r?Kd("span",{className:tw,onClick:r.onClick},this.getIcon(r.icon)):null),Kd("div",{className:nw},Kd("div",{autoFocus:!0,contentEditable:!0,className:rw,onKeyUp:e=>this.printChange(e)},t.formulaContent))))}}var ow="univer-rich-text-editor-container",iw="univer-rich-text-editor";class lw{constructor(e){this.inlineStyleAffectAttribute={bl:1,it:1,ff:1,cl:1,un:1,fs:1,fc:1,bg:1},this.inlineStyleAffectCssName={"font-weight":1,"font-style":1,"font-family":1,"text-decoration":1,"border-bottom":1,"font-size":1,color:1,background:1},this.univerToCssName={bl:"font-weight",it:"font-style",ff:"font-family",fs:"font-size",fc:"color",bg:"background",cl:"text-decoration",un:"border-bottom"},this.editor=e}updateFormat(e,t){if(e in this.inlineStyleAffectAttribute){"="!==this.editor.textContent.substr(0,1)&&this.updateInlineStringFormat(e,t)}}updateInlineStringFormat(e,t){var n;let r,s=window.getSelection();if("None"===(null==s?void 0:s.type)||(r=null==s?void 0:s.getRangeAt(0)),!r)return;let o=this.editor,i=r.endContainer,l=r.startContainer,a=r.endOffset,c=r.startOffset;if(o)if(l===i){let r,s=l.parentNode,i=!1,h=s.innerHTML;"<span"!==o.innerHTML.substr(0,5)&&(i=!0);let u="",d="",g="",f=0,m=c,p=a,b=h.length;u=h.substring(f,m),d=h.substring(m,p),g=h.substring(p,b);let _="";if(""!==u){let e=s.style.cssText;if(i){let t=s.closest(`.${ow}`);null!=t&&(e=this.extendCssText(t.style.cssText,e))}_+=`<span style='${e}'>${u}</span>`}if(""!==d){let n=this.getCssText(s.style.cssText,e,t);if(i){let e=s.closest(`.${ow}`);null!=e&&(n=this.extendCssText(e.style.cssText,n))}_+=`<span style='${n}'>${d}</span>`}if(""!==g){let e=s.style.cssText;if(i){let t=s.closest(`.${ow}`);null!=t&&(e=this.extendCssText(t.style.cssText,e))}_+=`<span style='${e}'>${g}</span>`}if("SPAN"===l.parentNode.tagName){r=wm("span",o).indexOf(s);let e=null==(n=s.parentElement)?void 0:n.innerHTML,t=s.outerHTML.replace("\\","");const i=null==e?void 0:e.replace(t,_);s.parentElement.innerHTML=i}else r=0,s.innerHTML=_;let v=0;v=f===m?r:r+1,Im(o.querySelectorAll("span")[v])}else if("SPAN"===l.parentNode.tagName&&"SPAN"===i.parentNode.tagName){let n,r,s=l.parentNode,h=i.parentNode;n=wm("span",o).indexOf(s),r=wm("span",o).indexOf(h);let u=s.innerHTML,d=h.innerHTML,g="",f="",m="",p="",b=0,_=c,v=a,C=d.length;g=u.substring(b,_),f=u.substring(_,u.length),m=d.substring(0,v),p=d.substring(v,C);let T=Array.prototype.slice.call(o.querySelectorAll("span"));T.slice(n,r+1);let w,y,S="";for(let e=0;e<n;e++){let t=T[`${e}`],n=t.innerHTML;S+=`<span style='${t.style.cssText}'>${n}</span>`}if(""!==g&&(S+=`<span style='${s.style.cssText}'>${g}</span>`),""!==f){S+=`<span style='${this.getCssText(s.style.cssText,e,t)}'>${f}</span>`}if(n<r)for(let o=n+1;o<r;o++){let n=T[`${o}`],r=n.innerHTML;S+=`<span style='${this.getCssText(n.style.cssText,e,t)}'>${r}</span>`}if(""!==m){S+=`<span style='${this.getCssText(h.style.cssText,e,t)}'>${m}</span>`}""!==p&&(S+=`<span style='${h.style.cssText}'>${p}</span>`);for(let e=r+1;e<T.length;e++){let t=T[`${e}`],n=t.innerHTML;S+=`<span style='${t.style.cssText}'>${n}</span>`}o.innerHTML=S,b===_?(w=n,y=r):(w=n+1,y=r+1),T=o.querySelectorAll("span"),Am(T[`${w}`],T[`${y}`])}}extendCssText(e,t,n=!0){let r=e.split(";"),s=t.split(";"),o="",i={};for(let l=0;l<r.length;l++){let e=r[l],t=!0;e=e.toLowerCase();let a=Om(e.substr(0,e.indexOf(":")));if("font-size"===a)continue;let c=Om(e.substr(e.indexOf(":")+1));if(!n||a in this.inlineStyleAffectCssName){for(let e=0;e<s.length;e++){let n=s[e];n=n.toLowerCase();let r=Om(n.substr(0,n.indexOf(":"))),i=Om(n.substr(n.indexOf(":")+1));a!==r||(o+=`${r}:${i};`,t=!1)}t&&(o+=`${a}:${c};`),i[a]=1}}for(let l=0;l<s.length;l++){let e=s[l];e=e.toLowerCase();let t=Om(e.substr(0,e.indexOf(":"))),r=Om(e.substr(e.indexOf(":")+1));n&&!(t in this.inlineStyleAffectCssName)||(t in i||(o+=`${t}:${r};`))}return o}getCssText(e,t,n){let r={};if(r[t]=n,"un"===t){let t=this.getClassWithcss(e,"color");""===t&&(t="#000000");let n=this.getClassWithcss(e,"font-size"),s=parseInt(n);""===n&&(s=11),r._fontSize=s,r._color=t}let s=this.getFontStyleByCell(r,void 0,void 0,!1),o=Om(s&&s.substr(0,s.indexOf(":"))),i=Om(s&&s.substr(s.indexOf(":")+1));return i=i.substr(0,i.length-1),e=this.removeClassWidthCss(e,t),e=this.upsetClassWithCss(e,o,i)}getClassWithcss(e,t){let n=e.split(";");if(null==t||0===t.length)return e;if(e.indexOf(t)>-1)for(let r=0;r<n.length;r++){let e=n[r];e=e.toLowerCase();let s=Om(e.substr(0,e.indexOf(":"))),o=Om(e.substr(e.indexOf(":")+1));if(s===t)return o}return""}removeClassWidthCss(e,t){let n=e.split(";"),r="",s=t;if(null==t||0===t.length)return e;if(t in this.univerToCssName&&(t=this.univerToCssName[t]),e.indexOf(t)>-1)for(let o=0;o<n.length;o++){let e=n[o];e=e.toLowerCase();let i=Om(e.substr(0,e.indexOf(":"))),l=Om(e.substr(e.indexOf(":")+1));i===t||"cl"===s&&"lucky-strike"===i||"un"===s&&"lucky-underline"===i||i.length>0&&(r+=`${i}:${l};`)}else r=e;return r}upsetClassWithCss(e,t,n){let r=e.split(";"),s="";if(null==t||0===t.length)return e;if(e.indexOf(t)>-1)for(let o=0;o<r.length;o++){let e=r[o];e=e.toLowerCase();let i=Om(e.substr(0,e.indexOf(":"))),l=Om(e.substr(e.indexOf(":")+1));i===t?s+=`${i}:${n};`:i.length>0&&(s+=`${i}:${l};`)}else t.length>0&&(s=e+=`${t}:${n};`);return s}getFontStyleByCell(e,t,n,r=!0){if(null==e)return"";let s="";for(let o in e){let i=e[o];if(r&&(i=this.checkstatusByCell(e,o)),"bl"===o&&"0"!==i&&(s+="font-weight: bold;"),"it"===o&&"0"!==i&&(s+="font-style:italic;"),"ff"===o){s+=`font-family: ${i};`}if("fs"===o&&"10"!==i&&(s+=`font-size: ${i}pt;`),("fc"===o&&"#000000"!==i||null!=t||null!=n&&null!=n.textColor)&&(null!=n&&null!=n.textColor?s+=`color: ${n.textColor};`:s+=null!=t?`color: ${t[0]};`:`color: ${i};`),"bg"===o&&"#ffffff"!==i&&"#fff"!==i&&(s+=`background: ${i};`),"cl"===o&&"0"!==i&&(s+="text-decoration: line-through;"),"un"===o&&("1"===i||"3"===i)){let t=e._color;null==t&&(t=e.fc);let n=e._fontSize||11;null==n&&(n=e.fs||11),s+=`border-bottom: ${Math.floor(n/9)}px solid ${t};`}}return s}checkstatusByCell(e,t){let n;return t in{bl:1,it:1,ff:1,cl:1,un:1}?null==n?n="0":(n=n[t],null==n&&(n="0")):"fc"===t?null==n?n="#000000":(n=n[t],null==n&&(n="#000000"),n.indexOf("rgba")>-1&&(n=qt.rgbColorToHexValue(n))):"bg"===t?null==n?n=null:(n=n[t],null==n?n=null:n.toString().indexOf("rgba")>-1&&(n=qt.rgbColorToHexValue(n))):"bs"===t.substr(0,2)?null==n?n="none":(n=n[t],null==n&&(n="none")):"bc"===t.substr(0,2)?null==n?n="#000000":(n=n[t],null==n&&(n="#000000")):"ht"===t?(null==n?n="1":(n=n[t],null==n&&(n="1")),-1===["0","1","2"].indexOf(n.toString())&&(n="1")):"vt"===t?(null==n?n="0":(n=n[t],null==n&&(n="0")),-1===["0","1","2"].indexOf(n.toString())&&(n="0")):"ct"===t?null==n?n=null:(n=n[t],null==n&&(n=null)):"fs"===t?null==n?n="10":(n=n[t],null==n&&(n="10")):"tb"===t||"tr"===t?null==n?n="0":(n=n[t],null==n&&(n="0")):"rt"===t&&(null==n?n=null:(n=n[t],null==n&&(n=null))),n}}class aw extends sm{constructor(){super(...arguments),this.container={current:null},this.ref={current:null},this.hooks=new Map}initialize(e){}setValue(e){this.ref.current&&(this.ref.current.innerHTML=Nm(e))}getValue(){var e;return(null==(e=this.ref.current)?void 0:e.innerHTML)||""}show(){this.container.current.style.display="block"}hide(){this.container.current.style.display="none"}onKeyDown(e){const t=this.hooks.get("onKeyDown");t&&t(e),"Enter"===e.key&&e.preventDefault()}onKeyUp(e){const t=this.hooks.get("onKeyUp");t&&t(e),"Enter"===e.key&&e.preventDefault()}componentWillMount(){}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this),this.cellTextStyle=new lw(this.ref.current)}componentWillUnmount(){}render(e,t){const{style:n,className:r="",onClick:s,text:o}=e;return Kd("div",{className:`${ow} ${r}`,style:n,ref:this.container},Kd("div",{ref:this.ref,className:iw,onClick:s,onKeyDown:this.onKeyDown.bind(this),onKeyUp:this.onKeyUp.bind(this),dangerouslySetInnerHTML:{__html:o||""},contentEditable:!0}))}}class cw extends sm{constructor(){super(...arguments),this.refMap=new Map}initialize(){this.state={slotGroup:new Map}}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}setSlotGroup(e,t){this.setState({slotGroup:e},t)}getSlotGroup(){return this.refMap}getRender(e){const t=[];return e.forEach(((n,r)=>{var s,o;const i=null==(s=e.get(r))?void 0:s.component,l=null==(o=e.get(r))?void 0:o.props;i&&t.push(Kd(i,__spreadValues({ref:e=>{this.refMap.set(r,e)}},l)))})),t}render(){const{slotGroup:e}=this.state;return Kd("div",null,this.getRender(e))}}var hw="univer-toolbar-warp",uw="univer-toolbar",dw="univer-select-label-string",gw="univer-select-double-string",fw="univer-select-color-picker-parent",mw="univer-select-color-picker",pw="univer-select-line-bold-parent",bw="univer-text-button",_w="univer-more-button",vw="univer-more-tool",Cw="univer-tooltip-title",Tw="univer-bottom";class ww extends sm{constructor(){super(...arguments),this.toolbarRef={current:null},this.moreBtnRef={current:null},this.moreToolRef={current:null},this.SelectRef={current:null},this.clientWidth=0,this.debounceSetToolbarListWidth=Rm((()=>{this.setToolbarListWidth()}),50),this.showMore=()=>{let e=this.state.showMore;this.setState({showMore:!e}),e||document.addEventListener("click",this.hide,!0)},this.hide=e=>{this.moreToolRef.current.contains(e.target)||(e.stopImmediatePropagation(),this.setState({showMore:!1}),document.removeEventListener("click",this.hide,!0))},this.setToolbarListWidth=()=>{this.clientWidth||(this.clientWidth=document.documentElement.clientWidth);const e=this.toolbarRef.current.querySelectorAll(`.${hw} > div`),t=this.moreBtnRef.current.clientWidth;let n=60+t,r=null;const s=document.documentElement.clientWidth;if(s<=this.clientWidth){this.clientWidth=s;for(let t=0;t<e.length;t++)if(n+=e[t].clientWidth+6,n>s){r=t;break}null!==r&&this.setState({defaultToolList:this.state.toolList.slice(0,r),moreToolList:r?this.state.toolList.slice(r):[]},(()=>{this.resetUl(),this.forceUpdate()}))}else if(this.clientWidth=s,this.state.moreToolList.length){let n=30+t;for(let t=0;t<e.length;t++)n+=e[t].clientWidth+6;const r=this.moreToolRef.current.querySelectorAll(`.${vw} > div`);let o=null,i=!1;for(let e=0;e<r.length;e++){if(n+=r[e].clientWidth+6,n>s){o=e;break}e===r.length-1&&(o=e,i=!0)}null!==o&&this.setState({defaultToolList:this.state.defaultToolList.concat(this.state.moreToolList.slice(0,i?o+1:o)),moreToolList:i?[]:this.state.moreToolList.slice(o)},(()=>{this.resetUl(),this.forceUpdate()}))}},this.resetLabel=e=>{var t,n,r;const s=null==(t=this.getContext().getPluginManager().getPluginByName(xd))?void 0:t.getComponentManager();for(let o=0;o<e.length;o++){const t=Lm(e[o],this.getLocale.bind(this));if(t.customLabel){const e=null==s?void 0:s.get(t.customLabel.name);if(e){const r=null!=(n=t.customLabel.props)?n:{};t.label=Kd(e,__spreadValues({},r))}}if(t.customSuffix){const e=null==s?void 0:s.get(t.customSuffix.name);if(e){const n=null!=(r=t.customSuffix.props)?r:{};t.suffix=Kd(e,__spreadValues({},n))}}t.children&&(t.children=this.resetLabel(t.children))}return e},this.setToolbar=e=>{this.setState({toolList:e,defaultToolList:e},(()=>{this.setToolbarListWidth()}))},this.resetUl=()=>{var e;const t=`${(null==(e=this.getContext().getPluginManager().getPluginByName(xd))?void 0:e.getAppUIController().getSheetContainerController().getContentRef().current).offsetHeight}px`,n=this.toolbarRef.current.querySelectorAll("ul");for(let r=0;r<n.length;r++)n[r].style.maxHeight=t}}initialize(){this.state={showMore:!1,toolList:[],defaultToolList:[],moreToolList:[],toolbarListWidths:[]}}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this),window.addEventListener("resize",this.debounceSetToolbarListWidth)}componentWillUnmount(){window.removeEventListener("resize",this.debounceSetToolbarListWidth)}getToolbarList(e){return(e=this.resetLabel(e)).map((e=>{if(e.toolbarType){if(e.show)return Kd(uv,{title:this.getLocale(e.tooltip),placement:"bottom"},Kd(pb,{unActive:e.unActive,className:bw,type:"text",active:e.active,onClick:e.onClick},e.label))}else if(e.show)return Kd(aC,{tooltip:this.getLocale(e.tooltip),type:e.type,display:e.display,children:e.children,customLabel:e.customLabel,customSuffix:e.customSuffix,label:e.label,onClick:e.onClick,onPressEnter:e.onPressEnter,onMainClick:e.onMainClick,defaultColor:e.defaultColor,hideSelectedIcon:e.hideSelectedIcon,className:e.className});return null}))}render(){const{defaultToolList:e,moreToolList:t,showMore:n}=this.state;return Kd(b_,{style:{position:"relative"}},Kd("div",{className:`${hw} ${uw}`,ref:this.toolbarRef},this.getToolbarList(e),Kd("div",{ref:this.moreBtnRef,className:_w,style:{visibility:t.length?"visible":"hidden"}},Kd(uv,{title:this.getLocale("toolbar.toolMoreTip"),placement:"bottom"},Kd(pb,{type:"text",onClick:this.showMore},Kd("div",{style:{fontSize:"14px"}},this.getLocale("toolbar.toolMore")))))),t.length?Kd("div",{style:{visibility:n?"visible":"hidden"},className:`${vw} ${uw}`,ref:this.moreToolRef},this.getToolbarList(t)):"")}}ww.contextType=Vg;class yw extends sm{constructor(e){super(),this.splitLeftRef={current:null},this.contentRef={current:null},this.handleSplitBarMouseDown=e=>{var t,n,r,s,o;this.leftContentLeft=null==(t=this.splitLeftRef.current)?void 0:t.getBoundingClientRect().left,this.leftContentTop=null==(n=this.splitLeftRef.current)?void 0:n.getBoundingClientRect().top;const i=null==(r=this.splitLeftRef.current)?void 0:r.parentElement;this.rightBorderX=null==(s=null==i?void 0:i.getBoundingClientRect())?void 0:s.width,this.rightBorderY=null==(o=null==i?void 0:i.getBoundingClientRect())?void 0:o.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=e=>{var t;const n=null==(t=this.props.config.layout)?void 0:t.sheetContainerConfig;let r=(e=e||window.event).clientX-this.leftContentLeft,s=e.clientY-this.leftContentTop;r=r>=this.rightBorderX?this.rightBorderX:r,s=s>=this.rightBorderY?this.rightBorderY:s,"vertical"===n.contentSplit?this.splitLeftRef.current.style.height=`${s}px`:this.splitLeftRef.current.style.width=`${r}px`},this.handleSplitBarMouseUp=e=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.changeSkin(e.config.container,"default")}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}getContentRef(){return this.contentRef}getSplitLeftRef(){return this.splitLeftRef}changeSkin(e,t){let n=document.documentElement;const r="string"==typeof e?e:e.id;let s={default:dC}[t];if(s=Object.fromEntries(Object.keys(s).map((e=>[`--${e.replace(/([A-Z0-9])/g,"-$1").toLowerCase()}`,s[e]]))),C.isIEBrowser())FC({rootElement:n,variables:s});else{(function(e){const t="universheet-skin-style";for(let s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].title===t)return o(document.styleSheets[s],e),document.styleSheets[s];const n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");return r.title=t,n.appendChild(r),document.styleSheets[document.styleSheets.length-1]})(r).insertRule(`#${r} ${JSON.stringify(s).replace(/"/g,"").replace(/,(?=--)/g,";")}`)}function o(e,t){let n=0;for(let r=0;r<e.cssRules.length;r++){const s=e.cssRules[r];if(s instanceof CSSStyleRule&&s.selectorText===`#${t}`){n=r,e.deleteRule(n);break}}}}render(){const{methods:e}=this.props,{layout:t}=this.props.config,n=null==t?void 0:t.sheetContainerConfig;return Kd(b_,{className:$C},Kd(E_,null,Kd(x_,{style:{display:n.outerLeft?"block":"none"}}),Kd(E_,{className:eT,style:{position:"relative"}},Kd(R_,{style:{display:n.header?"block":"none"}},n.infoBar&&Kd(iT,__spreadValues({},e.infoBar)),n.toolbar&&Kd(ww,__spreadValues({},e.toolbar)),n.formulaBar&&Kd(sw,__spreadValues({},e.formulaBar))),Kd(E_,null,Kd(x_,{style:{display:n.innerLeft?"block":"none"}}),Kd(A_,{className:"vertical"===n.contentSplit?JC:QC},Kd(cw,__spreadValues({},e.slot)),!!n.contentSplit&&Kd(b_,{ref:this.splitLeftRef,className:KC},Kd("div",{className:ZC,onMouseDown:this.handleSplitBarMouseDown})),Kd(b_,{onContextMenu:e=>e.preventDefault(),ref:this.contentRef,className:qC},n.rightMenu&&Kd(hT,__spreadValues({},e.rightMenu)),Kd(aw,__spreadValues({},e.cellEditor)))),Kd(x_,{style:{display:n.innerRight?"block":"none"}})),Kd(I_,{style:{display:n.footer?"block":"none"}},n.sheetBar&&Kd(KT,__spreadValues({},e.sheetBar)),n.countBar&&Kd(bT,__spreadValues({},e.countBar)))),Kd(x_,{style:{display:n.outerRight?"block":"none"},className:tT})))}}class Sw extends sm{constructor(e){super(e),this.state={locale:this.props.locale}}setLocale(e){const t=e.target.value;this.props.changeLocale(t),this.setState({locale:t})}render(){const{context:e,UIConfig:t}=this.props,{locale:n}=this.state;return Kd(Vg.Provider,{value:{context:e,locale:n}},Kd("div",{style:{position:"fixed",right:"250px",top:"14px",fontSize:"14px",zIndex:100},className:"univer-dev-operation"},Kd("span",{style:{display:"inline-block",width:70,margin:"5px 0 0 5px"}},"Language"),Kd("select",{value:n,onChange:this.setLocale.bind(this),style:{width:70}},Kd("option",{value:"en"},"English"),Kd("option",{value:"zh"},""))),Kd(yw,__spreadValues({},t)))}}var Ew="univer-color-select",Rw="univer-color-select-line";class Iw extends sm{componentDidMount(){var e,t,n;const r=null==(e=this.getContext().getPluginManager().getPluginByName(xd))?void 0:e.getComponentManager();let s=this.props.label;if(this.props.customLabel){s=Kd(null==r?void 0:r.get(this.props.customLabel.name),__spreadValues({},this.props.customLabel.props))}this.setState({label:s,color:this.props.color}),null==(n=(t=this.props).getComponent)||n.call(t,this)}componentWillReceiveProps(e){this.setState({color:e.color})}setColor(e){this.setState({color:e})}render(){return Kd("div",{className:Ew},Kd("div",null,this.state.label),Kd("div",{className:Rw,style:{background:this.state.color}}))}}class Aw extends sm{initialize(){this.state={img:""}}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}componentWillReceiveProps(e){this.setState({img:e.img})}setImg(e=""){this.setState({img:e})}getImg(e){var t;if(!e)return null;const n={width:document.querySelector(".base-sheets-line-bold").offsetWidth},r=null==(t=this.getContext().getPluginManager().getPluginByName(xd))?void 0:t.getComponentManager();return Kd(null==r?void 0:r.get(e),__spreadValues({},n))}render(){const{img:e}=this.state,{label:t}=this.props;return Kd("div",{style:{paddingBottom:"3px",width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"}},Kd("span",{className:"base-sheets-line-bold",style:{position:"relative"}},this.getLocale(t),Kd("div",{style:{width:"100%",height:0,position:"absolute",left:0,bottom:"14px"}},e.length?this.getImg(e):"")),Kd(Ep,null))}}class xw extends sm{initialize(){this.state={color:this.props.color}}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}componentWillReceiveProps(e){this.setState({color:e.color})}setColor(e){this.setState({color:e})}render(){const{color:e}=this.state,{label:t}=this.props;return Kd("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},Kd("span",{style:{display:"inline-block",borderBottom:`3px solid ${e}`}},this.getLocale(t)),Kd(Ep,null))}}class Ow{constructor(e){this._initialize(e)}static create(e){return new Ow(e)}_initialize(e){let t;const n=e.container;if("string"==typeof n){const e=document.getElementById(n);null==e?(t=document.createElement("div"),t.id=n):t=e}else Cm(n)?t=n:(t=document.createElement("div"),t.id="univer");vg(Kd(Sw,__spreadValues({},e)),t)}}class Mw{constructor(e,t){this.getComponent=e=>{this._rightMenu=e,this.setMenuList()},this._plugin=e,this._sheetPlugin=e.getUniver().getCurrentUniverSheetInstance().context.getPluginManager().getPluginByName(Ut.SPREADSHEET),this._config=C.deepMerge({},Od,t),this._menuList=[{label:"rightClick.insertRow",onClick:()=>this.insertRow(),show:this._config.InsertRow},{label:"rightClick.insertColumn",onClick:()=>this.insertColumn(),show:this._config.InsertColumn},{customLabel:{name:uT.name,props:{prefix:"rightClick.toTopAdd",suffix:"rightClick.row"}},show:this._config.AddRowTop},{customLabel:{name:uT.name,props:{prefix:"rightClick.toBottomAdd",suffix:"rightClick.row"}},show:this._config.AddRowBottom},{customLabel:{name:uT.name,props:{prefix:"rightClick.toLeftAdd",suffix:"rightClick.column"}},show:this._config.AddColumnLeft},{customLabel:{name:uT.name,props:{prefix:"rightClick.toRightAdd",suffix:"rightClick.column"}},show:this._config.AddColumnRight},{label:"rightClick.deleteSelectedRow",onClick:()=>this.deleteRow(),show:this._config.DeleteRow},{label:"rightClick.deleteSelectedColumn",onClick:()=>this.deleteColumn(),show:this._config.DeleteColumn},{label:"rightClick.hideSelectedRow",show:this._config.HideRow},{label:"rightClick.showHideRow",show:this._config.ShowRow},{customLabel:{name:uT.name,props:{prefix:"rightClick.rowHeight",suffix:"px",onKeyUp:this.setRowHeight.bind(this)}},onClick:()=>{},show:!0},{label:"rightClick.hideSelectedColumn",show:this._config.HideColumn},{label:"rightClick.showHideColumn",show:this._config.ShowColumn},{customLabel:{name:uT.name,props:{prefix:"rightClick.columnWidth",suffix:"px",onKeyUp:this.setColumnWidth.bind(this)}},show:!0},{show:this._config.DeleteCell,customLabel:{name:dT.name,props:{label:"rightClick.deleteCell"}},border:!0,children:[{label:"rightClick.moveLeft",className:aT,onClick:()=>this.deleteCellLeft()},{label:"rightClick.moveUp",className:aT,onClick:()=>this.deleteCellTop()}]},{label:"rightClick.clearContent",onClick:()=>this.clearContent(),border:!0,show:this._config.ClearContent}],this._initialize()}setMenuList(){var e;null==(e=this._rightMenu)||e.setMenuList(this._menuList)}setUIObserve(e){this._plugin.getContext().getObserverManager().requiredObserver("onUIChangeObservable","core").notifyObservers(e)}insertRow(){this.setUIObserve({name:"insertRow"})}insertColumn(){this.setUIObserve({name:"insertColumn"})}deleteRow(){this.setUIObserve({name:"deleteRow"})}deleteColumn(){this.setUIObserve({name:"deleteColumn"})}setRowHeight(e){if(console.dir(this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getActiveSheet().getConfig()),console.dir(this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getStyles()),"Enter"!==e.key)return;const t={name:"setRowHeight",value:e.target.value};this.setUIObserve(t)}setColumnWidth(e){if("Enter"!==e.key)return;const t={name:"setColumnWidth",value:e.target.value};this.setUIObserve(t)}deleteCellLeft(){this.setUIObserve({name:"moveLeft"})}deleteCellTop(){this.setUIObserve({name:"moveTop"})}clearContent(){this.setUIObserve({name:"clearContent"})}_initialize(){this._plugin.getComponentManager().register(uT.name,uT),this._plugin.getComponentManager().register(dT.name,dT),this._sheetPlugin.getMainComponent().onPointerDownObserver.add((e=>{2===e.button&&(e.preventDefault(),this._rightMenu.handleContextMenu(e))}))}}const Nw=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],kw=[{labelLocale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{labelLocale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{labelLocale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{labelLocale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{labelLocale:"fontFamily.MicrosoftAccorblack",style:{"font-family":""},value:""},{labelLocale:"fontFamily.SimSun",style:{"font-family":""},value:""},{labelLocale:"fontFamily.SimHei",style:{"font-family":""},value:""},{labelLocale:"fontFamily.Kaiti",style:{"font-family":""},value:""},{labelLocale:"fontFamily.FangSong",style:{"font-family":""},value:""},{labelLocale:"fontFamily.NSimSun",style:{"font-family":""},value:""},{labelLocale:"fontFamily.STXinwei",style:{"font-family":""},value:""},{labelLocale:"fontFamily.STXingkai",style:{"font-family":""},value:""},{labelLocale:"fontFamily.STLiti",style:{"font-family":""},value:""},{labelLocale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{labelLocale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{labelLocale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}],Lw=[{labelLocale:"borderLine.borderTop",customSuffix:{name:"TopBorderIcon"},value:"top"},{labelLocale:"borderLine.borderBottom",customSuffix:{name:"BottomBorderIcon"},value:"bottom"},{labelLocale:"borderLine.borderLeft",customSuffix:{name:"LeftBorderIcon"},value:"left"},{labelLocale:"borderLine.borderRight",customSuffix:{name:"RightBorderIcon"},value:"right",border:!0},{labelLocale:"borderLine.borderNone",customSuffix:{name:"NoneBorderIcon"},value:"none"},{labelLocale:"borderLine.borderAll",customSuffix:{name:"FullBorderIcon"},value:"all",selected:!0},{labelLocale:"borderLine.borderOutside",customSuffix:{name:"OuterBorderIcon"},value:"outside"},{labelLocale:"borderLine.borderInside",customSuffix:{name:"InnerBorderIcon"},value:"inside"},{labelLocale:"borderLine.borderHorizontal",customSuffix:{name:"StripingBorderIcon"},value:"horizontal"},{labelLocale:"borderLine.borderVertical",customSuffix:{name:"VerticalBorderIcon"},value:"vertical"}],Dw=[{labelLocale:"borderLine.borderNone",value:ye.NONE},{customLabel:{name:"BorderThin"},value:ye.THIN},{customLabel:{name:"BorderHair"},value:ye.HAIR},{customLabel:{name:"BorderDotted"},value:ye.DOTTED},{customLabel:{name:"BorderDashed"},value:ye.DASHED},{customLabel:{name:"BorderDashDot"},value:ye.DOTTED},{customLabel:{name:"BorderDashDotDot"},value:ye.DASH_DOT_DOT},{customLabel:{name:"BorderMedium"},value:ye.MEDIUM},{customLabel:{name:"BorderMediumDashed"},value:ye.MEDIUM_DASHED},{customLabel:{name:"BorderMediumDashDot"},value:ye.MEDIUM_DASH_DOT},{customLabel:{name:"BorderMediumDashDotDot"},value:ye.MEDIUM_DASH_DOT_DOT},{customLabel:{name:"BorderThick"},value:ye.THICK}],Pw=[{labelLocale:"merge.all",value:"all"},{labelLocale:"merge.vertical",value:"vertical"},{labelLocale:"merge.horizontal",value:"horizontal"},{labelLocale:"merge.cancel",value:"cancel"}],Bw=[{labelLocale:"align.left",customSuffix:{name:"LeftAlignIcon"},value:1},{labelLocale:"align.center",selected:!0,customSuffix:{name:"CenterAlignIcon"},value:2},{labelLocale:"align.right",customSuffix:{name:"RightAlignIcon"},value:3}],Hw=[{labelLocale:"align.top",customSuffix:{name:"TopVerticalIcon"},value:1},{labelLocale:"align.middle",customSuffix:{name:"CenterVerticalIcon"},value:2},{labelLocale:"align.bottom",customSuffix:{name:"BottomVerticalIcon"},value:3}],Fw=[{labelLocale:"textWrap.overflow",customSuffix:{name:"OverflowIcon"},value:1},{labelLocale:"textWrap.wrap",customSuffix:{name:"BrIcon"},value:3},{labelLocale:"textWrap.clip",customSuffix:{name:"CutIcon"},value:2}],zw=[{labelLocale:"textRotate.none",customSuffix:{name:"TextRotateIcon"},value:0},{labelLocale:"textRotate.angleUp",customSuffix:{name:"TextRotateAngleUpIcon"},value:-45},{labelLocale:"textRotate.angleDown",customSuffix:{name:"TextRotateAngleDownIcon"},value:45},{labelLocale:"textRotate.vertical",customSuffix:{name:"TextRotateVerticalIcon"},value:"v"},{labelLocale:"textRotate.rotationUp",customSuffix:{name:"TextRotateRotationUpIcon"},value:-90},{labelLocale:"textRotate.rotationDown",customSuffix:{name:"TextRotateRotationDownIcon"},value:90}];var Uw,Ww;(Ww=Uw||(Uw={}))[Ww.SELECT=0]="SELECT",Ww[Ww.BUTTON=1]="BUTTON";class Vw{constructor(e,t){this._textColor="#000",this._background="#fff",this._borderInfo={type:Ee.ALL,color:"#000",style:1},this.getComponent=e=>{this._toolbar=e,this.setToolbar()},this._plugin=e,this._sheetPlugin=e.getContext().getUniver().getCurrentUniverSheetInstance().context.getPluginManager().getPluginByName(Ut.SPREADSHEET),this._config=C.deepMerge({},Md,t),this._toolList=[{toolbarType:1,tooltip:"toolbar.undo",name:"undo",customLabel:{name:"ForwardIcon"},show:this._config.undo,onClick:()=>{this.setUndo(),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.redo",customLabel:{name:"BackIcon"},name:"redo",show:this._config.redo,onClick:()=>{this.setRedo(),this.hideTooltip()}},{type:0,tooltip:"toolbar.font",className:dw,name:"font",show:this._config.font,border:!0,onMainClick:()=>{this.hideTooltip()},onClick:e=>{this.setFontFamily(e)},children:kw},{type:1,tooltip:"toolbar.fontSize",label:String(Dt.fs),name:"fontSize",show:this._config.fontSize,onClick:e=>{this.setFontSize(e)},onMainClick:()=>{this.hideTooltip()},onPressEnter:e=>{this.setFontSize(e),this.hideTooltip()},children:Nw},{toolbarType:1,tooltip:"toolbar.bold",customLabel:{name:"BoldIcon"},unActive:!1,name:"bold",show:this._config.bold,onClick:(e,t)=>{this.setFontWeight(t),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.italic",customLabel:{name:"ItalicIcon"},unActive:!1,name:"italic",show:this._config.italic,onClick:(e,t)=>{this.setFontStyle(t),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},unActive:!1,name:"strikethrough",show:this._config.strikethrough,onClick:(e,t)=>{this.hideTooltip();const n=this._toolList.find((e=>"strikethrough"===e.name));n&&(n.active=t,this.setStrikeThrough(t))}},{toolbarType:1,tooltip:"toolbar.underline",customLabel:{name:"UnderLineIcon"},unActive:!1,name:"underline",show:this._config.underline,onClick:(e,t)=>{this.hideTooltip();const n=this._toolList.find((e=>"underline"===e.name));n&&(n.active=t,this.setUnderline(t))}},{type:5,tooltip:"toolbar.textColor.main",customLabel:{name:xd+Iw.name,props:{getComponent:e=>{this._colorSelect1=e},color:"#000",customLabel:{name:"TextColorIcon"}}},onClick:()=>{this.hideTooltip();const e=this._toolList.find((e=>"textColor"===e.name));e&&e.customLabel&&e.customLabel.props&&(e.customLabel.props.color=this._textColor,this.changeColor(this._textColor))},hideSelectedIcon:!0,className:fw,children:[{labelLocale:"toolbar.resetColor"},{customLabel:{name:xd+g_.name,props:{onClick:(e,t)=>{this._colorSelect1.setColor(e),this._textColor=e}}},className:mw}],name:"textColor",show:this._config.textColor},{type:5,tooltip:"toolbar.fillColor.main",customLabel:{name:xd+Iw.name,props:{getComponent:e=>{this._colorSelect2=e},color:"#fff",customLabel:{name:"FillColorIcon"}}},onClick:()=>{this.hideTooltip();const e=this._toolList.find((e=>"fillColor"===e.name));e&&e.customLabel&&e.customLabel.props&&(e.customLabel.props.color=this._background,this.setBackground(this._background))},hideSelectedIcon:!0,className:fw,children:[{labelLocale:"toolbar.resetColor"},{customLabel:{name:xd+g_.name,props:{onClick:(e,t)=>{this._colorSelect2.setColor(e),this._background=e}}},className:mw}],name:"fillColor",show:this._config.fillColor},{type:3,display:1,show:this._config.border,tooltip:"toolbar.border.main",className:gw,onClick:e=>{e&&(this._borderInfo.type=e),this.hideTooltip(),this.setBorder()},name:"border",children:[...Lw,{name:"borderColor",customLabel:{name:xd+xw.name,props:{color:"#000",label:"borderLine.borderColor",getComponent:e=>this._lineColor=e}},unSelectable:!0,className:fw,children:[{customLabel:{name:xd+g_.name,props:{onClick:(e,t)=>{var n;this._lineColor.setColor(e),this._borderInfo.color=e;const r=this._toolList.find((e=>"border"===e.name)),s=null==(n=null==r?void 0:r.children)?void 0:n.find((e=>"borderColor"===e.name));s&&s.customLabel&&s.customLabel.props&&(s.customLabel.props.color=e)}}},className:mw,onClick:(...e)=>{e[0].stopPropagation()}}]},{customLabel:{name:xd+Aw.name,props:{img:0,label:"borderLine.borderSize",getComponent:e=>this._lineBold=e}},onClick:(...e)=>{var t;e[0].stopPropagation(),this._lineBold.setImg(null==(t=Dw[e[2]].customLabel)?void 0:t.name),this._borderInfo.style=e[1]},className:pw,unSelectable:!0,children:Dw}]},{type:5,tooltip:"toolbar.mergeCell.main",customLabel:{name:"MergeIcon"},show:this._config.mergeCell,onClick:e=>{this.setMerge(null!=e?e:"all"),this.hideTooltip()},name:"mergeCell",children:Pw},{type:3,tooltip:"toolbar.horizontalAlignMode.main",className:gw,display:1,name:"horizontalAlignMode",show:this._config.horizontalAlignMode,onClick:e=>{this.setHorizontalAlignment(e),this.hideTooltip()},children:Bw},{type:3,tooltip:"toolbar.verticalAlignMode.main",className:gw,display:1,name:"verticalAlignMode",show:this._config.verticalAlignMode,onClick:e=>{this.setVerticalAlignment(e),this.hideTooltip()},children:Hw},{type:3,className:gw,tooltip:"toolbar.textWrapMode.main",display:1,name:"textWrapMode",show:this._config.textWrapMode,onClick:e=>{this.setWrapStrategy(e),this.hideTooltip()},children:Fw},{type:3,className:gw,name:"textRotateMode",tooltip:"toolbar.textRotateMode.main",display:1,show:this._config.textRotateMode,onClick:e=>{this.setTextRotation(e),this.hideTooltip()},children:zw}],this._initialize()}addToolbarConfig(e){this._toolList.findIndex((t=>t.name===e.name))>-1||this._toolList.push(e)}deleteToolbarConfig(e){const t=this._toolList.findIndex((t=>t.name===e));t>-1&&this._toolList.splice(t,1)}setToolbar(){var e;null==(e=this._toolbar)||e.setToolbar(this._toolList)}setUIObserve(e){this._plugin.getContext().getObserverManager().requiredObserver("onUIChangeObservable","core").notifyObservers(e)}changeColor(e){var t,n;const r=this._toolList.find((e=>"strikethrough"===e.name)),s=this._toolList.find((e=>"underline"===e.name));this.setFontColor(e),s&&this.setUnderline(null!=(t=s.active)&&t),r&&this.setStrikeThrough(null!=(n=r.active)&&n)}setUndo(){this.setUIObserve({name:"undo"})}setRedo(){this.setUIObserve({name:"redo"})}setFontFamily(e){const t={name:"fontFamily",value:e};this.setUIObserve(t)}setFontSize(e){const t={name:"fontSize",value:e};this.setUIObserve(t)}setFontWeight(e){const t={name:"fontWeight",value:e};this.setUIObserve(t)}setFontStyle(e){const t={name:"fontStyle",value:e};this.setUIObserve(t)}setStrikeThrough(e){const t={name:"strikeThrough",value:e};this.setUIObserve(t)}setUnderline(e){const t={name:"underLine",value:e};this.setUIObserve(t)}setFontColor(e){const t={name:"fontColor",value:e};this.setUIObserve(t)}setBackground(e){const t={name:"background",value:e};this.setUIObserve(t)}setMerge(e){const t={name:"merge",value:e};this.setUIObserve(t)}setTextRotation(e){const t={name:"textRotation",value:e};this.setUIObserve(t)}setWrapStrategy(e){const t={name:"wrapStrategy",value:e};this.setUIObserve(t)}setVerticalAlignment(e){const t={name:"verticalAlignment",value:e};this.setUIObserve(t)}setHorizontalAlignment(e){const t={name:"horizontalAlignment",value:e};this.setUIObserve(t)}setBorder(){const e={name:"borderInfo",value:this._borderInfo};this.setUIObserve(e)}hideTooltip(){this._toolbar.base.querySelectorAll(`.${Cw}.${Tw}`).forEach((e=>{e.style.display="none"}))}_changeToolbarState(e){var t,n,r,s,o,i,l,a;if(this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getActiveSheet()){const c=e.getFontWeight(),h=e.getFontStyle(),u=e.getStrikeThrough(),d=e.getFontSize(),g=e.getFontWeight(),f=e.getFontFamily(),m=e.getFontStyle(),p=e.getUnderline(),b=null!=(t=e.getHorizontalAlignment())?t:lt.LEFT,_=null!=(n=e.getVerticalAlignment())?n:ct.BOTTOM,v=e.getTextRotation(),C=null!=(r=e.getWrapStrategy())?r:ut.CLIP,T=this._toolList.find((e=>"bold"===e.name)),w=this._toolList.find((e=>"italic"===e.name)),y=this._toolList.find((e=>"textRotateMode"===e.name)),S=this._toolList.find((e=>"fontSize"===e.name)),E=this._toolList.find((e=>"font"===e.name)),R=this._toolList.find((e=>"bold"===e.name)),I=this._toolList.find((e=>"italic"===e.name)),A=this._toolList.find((e=>"strikethrough"===e.name)),x=this._toolList.find((e=>"underline"===e.name)),O=this._toolList.find((e=>"horizontalAlignMode"===e.name)),M=this._toolList.find((e=>"verticalAlignMode"===e.name)),N=this._toolList.find((e=>"textWrapMode"===e.name));T&&(T.active=c===mt.BOLD),w&&(w.active=h===gt.ITALIC),A&&(A.active=!(!u||!u.s)),E&&(null==(s=E.children)||s.forEach((e=>{e.selected=f===e.value}))),S&&(S.label=d.toString()),R&&(R.active=!!g),I&&(I.active=!!m),x&&(x.active=!(!p||!p.s)),O&&(null==(o=O.children)||o.forEach((e=>{e.selected=b===e.value}))),y&&(null==(i=y.children)||i.forEach((e=>{v.v?e.selected="v"===e.value:e.selected=v.a===e.value}))),M&&(null==(l=M.children)||l.forEach((e=>{e.selected=_===e.value}))),N&&(null==(a=N.children)||a.forEach((e=>{e.selected=C===e.value}))),this.setToolbar()}}_initialize(){this._plugin.getComponentManager().register(xd+Iw.name,Iw),this._plugin.getComponentManager().register(xd+g_.name,g_),this._plugin.getComponentManager().register(xd+xw.name,xw),this._plugin.getComponentManager().register(xd+Aw.name,Aw),zr.getCommandObservers().add((({actions:e})=>{if(!e||0===e.length)return;const t=e[0];if(this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getUnitId()!==t.getWorkBook().getUnitId())return;const n=this._sheetPlugin.getSelectionManager(),r=null==n?void 0:n.getCurrentCell();r&&this._changeToolbarState(r)}))}}class jw{constructor(e){this.getComponent=e=>{this._richText=e,this.setRichText()},this._plugin=e,this._sheetPlugin=e.getUniver().getCurrentUniverSheetInstance().context.getPluginManager().getRequirePluginByName(Ut.SPREADSHEET),this._initialize()}getCellEditor(){return this._richText}hideEditContainer(){this._richTextEle.style.maxHeight="1px",this._richTextEle.style.maxWidth="1px",this._richTextEle.style.minWidth="1px",this._richTextEle.style.minHeight="1px",this._richTextEle.style.borderWidth="0px",this._richTextEle.style.transform="scale(0)"}enterEditMode(e=!1){var t,n,r,s;if(this.focusEditEle(),this.isEditMode)return;setTimeout((()=>{km(this._richTextEditEle)}),1),this.isEditMode=!0;const o=this._sheetPlugin.getSelectionManager().getCurrentCellModel();if(!o)return!1;let i,l,a,c;if(o.isMerged){const e=o.mergeInfo;i=e.startX,l=e.endX,a=e.startY,c=e.endY}else i=o.startX,l=o.endX,a=o.startY,c=o.endY;const h=(null==(n=null==(t=this._sheetPlugin.getMainScene())?void 0:t.getViewport(Ou.VIEW_TOP))?void 0:n.actualScrollX)||0,u=(null==(s=null==(r=this._sheetPlugin.getMainScene())?void 0:r.getViewport(Ou.VIEW_LEFT))?void 0:s.actualScrollY)||0;this._richTextEle.style.left=i-h+"px",this._richTextEle.style.top=a-u+"px",this._richTextEle.style.minWidth=l-i+"px",this._richTextEle.style.minHeight=c-a+"px",this._richTextEle.style.borderWidth="2px";const d=Mm(this._plugin.getAppUIController().getSheetContainerController().getContentRef()).getBoundingClientRect();this._richTextEle.style.maxWidth=`${d.width-i+h}px`,this._richTextEle.style.maxHeight=`${d.height-a+u}px`,this._richTextEle.style.transform="";let g=this._sheetPlugin.getCellEditorController().getSelectionValue();const f=this._cellEditExtensionManager.handle({row:o.row,column:o.column,value:g});f&&(g=f.value),e&&(g=""),this._richText.setValue(g);const m=this._sheetPlugin.getCellEditorController().getSelectionStyle();this._richTextEditEle.style.cssText="",m&&(this._richTextEditEle.style.cssText=Dn(m,!0)),this._sheetPlugin.getCellEditorController().setCurrentEditRangeData()}exitEditMode(){if(this.focusEditEle(),!this.isEditMode)return;this.isEditMode=!1;const e=sb(this._richTextEditEle),t=this._richTextEditEle.innerText;let n={};"string"==typeof e?(n.v=e,n.m=e):"object"==typeof e&&(n.p=e,n.v=t,n.m=t);const r=ob(this._richTextEditEle);C.isPlainObject(r)&&(n.s=r),this._sheetPlugin.getCellEditorController().setCurrentEditRangeValue(n),this.hideEditContainer()}focusEditEle(){setTimeout((()=>{this._richTextEditEle.focus()}),100)}getRichTextEle(){return this._richTextEle}getRichTextEditEle(){return this._richTextEditEle}_initialize(){const e=this._sheetPlugin.getMainComponent();e.onDblclickObserver.add((e=>{2!==e.button&&this.enterEditMode()})),e.onPointerDownObserver.add((e=>{this.exitEditMode(),e.preventDefault()})),this._cellEditExtensionManager=new Ig}setRichText(){this._richTextEle=Mm(this._richText.container),this._richTextEditEle=wm("div",this._richTextEle),this._richTextEditEle.focus(),this.hideEditContainer(),this._plugin.getKeyboardManager().handleKeyboardAction(this._richTextEditEle),this._handleKeyboardObserver(),this._richText.hooks.set("onKeyDown",(e=>{var t;null==(t=this._plugin.getObserver("onRichTextKeyDownObservable"))||t.notifyObservers(e)})),this._richText.hooks.set("onKeyUp",(e=>{var t;null==(t=this._plugin.getObserver("onRichTextKeyUpObservable"))||t.notifyObservers(e)}))}_handleKeyboardObserver(){const e=this._plugin.getGlobalContext().getObserverManager().getObserver("onKeyDownObservable","core"),t=this._plugin.getGlobalContext().getObserverManager().getObserver("onKeyCompositionStartObservable","core");e&&!e.hasObservers()&&e.add((e=>{if(!e.ctrlKey&&tr(e.key))this.enterEditMode(!0);else switch(e.key){case"Enter":if(this.isEditMode){this.exitEditMode();const e=this._sheetPlugin.getSelectionManager().getCurrentCellModel();(null==e?void 0:e.isMerged)||this._sheetPlugin.getSelectionManager().move(Fe.BOTTOM)}else this.enterEditMode();break;case"Space":this.isEditMode||this.enterEditMode(!0);break;case"ArrowUp":this.isEditMode||this._sheetPlugin.getSelectionManager().move(Fe.TOP);break;case"ArrowDown":this.isEditMode||this._sheetPlugin.getSelectionManager().move(Fe.BOTTOM);break;case"ArrowLeft":this.isEditMode||this._sheetPlugin.getSelectionManager().move(Fe.LEFT);break;case"ArrowRight":this.isEditMode||this._sheetPlugin.getSelectionManager().move(Fe.RIGHT);break;case"Tab":this.isEditMode||this._sheetPlugin.getSelectionManager().move(Fe.RIGHT),e.preventDefault()}})),t&&!t.hasObservers()&&t.add((e=>{this.isEditMode||this.enterEditMode(!0)}))}}class Yw{constructor(e){var t;this.onChange=e=>{this._setUIObserve("onUIChangeObservable",{name:"changeZoom",value:C.numberFixed(parseFloat(e)/100,2)})},this.getComponent=e=>{this._countBar=e,this._refreshComponent()},this._plugin=e,zr.getActionObservers().add((e=>{const t=e.action,n=e.data;if(t.getWorkBook().getUnitId()===this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getUnitId())switch(n.actionName){case Ho.NAME:this._refreshCountBarUI()}}));const n=e.getContext().getUniver().getCurrentUniverSheetInstance().context.getPluginManager().getRequirePluginByName(Ut.SPREADSHEET).getSelectionManager();null==(t=e.getObserver("onChangeSelectionObserver"))||t.add((()=>{const e=n.getActiveRangeList();e&&this._countBar&&this._totalRangeList(e)}))}setCountBar(e){this._countBar.setValue({content:e})}_totalRangeList(e){let t=e.getRangeList(),n=[],r=this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getActiveSheet().getCellMatrix(),s=0,o=0,i=0;for(let l=0;l<t.length;l++){let e=t[l];for(let t=e.startRow;t<=e.endRow;t++)for(let s=e.startColumn;s<=e.endColumn;s++){if(n.includes(`${t}${s}`))continue;const e=r.getValue(t,s);if(e){let t=parseFloat(e.v);isNaN(t)||(i+=1,o+=t)}n.push(`${t}${s}`)}}i>0&&(s=o/i),this._countBar.setState({content:`${C.numberFixed(s,2)} ${C.numberFixed(o,2)} ${i}`})}_refreshCountBarUI(){}_refreshComponent(){this._refreshCountBarUI()}_setUIObserve(e,t){this._plugin.getContext().getObserverManager().requiredObserver(e,"core").notifyObservers(t)}}class Gw{constructor(e){this.getComponent=e=>{this._formulaBar=e,this.setFormulaBar()},this._plugin=e,this._sheetPlugin=e.getUniver().getCurrentUniverSheetInstance().context.getPluginManager().getPluginByName(Ut.SPREADSHEET),this._initialize()}getFormulaBar(){return this._formulaBar}_initialize(){var e;null==(e=this._sheetPlugin.getObserver("onChangeSelectionObserver"))||e.add((e=>{var t,n;const r=e.model.currentCell;if(r){let e;if(r.isMerged){const t=r.mergeInfo;e={startRow:t.startRow,endRow:t.endRow,startColumn:t.startColumn,endColumn:t.endColumn}}else{const{row:t,column:n}=r;e={startRow:t,endRow:t,startColumn:n,endColumn:n}}const s=this._sheetPlugin.getWorkbook().getActiveSheet().getRange(e).getObjectValue({isIncludeStyle:!0});if(s){let n=String(s.m||s.v||"");const r=this._cellInputExtensionManager.handle({row:e.startRow,column:e.startColumn,value:n});r&&(n=r.value),null==(t=this._formulaBar)||t.setFormulaContent(n)}else null==(n=this._formulaBar)||n.setFormulaContent("")}})),this._cellInputExtensionManager=new Ng}setFormulaBar(){this._namedRanges=this._sheetPlugin.getContext().getWorkBook().getConfig().namedRanges;const e=this._namedRanges.map((e=>({value:e.name,label:e.name})));this._formulaBar.setNamedRanges(e)}}class Xw{constructor(e){this._name=e}get name(){return this._name}setName(e){this._name=e}}class $w{constructor(e){this.getComponent=e=>{this._infoBar=e,this._refreshComponent(),this.resetInfoList(this._infoList)},this._plugin=e}resetInfoList(e){const t=this._plugin.getGlobalContext().getLocale();for(let n in e)e[n].locale&&(e[n].label=t.get(e[n].locale));this._infoBar.setInfoList(e)}setSheetName(e){const t=e.target.value;this._infoBarModel.setName(t)}_refreshComponent(){const e=this._plugin.getUniver().getCurrentUniverSheetInstance().getWorkBook().getConfig().name;this._infoBarModel=new Xw(e),this._infoList={back:{locale:"info.return"},rename:{locale:"info.tips"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},sheet:{label:e,onBlur:e=>{this.setSheetName(e)}}}}}class Qw{constructor(e){var t,n;this.getComponent=e=>{this._sheetBar=e,this._refreshComponent()},this.addSheet=(e,t)=>{this.setUIObserve("onUIChangeObservable",{name:"addSheet",value:{position:e,config:t}})},this.changeSheetName=e=>{this.setUIObserve("onUIChangeObservable",{name:"renameSheet",value:{sheetId:this._dataId,sheetName:e.target.innerText}})},this.dragEnd=e=>{let t=[],n=this._dataId;Array.from(e).forEach((e=>{const n=this._sheetList.find((t=>t.sheetId===e.dataset.id));n&&t.push(n)})),t.forEach(((e,t)=>{e.sheetId===n&&this._plugin.getUniver().getCurrentUniverSheetInstance().getWorkBook().setSheetOrder(e.sheetId,t)}))};let r=this;this._plugin=e,this._sheetUl=[{locale:"sheetConfig.delete",onClick:()=>{r.setUIObserve("onUIChangeObservable",{name:"deleteSheet",value:this._dataId})}},{locale:"sheetConfig.copy",onClick:()=>{r.setUIObserve("onUIChangeObservable",{name:"copySheet"})}},{locale:"sheetConfig.rename",onClick:()=>{this._sheetBar.reNameSheet(this._dataId)}},{locale:"sheetConfig.changeColor",border:!0,className:kT,children:[{customLabel:{name:this._plugin.getPluginName()+g_.name,props:{onClick:e=>{this.setUIObserve("onUIChangeObservable",{name:"changeSheetColor",value:{color:e,sheetId:this._dataId}})}}},className:LT}]},{locale:"sheetConfig.hide",onClick:()=>{r.setUIObserve("onUIChangeObservable",{name:"hideSheet",value:this._dataId})}},{locale:"sheetConfig.unhide",onClick:()=>{this._sheetBar.ref.current.showMenu(!0),r.setUIObserve("onUIChangeObservable",{name:"unHideSheet",value:this._dataId})}}],null==(t=this._plugin.getPluginByName(xd))||t.getComponentManager().register(this._plugin.getPluginName()+g_.name,g_),zr.getActionObservers().add((e=>{const t=e.action,n=e.data;if(t.getWorkBook().getUnitId()===this._plugin.getUniver().getCurrentUniverSheetInstance().getWorkBook().getUnitId())switch(n.actionName){case Ao.NAME:case No.NAME:case no.NAME:case ao.NAME:case Po.NAME:case Oo.NAME:case Bo.NAME:case Lo.NAME:this._refreshSheetData(),this._refreshSheetBarUI()}})),null==(n=this._plugin.getPluginByName(xd))||n.getComponentManager().register(this._plugin.getPluginName()+g_.name,g_)}resetLabel(e){const t=this._plugin.getGlobalContext().getLocale();let n="";return e instanceof Array?e.forEach((e=>{e.includes(".")?n+=t.get(e):n+=e})):e.includes(".")?n=t.get(e):n+=e,n}findLocale(e){for(let t in e)if("locale"===t)e.label=this.resetLabel(e[t]);else if(t.endsWith("Locale")){const n=t.indexOf("Locale");e[t.slice(0,n)]=this.resetLabel(e[t])}else e[t].$$typeof||("[object Object]"===Object.prototype.toString.call(e[t])?this.findLocale(e[t]):"[object Array]"===Object.prototype.toString.call(e[t])&&(e[t]=this.resetSheetUl(e[t])));return e}setUIObserve(e,t){this._plugin.getContext().getObserverManager().requiredObserver(e,"core").notifyObservers(t)}getSheetBar(){return this._sheetBar}getDataId(){return this._dataId}getSheetList(){return this._sheetList}getMenuList(){return this._menuList}resetSheetUl(e){for(let t=0;t<e.length;t++){let n=e[t];n=this.findLocale(n),n.children&&(n.children=this.resetSheetUl(n.children))}return e}selectSheet(){}deleteSheet(){}sortMenu(e,t,n){}copySheet(){}hideSheet(){}unHideSheet(){this._sheetBar.ref.current.showSelect()}moveSheet(e){}contextMenu(e){this._sheetBar.contextMenu(e)}_refreshSheetBarUI(){this._sheetBar.setValue({sheetList:this._sheetList,sheetUl:this._sheetUl,menuList:this._menuList,selectSheet:(e,t)=>{this._dataId=t.item.sheetId;const n=this._plugin.getUniver().getCurrentUniverSheetInstance().getWorkBook().getSheetBySheetId(this._dataId);n&&n.activate()},contextMenu:e=>{const t=e.currentTarget;this._dataId=t.dataset.id},changeSheetName:e=>{},dragEnd:e=>{}})}_refreshSheetData(){const e=this._plugin.getUniver().getCurrentUniverSheetInstance().getWorkBook().getSheets();this._menuList=e.map(((e,t)=>({label:e.getName(),index:String(t),sheetId:e.getSheetId(),hide:1===e.isSheetHidden(),selected:1===e.getStatus(),onClick:t=>{if(t){const n=t.currentTarget;this._dataId=n.dataset.id,e.showSheet(),e.activate()}}}))),this._sheetList=e.filter((e=>!e.isSheetHidden())).map(((e,t)=>({sheetId:e.getSheetId(),label:e.getName(),index:String(t),selected:1===e.getStatus(),color:e.getTabColor(),onDown:e=>{const t=e.currentTarget;this._dataId=t.dataset.id},onClick:t=>{const n=t.currentTarget;this._dataId=n.dataset.id,e.activate()}}))),this._sheetIndex=e.findIndex((e=>1===e.getStatus())),this._sheetIndex>-1&&(this._dataId=e[this._sheetIndex].getSheetId())}_refreshComponent(){this._sheetUl=this.resetSheetUl(this._sheetUl),this._refreshSheetData(),this._refreshSheetBarUI()}}class Kw{constructor(){this._slotGroup=new Map,this.getComponent=e=>{this._slot=e,this.setSlot()}}addSlot(e,t,n){var r;this._slotGroup.get(e)||(this._slotGroup.set(e,{component:t.component,props:null!=(r=t.props)?r:{}}),this.setSlot(n))}getSlot(e){return this._slot.getSlotGroup().get(e)}removeSlot(e){this._slotGroup.delete(e),this.setSlot()}setSlot(e){var t;null==(t=this._slot)||t.setSlotGroup(this._slotGroup,e)}}class Zw{constructor(e){var t,n;this.getComponent=e=>{var t;this._sheetContainer=e,null==(t=this._plugin.getObserver("onUIDidMount"))||t.notifyObservers(this._sheetContainer),this.setSheetContainer()},this.changeLocale=e=>{this._plugin.getContext().getLocale().change(e),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onAfterChangeUILocaleObservable","core").notifyObservers()},this._plugin=e,this._config=this._plugin.getConfig(),this._initialize(),this._slotController=new Kw,this._toolbarController=new Vw(this._plugin,null==(t=this._config.layout)?void 0:t.toolbarConfig),this._cellEditorUIController=new jw(this._plugin),this._formulaBarUIController=new Gw(this._plugin),this._infoBarController=new $w(this._plugin),this._rightMenuController=new Mw(this._plugin,null==(n=this._config.layout)?void 0:n.rightMenuConfig),this._countBarController=new Yw(this._plugin),this._sheetBarController=new Qw(this._plugin),this._slotController.addSlot(xd+Gv.name,{component:Gv})}getUIConfig(){return{context:this._plugin.getGlobalContext(),config:this._config,changeLocale:this.changeLocale,getComponent:this.getComponent,methods:{toolbar:{getComponent:this._toolbarController.getComponent},cellEditor:{getComponent:this._cellEditorUIController.getComponent},formulaBar:{getComponent:this._formulaBarUIController.getComponent},infoBar:{getComponent:this._infoBarController.getComponent},rightMenu:{getComponent:this._rightMenuController.getComponent},countBar:{getComponent:this._countBarController.getComponent,onChange:this._countBarController.onChange},sheetBar:{getComponent:this._sheetBarController.getComponent,addSheet:this._sheetBarController.addSheet,selectSheet:this._sheetBarController.selectSheet,dragEnd:this._sheetBarController.dragEnd,changeSheetName:this._sheetBarController.changeSheetName},slot:{getComponent:this._slotController.getComponent}}}}getContentRef(){return this._sheetContainer.getContentRef()}setEventManager(){this._plugin.getUniver().getAllUniverSheetsInstance().forEach((e=>{e.getWorkBook().getContext().getPluginManager().getRequirePluginByName(Ut.SPREADSHEET).listenEventManager()}))}getEventManager(){return this._eventManager}getCellEditorUIController(){return this._cellEditorUIController}getFormulaBarUIController(){return this._formulaBarUIController}getMainSlotController(){return this._slotController}getToolbarController(){return this._toolbarController}UIDidMount(e){var t;if(this._sheetContainer)return e(this._sheetContainer);null==(t=this._plugin.getObserver("onUIDidMount"))||t.add((()=>e(this._sheetContainer)))}_initialize(){this._dragManager=new Yg(this._plugin),this._eventManager=new Gg(this._plugin),this.setEventManager()}setSheetContainer(){this._dragManager.handleDragAction(Mm(this._sheetContainer))}}class qw{constructor(e){this.changeLocale=e=>{this._plugin.getGlobalContext().getLocale().change(e),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onAfterChangeUILocaleObservable","core").notifyObservers()},this._plugin=e,this._sheetContainerController=new Zw(this._plugin);const t=this._sheetContainerController.getUIConfig();Ow.create({context:this._plugin.getGlobalContext(),locale:this._plugin.getGlobalContext().getLocale().getCurrentLocale(),changeLocale:this.changeLocale,UIConfig:t,container:this._plugin.getConfig().container})}getSheetContainerController(){return this._sheetContainerController}}class Jw extends Fo{constructor(e){super(xd),this._config=C.deepMerge({},kd,e)}static create(e){return new Jw(e)}installTo(e){e.installPlugin(this)}initialize(e){Pd(this),this.getLocale().load({zh:Ld,en:Dd}),this._componentManager=new nb,this._keyboardManager=new jg(this),this._registerManager=new rb(this),this._appUIController=new qw(this),this.UIDidMount((()=>{this.initRender()}))}getConfig(){return this._config}initRender(){var e;const t=null==(e=this.getPluginByName(Ut.BASE_RENDER))?void 0:e.getEngine();let n=Mm(this._appUIController.getSheetContainerController().getContentRef());t.setContainer(n),window.addEventListener("resize",(()=>{t.resize()})),setTimeout((()=>{t.resize()}),0)}initUI(){}onMounted(e){this.initialize(e)}onDestroy(){}getAppUIController(){return this._appUIController}getComponentManager(){return this._componentManager}getRegisterManager(){return this._registerManager}getKeyboardManager(){return this._keyboardManager}setFormulaContent(e){this._appUIController.getSheetContainerController().getFormulaBarUIController().getFormulaBar().setFormulaContent(e)}setFx(e){this._appUIController.getSheetContainerController().getFormulaBarUIController().getFormulaBar().setFx(e)}UIDidMount(e){this._appUIController.getSheetContainerController().UIDidMount(e)}addSlot(e,t,n){this._appUIController.getSheetContainerController().getMainSlotController().addSlot(e,t,n)}getSlot(e){return this._appUIController.getSheetContainerController().getMainSlotController().getSlot(e)}addToolButton(e){this._appUIController.getSheetContainerController().getToolbarController().addToolbarConfig(e)}deleteToolButton(e){this._appUIController.getSheetContainerController().getToolbarController().deleteToolbarConfig(e)}}var ey=Object.freeze(Object.defineProperty({__proto__:null,SHEET_UI_PLUGIN_NAME:xd,DefaultRightMenuConfig:Od,DefaultToolbarConfig:Md,DefaultSheetContainerConfig:Nd,DefaultSheetUIConfig:kd,zh:Ld,en:Dd,uninstallObserver:function(e){e.deleteObserve("onRichTextKeyDownObservable"),e.deleteObserve("onRichTextKeyUpObservable"),e.deleteObserve("onUIDidMount")},installObserver:Pd,RightMenuUIController:Mw,ToolbarUIController:Vw,SheetContainerUIController:Zw,InfoBarUIController:$w,SheetUIPlugin:Jw,SheetContainer:yw,Toolbar:ww,RightMenu:hT,RightMenuButton:class extends sm{render(){const{label:e,children:t}=this.props;return Kd("div",null,e,t.map((e=>Kd(pb,{type:"primary"},e.label))))}},RightMenuInput:uT,RightMenuItem:dT,RightMenuSelect:class extends sm{render(){const{label:e,options:t}=this.props;return Kd("div",null,Kd("div",null,e),Kd("select",null,t.map((e=>Kd("option",null,e.label)))),Kd(e_,{type:"number",placeholder:"2"}))}},InfoBar:iT,ColorSelect:Iw,LineBold:Aw,LineColor:xw,Slot:cw,UI:Ow},Symbol.toStringTag,{value:"Module"})),ty={spreadsheetLabel:"",spreadsheetRightLabel:" Sheets",spreadsheet:{one:"",two:"",three:""},toolbar:{undo:"",redo:"",paintFormat:"",currencyFormat:"",percentageFormat:"",numberDecrease:"",numberIncrease:"",moreFormats:"",font:"",fontSize:"",bold:" (Ctrl+B)",italic:" (Ctrl+I)",strikethrough:" (Alt+Shift+5)",underline:"",textColor:{main:"",right:""},resetColor:"",customColor:"",alternatingColors:"",confirmColor:"",cancelColor:"",collapse:"",fillColor:{main:"",right:""},border:{main:"",right:""},mergeCell:{main:"",right:""},horizontalAlignMode:{main:"",right:""},verticalAlignMode:{main:"",right:""},textWrapMode:{main:"",right:""},textRotateMode:{main:"",right:""},freezeTopRow:"",sortAndFilter:"",findAndReplace:"",sum:"",autoSum:"",moreFunction:"",conditionalalFormat:"",comment:"",pivotTable:"",chart:"",screenshot:"",splitColumn:"",insertImage:"",insertLink:"",dataValidation:"",protection:"",clearText:"",noColorSelectedText:"",toolMore:"",toolLess:"",toolClose:"",toolMoreTip:"",moreOptions:"",cellFormat:"",print:"",borderMethod:{top:"",bottom:"",left:"",right:""},more:""},defaultFmt:{Automatic:{text:"",value:"General",example:""},Number:{text:"",value:"##0.00",example:"1000.12"},Percent:{text:"",value:"#0.00%",example:"12.21%"},PlainText:{text:"",value:"@",example:""},Scientific:{text:"",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"",value:"(0.00)",example:"(1200.09)"},Thousand:{text:"",value:"w",example:"120002500"},Currency:{text:"",value:"0.00",example:"1200.09"},Digit:{text:"2",value:"w0.00",example:"22500.55"},Date:{text:"",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"24H",value:"hh:mm",example:"15:00"},DateTime:{text:"",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"",moreDateTime:"",moreNumber:"",titleCurrency:"",decimalPlaces:"",titleDateTime:"",titleNumber:""},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"",SimSun:"",SimHei:"",Kaiti:"",FangSong:"",NSimSun:"",STXinwei:"",STXingkai:"",STLiti:"",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"",layoutBtn:"",pageBtn:"",menuItemPrint:"(Ctrl+P)",menuItemAreas:"",menuItemRows:"",menuItemColumns:""},align:{left:"",center:"",right:"",top:"",middle:"",bottom:""},button:{confirm:"",cancel:"",close:"",update:"Update",delete:"Delete",insert:"",prevPage:"",nextPage:"",total:""},punctuation:{tab:"Tab ",semicolon:"",comma:"",space:""},colorPicker:{collapse:"",customColor:"",change:"",confirmColor:"",cancelColor:""},borderLine:{borderTop:"",borderBottom:"",borderLeft:"",borderRight:"",borderNone:"",borderAll:"",borderOutside:"",borderInside:"",borderHorizontal:"",borderVertical:"",borderColor:"",borderSize:""},merge:{all:"",vertical:"",horizontal:"",cancel:"",overlappingError:"",partiallyError:""},textWrap:{overflow:"",wrap:"",clip:""},textRotate:{none:"",angleUp:"",angleDown:"",vertical:"",rotationUp:"90",rotationDown:"90"},sheetConfig:{delete:"",copy:"",rename:"",changeColor:"",hide:"",unhide:"",moveLeft:"",moveRight:"",resetColor:"",cancelText:"",chooseText:"",tipNameRepeat:"",noMoreSheet:"",confirmDelete:"",redoDelete:"Ctrl+Z",noHide:", sheet",chartEditNoOpt:"",sheetNameSpecCharError:"31' :\r\n[ ] : \\ ? * /",sheetNameCannotIsEmptyError:"!"},rightClick:{copy:"",copyAs:"",cut:"",paste:"",insert:"",delete:"",insertRow:"",insertColumn:"",deleteCell:"",deleteSelected:"",hide:"",hideSelected:"",showHide:"",toTopAdd:"",toBottomAdd:"",toLeftAdd:"",toRightAdd:"",deleteSelectedRow:"",deleteSelectedColumn:"",hideSelectedRow:"",showHideRow:"",rowHeight:"",hideSelectedColumn:"",showHideColumn:"",columnWidth:"",to:"",left:"",right:"",top:"",bottom:"",moveLeft:"",moveUp:"",add:"",row:"",column:"",width:"",height:"",number:"",confirm:"",orderAZ:"A-Z",orderZA:"Z-A",clearContent:"",matrix:"",sortSelection:"",filterSelection:"",chartGeneration:"",firstLineTitle:"",untitled:"",array1:"",array2:"",array3:"",diagonal:"",antiDiagonal:"",diagonalOffset:"",offset:"",boolean:"",flip:"",upAndDown:"",leftAndRight:"",clockwise:"",counterclockwise:"",transpose:"",matrixCalculation:"",plus:"",minus:"",multiply:"",divided:"",power:"",root:"",log:"log",delete0:"0",removeDuplicate:"",byRow:"",byCol:"",generateNewMatrix:""},info:{detailUpdate:"",detailSave:"",row:"",column:"",loading:"",copy:"",return:"",rename:"",tips:"",noName:"",wait:"",add:"",addLast:"",backTop:"",pageInfo:"${total}${totalPage}${currentPage}",nextPage:"",tipInputNumber:"",tipInputNumberLimit:"1-100",tipRowHeightLimit:"0 ~ 545",tipColumnWidthLimit:"0 ~ 2038",pageInfoFull:"${total}${totalPage}"}},ny={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"(0.00)",example:"(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"120002500"},Currency:{text:"Currency",value:"0.00",example:"1200.09"},Digit:{text:"2",value:"w0.00",example:"22500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Pagebreakpreview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:"The name cannot contain:[ ] :  ? * / ' \"",sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",cut:"Cut",paste:"Paste",insert:"Insert",insertRow:"InsertRow",insertColumn:"InsertColumn",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",toTopAdd:"Towards Top Add",toBottomAdd:"Towards Bottom Add",toLeftAdd:"Towards Left Add",toRightAdd:"Towards Right Add",deleteSelectedRow:"Delete selected row",deleteSelectedColumn:"Delete selected column",hideSelectedRow:"Hide selected row",showHideRow:"Show selected row",rowHeight:"Row height",hideSelectedColumn:"Hide selected column",showHideColumn:"Show hide column",columnWidth:"Column width",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}${totalPage} pagecurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}${totalPage} pageAll data displayed"}};const ry="DocUI",sy={undo:!0,redo:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0},oy={outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},iy={layout:{docContainerConfig:oy,toolbarConfig:sy}};var ly="univer-layout-container",ay="univer-content-container-horizontal",cy="univer-content-inner-left-container",hy="univer-hover-cursor",uy="univer-content-inner-right-container",dy="univer-content-container-vertical",gy="univer-main-content",fy="univer-outer-right-container";var my="univer-toolbar-warp",py="univer-toolbar",by="univer-select-label-string",_y="univer-select-double-string",vy="univer-select-color-picker-parent",Cy="univer-select-color-picker",Ty="univer-text-button",wy="univer-more-button",yy="univer-more-tool",Sy="univer-tooltip-title",Ey="univer-bottom";class Ry extends sm{constructor(){super(...arguments),this.toolbarRef={current:null},this.moreBtnRef={current:null},this.moreToolRef={current:null},this.SelectRef={current:null},this.clientWidth=0,this.debounceSetToolbarListWidth=Rm((()=>{this.setToolbarListWidth()}),50),this.showMore=()=>{let e=this.state.showMore;this.setState({showMore:!e}),e||document.addEventListener("click",this.hide,!0)},this.hide=e=>{this.moreToolRef.current.contains(e.target)||(e.stopImmediatePropagation(),this.setState({showMore:!1}),document.removeEventListener("click",this.hide,!0))},this.setToolbarListWidth=()=>{this.clientWidth||(this.clientWidth=document.documentElement.clientWidth);const e=this.toolbarRef.current.querySelectorAll(`.${my} > div`),t=this.moreBtnRef.current.clientWidth;let n=60+t,r=null;const s=document.documentElement.clientWidth;if(s<=this.clientWidth){this.clientWidth=s;for(let t=0;t<e.length;t++)if(n+=e[t].clientWidth+6,n>s){r=t;break}null!==r&&this.setState({defaultToolList:this.state.toolList.slice(0,r),moreToolList:r?this.state.toolList.slice(r):[]},(()=>{this.resetUl(),this.forceUpdate()}))}else if(this.clientWidth=s,this.state.moreToolList.length){let n=30+t;for(let t=0;t<e.length;t++)n+=e[t].clientWidth+6;const r=this.moreToolRef.current.querySelectorAll(`.${yy} > div`);let o=null,i=!1;for(let e=0;e<r.length;e++){if(n+=r[e].clientWidth+6,n>s){o=e;break}e===r.length-1&&(o=e,i=!0)}null!==o&&this.setState({defaultToolList:this.state.defaultToolList.concat(this.state.moreToolList.slice(0,i?o+1:o)),moreToolList:i?[]:this.state.moreToolList.slice(o)},(()=>{this.resetUl(),this.forceUpdate()}))}},this.resetLabel=e=>{var t,n,r;const s=null==(t=this.getContext().getPluginManager().getPluginByName(ry))?void 0:t.getComponentManager();for(let o=0;o<e.length;o++){const t=Lm(e[o],this.getLocale.bind(this));if(t.customLabel){const e=null==s?void 0:s.get(t.customLabel.name);if(e){const r=null!=(n=t.customLabel.props)?n:{};t.label=Kd(e,__spreadValues({},r))}}if(t.customSuffix){const e=null==s?void 0:s.get(t.customSuffix.name);if(e){const n=null!=(r=t.customSuffix.props)?r:{};t.suffix=Kd(e,__spreadValues({},n))}}t.children&&(t.children=this.resetLabel(t.children))}return e},this.setToolbar=e=>{this.setState({toolList:e,defaultToolList:e},(()=>{this.setToolbarListWidth()}))},this.resetUl=()=>{var e;const t=`${(null==(e=this.getContext().getPluginManager().getPluginByName(ry))?void 0:e.getAppUIController().getDocContainerController().getContentRef().current).offsetHeight}px`,n=this.toolbarRef.current.querySelectorAll("ul");for(let r=0;r<n.length;r++)n[r].style.maxHeight=t}}initialize(){this.state={showMore:!1,toolList:[],defaultToolList:[],moreToolList:[],toolbarListWidths:[]}}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this),window.addEventListener("resize",this.debounceSetToolbarListWidth)}componentWillUnmount(){window.removeEventListener("resize",this.debounceSetToolbarListWidth)}getToolbarList(e){return(e=this.resetLabel(e)).map((e=>{if(e.toolbarType){if(e.show)return Kd(uv,{title:this.getLocale(e.tooltip),placement:"bottom"},Kd(pb,{unActive:e.unActive,className:Ty,type:"text",active:e.active,onClick:e.onClick},e.label))}else if(e.show)return Kd(aC,{tooltip:this.getLocale(e.tooltip),type:e.type,display:e.display,children:e.children,customLabel:e.customLabel,customSuffix:e.customSuffix,label:e.label,onClick:e.onClick,onPressEnter:e.onPressEnter,onMainClick:e.onMainClick,defaultColor:e.defaultColor,hideSelectedIcon:e.hideSelectedIcon,className:e.className});return null}))}render(){const{defaultToolList:e,moreToolList:t,showMore:n}=this.state;return Kd(b_,{style:{position:"relative"}},Kd("div",{className:`${my} ${py}`,ref:this.toolbarRef},this.getToolbarList(e),Kd("div",{ref:this.moreBtnRef,className:wy,style:{visibility:t.length?"visible":"hidden"}},Kd(uv,{title:this.getLocale("toolbar.toolMoreTip"),placement:"bottom"},Kd(pb,{type:"text",onClick:this.showMore},Kd("div",{style:{fontSize:"14px"}},this.getLocale("toolbar.toolMore")))))),t.length?Kd("div",{style:{visibility:n?"visible":"hidden"},className:`${yy} ${py}`,ref:this.moreToolRef},this.getToolbarList(t)):"")}}Ry.contextType=Vg;var Iy="univer-info-detail",Ay="univer-sheet-name",xy="univer-info-detail-update",Oy="univer-info-detail-save";class My extends sm{initialize(){this.state={infoList:null}}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}setInfoList(e){this.setState({infoList:e})}render(){const{renameSheet:e}=this.props;if(!this.state.infoList)return;const{back:t,sheet:n,update:r,save:s,rename:o}=this.state.infoList;return Kd(b_,{className:Iy},Kd("div",{className:Ay},Kd(uv,{title:o.label,placement:"bottom"},Kd(e_,{bordered:!1,value:n.label,onBlur:e}))),Kd("div",{className:xy},r.label),Kd("div",{className:Oy},s.label))}}class Ny extends sm{constructor(e){super(),this.splitLeftRef={current:null},this.contentRef={current:null},this.handleSplitBarMouseDown=e=>{var t,n,r,s,o;this.leftContentLeft=null==(t=this.splitLeftRef.current)?void 0:t.getBoundingClientRect().left,this.leftContentTop=null==(n=this.splitLeftRef.current)?void 0:n.getBoundingClientRect().top;const i=null==(r=this.splitLeftRef.current)?void 0:r.parentElement;this.rightBorderX=null==(s=null==i?void 0:i.getBoundingClientRect())?void 0:s.width,this.rightBorderY=null==(o=null==i?void 0:i.getBoundingClientRect())?void 0:o.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=e=>{var t;const n=null==(t=this.props.config.layout)?void 0:t.docContainerConfig;let r=(e=e||window.event).clientX-this.leftContentLeft,s=e.clientY-this.leftContentTop;r=r>=this.rightBorderX?this.rightBorderX:r,s=s>=this.rightBorderY?this.rightBorderY:s,"vertical"===n.contentSplit?this.splitLeftRef.current.style.height=`${s}px`:this.splitLeftRef.current.style.width=`${r}px`},this.handleSplitBarMouseUp=e=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.changeSkin(e.config.container,"default")}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}getContentRef(){return this.contentRef}getSplitLeftRef(){return this.splitLeftRef}changeSkin(e,t){let n=document.documentElement;const r="string"==typeof e?e:e.id;let s={default:dC}[t];if(s=Object.fromEntries(Object.keys(s).map((e=>[`--${e.replace(/([A-Z0-9])/g,"-$1").toLowerCase()}`,s[e]]))),C.isIEBrowser())FC({rootElement:n,variables:s});else{(function(e){const t="universheet-skin-style";for(let s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].title===t)return o(document.styleSheets[s],e),document.styleSheets[s];const n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");return r.title=t,n.appendChild(r),document.styleSheets[document.styleSheets.length-1]})(r).insertRule(`#${r} ${JSON.stringify(s).replace(/"/g,"").replace(/,(?=--)/g,";")}`)}function o(e,t){let n=0;for(let r=0;r<e.cssRules.length;r++){const s=e.cssRules[r];if(s instanceof CSSStyleRule&&s.selectorText===`#${t}`){n=r,e.deleteRule(n);break}}}}render(){const{methods:e}=this.props,{layout:t}=this.props.config,n=null==t?void 0:t.docContainerConfig;return Kd(b_,{className:ly},Kd(E_,null,Kd(x_,{style:{display:n.outerLeft?"block":"none"}}),Kd(E_,{className:gy,style:{position:"relative"}},Kd(R_,{style:{display:n.header?"block":"none"}},n.infoBar&&Kd(My,__spreadValues({},e.infoBar)),n.toolbar&&Kd(Ry,__spreadValues({},e.toolbar))),Kd(E_,null,Kd(x_,{style:{display:n.innerLeft?"block":"none"}}),Kd(A_,{className:"vertical"===n.contentSplit?dy:ay},!!n.contentSplit&&Kd(b_,{ref:this.splitLeftRef,className:cy},Kd("div",{className:hy,onMouseDown:this.handleSplitBarMouseDown})),Kd(b_,{onContextMenu:e=>e.preventDefault(),ref:this.contentRef,className:uy})),Kd(x_,{style:{display:n.innerRight?"block":"none"}})),Kd(I_,{style:{display:n.footer?"block":"none"}})),Kd(x_,{style:{display:n.outerRight?"block":"none"},className:fy})))}}class ky extends sm{constructor(e){super(e),this.state={locale:this.props.locale}}setLocale(e){const t=e.target.value;this.props.changeLocale(t),this.setState({locale:t})}render(){const{context:e,UIConfig:t}=this.props,{locale:n}=this.state;return Kd(Vg.Provider,{value:{context:e,locale:n}},Kd("div",{style:{position:"fixed",right:"250px",top:"14px",fontSize:"14px",zIndex:100},className:"univer-dev-operation"},Kd("span",{style:{display:"inline-block",width:70,margin:"5px 0 0 5px"}},"Language"),Kd("select",{value:n,onChange:this.setLocale.bind(this),style:{width:70}},Kd("option",{value:"en"},"English"),Kd("option",{value:"zh"},""))),Kd(Ny,__spreadValues({},t)))}}class Ly{constructor(e){this._initialize(e)}static create(e){return new Ly(e)}_initialize(e){let t;const n=e.container;if("string"==typeof n){const e=document.getElementById(n);null==e?(t=document.createElement("div"),t.id=n):t=e}else Cm(n)?t=n:(t=document.createElement("div"),t.id="univer");vg(Kd(ky,__spreadValues({},e)),t)}}class Dy{constructor(e){this._name=e}get name(){return this._name}setName(e){this._name=e}}class Py{constructor(e){this.getComponent=e=>{this._infoBar=e,this._refreshComponent(),this.resetInfoList(this._infoList)},this._plugin=e}resetInfoList(e){const t=this._plugin.getContext().getLocale();for(let n in e)e[n].locale&&(e[n].label=t.get(e[n].locale));this._infoBar.setInfoList(e)}setSheetName(e){const t=e.target.value;this._infoBarModel.setName(t)}_refreshComponent(){const e="UniverDoc";this._infoBarModel=new Dy(e),this._infoList={back:{locale:"info.return"},rename:{locale:"info.tips"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},sheet:{label:e,onBlur:e=>{this.setSheetName(e)}}}}}var By="univer-color-select",Hy="univer-color-select-line";class Fy extends sm{componentDidMount(){var e,t,n;const r=null==(e=this.getContext().getPluginManager().getPluginByName(ry))?void 0:e.getComponentManager();let s=this.props.label;if(this.props.customLabel){s=Kd(null==r?void 0:r.get(this.props.customLabel.name),__spreadValues({},this.props.customLabel.props))}this.setState({label:s,color:this.props.color}),null==(n=(t=this.props).getComponent)||n.call(t,this)}componentWillReceiveProps(e){this.setState({color:e.color})}setColor(e){this.setState({color:e})}render(){return Kd("div",{className:By},Kd("div",null,this.state.label),Kd("div",{className:Hy,style:{background:this.state.color}}))}}const zy=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],Uy=[{labelLocale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{labelLocale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{labelLocale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{labelLocale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{labelLocale:"fontFamily.MicrosoftAccorblack",style:{"font-family":""},value:""},{labelLocale:"fontFamily.SimSun",style:{"font-family":""},value:""},{labelLocale:"fontFamily.SimHei",style:{"font-family":""},value:""},{labelLocale:"fontFamily.Kaiti",style:{"font-family":""},value:""},{labelLocale:"fontFamily.FangSong",style:{"font-family":""},value:""},{labelLocale:"fontFamily.NSimSun",style:{"font-family":""},value:""},{labelLocale:"fontFamily.STXinwei",style:{"font-family":""},value:""},{labelLocale:"fontFamily.STXingkai",style:{"font-family":""},value:""},{labelLocale:"fontFamily.STLiti",style:{"font-family":""},value:""},{labelLocale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{labelLocale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{labelLocale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}];ye.NONE,ye.THIN,ye.HAIR,ye.DOTTED,ye.DASHED,ye.DOTTED,ye.DASH_DOT_DOT,ye.MEDIUM,ye.MEDIUM_DASHED,ye.MEDIUM_DASH_DOT,ye.MEDIUM_DASH_DOT_DOT,ye.THICK;const Wy=[{labelLocale:"align.left",customSuffix:{name:"LeftAlignIcon"},value:1},{labelLocale:"align.center",selected:!0,customSuffix:{name:"CenterAlignIcon"},value:2},{labelLocale:"align.right",customSuffix:{name:"RightAlignIcon"},value:3}],Vy=[{labelLocale:"align.top",customSuffix:{name:"TopVerticalIcon"},value:1},{labelLocale:"align.middle",customSuffix:{name:"CenterVerticalIcon"},value:2},{labelLocale:"align.bottom",customSuffix:{name:"BottomVerticalIcon"},value:3}],jy=[{labelLocale:"textWrap.overflow",customSuffix:{name:"OverflowIcon"},value:1},{labelLocale:"textWrap.wrap",customSuffix:{name:"BrIcon"},value:3},{labelLocale:"textWrap.clip",customSuffix:{name:"CutIcon"},value:2}],Yy=[{labelLocale:"textRotate.none",customSuffix:{name:"TextRotateIcon"},value:0},{labelLocale:"textRotate.angleUp",customSuffix:{name:"TextRotateAngleUpIcon"},value:-45},{labelLocale:"textRotate.angleDown",customSuffix:{name:"TextRotateAngleDownIcon"},value:45},{labelLocale:"textRotate.vertical",customSuffix:{name:"TextRotateVerticalIcon"},value:"v"},{labelLocale:"textRotate.rotationUp",customSuffix:{name:"TextRotateRotationUpIcon"},value:-90},{labelLocale:"textRotate.rotationDown",customSuffix:{name:"TextRotateRotationDownIcon"},value:90}];var Gy;!function(e){e[e.SELECT=0]="SELECT",e[e.BUTTON=1]="BUTTON"}(Gy||(Gy={}));class Xy{constructor(e,t){this._textColor="#000",this._background="#fff",this.getComponent=e=>{this._toolbar=e,this.setToolbar()},this._plugin=e,this._config=C.deepMerge({},sy,t),this._toolList=[{toolbarType:1,tooltip:"toolbar.undo",name:"undo",customLabel:{name:"ForwardIcon"},show:this._config.undo,onClick:()=>{this.setUndo(),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.redo",customLabel:{name:"BackIcon"},name:"redo",show:this._config.redo,onClick:()=>{this.setRedo(),this.hideTooltip()}},{type:0,tooltip:"toolbar.font",className:by,name:"font",show:this._config.font,border:!0,onMainClick:()=>{this.hideTooltip()},onClick:e=>{this.setFontFamily(e)},children:Uy},{type:1,tooltip:"toolbar.fontSize",label:String(Dt.fs),name:"fontSize",show:this._config.fontSize,onClick:e=>{this.setFontSize(e)},onMainClick:()=>{this.hideTooltip()},onPressEnter:e=>{this.setFontSize(e),this.hideTooltip()},children:zy},{toolbarType:1,tooltip:"toolbar.bold",customLabel:{name:"BoldIcon"},unActive:!1,name:"bold",show:this._config.bold,onClick:(e,t)=>{this.setFontWeight(t),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.italic",customLabel:{name:"ItalicIcon"},unActive:!1,name:"italic",show:this._config.italic,onClick:(e,t)=>{this.setFontStyle(t),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},unActive:!1,name:"strikethrough",show:this._config.strikethrough,onClick:(e,t)=>{this.hideTooltip();const n=this._toolList.find((e=>"strikethrough"===e.name));n&&(n.active=t,this.setStrikeThrough(t))}},{toolbarType:1,tooltip:"toolbar.underline",customLabel:{name:"UnderLineIcon"},unActive:!1,name:"underline",show:this._config.underline,onClick:(e,t)=>{this.hideTooltip();const n=this._toolList.find((e=>"underline"===e.name));n&&(n.active=t,this.setUnderline(t))}},{type:5,tooltip:"toolbar.textColor.main",customLabel:{name:ry+Fy.name,props:{getComponent:e=>{this._colorSelect1=e},color:"#000",customLabel:{name:"TextColorIcon"}}},onClick:()=>{this.hideTooltip();const e=this._toolList.find((e=>"textColor"===e.name));e&&e.customLabel&&e.customLabel.props&&(e.customLabel.props.color=this._textColor,this.changeColor(this._textColor))},hideSelectedIcon:!0,className:vy,children:[{labelLocale:"toolbar.resetColor"},{customLabel:{name:ry+g_.name,props:{onClick:(e,t)=>{this._colorSelect1.setColor(e),this._textColor=e}}},className:Cy}],name:"textColor",show:this._config.textColor},{type:5,tooltip:"toolbar.fillColor.main",customLabel:{name:ry+Fy.name,props:{getComponent:e=>{this._colorSelect2=e},color:"#fff",customLabel:{name:"FillColorIcon"}}},onClick:()=>{this.hideTooltip();const e=this._toolList.find((e=>"fillColor"===e.name));e&&e.customLabel&&e.customLabel.props&&(e.customLabel.props.color=this._background,this.setBackground(this._background))},hideSelectedIcon:!0,className:vy,children:[{labelLocale:"toolbar.resetColor"},{customLabel:{name:ry+g_.name,props:{onClick:(e,t)=>{this._colorSelect2.setColor(e),this._background=e}}},className:Cy}],name:"fillColor",show:this._config.fillColor},{type:3,tooltip:"toolbar.horizontalAlignMode.main",className:_y,display:1,name:"horizontalAlignMode",show:this._config.horizontalAlignMode,onClick:e=>{this.setHorizontalAlignment(e),this.hideTooltip()},children:Wy},{type:3,tooltip:"toolbar.verticalAlignMode.main",className:_y,display:1,name:"verticalAlignMode",show:this._config.verticalAlignMode,onClick:e=>{this.setVerticalAlignment(e),this.hideTooltip()},children:Vy},{type:3,className:_y,tooltip:"toolbar.textWrapMode.main",display:1,name:"textWrapMode",show:this._config.textWrapMode,onClick:e=>{this.setWrapStrategy(e),this.hideTooltip()},children:jy},{type:3,className:_y,name:"textRotateMode",tooltip:"toolbar.textRotateMode.main",display:1,show:this._config.textRotateMode,onClick:e=>{this.setTextRotation(e),this.hideTooltip()},children:Yy}],this._initialize()}addToolbarConfig(e){this._toolList.findIndex((t=>t.name===e.name))>-1||this._toolList.push(e)}deleteToolbarConfig(e){const t=this._toolList.findIndex((t=>t.name===e));t>-1&&this._toolList.splice(t,1)}setToolbar(){var e;null==(e=this._toolbar)||e.setToolbar(this._toolList)}setUIObserve(e){this._plugin.getContext().getObserverManager().requiredObserver("onUIChangeObservable","core").notifyObservers(e)}changeColor(e){var t,n;const r=this._toolList.find((e=>"strikethrough"===e.name)),s=this._toolList.find((e=>"underline"===e.name));this.setFontColor(e),s&&this.setUnderline(null!=(t=s.active)&&t),r&&this.setStrikeThrough(null!=(n=r.active)&&n)}setUndo(){this.setUIObserve({name:"undo"})}setRedo(){this.setUIObserve({name:"redo"})}setFontFamily(e){const t={name:"fontFamily",value:e};this.setUIObserve(t)}setFontSize(e){const t={name:"fontSize",value:e};this.setUIObserve(t)}setFontWeight(e){const t={name:"fontWeight",value:e};this.setUIObserve(t)}setFontStyle(e){const t={name:"fontStyle",value:e};this.setUIObserve(t)}setStrikeThrough(e){const t={name:"strikeThrough",value:e};this.setUIObserve(t)}setUnderline(e){const t={name:"underLine",value:e};this.setUIObserve(t)}setFontColor(e){const t={name:"fontColor",value:e};this.setUIObserve(t)}setBackground(e){const t={name:"background",value:e};this.setUIObserve(t)}setTextRotation(e){const t={name:"textRotation",value:e};this.setUIObserve(t)}setWrapStrategy(e){const t={name:"wrapStrategy",value:e};this.setUIObserve(t)}setVerticalAlignment(e){const t={name:"verticalAlignment",value:e};this.setUIObserve(t)}setHorizontalAlignment(e){const t={name:"horizontalAlignment",value:e};this.setUIObserve(t)}hideTooltip(){this._toolbar.base.querySelectorAll(`.${Sy}.${Ey}`).forEach((e=>{e.style.display="none"}))}_changeToolbarState(e){var t,n,r,s,o,i,l,a;if(this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getActiveSheet()){const c=e.getFontWeight(),h=e.getFontStyle(),u=e.getStrikeThrough(),d=e.getFontSize(),g=e.getFontWeight(),f=e.getFontFamily(),m=e.getFontStyle(),p=e.getUnderline(),b=null!=(t=e.getHorizontalAlignment())?t:lt.LEFT,_=null!=(n=e.getVerticalAlignment())?n:ct.BOTTOM,v=e.getTextRotation(),C=null!=(r=e.getWrapStrategy())?r:ut.CLIP,T=this._toolList.find((e=>"bold"===e.name)),w=this._toolList.find((e=>"italic"===e.name)),y=this._toolList.find((e=>"textRotateMode"===e.name)),S=this._toolList.find((e=>"fontSize"===e.name)),E=this._toolList.find((e=>"font"===e.name)),R=this._toolList.find((e=>"bold"===e.name)),I=this._toolList.find((e=>"italic"===e.name)),A=this._toolList.find((e=>"strikethrough"===e.name)),x=this._toolList.find((e=>"underline"===e.name)),O=this._toolList.find((e=>"horizontalAlignMode"===e.name)),M=this._toolList.find((e=>"verticalAlignMode"===e.name)),N=this._toolList.find((e=>"textWrapMode"===e.name));T&&(T.active=c===mt.BOLD),w&&(w.active=h===gt.ITALIC),A&&(A.active=!(!u||!u.s)),E&&(null==(s=E.children)||s.forEach((e=>{e.selected=f===e.value}))),S&&(S.label=d.toString()),R&&(R.active=!!g),I&&(I.active=!!m),x&&(x.active=!(!p||!p.s)),O&&(null==(o=O.children)||o.forEach((e=>{e.selected=b===e.value}))),y&&(null==(i=y.children)||i.forEach((e=>{v.v?e.selected="v"===e.value:e.selected=v.a===e.value}))),M&&(null==(l=M.children)||l.forEach((e=>{e.selected=_===e.value}))),N&&(null==(a=N.children)||a.forEach((e=>{e.selected=C===e.value}))),this.setToolbar()}}_initialize(){this._plugin.getComponentManager().register(ry+Fy.name,Fy),this._plugin.getComponentManager().register(ry+g_.name,g_)}}class $y{constructor(e){var t;this.getComponent=e=>{var t;this._docContainer=e,null==(t=this._plugin.getObserver("onUIDidMount"))||t.notifyObservers(this._docContainer),this._initDocContainer()},this.changeLocale=e=>{this._plugin.getContext().getLocale().change(e),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onAfterChangeUILocaleObservable","core").notifyObservers()},this._plugin=e,this._config=this._plugin.getConfig(),this._initialize(),this._toolbarController=new Xy(this._plugin,null==(t=this._config.layout)?void 0:t.toolbarConfig),this._infoBarController=new Py(this._plugin)}getUIConfig(){return{context:this._plugin.getContext(),config:this._config,changeLocale:this.changeLocale,getComponent:this.getComponent,methods:{toolbar:{getComponent:this._toolbarController.getComponent},infoBar:{getComponent:this._infoBarController.getComponent}}}}getContentRef(){return this._docContainer.getContentRef()}setEventManager(){this._plugin.getUniver().getAllUniverDocsInstance().forEach((e=>{}))}getEventManager(){return this._eventManager}getToolbarController(){return this._toolbarController}UIDidMount(e){var t;if(this._docContainer)return e(this._docContainer);null==(t=this._plugin.getObserver("onUIDidMount"))||t.add((()=>e(this._docContainer)))}_initialize(){this._eventManager=new Gg(this._plugin),this.setEventManager()}_initDocContainer(){}}class Qy{constructor(e){this.changeLocale=e=>{this._plugin.getGlobalContext().getLocale().change(e),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onAfterChangeUILocaleObservable","core").notifyObservers()},this._plugin=e,this._docContainerController=new $y(this._plugin);const t=this._docContainerController.getUIConfig();Ly.create({context:this._plugin.getGlobalContext(),locale:this._plugin.getGlobalContext().getLocale().getCurrentLocale(),changeLocale:this.changeLocale,UIConfig:t,container:this._plugin.getConfig().container})}getDocContainerController(){return this._docContainerController}}class Ky extends Fo{constructor(e){super(ry),this._config=C.deepMerge({},iy,e)}static create(e){return new Ky(e)}installTo(e){e.installPlugin(this)}initialize(e){this.getLocale().load({en:ny,zh:ty}),this._componentManager=new nb,this._appUIController=new Qy(this),this.UIDidMount((()=>{this.initRender()}))}getConfig(){return this._config}initRender(){var e;const t=null==(e=this.getPluginByName(Ut.BASE_RENDER))?void 0:e.getEngine();let n=Mm(this._appUIController.getDocContainerController().getContentRef());t.setContainer(n),this.getUniver().getCurrentUniverDocInstance().context.getPluginManager().getRequirePluginByName(Ut.DOCUMENT).calculatePagePosition(),window.addEventListener("resize",(()=>{t.resize()})),setTimeout((()=>{t.resize()}),0)}getAppUIController(){return this._appUIController}getComponentManager(){return this._componentManager}getRegisterManager(){return this._registerManager}UIDidMount(e){this._appUIController.getDocContainerController().UIDidMount(e)}onMounted(e){this.initialize(e)}onDestroy(){}}var Zy=Object.freeze(Object.defineProperty({__proto__:null,DocUIPlugin:Ky,DOC_UI_PLUGIN_NAME:ry,DefaultToolbarConfig:sy,DefaultDocContainerConfig:oy,DefaultDocUiConfig:iy,zh:ty,en:ny},Symbol.toStringTag,{value:"Module"})),qy={ui:{tooltip:"UI",one:"",two:"",three:""}},Jy={ui:{tooltip:"UI",one:"one",two:"two",three:"three"}};const eS="SlideUI";var tS="univer-layout-container",nS="univer-content-container-horizontal",rS="univer-content-inner-left-container",sS="univer-hover-cursor",oS="univer-content-inner-right-container",iS="univer-content-container-vertical",lS="univer-main-content",aS="univer-outer-right-container";var cS="univer-info-detail",hS="univer-sheet-name",uS="univer-info-detail-update",dS="univer-info-detail-save";class gS extends sm{initialize(){this.state={infoList:null}}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}setInfoList(e){this.setState({infoList:e})}render(){const{renameSheet:e}=this.props;if(!this.state.infoList)return;const{back:t,slide:n,update:r,save:s,rename:o}=this.state.infoList;return Kd(b_,{className:cS},Kd("div",{className:hS},Kd(uv,{title:o.label,placement:"bottom"},Kd(e_,{bordered:!1,value:n.label,onBlur:e}))),Kd("div",{className:uS},r.label),Kd("div",{className:dS},s.label))}}const fS={undo:!0,redo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0,mergeCell:!0},mS={outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},pS={layout:{slideContainerConfig:mS,toolbarConfig:fS}};function bS(e){e.pushToObserve("onUIDidMount")}var _S="univer-toolbar-warp",vS="univer-toolbar",CS="univer-select-label-string",TS="univer-select-double-string",wS="univer-select-color-picker-parent",yS="univer-select-color-picker",SS="univer-select-line-bold-parent",ES="univer-text-button",RS="univer-more-button",IS="univer-more-tool",AS="univer-tooltip-title",xS="univer-bottom";class OS extends sm{constructor(){super(...arguments),this.toolbarRef={current:null},this.moreBtnRef={current:null},this.moreToolRef={current:null},this.SelectRef={current:null},this.clientWidth=0,this.debounceSetToolbarListWidth=Rm((()=>{this.setToolbarListWidth()}),50),this.showMore=()=>{let e=this.state.showMore;this.setState({showMore:!e}),e||document.addEventListener("click",this.hide,!0)},this.hide=e=>{this.moreToolRef.current.contains(e.target)||(e.stopImmediatePropagation(),this.setState({showMore:!1}),document.removeEventListener("click",this.hide,!0))},this.setToolbarListWidth=()=>{this.clientWidth||(this.clientWidth=document.documentElement.clientWidth);const e=this.toolbarRef.current.querySelectorAll(`.${_S} > div`),t=this.moreBtnRef.current.clientWidth;let n=60+t,r=null;const s=document.documentElement.clientWidth;if(s<=this.clientWidth){this.clientWidth=s;for(let t=0;t<e.length;t++)if(n+=e[t].clientWidth+6,n>s){r=t;break}null!==r&&this.setState({defaultToolList:this.state.toolList.slice(0,r),moreToolList:r?this.state.toolList.slice(r):[]},(()=>{this.resetUl(),this.forceUpdate()}))}else if(this.clientWidth=s,this.state.moreToolList.length){let n=30+t;for(let t=0;t<e.length;t++)n+=e[t].clientWidth+6;const r=this.moreToolRef.current.querySelectorAll(`.${IS} > div`);let o=null,i=!1;for(let e=0;e<r.length;e++){if(n+=r[e].clientWidth+6,n>s){o=e;break}e===r.length-1&&(o=e,i=!0)}null!==o&&this.setState({defaultToolList:this.state.defaultToolList.concat(this.state.moreToolList.slice(0,i?o+1:o)),moreToolList:i?[]:this.state.moreToolList.slice(o)},(()=>{this.resetUl(),this.forceUpdate()}))}},this.resetLabel=e=>{var t,n,r;const s=null==(t=this.getContext().getPluginManager().getPluginByName(eS))?void 0:t.getComponentManager();for(let o=0;o<e.length;o++){const t=Lm(e[o],this.getLocale.bind(this));if(t.customLabel){const e=null==s?void 0:s.get(t.customLabel.name);if(e){const r=null!=(n=t.customLabel.props)?n:{};t.label=Kd(e,__spreadValues({},r))}}if(t.customSuffix){const e=null==s?void 0:s.get(t.customSuffix.name);if(e){const n=null!=(r=t.customSuffix.props)?r:{};t.suffix=Kd(e,__spreadValues({},n))}}t.children&&(t.children=this.resetLabel(t.children))}return e},this.setToolbar=e=>{this.setState({toolList:e,defaultToolList:e},(()=>{this.setToolbarListWidth()}))},this.resetUl=()=>{var e;const t=`${(null==(e=this.getContext().getPluginManager().getPluginByName(eS))?void 0:e.getAppUIController().getSlideContainerController().getContentRef().current).offsetHeight}px`,n=this.toolbarRef.current.querySelectorAll("ul");for(let r=0;r<n.length;r++)n[r].style.maxHeight=t}}initialize(){this.state={showMore:!1,toolList:[],defaultToolList:[],moreToolList:[],toolbarListWidths:[]}}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this),window.addEventListener("resize",this.debounceSetToolbarListWidth)}componentWillUnmount(){window.removeEventListener("resize",this.debounceSetToolbarListWidth)}getToolbarList(e){return(e=this.resetLabel(e)).map((e=>{if(e.toolbarType){if(e.show)return Kd(uv,{title:this.getLocale(e.tooltip),placement:"bottom"},Kd(pb,{unActive:e.unActive,className:ES,type:"text",active:e.active,onClick:e.onClick},e.label))}else if(e.show)return Kd(aC,{tooltip:this.getLocale(e.tooltip),type:e.type,display:e.display,children:e.children,customLabel:e.customLabel,customSuffix:e.customSuffix,label:e.label,onClick:e.onClick,onPressEnter:e.onPressEnter,onMainClick:e.onMainClick,defaultColor:e.defaultColor,hideSelectedIcon:e.hideSelectedIcon,className:e.className});return null}))}render(){const{defaultToolList:e,moreToolList:t,showMore:n}=this.state;return Kd(b_,{style:{position:"relative"}},Kd("div",{className:`${_S} ${vS}`,ref:this.toolbarRef},this.getToolbarList(e),Kd("div",{ref:this.moreBtnRef,className:RS,style:{visibility:t.length?"visible":"hidden"}},Kd(uv,{title:this.getLocale("toolbar.toolMoreTip"),placement:"bottom"},Kd(pb,{type:"text",onClick:this.showMore},Kd("div",{style:{fontSize:"14px"}},this.getLocale("toolbar.toolMore")))))),t.length?Kd("div",{style:{visibility:n?"visible":"hidden"},className:`${IS} ${vS}`,ref:this.moreToolRef},this.getToolbarList(t)):"")}}OS.contextType=Vg;var MS="univer-slide-bar",NS="univer-slide-bar-content",kS="univer-slide-bar-item",LS="univer-slide-bar-box",DS="univer-slide-bar-item-active",PS="univer-slide-add-button";class BS extends sm{constructor(){super(...arguments),this.slideBarRef={current:null}}initialize(){this.state={slideList:[]}}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}isActive(e,t=0){return null==this.state.activePageId&&0===t||this.state.activePageId===e?DS:""}setSlide(e,t){this.setState({slideList:e},t)}activeSlide(e,t){this.state.activePageId!==e&&(this.setState({activePageId:e}),this.props.activeSlide(e))}render(){const{addSlide:e}=this.props,{slideList:t}=this.state;return Kd("div",{className:MS,ref:this.slideBarRef},Kd("div",{className:NS},t.map(((e,t)=>Kd("div",{className:`${kS} ${this.isActive(e.id,t)}`,onClick:()=>this.activeSlide(e.id,t)},Kd("span",null,t+1),Kd("div",{className:LS}))))),Kd("div",{className:PS},Kd(pb,{type:"text",onClick:e},"+")))}}BS.contextType=Vg;class HS extends sm{constructor(e){super(),this.splitLeftRef={current:null},this.contentRef={current:null},this.handleSplitBarMouseDown=e=>{var t,n,r,s,o;this.leftContentLeft=null==(t=this.splitLeftRef.current)?void 0:t.getBoundingClientRect().left,this.leftContentTop=null==(n=this.splitLeftRef.current)?void 0:n.getBoundingClientRect().top;const i=null==(r=this.splitLeftRef.current)?void 0:r.parentElement;this.rightBorderX=null==(s=null==i?void 0:i.getBoundingClientRect())?void 0:s.width,this.rightBorderY=null==(o=null==i?void 0:i.getBoundingClientRect())?void 0:o.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=e=>{var t;const n=null==(t=this.props.config.layout)?void 0:t.slideContainerConfig;let r=(e=e||window.event).clientX-this.leftContentLeft,s=e.clientY-this.leftContentTop;r=r>=this.rightBorderX?this.rightBorderX:r,s=s>=this.rightBorderY?this.rightBorderY:s,"vertical"===n.contentSplit?this.splitLeftRef.current.style.height=`${s}px`:this.splitLeftRef.current.style.width=`${r}px`},this.handleSplitBarMouseUp=e=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.changeSkin(e.config.container,"default")}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}getContentRef(){return this.contentRef}getSplitLeftRef(){return this.splitLeftRef}changeSkin(e,t){let n=document.documentElement;const r="string"==typeof e?e:e.id;let s={default:dC}[t];if(s=Object.fromEntries(Object.keys(s).map((e=>[`--${e.replace(/([A-Z0-9])/g,"-$1").toLowerCase()}`,s[e]]))),C.isIEBrowser())FC({rootElement:n,variables:s});else{(function(e){const t="universlide-skin-style";for(let s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].title===t)return o(document.styleSheets[s],e),document.styleSheets[s];const n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");return r.title=t,n.appendChild(r),document.styleSheets[document.styleSheets.length-1]})(r).insertRule(`#${r} ${JSON.stringify(s).replace(/"/g,"").replace(/,(?=--)/g,";")}`)}function o(e,t){let n=0;for(let r=0;r<e.cssRules.length;r++){const s=e.cssRules[r];if(s instanceof CSSStyleRule&&s.selectorText===`#${t}`){n=r,e.deleteRule(n);break}}}}render(){const{methods:e}=this.props,{layout:t}=this.props.config,n=null==t?void 0:t.slideContainerConfig;return Kd(b_,{className:tS},Kd(E_,null,Kd(x_,{style:{display:n.outerLeft?"block":"none"}}),Kd(E_,{className:lS,style:{position:"relative"}},Kd(R_,{style:{display:n.header?"block":"none"}},n.infoBar&&Kd(gS,__spreadValues({},e.infoBar)),n.toolbar&&Kd(OS,__spreadValues({},e.toolbar))),Kd(E_,null,Kd(x_,{style:{width:"300px",display:n.innerLeft?"block":"none"}},Kd(BS,__spreadValues({},e.slideBar))),Kd(A_,{className:"vertical"===n.contentSplit?iS:nS},!!n.contentSplit&&Kd(b_,{ref:this.splitLeftRef,className:rS},Kd("div",{className:sS,onMouseDown:this.handleSplitBarMouseDown})),Kd(b_,{onContextMenu:e=>e.preventDefault(),ref:this.contentRef,className:oS})),Kd(x_,{style:{display:n.innerRight?"block":"none"}})),Kd(I_,{style:{display:n.footer?"block":"none"}})),Kd(x_,{style:{display:n.outerRight?"block":"none"},className:aS})))}}class FS extends sm{constructor(e){super(e),this.state={locale:this.props.locale}}setLocale(e){const t=e.target.value;this.props.changeLocale(t),this.setState({locale:t})}render(){const{context:e,UIConfig:t}=this.props,{locale:n}=this.state;return Kd(Vg.Provider,{value:{context:e,locale:n}},Kd("div",{style:{position:"fixed",right:"250px",top:"14px",fontSize:"14px",zIndex:100},className:"univer-dev-operation"},Kd("span",{style:{display:"inline-block",width:70,margin:"5px 0 0 5px"}},"Language"),Kd("select",{value:n,onChange:this.setLocale.bind(this),style:{width:70}},Kd("option",{value:"en"},"English"),Kd("option",{value:"zh"},""))),Kd(HS,__spreadValues({},t)))}}var zS="univer-color-select",US="univer-color-select-line";class WS extends sm{componentDidMount(){var e,t,n;const r=null==(e=this.getContext().getPluginManager().getPluginByName(eS))?void 0:e.getComponentManager();let s=this.props.label;if(this.props.customLabel){s=Kd(null==r?void 0:r.get(this.props.customLabel.name),__spreadValues({},this.props.customLabel.props))}this.setState({label:s,color:this.props.color}),null==(n=(t=this.props).getComponent)||n.call(t,this)}componentWillReceiveProps(e){this.setState({color:e.color})}setColor(e){this.setState({color:e})}render(){return Kd("div",{className:zS},Kd("div",null,this.state.label),Kd("div",{className:US,style:{background:this.state.color}}))}}class VS extends sm{initialize(){this.state={img:""}}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}componentWillReceiveProps(e){this.setState({img:e.img})}setImg(e=""){this.setState({img:e})}getImg(e){var t;if(!e)return null;const n={width:document.querySelector(".base-sheets-line-bold").offsetWidth},r=null==(t=this.getContext().getPluginManager().getPluginByName(eS))?void 0:t.getComponentManager();return Kd(null==r?void 0:r.get(e),__spreadValues({},n))}render(){const{img:e}=this.state,{label:t}=this.props;return Kd("div",{style:{paddingBottom:"3px",width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"}},Kd("span",{className:"base-sheets-line-bold",style:{position:"relative"}},this.getLocale(t),Kd("div",{style:{width:"100%",height:0,position:"absolute",left:0,bottom:"14px"}},e.length?this.getImg(e):"")),Kd(Ep,null))}}class jS extends sm{initialize(){this.state={color:this.props.color}}componentDidMount(){var e,t;null==(t=(e=this.props).getComponent)||t.call(e,this)}componentWillReceiveProps(e){this.setState({color:e.color})}setColor(e){this.setState({color:e})}render(){const{color:e}=this.state,{label:t}=this.props;return Kd("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},Kd("span",{style:{display:"inline-block",borderBottom:`3px solid ${e}`}},this.getLocale(t)),Kd(Ep,null))}}class YS{constructor(e){this._initialize(e)}static create(e){return new YS(e)}_initialize(e){let t;const n=e.container;if("string"==typeof n){const e=document.getElementById(n);null==e?(t=document.createElement("div"),t.id=n):t=e}else Cm(n)?t=n:(t=document.createElement("div"),t.id="univer");vg(Kd(FS,__spreadValues({},e)),t)}}class GS{constructor(e){this._name=e}get name(){return this._name}setName(e){this._name=e}}class XS{constructor(e){this.getComponent=e=>{this._infoBar=e,this._refreshComponent(),this.resetInfoList(this._infoList)},this._plugin=e}resetInfoList(e){const t=this._plugin.getGlobalContext().getLocale();for(let n in e)e[n].locale&&(e[n].label=t.get(e[n].locale));this._infoBar.setInfoList(e)}setSlideName(e){const t=e.target.value;this._infoBarModel.setName(t)}_refreshComponent(){const e="UniverSlide";this._infoBarModel=new GS(e),this._infoList={back:{locale:"info.return"},rename:{locale:"info.tips"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},slide:{label:e,onBlur:e=>{this.setSlideName(e)}}}}}class $S{constructor(e){this._pages=[],this.getComponent=e=>{this._slideBar=e,this.setSlideBar()},this.addSlide=()=>{const e=this._slidePlugin.getContext().getSlide(),t=this._getCanvasView(),n=e.addPage();this._pages.push(n),this._slideBar.setSlide(this._pages,(()=>{var e;const n=null==(e=this._slideBar.slideBarRef.current)?void 0:e.childNodes[0].childNodes;t.createSlidePages(n,this._pages)}))},this.activeSlide=e=>{this._getCanvasView().activePage(e)},this._plugin=e,this._slidePlugin=e.getUniver().getCurrentUniverSlideInstance().context.getPluginManager().getRequirePluginByName(Ut.SLIDE),this._initialize()}setSlideBar(){const e=this._getCanvasView();this._slideBar.setSlide(this._pages,(()=>{var t;const n=null==(t=this._slideBar.slideBarRef.current)?void 0:t.childNodes[0].childNodes;e.createSlidePages(n,this._pages)})),e.getSlide().onSlideChangePageByNavigationObservable.add((t=>{this._slideBar.state.activePageId!==t&&null!=t&&(this._slideBar.setState({activePageId:t}),e.activePage(t))}))}_initialize(){this._generateModel()}_getCanvasView(){return this._slidePlugin.getCanvasView()}_generateModel(){const e=this._slidePlugin.getContext().getSlide(),t=e.getPages(),n=e.getPageOrder();t&&n&&n.forEach((e=>{this._pages.push(t[e])}))}}const QS=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],KS=[{labelLocale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{labelLocale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{labelLocale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{labelLocale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{labelLocale:"fontFamily.MicrosoftAccorblack",style:{"font-family":""},value:""},{labelLocale:"fontFamily.SimSun",style:{"font-family":""},value:""},{labelLocale:"fontFamily.SimHei",style:{"font-family":""},value:""},{labelLocale:"fontFamily.Kaiti",style:{"font-family":""},value:""},{labelLocale:"fontFamily.FangSong",style:{"font-family":""},value:""},{labelLocale:"fontFamily.NSimSun",style:{"font-family":""},value:""},{labelLocale:"fontFamily.STXinwei",style:{"font-family":""},value:""},{labelLocale:"fontFamily.STXingkai",style:{"font-family":""},value:""},{labelLocale:"fontFamily.STLiti",style:{"font-family":""},value:""},{labelLocale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{labelLocale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{labelLocale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}],ZS=[{labelLocale:"borderLine.borderTop",customSuffix:{name:"TopBorderIcon"},value:"top"},{labelLocale:"borderLine.borderBottom",customSuffix:{name:"BottomBorderIcon"},value:"bottom"},{labelLocale:"borderLine.borderLeft",customSuffix:{name:"LeftBorderIcon"},value:"left"},{labelLocale:"borderLine.borderRight",customSuffix:{name:"RightBorderIcon"},value:"right",border:!0},{labelLocale:"borderLine.borderNone",customSuffix:{name:"NoneBorderIcon"},value:"none"},{labelLocale:"borderLine.borderAll",customSuffix:{name:"FullBorderIcon"},value:"all",selected:!0},{labelLocale:"borderLine.borderOutside",customSuffix:{name:"OuterBorderIcon"},value:"outside"},{labelLocale:"borderLine.borderInside",customSuffix:{name:"InnerBorderIcon"},value:"inside"},{labelLocale:"borderLine.borderHorizontal",customSuffix:{name:"StripingBorderIcon"},value:"horizontal"},{labelLocale:"borderLine.borderVertical",customSuffix:{name:"VerticalBorderIcon"},value:"vertical"}],qS=[{labelLocale:"borderLine.borderNone",value:ye.NONE},{customLabel:{name:"BorderThin"},value:ye.THIN},{customLabel:{name:"BorderHair"},value:ye.HAIR},{customLabel:{name:"BorderDotted"},value:ye.DOTTED},{customLabel:{name:"BorderDashed"},value:ye.DASHED},{customLabel:{name:"BorderDashDot"},value:ye.DOTTED},{customLabel:{name:"BorderDashDotDot"},value:ye.DASH_DOT_DOT},{customLabel:{name:"BorderMedium"},value:ye.MEDIUM},{customLabel:{name:"BorderMediumDashed"},value:ye.MEDIUM_DASHED},{customLabel:{name:"BorderMediumDashDot"},value:ye.MEDIUM_DASH_DOT},{customLabel:{name:"BorderMediumDashDotDot"},value:ye.MEDIUM_DASH_DOT_DOT},{customLabel:{name:"BorderThick"},value:ye.THICK}],JS=[{labelLocale:"merge.all",value:"all"},{labelLocale:"merge.vertical",value:"vertical"},{labelLocale:"merge.horizontal",value:"horizontal"},{labelLocale:"merge.cancel",value:"cancel"}],eE=[{labelLocale:"align.left",customSuffix:{name:"LeftAlignIcon"},value:1},{labelLocale:"align.center",selected:!0,customSuffix:{name:"CenterAlignIcon"},value:2},{labelLocale:"align.right",customSuffix:{name:"RightAlignIcon"},value:3}],tE=[{labelLocale:"align.top",customSuffix:{name:"TopVerticalIcon"},value:1},{labelLocale:"align.middle",customSuffix:{name:"CenterVerticalIcon"},value:2},{labelLocale:"align.bottom",customSuffix:{name:"BottomVerticalIcon"},value:3}],nE=[{labelLocale:"textWrap.overflow",customSuffix:{name:"OverflowIcon"},value:1},{labelLocale:"textWrap.wrap",customSuffix:{name:"BrIcon"},value:3},{labelLocale:"textWrap.clip",customSuffix:{name:"CutIcon"},value:2}],rE=[{labelLocale:"textRotate.none",customSuffix:{name:"TextRotateIcon"},value:0},{labelLocale:"textRotate.angleUp",customSuffix:{name:"TextRotateAngleUpIcon"},value:-45},{labelLocale:"textRotate.angleDown",customSuffix:{name:"TextRotateAngleDownIcon"},value:45},{labelLocale:"textRotate.vertical",customSuffix:{name:"TextRotateVerticalIcon"},value:"v"},{labelLocale:"textRotate.rotationUp",customSuffix:{name:"TextRotateRotationUpIcon"},value:-90},{labelLocale:"textRotate.rotationDown",customSuffix:{name:"TextRotateRotationDownIcon"},value:90}];var sE;!function(e){e[e.SELECT=0]="SELECT",e[e.BUTTON=1]="BUTTON"}(sE||(sE={}));class oE{constructor(e,t){this._textColor="#000",this._background="#fff",this._borderInfo={type:Ee.ALL,color:"#000",style:1},this.getComponent=e=>{this._toolbar=e,this.setToolbar()},this._plugin=e,this._slidePlugin=e.getContext().getUniver().getCurrentUniverSlideInstance().context.getPluginManager().getPluginByName(Ut.SLIDE),this._config=C.deepMerge({},fS,t),this._toolList=[{toolbarType:1,tooltip:"toolbar.undo",name:"undo",unActive:!0,customLabel:{name:"ForwardIcon"},show:this._config.undo,onClick:()=>{this.setUndo(),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.redo",unActive:!0,customLabel:{name:"BackIcon"},name:"redo",show:this._config.redo,onClick:()=>{this.setRedo(),this.hideTooltip()}},{type:0,tooltip:"toolbar.font",className:CS,name:"font",show:this._config.font,border:!0,onMainClick:()=>{this.hideTooltip()},onClick:e=>{this.setFontFamily(e)},children:KS},{type:1,tooltip:"toolbar.fontSize",label:String(Dt.fs),name:"fontSize",show:this._config.fontSize,onClick:e=>{this.setFontSize(e)},onMainClick:()=>{this.hideTooltip()},onPressEnter:e=>{this.setFontSize(e),this.hideTooltip()},children:QS},{toolbarType:1,tooltip:"toolbar.bold",customLabel:{name:"BoldIcon"},active:!1,name:"bold",show:this._config.bold,onClick:(e,t)=>{this.setFontWeight(t),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.italic",customLabel:{name:"ItalicIcon"},name:"italic",show:this._config.italic,onClick:(e,t)=>{this.setFontStyle(t),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},name:"strikethrough",show:this._config.strikethrough,onClick:(e,t)=>{this.hideTooltip();const n=this._toolList.find((e=>"strikethrough"===e.name));n&&(n.active=t,this.setStrikeThrough(t))}},{toolbarType:1,tooltip:"toolbar.underline",customLabel:{name:"UnderLineIcon"},name:"underline",show:this._config.underline,onClick:(e,t)=>{this.hideTooltip();const n=this._toolList.find((e=>"underline"===e.name));n&&(n.active=t,this.setUnderline(t))}},{type:5,tooltip:"toolbar.textColor.main",customLabel:{name:eS+WS.name,props:{getComponent:e=>{this._colorSelect1=e},color:"#000",customLabel:{name:"TextColorIcon"}}},onClick:()=>{this.hideTooltip();const e=this._toolList.find((e=>"textColor"===e.name));e&&e.customLabel&&e.customLabel.props&&(e.customLabel.props.color=this._textColor,this.changeColor(this._textColor))},hideSelectedIcon:!0,className:wS,children:[{labelLocale:"toolbar.resetColor"},{customLabel:{name:eS+g_.name,props:{onClick:(e,t)=>{this._colorSelect1.setColor(e),this._textColor=e}}},className:yS}],name:"textColor",show:this._config.textColor},{type:5,tooltip:"toolbar.fillColor.main",customLabel:{name:eS+WS.name,props:{getComponent:e=>{this._colorSelect2=e},color:"#fff",customLabel:{name:"FillColorIcon"}}},onClick:()=>{this.hideTooltip();const e=this._toolList.find((e=>"fillColor"===e.name));e&&e.customLabel&&e.customLabel.props&&(e.customLabel.props.color=this._background,this.setBackground(this._background))},hideSelectedIcon:!0,className:wS,children:[{labelLocale:"toolbar.resetColor"},{customLabel:{name:eS+g_.name,props:{onClick:(e,t)=>{this._colorSelect2.setColor(e),this._background=e}}},className:yS}],name:"fillColor",show:this._config.fillColor},{type:3,display:1,show:this._config.border,tooltip:"toolbar.border.main",className:TS,onClick:e=>{e&&(this._borderInfo.type=e),this.hideTooltip(),this.setBorder()},name:"border",children:[...ZS,{name:"borderColor",customLabel:{name:eS+jS.name,props:{color:"#000",label:"borderLine.borderColor",getComponent:e=>this._lineColor=e}},unSelectable:!0,className:wS,children:[{customLabel:{name:eS+g_.name,props:{onClick:(e,t)=>{var n;this._lineColor.setColor(e),this._borderInfo.color=e;const r=this._toolList.find((e=>"border"===e.name)),s=null==(n=null==r?void 0:r.children)?void 0:n.find((e=>"borderColor"===e.name));s&&s.customLabel&&s.customLabel.props&&(s.customLabel.props.color=e)}}},className:yS,onClick:(...e)=>{e[0].stopPropagation()}}]},{customLabel:{name:eS+VS.name,props:{img:0,label:"borderLine.borderSize",getComponent:e=>this._lineBold=e}},onClick:(...e)=>{var t;e[0].stopPropagation(),this._lineBold.setImg(null==(t=qS[e[2]].customLabel)?void 0:t.name),this._borderInfo.style=e[1]},className:SS,unSelectable:!0,children:qS}]},{type:5,tooltip:"toolbar.mergeCell.main",customLabel:{name:"MergeIcon"},show:this._config.mergeCell,onClick:e=>{this.setMerge(null!=e?e:"all"),this.hideTooltip()},name:"mergeCell",children:JS},{type:3,tooltip:"toolbar.horizontalAlignMode.main",className:TS,display:1,name:"horizontalAlignMode",show:this._config.horizontalAlignMode,onClick:e=>{this.setHorizontalAlignment(e),this.hideTooltip()},children:eE},{type:3,tooltip:"toolbar.verticalAlignMode.main",className:TS,display:1,name:"verticalAlignMode",show:this._config.verticalAlignMode,onClick:e=>{this.setVerticalAlignment(e),this.hideTooltip()},children:tE},{type:3,className:TS,tooltip:"toolbar.textWrapMode.main",display:1,name:"textWrapMode",show:this._config.textWrapMode,onClick:e=>{this.setWrapStrategy(e),this.hideTooltip()},children:nE},{type:3,className:TS,name:"textRotateMode",tooltip:"toolbar.textRotateMode.main",display:1,show:this._config.textRotateMode,onClick:e=>{this.setTextRotation(e),this.hideTooltip()},children:rE}],this._initialize()}addToolbarConfig(e){this._toolList.findIndex((t=>t.name===e.name))>-1||this._toolList.push(e)}deleteToolbarConfig(e){const t=this._toolList.findIndex((t=>t.name===e));t>-1&&this._toolList.splice(t,1)}setToolbar(){var e;null==(e=this._toolbar)||e.setToolbar(this._toolList)}setUIObserve(e){this._plugin.getContext().getObserverManager().requiredObserver("onUIChangeObservable","core").notifyObservers(e)}changeColor(e){var t,n;const r=this._toolList.find((e=>"strikethrough"===e.name)),s=this._toolList.find((e=>"underline"===e.name));this.setFontColor(e),s&&this.setUnderline(null!=(t=s.active)&&t),r&&this.setStrikeThrough(null!=(n=r.active)&&n)}setUndo(){this.setUIObserve({name:"undo"})}setRedo(){this.setUIObserve({name:"redo"})}setFontFamily(e){const t={name:"fontFamily",value:e};this.setUIObserve(t)}setFontSize(e){const t={name:"fontSize",value:e};this.setUIObserve(t)}setFontWeight(e){const t={name:"fontWeight",value:e};this.setUIObserve(t)}setFontStyle(e){const t={name:"fontStyle",value:e};this.setUIObserve(t)}setStrikeThrough(e){const t={name:"strikeThrough",value:e};this.setUIObserve(t)}setUnderline(e){const t={name:"underLine",value:e};this.setUIObserve(t)}setFontColor(e){const t={name:"fontColor",value:e};this.setUIObserve(t)}setBackground(e){const t={name:"background",value:e};this.setUIObserve(t)}setMerge(e){const t={name:"merge",value:e};this.setUIObserve(t)}setTextRotation(e){const t={name:"textRotation",value:e};this.setUIObserve(t)}setWrapStrategy(e){const t={name:"wrapStrategy",value:e};this.setUIObserve(t)}setVerticalAlignment(e){const t={name:"verticalAlignment",value:e};this.setUIObserve(t)}setHorizontalAlignment(e){const t={name:"horizontalAlignment",value:e};this.setUIObserve(t)}setBorder(){const e={name:"borderInfo",value:this._borderInfo};this.setUIObserve(e)}hideTooltip(){this._toolbar.base.querySelectorAll(`.${AS}.${xS}`).forEach((e=>{e.style.display="none"}))}_initialize(){this._plugin.getComponentManager().register(eS+WS.name,WS),this._plugin.getComponentManager().register(eS+g_.name,g_),this._plugin.getComponentManager().register(eS+jS.name,jS),this._plugin.getComponentManager().register(eS+VS.name,VS),zr.getCommandObservers().add((({actions:e})=>{}))}}class iE{constructor(e){var t;this.getComponent=e=>{var t;this._slideContainer=e,null==(t=this._plugin.getObserver("onUIDidMount"))||t.notifyObservers(this._slideContainer),this.setSlideContainer()},this.changeLocale=e=>{this._plugin.getContext().getLocale().change(e),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onAfterChangeUILocaleObservable","core").notifyObservers()},this._plugin=e,this._config=this._plugin.getConfig(),this._initialize(),this._toolbarController=new oE(this._plugin,null==(t=this._config.layout)?void 0:t.toolbarConfig),this._infoBarController=new XS(this._plugin),this._slideBarController=new $S(this._plugin)}getUIConfig(){return{context:this._plugin.getContext(),config:this._config,changeLocale:this.changeLocale,getComponent:this.getComponent,methods:{toolbar:{getComponent:this._toolbarController.getComponent},infoBar:{getComponent:this._infoBarController.getComponent},slideBar:{getComponent:this._slideBarController.getComponent,addSlide:this._slideBarController.addSlide,activeSlide:this._slideBarController.activeSlide}}}}getContentRef(){return this._slideContainer.getContentRef()}setEventManager(){this._plugin.getUniver().getAllUniverSlidesInstance().forEach((e=>{e.context.getPluginManager().getRequirePluginByName(Ut.SLIDE).listenEventManager()}))}getEventManager(){return this._eventManager}getToolbarController(){return this._toolbarController}UIDidMount(e){var t;if(this._slideContainer)return e(this._slideContainer);null==(t=this._plugin.getObserver("onUIDidMount"))||t.add((()=>e(this._slideContainer)))}_initialize(){this._dragManager=new Yg(this._plugin),this._eventManager=new Gg(this._plugin),this.setEventManager()}setSlideContainer(){this._dragManager.handleDragAction(Mm(this._slideContainer))}}class lE{constructor(e){this.changeLocale=e=>{this._plugin.getGlobalContext().getLocale().change(e),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onAfterChangeUILocaleObservable","core").notifyObservers()},this._plugin=e,this._slideContainerController=new iE(this._plugin);const t=this._slideContainerController.getUIConfig();YS.create({context:this._plugin.getGlobalContext(),locale:this._plugin.getGlobalContext().getLocale().getCurrentLocale(),changeLocale:this.changeLocale,UIConfig:t,container:this._plugin.getConfig().container})}getSlideContainerController(){return this._slideContainerController}}class aE extends Fo{constructor(e){super(eS),this._config=C.deepMerge({},pS,e)}static create(e){return new aE(e)}installTo(e){e.installPlugin(this)}initialize(e){bS(this),this.getLocale().load({en:Jy,zh:qy}),this._componentManager=new nb,this._registerManager=new rb(this),this._appUIController=new lE(this),this.UIDidMount((()=>{this.initRender()}))}getConfig(){return this._config}initRender(){var e;const t=null==(e=this.getPluginByName(Ut.BASE_RENDER))?void 0:e.getEngine();let n=Mm(this._appUIController.getSlideContainerController().getContentRef());t.setContainer(n),this.getUniver().getCurrentUniverSlideInstance().context.getPluginManager().getRequirePluginByName(Ut.SLIDE).getCanvasView().scrollToCenter(),window.addEventListener("resize",(()=>{t.resize()})),setTimeout((()=>{t.resize()}),0)}initUI(){}onMounted(e){this.initialize(e)}onDestroy(){}getAppUIController(){return this._appUIController}getComponentManager(){return this._componentManager}getRegisterManager(){return this._registerManager}UIDidMount(e){this._appUIController.getSlideContainerController().UIDidMount(e)}addToolButton(e){this._appUIController.getSlideContainerController().getToolbarController().addToolbarConfig(e)}deleteToolButton(e){this._appUIController.getSlideContainerController().getToolbarController().deleteToolbarConfig(e)}}var cE,hE=Object.freeze(Object.defineProperty({__proto__:null,SlideUIPlugin:aE,SLIDE_UI_PLUGIN_NAME:eS,DefaultToolbarConfig:fS,DefaultSlideContainerConfig:mS,DefaultSlideUIConfig:pS,uninstallObserver:function(e){e.deleteObserve("onUIDidMount")},installObserver:bS},Symbol.toStringTag,{value:"Module"})),uE={spreadsheetLabel:"",spreadsheetRightLabel:" Sheets",spreadsheet:{one:"",two:"",three:""},toolbar:{undo:"",redo:"",paintFormat:"",currencyFormat:"",percentageFormat:"",numberDecrease:"",numberIncrease:"",moreFormats:"",font:"",fontSize:"",bold:" (Ctrl+B)",italic:" (Ctrl+I)",strikethrough:" (Alt+Shift+5)",underline:"",textColor:{main:"",right:""},resetColor:"",customColor:"",alternatingColors:"",confirmColor:"",cancelColor:"",collapse:"",fillColor:{main:"",right:""},border:{main:"",right:""},mergeCell:{main:"",right:""},horizontalAlignMode:{main:"",right:""},verticalAlignMode:{main:"",right:""},textWrapMode:{main:"",right:""},textRotateMode:{main:"",right:""},freezeTopRow:"",sortAndFilter:"",findAndReplace:"",sum:"",autoSum:"",moreFunction:"",conditionalalFormat:"",comment:"",pivotTable:"",chart:"",screenshot:"",splitColumn:"",insertImage:"",insertLink:"",dataValidation:"",protection:"",clearText:"",noColorSelectedText:"",toolMore:"",toolLess:"",toolClose:"",toolMoreTip:"",moreOptions:"",cellFormat:"",print:"",borderMethod:{top:"",bottom:"",left:"",right:""},more:""},defaultFmt:{Automatic:{text:"",value:"General",example:""},Number:{text:"",value:"##0.00",example:"1000.12"},Percent:{text:"",value:"#0.00%",example:"12.21%"},PlainText:{text:"",value:"@",example:""},Scientific:{text:"",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"",value:"(0.00)",example:"(1200.09)"},Thousand:{text:"",value:"w",example:"120002500"},Currency:{text:"",value:"0.00",example:"1200.09"},Digit:{text:"2",value:"w0.00",example:"22500.55"},Date:{text:"",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"24H",value:"hh:mm",example:"15:00"},DateTime:{text:"",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"",moreDateTime:"",moreNumber:"",titleCurrency:"",decimalPlaces:"",titleDateTime:"",titleNumber:""},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"",SimSun:"",SimHei:"",Kaiti:"",FangSong:"",NSimSun:"",STXinwei:"",STXingkai:"",STLiti:"",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"",layoutBtn:"",pageBtn:"",menuItemPrint:"(Ctrl+P)",menuItemAreas:"",menuItemRows:"",menuItemColumns:""},align:{left:"",center:"",right:"",top:"",middle:"",bottom:""},button:{confirm:"",cancel:"",close:"",update:"Update",delete:"Delete",insert:"",prevPage:"",nextPage:"",total:""},punctuation:{tab:"Tab ",semicolon:"",comma:"",space:""},colorPicker:{collapse:"",customColor:"",change:"",confirmColor:"",cancelColor:""},borderLine:{borderTop:"",borderBottom:"",borderLeft:"",borderRight:"",borderNone:"",borderAll:"",borderOutside:"",borderInside:"",borderHorizontal:"",borderVertical:"",borderColor:"",borderSize:""},merge:{all:"",vertical:"",horizontal:"",cancel:"",overlappingError:"",partiallyError:""},textWrap:{overflow:"",wrap:"",clip:""},textRotate:{none:"",angleUp:"",angleDown:"",vertical:"",rotationUp:"90",rotationDown:"90"},sheetConfig:{delete:"",copy:"",rename:"",changeColor:"",hide:"",unhide:"",moveLeft:"",moveRight:"",resetColor:"",cancelText:"",chooseText:"",tipNameRepeat:"",noMoreSheet:"",confirmDelete:"",redoDelete:"Ctrl+Z",noHide:", sheet",chartEditNoOpt:"",sheetNameSpecCharError:"31' :\r\n[ ] : \\ ? * /",sheetNameCannotIsEmptyError:"!"},rightClick:{copy:"",copyAs:"",paste:"",insert:"",delete:"",deleteCell:"",deleteSelected:"",hide:"",hideSelected:"",showHide:"",to:"",left:"",right:"",top:"",bottom:"",moveLeft:"",moveUp:"",add:"",row:"",column:"",width:"",height:"",number:"",confirm:"",orderAZ:"A-Z",orderZA:"Z-A",clearContent:"",matrix:"",sortSelection:"",filterSelection:"",chartGeneration:"",firstLineTitle:"",untitled:"",array1:"",array2:"",array3:"",diagonal:"",antiDiagonal:"",diagonalOffset:"",offset:"",boolean:"",flip:"",upAndDown:"",leftAndRight:"",clockwise:"",counterclockwise:"",transpose:"",matrixCalculation:"",plus:"",minus:"",multiply:"",divided:"",power:"",root:"",log:"log",delete0:"0",removeDuplicate:"",byRow:"",byCol:"",generateNewMatrix:""},info:{detailUpdate:"",detailSave:"",row:"",column:"",loading:"",copy:"",return:"",rename:"",tips:"",noName:"",wait:"",add:"",addLast:"",backTop:"",pageInfo:"${total}${totalPage}${currentPage}",nextPage:"",tipInputNumber:"",tipInputNumberLimit:"1-100",tipRowHeightLimit:"0 ~ 545",tipColumnWidthLimit:"0 ~ 2038",pageInfoFull:"${total}${totalPage}"}},dE={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"(0.00)",example:"(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"120002500"},Currency:{text:"Currency",value:"0.00",example:"1200.09"},Digit:{text:"2",value:"w0.00",example:"22500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Pagebreakpreview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:"The name cannot contain:[ ] :  ? * / ' \"",sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}${totalPage} pagecurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}${totalPage} pageAll data displayed"}};class gE{constructor(e){this._plugin=e}}class fE{constructor(e){var t;this._plugin=e,this._previousIMEContent="",null==(t=this._plugin.getObserver("onDocContainerDidMountObservable"))||t.add((()=>{this._initialize()}))}_initialize(){const e=this._plugin.getInputEvent();if(!e)return;const{onInputObservable:t,onCompositionstartObservable:n,onCompositionupdateObservable:r,onCompositionendObservable:s,onKeydownObservable:o}=e,i=this._plugin.context.getDocument();o.add((e=>{const{event:t,document:n,activeSelection:r,selectionList:s}=e;let o=t;const l=null==r?void 0:r.getRange(),a=null==r?void 0:r.segmentId,c=n.getSkeleton();if(!c||!l)return;const{cursorStart:h,cursorEnd:u,isCollapse:d,isEndBack:g,isStartBack:f}=l;if(o.key===Xe.backspace&&d){let e=h;!1===f&&(e+=1);const t=n.remainActiveSelection();i.deleteText(l,a),c.calculate();const r=n.findNodeByCharIndex(e-2);this._adjustSelection(n,t,r),this._resetIME()}})),t.add((e=>{const{event:t,content:n="",document:r,activeSelection:s,selectionList:o}=e,l=null==s?void 0:s.getRange(),a=r.getSkeleton(),c=null==s?void 0:s.segmentId;if(!a||!l)return;const{cursorStart:h,cursorEnd:u,isCollapse:d,isEndBack:g,isStartBack:f}=l;if(d){let e=h;!1===f&&(e+=1);const t=r.remainActiveSelection();i.insertText(n,l,c),a.calculate();const s=r.findNodeByCharIndex(e+n.length-1);this._adjustSelection(r,t,s)}})),n.add((e=>{const{activeSelection:t,selectionList:n}=e,r=null==t?void 0:t.getRange();if(!r)return;const{cursorStart:s,cursorEnd:o,isCollapse:i,isEndBack:l,isStartBack:a}=r;if(i){let e=s;!1===a&&(e+=1),this._previousIMEStart=e}})),r.add((e=>{const{event:t,content:n="",document:r}=e,s=this._previousIMEStart,o=r.getSkeleton();if(!o)return;const l=t;if(n===this._previousIMEContent)return;const a=r.remainActiveSelection();i.updateText(n,this._previousIMEContent,s),o.calculate();const c=r.findNodeByCharIndex(s+n.length-1);console.log("Compositionupdate",n,this._previousIMEContent,l.data,s,c,o.getSkeletonData(),o),this._adjustSelection(r,a,c),this._previousIMEContent=n})),s.add((e=>{this._resetIME()}))}_resetIME(){this._previousIMEContent="",this._previousIMEStart=-1}_getIncreaseText(e,t){const n=t.length;return e.slice(n)}_adjustSelection(e,t,n){if(null==n)return;const r=e.findPositionBySpan(n);if(null==r||null==t)return;this._hasListSpan(n)&&(r.span+=1);const s=__spreadProps(__spreadValues({},r),{isBack:!1});e.addSelection(t),t.startNodePosition=s,t.endNodePosition=void 0,t.refresh(e),e.syncSelection()}_hasListSpan(e){var t;const n=null==e?void 0:e.parent;if(null==n)return!1;return(null==(t=n.spanGroup[0])?void 0:t.spanType)===hl.LIST}}class mE{constructor(e,t={}){this._plugin=e,this._config=t,this._initialize()}_initialize(){this._inputController=new fE(this._plugin)}}class pE{constructor(e){this._plugin=e}}class bE{constructor(){this.zIndex=0,this.viewKey=""}getScene(){return this._scene}getPlugin(){return this._plugin}getContext(){return this._plugin.getContext()}updateToSheet(){}initialize(e,t){return this._scene=e,this._plugin=t,this._initialize(),this}_initialize(){}}!function(e){e.MAIN_SCENE="mainScene",e.DOCS_VIEW="docsView"}(cE||(cE={}));const _E=Qo.create();var vE;(vE||(vE={})).MAIN="__DocsRender__";_E.add(new class extends bE{constructor(){super(...arguments),this.zIndex=1,this.viewKey=cE.DOCS_VIEW}getDocumentSkeleton(){return this._documentSkeleton}getDocs(){return this._documents}_initialize(){const e=this.getScene(),t=this.getContext().getDocument(),n=this._buildSkeleton(t.getSnapshot()),r=new Lh(vE.MAIN,n);r.zIndex=1e3,this._documentSkeleton=n,this._documents=r,n.calculate(),e.addObjects([r],0),r.calculatePagePosition(),r.enableEditor()}_buildSkeleton(e){const t=this.getContext();return mh.create(e,t)}});_E.add(new class extends bE{constructor(){super(...arguments),this.zIndex=2,this.viewKey="page_view_background"}_initialize(){var e;const t=this.getScene();this.getContext();const n=t.getObject(vE.MAIN),r=null==(e=n.getSkeleton())?void 0:e.getPageSize();n.onPageRenderObservable.add((e=>{const{page:t,pageLeft:n,pageTop:s,ctx:o}=e,{width:i,height:l,marginBottom:a,marginLeft:c,marginRight:h,marginTop:u}=t;o.save(),o.translate(n-.5,s-.5),Ha.drawWith(o,{width:(null==r?void 0:r.width)||i,height:(null==r?void 0:r.height)||l,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:"rgba(255,255,255, 1)",zIndex:3}),o.restore()}))}});_E.add(new class extends bE{constructor(){super(...arguments),this.zIndex=3,this.viewKey="drawings_view_background",this._liquid=new Rh}_initialize(){var e;const t=this.getScene();this.getContext();const n=t.getObject(vE.MAIN),r=n.getSkeleton(),s=null==r?void 0:r.getSkeletonData();if(!s)return;const{left:o,top:i}=n,{pages:l}=s,a=[],c=new Map;for(let h=0,u=l.length;h<u;h++){const e=l[h],{skeDrawings:t,marginLeft:r,marginTop:s,pageWidth:u,pageHeight:d}=e;this._liquid.translatePagePadding(e),t.forEach((e=>{var t;const{aLeft:n,aTop:r,height:s,width:l,drawingOrigin:h}=e,{objectProperties:u}=h,d=new Va(e.objectId,{url:(null==(t=u.imageProperties)?void 0:t.contentUrl)||"",left:n+o+this._liquid.x,top:r+i+this._liquid.y,width:l,height:s,zIndex:11,isTransformer:!0});c.set(e.objectId,{marginLeft:this._liquid.x,marginTop:this._liquid.y}),a.push(d)})),this._liquid.translatePage(e,n.pageLayoutType,n.pageMarginLeft,n.pageMarginTop)}t.openTransformer(),t.addObjects(a),null==(e=t.getTransformer())||e.onChangingObservable.add((e=>{const{objects:t}=e;t.forEach((e=>{const{oKey:t,left:n,top:s,height:l,width:a}=e,h=c.get(t),u=(null==h?void 0:h.marginLeft)||0,d=(null==h?void 0:h.marginTop)||0;null==r||r.updateDrawing(t,{left:n-o-u,top:s-i-d,height:l,width:a})})),null==r||r.calculate()})),t.closeTransformer()}});class CE{constructor(e,t){this._engine=e,this._plugin=t,this._views=[],this._initialize()}getView(e){for(let t of this._views)if(t.viewKey===e)return t}getDocsView(){return this.getView(cE.DOCS_VIEW)}_initialize(){const e=this._engine;this._plugin.getContext();const t=new Qh(cE.MAIN_SCENE,e,{width:1200,height:2e3});this._scene=t;const n=new Zh(cE.DOCS_VIEW,t,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});t.addViewport(n).attachControl(),t.on(Pi.wheel,((e,r)=>{const s=e;if(s.ctrlKey){const e=Math.abs(s.deltaX);let n=e<40?.2:e<80?.4:.2;n*=s.deltaY>0?-1:1,t.scaleX<1&&(n/=2),t.scaleX+n>4?t.scale(4,4):t.scaleX+n<.1?t.scale(.1,.1):(s.deltaY,s.preventDefault())}else n.onMouseWheel(s,r)})),new Wa(n),t.addLayer(Oa.create(t,[],0),Oa.create(t,[],2)),this._viewLoader(t,this._plugin),e.runRenderLoop((()=>{t.render();const n=document.getElementById("app");n&&(n.innerText=`fps:${Math.round(e.getFps()).toString()}`)}))}_viewLoader(e,t){_E.getData().sort(Ar).forEach((n=>{this._views.push(n.initialize(e,t))}))}}const TE={};class wE extends Fo{constructor(e={}){super(Ut.DOCUMENT),this._config=Object.assign(TE,e)}static create(e){return new wE(e)}installTo(e){e.installPlugin(this)}initialize(e){var t;this.context=e,this.getGlobalContext().getLocale().load({en:dE,zh:uE}),(t=this).pushToObserve("onAfterChangeFontFamilyObservable"),t.pushToObserve("onAfterChangeFontSizeObservable"),t.pushToObserve("onAfterChangeFontWeightObservable"),t.pushToObserve("onAfterChangeFontItalicObservable"),t.pushToObserve("onAfterChangeFontStrikethroughObservable"),t.pushToObserve("onAfterChangeFontUnderlineObservable"),t.pushToObserve("onAfterChangeFontBackgroundObservable"),t.pushToObserve("onAfterChangeFontColorObservable"),t.pushToObserve("onDragAndDropStartObserver"),t.pushToObserve("onDragAndDroppingObserver"),t.pushToObserve("onDragAndDropEndEndObserver"),t.pushToObserve("onFillStartObserver"),t.pushToObserve("onFillingObserver"),t.pushToObserve("onFillEndObserver"),t.pushToObserve("onChangeCurrentSheetObserver"),t.pushToObserve("onToolbarDidMountObservable"),t.pushToObserve("onSheetBarDidMountObservable"),t.pushToObserve("onCountBarDidMountObservable"),t.pushToObserve("onInfoBarDidMountObservable"),t.pushToObserve("onRightMenuDidMountObservable"),t.pushToObserve("onDocContainerDidMountObservable"),t.pushToObserve("onSpreadsheetKeyDownObservable"),t.pushToObserve("onSpreadsheetKeyUpObservable"),t.pushToObserve("onSpreadsheetKeyCopyObservable"),t.pushToObserve("onSpreadsheetKeyPasteObservable"),t.pushToObserve("onSpreadsheetKeyCutObservable"),t.pushToObserve("onSpreadsheetKeyCompositionStartObservable"),t.pushToObserve("onSpreadsheetKeyCompositionUpdateObservable"),t.pushToObserve("onSpreadsheetKeyCompositionEndObservable"),this.initController(),this.initCanvasView()}initController(){this._toolbarControl=new gE(this),this._infoBarControl=new pE(this),this._documentController=new mE(this,this._config)}initCanvasView(){var e;const t=null==(e=this.getContext().getUniver().getGlobalContext().getPluginManager().getPluginByName(Ut.BASE_RENDER))?void 0:e.getEngine();this._canvasEngine=t,null==this._canvasView&&(this._canvasView=new CE(t,this))}getConfig(){return this._config}getCanvasEngine(){return this._canvasEngine}getCanvasView(){return this._canvasView}getMainScene(){return this._canvasEngine.getScene(cE.MAIN_SCENE)}getDocsView(){return this.getCanvasView().getDocsView()}getMainComponent(){return this.getDocsView().getDocs()}getInputEvent(){return this.getMainComponent().getEditorInputEvent()}getToolbarControl(){return this._toolbarControl}getInfoBarControl(){return this._infoBarControl}onMounted(e){this.initialize(e)}onDestroy(){}calculatePagePosition(){const e=this.getCanvasView().getDocsView(),{docsLeft:t,docsTop:n}=e.getDocs().calculatePagePosition(),r=e.getDocumentSkeleton().getSkeletonData().pages,s=e.getDocs().pageMarginLeft,o=e.getDocs().pageMarginTop;for(let i=0;i<r.length;i++)for(let l of r[i].skeDrawings.keys()){const r=e.getScene().getObject(l);null==r||r.translate(r.left+t-s,r.top+n-o)}}}var yE=Object.freeze(Object.defineProperty({__proto__:null,DocPlugin:wE},Symbol.toStringTag,{value:"Module"})),SE={spreadsheetLabel:"",spreadsheetRightLabel:" Sheets",spreadsheet:{one:"",two:"",three:""},toolbar:{undo:"",redo:"",paintFormat:"",currencyFormat:"",percentageFormat:"",numberDecrease:"",numberIncrease:"",moreFormats:"",font:"",fontSize:"",bold:" (Ctrl+B)",italic:" (Ctrl+I)",strikethrough:" (Alt+Shift+5)",underline:"",textColor:{main:"",right:""},resetColor:"",customColor:"",alternatingColors:"",confirmColor:"",cancelColor:"",collapse:"",fillColor:{main:"",right:""},border:{main:"",right:""},mergeCell:{main:"",right:""},horizontalAlignMode:{main:"",right:""},verticalAlignMode:{main:"",right:""},textWrapMode:{main:"",right:""},textRotateMode:{main:"",right:""},freezeTopRow:"",sortAndFilter:"",findAndReplace:"",sum:"",autoSum:"",moreFunction:"",conditionalalFormat:"",comment:"",pivotTable:"",chart:"",screenshot:"",splitColumn:"",insertImage:"",insertLink:"",dataValidation:"",protection:"",clearText:"",noColorSelectedText:"",toolMore:"",toolLess:"",toolClose:"",toolMoreTip:"",moreOptions:"",cellFormat:"",print:"",borderMethod:{top:"",bottom:"",left:"",right:""},more:""},defaultFmt:{Automatic:{text:"",value:"General",example:""},Number:{text:"",value:"##0.00",example:"1000.12"},Percent:{text:"",value:"#0.00%",example:"12.21%"},PlainText:{text:"",value:"@",example:""},Scientific:{text:"",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"",value:"(0.00)",example:"(1200.09)"},Thousand:{text:"",value:"w",example:"120002500"},Currency:{text:"",value:"0.00",example:"1200.09"},Digit:{text:"2",value:"w0.00",example:"22500.55"},Date:{text:"",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"24H",value:"hh:mm",example:"15:00"},DateTime:{text:"",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"",moreDateTime:"",moreNumber:"",titleCurrency:"",decimalPlaces:"",titleDateTime:"",titleNumber:""},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"",SimSun:"",SimHei:"",Kaiti:"",FangSong:"",NSimSun:"",STXinwei:"",STXingkai:"",STLiti:"",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"",layoutBtn:"",pageBtn:"",menuItemPrint:"(Ctrl+P)",menuItemAreas:"",menuItemRows:"",menuItemColumns:""},align:{left:"",center:"",right:"",top:"",middle:"",bottom:""},button:{confirm:"",cancel:"",close:"",update:"Update",delete:"Delete",insert:"",prevPage:"",nextPage:"",total:""},punctuation:{tab:"Tab ",semicolon:"",comma:"",space:""},colorPicker:{collapse:"",customColor:"",change:"",confirmColor:"",cancelColor:""},borderLine:{borderTop:"",borderBottom:"",borderLeft:"",borderRight:"",borderNone:"",borderAll:"",borderOutside:"",borderInside:"",borderHorizontal:"",borderVertical:"",borderColor:"",borderSize:""},merge:{all:"",vertical:"",horizontal:"",cancel:"",overlappingError:"",partiallyError:""},textWrap:{overflow:"",wrap:"",clip:""},textRotate:{none:"",angleUp:"",angleDown:"",vertical:"",rotationUp:"90",rotationDown:"90"},sheetConfig:{delete:"",copy:"",rename:"",changeColor:"",hide:"",unhide:"",moveLeft:"",moveRight:"",resetColor:"",cancelText:"",chooseText:"",tipNameRepeat:"",noMoreSheet:"",confirmDelete:"",redoDelete:"Ctrl+Z",noHide:", sheet",chartEditNoOpt:"",sheetNameSpecCharError:"31' :\r\n[ ] : \\ ? * /",sheetNameCannotIsEmptyError:"!"},rightClick:{copy:"",copyAs:"",paste:"",insert:"",delete:"",deleteCell:"",deleteSelected:"",hide:"",hideSelected:"",showHide:"",to:"",left:"",right:"",top:"",bottom:"",moveLeft:"",moveUp:"",add:"",row:"",column:"",width:"",height:"",number:"",confirm:"",orderAZ:"A-Z",orderZA:"Z-A",clearContent:"",matrix:"",sortSelection:"",filterSelection:"",chartGeneration:"",firstLineTitle:"",untitled:"",array1:"",array2:"",array3:"",diagonal:"",antiDiagonal:"",diagonalOffset:"",offset:"",boolean:"",flip:"",upAndDown:"",leftAndRight:"",clockwise:"",counterclockwise:"",transpose:"",matrixCalculation:"",plus:"",minus:"",multiply:"",divided:"",power:"",root:"",log:"log",delete0:"0",removeDuplicate:"",byRow:"",byCol:"",generateNewMatrix:""},info:{detailUpdate:"",detailSave:"",row:"",column:"",loading:"",copy:"",return:"",rename:"",tips:"",noName:"",wait:"",add:"",addLast:"",backTop:"",pageInfo:"${total}${totalPage}${currentPage}",nextPage:"",tipInputNumber:"",tipInputNumberLimit:"1-100",tipRowHeightLimit:"0 ~ 545",tipColumnWidthLimit:"0 ~ 2038",pageInfoFull:"${total}${totalPage}"}},EE={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"(0.00)",example:"(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"120002500"},Currency:{text:"Currency",value:"0.00",example:"1200.09"},Digit:{text:"2",value:"w0.00",example:"22500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Pagebreakpreview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:"The name cannot contain:[ ] :  ? * / ' \"",sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}${totalPage} pagecurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}${totalPage} pageAll data displayed"}};class RE{constructor(){this.zIndex=0}check(e){if(e===this.viewKey)return this}convert(e,t,n){}}const IE=Qo.create();IE.add(new class extends RE{constructor(){super(...arguments),this.zIndex=1,this.viewKey=Xt.IMAGE}check(e){if(e===this.viewKey)return this}convert(e){const{id:t,zIndex:n,left:r=0,top:s=0,width:o,height:i,angle:l,scaleX:a,scaleY:c,skewX:h,skewY:u,flipX:d,flipY:g,title:f,description:m,image:p={}}=e,{imageProperties:b,placeholder:_,link:v}=p,C=(null==b?void 0:b.contentUrl)||"";return new Va(t,{url:C,top:s,left:r,width:o,height:i,zIndex:n,angle:l,scaleX:a,scaleY:c,skewX:h,skewY:u,flipX:d,flipY:g,isTransformer:!0,forceRender:!0})}});IE.add(new class extends RE{constructor(){super(...arguments),this.zIndex=2,this.viewKey=Xt.TEXT}check(e){if(e===this.viewKey)return this}convert(e,t,n){if(null==n)return;const{id:r,zIndex:s,left:o=0,top:i=0,width:l,height:a,angle:c,scaleX:h,scaleY:u,skewX:d,skewY:g,flipX:f,flipY:m,title:p,description:b,richText:_={}}=e,{text:v,ff:C,fs:T,it:w,bl:y,ul:S,st:E,ol:R,bg:I,bd:A,cl:x,rich:O}=_;let M={top:i,left:o,width:l,height:a,zIndex:s,angle:c,scaleX:h,scaleY:u,skewX:d,skewY:g,flipX:f,flipY:m,isTransformer:!0,forceRender:!0},N=!1;return null!=v?(M=__spreadProps(__spreadValues({},M),{text:v,ff:C,fs:T,it:w,bl:y,ul:S,st:E,ol:R,bg:I,bd:A,cl:x}),N=!0):null!=O&&(M=__spreadProps(__spreadValues({},M),{richText:O}),N=!0),!1!==N?new Ph(n,r,M):void 0}});var AE,xE,OE,ME,NE,kE;IE.add(new class extends RE{constructor(){super(...arguments),this.zIndex=2,this.viewKey=Xt.SHAPE}check(e){if(e===this.viewKey)return this}convert(e){const{id:t,zIndex:n,left:r=0,top:s=0,width:o,height:i,angle:l,scaleX:a,scaleY:c,skewX:h,skewY:u,flipX:d,flipY:g,title:f,description:m}=e,{shapeType:p,text:b,shapeProperties:_,placeholder:v,link:C}=e.shape||{},T=null==_?"":kn(_.shapeBackgroundFill)||"rgba(255,255,255,1)",w=null==_?void 0:_.outline,y={};if(w){const{outlineFill:e,weight:t}=w;y.strokeWidth=t,y.stroke=kn(e)||"rgba(0,0,0,1)"}if(p===It.RECTANGLE)return new Ha(t,__spreadValues({fill:T,top:s,left:r,width:o,height:i,zIndex:n,angle:l,scaleX:a,scaleY:c,skewX:h,skewY:u,flipX:d,flipY:g,isTransformer:!0,forceRender:!0},y));if(p===It.ROUND_RECTANGLE){const e=(null==_?void 0:_.radius)||0;return new Ha(t,__spreadValues({fill:T,top:s,left:r,width:o,height:i,zIndex:n,angle:l,scaleX:a,scaleY:c,skewX:h,skewY:u,flipX:d,flipY:g,isTransformer:!0,forceRender:!0,radius:e},y))}It.ELLIPSE}}),function(e){e.MAIN="spreadInSlide",e.SCENE="spreadInSlideScene",e.SCENE_VIEWER="spreadInSlideSceneViewer",e.ROW="spreadInSlideRow",e.COLUMN="spreadInSlideColumn",e.LEFT_TOP="spreadInSlideLeftTop",e.VIEW_MAIN="spreadInSlideViewMain",e.VIEW_TOP="spreadInSlideViewTop",e.VIEW_LEFT="spreadInSlideViewLeft",e.VIEW_LEFT_TOP="spreadInSlideViewLeftTop"}(AE||(AE={}));IE.add(new class extends RE{constructor(){super(...arguments),this.zIndex=4,this.viewKey=Xt.SPREADSHEET}check(e){if(e===this.viewKey)return this}convert(e,t,n){const{id:r,zIndex:s,left:o=0,top:i=0,width:l,height:a,angle:c,scaleX:h,scaleY:u,skewX:d,skewY:g,flipX:f,flipY:m,title:b,description:_,spreadsheet:v}=e;if(null==v||null==n)return;const{worksheet:C,styles:T}=v,{columnData:w,rowData:y,cellData:S}=C,E=new p(S),R=yu.create(C,E,new In(T),n),{rowTotalHeight:I,columnTotalWidth:A,rowTitleWidth:x,columnTitleHeight:O}=R,M=A+C.rowTitle.width||0,N=I+C.columnTitle.height||0,k=new Kh(AE.SCENE_VIEWER+r,{top:i,left:o,width:l,height:a,zIndex:s,angle:c,scaleX:h,scaleY:u,skewX:d,skewY:g,flipX:f,flipY:m,isTransformer:!0,forceRender:!0}),L=new Qh(AE.SCENE+r,k,{width:M,height:N});this._updateViewport(r,x,O,L,t);const D=new Cu("testSheetViewer",R,!1),P=new Tu(AE.ROW,R),B=new wu(AE.COLUMN,R),H=new Ha(AE.LEFT_TOP,{zIndex:2,left:-1,top:-1,width:x,height:O,fill:Al([248,249,250]),stroke:Al([217,217,217]),strokeWidth:1});return D.zIndex=10,L.addObjects([D],1),L.addObjects([P,B,H],2),D.enableSelection(),k}_updateViewport(e,t,n,r,s){if(null==s)return;const o=t*r.scaleX,i=n*r.scaleY,l=new Zh(AE.VIEW_MAIN+e,r,{left:o,top:i,bottom:0,right:0,isWheelPreventDefaultX:!0}),a=new Zh(AE.VIEW_TOP+e,r,{left:o,height:i,top:0,right:0,isWheelPreventDefaultX:!0}),c=new Zh(AE.VIEW_LEFT+e,r,{left:0,bottom:0,top:i,width:o,isWheelPreventDefaultX:!0}),h=new Zh(AE.VIEW_LEFT_TOP+e,r,{left:0,top:0,width:o,height:i,isWheelPreventDefaultX:!0});l.onScrollAfterObserver.add((e=>{const{scrollX:t,scrollY:n,actualScrollX:r,actualScrollY:s}=e;a.updateScroll({scrollX:t,actualScrollX:r}).makeDirty(!0),c.updateScroll({scrollY:n,actualScrollY:s}).makeDirty(!0)})),r.addViewport(l,c,a,h).attachControl(),new Wa(l,{mainScene:s}),r.on(Pi.wheel,((e,t)=>{const n=e;if(n.ctrlKey){const e=Math.abs(n.deltaX);let t=e<40?.05:e<80?.02:.01;t*=n.deltaY>0?-1:1,r.scaleX<1&&(t/=2),r.scaleX+t>4?r.scale(4,4):r.scaleX+t<.1?r.scale(.1,.1):(r.scaleBy(t,t),n.preventDefault())}else l.onMouseWheel(n,t)}))}}),function(e){e.MAIN="__DocsRender__",e.SCENE_VIEWER="__DocsViewer__",e.SCENE="__DocsScene__",e.VIEWPORT="__DocsViewPort_"}(xE||(xE={}));IE.add(new class extends RE{constructor(){super(...arguments),this.zIndex=5,this.viewKey=Xt.DOCUMENT,this._liquid=new Rh}check(e){if(e===this.viewKey)return this}convert(e,t,n){var r,s;const{id:o,zIndex:i,left:l=0,top:a=0,width:c,height:h,angle:u,scaleX:d,scaleY:g,skewX:f,skewY:m,flipX:p,flipY:b,title:_,description:v,document:C}=e;if(null==C)return;const T=mh.create(C,n),w=new Lh(xE.MAIN,T);T.calculate();const y=new Kh(xE.SCENE_VIEWER+o,{top:a,left:l,width:c,height:h,zIndex:i,angle:u,scaleX:d,scaleY:g,skewX:f,skewY:m,flipX:p,flipY:b,isTransformer:!0}),S=new Qh(xE.SCENE+o,y),E=new Zh(xE.VIEWPORT+o,S,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});S.addViewport(E).attachControl(),S.on(Pi.wheel,((e,t)=>{const n=e;if(n.ctrlKey){const e=Math.abs(n.deltaX);let t=e<40?.2:e<80?.4:.2;t*=n.deltaY>0?-1:1,S.scaleX<1&&(t/=2),S.scaleX+t>4?S.scale(4,4):S.scaleX+t<.1?S.scale(.1,.1):(n.deltaY,n.preventDefault())}else E.onMouseWheel(n,t)})),new Wa(E,{mainScene:t}),S.addObject(w),w.calculatePagePosition();const R=null==(r=w.getSkeleton())?void 0:r.getPageSize();w.onPageRenderObservable.add((e=>{const{page:t,pageLeft:n,pageTop:r,ctx:s}=e,{width:o,height:i,marginBottom:l,marginLeft:a,marginRight:c,marginTop:h}=t;s.save(),s.translate(n-.5,r-.5),Ha.drawWith(s,{width:(null==R?void 0:R.width)||o,height:(null==R?void 0:R.height)||i,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:"rgba(255,255,255, 1)",zIndex:3}),s.restore()}));const{left:I,top:A}=w,{pages:x}=T.getSkeletonData(),O=[],M=new Map;for(let N=0,k=x.length;N<k;N++){const e=x[N],{skeDrawings:t,marginLeft:n,marginTop:r,pageWidth:s,pageHeight:o}=e;this._liquid.translatePagePadding(e),t.forEach((e=>{var t;const{aLeft:n,aTop:r,height:s,width:o,drawingOrigin:i}=e,{objectProperties:l}=i,a=new Va(e.objectId,{url:(null==(t=l.imageProperties)?void 0:t.contentUrl)||"",left:n+I+this._liquid.x,top:r+A+this._liquid.y,width:o,height:s,zIndex:11,isTransformer:!0});M.set(e.objectId,{marginLeft:this._liquid.x,marginTop:this._liquid.y}),O.push(a)})),this._liquid.translatePage(e,w.pageLayoutType,w.pageMarginLeft,w.pageMarginTop)}return S.openTransformer(),S.addObjects(O),null==(s=S.getTransformer())||s.onChangingObservable.add((e=>{const{objects:t}=e;t.forEach((e=>{const{oKey:t,left:n,top:r,height:s,width:o}=e,i=M.get(t),l=(null==i?void 0:i.marginLeft)||0,a=(null==i?void 0:i.marginTop)||0;null==T||T.updateDrawing(t,{left:n-I-l,top:r-A-a,height:s,width:o})})),null==T||T.calculate()})),S.closeTransformer(),y}}),(ME=OE||(OE={})).MAIN="__SLIDERender__",ME.SCENE_VIEWER="__SLIDEViewer__",ME.SCENE="__SLIDEScene__",ME.VIEWPORT="__SLIDEViewPort_";IE.add(new class extends RE{constructor(){super(...arguments),this.zIndex=6,this.viewKey=Xt.SLIDE}check(e){if(e===this.viewKey)return this}convert(e,t,n){const{id:r,zIndex:s,left:o=0,top:i=0,width:l,height:a,angle:c,scaleX:h,scaleY:u,skewX:d,skewY:g,flipX:f,flipY:m,title:p,description:b,slide:_}=e;if(null==_)return;const v=new Jo(_,n),C=new Au(OE.MAIN+r,{top:i,left:o,width:l,height:a,zIndex:s,angle:c,scaleX:h,scaleY:u,skewX:d,skewY:g,flipX:f,flipY:m,isTransformer:!1,forceRender:!0});C.enableNav(),C.enableSelectedClipElement();const T=v.getPageOrder(),w=v.getPages();if(!T||!w)return C;this._ObjectProvider=new LE;for(var y=0,S=T.length;y<S;y++){const e=w[T[y]],{id:r}=e;C.addPage(this._createScene(r,C,e,t,v,n))}return C.activeFirstPage(),C}_createScene(e,t,n,r,s,o){let{width:i,height:l}=t;const a=new Qh(e,t,{width:i,height:l}),c=new Zh("PageViewer_"+e,a,{left:0,top:0,bottom:0,right:0});c.closeClip(),a.addViewport(c);const{pageElements:h,pageBackgroundFill:u}=n,d=this._ObjectProvider.convertToRenderObjects(h,r,o);return a.openTransformer(),this._addBackgroundRect(a,u,s),a.addObjects(d),a}_addBackgroundRect(e,t,n){const r=n.getPageSize(),{width:s=0,height:o=0}=r,i=new Ha("canvas",{left:0,top:0,width:s,height:o,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:kn(t)||"rgba(255,255,255, 1)",zIndex:0,evented:!1});e.addObject(i,0)}});class LE{constructor(){this._adaptors=[],this._adaptorLoader()}convertToRenderObjects(e,t,n){const r=Object.keys(e),s=[];return r.forEach((r=>{const o=e[r],i=this._executor(o,t,n);null!=i&&s.push(i)})),s}_executor(e,t,n){var r;const{id:s,type:o}=e;for(let i of this._adaptors){const s=null==(r=i.check(o))?void 0:r.convert(e,t,n);if(null!=s)return s}}_adaptorLoader(){IE.getData().sort(Ar).forEach((e=>{this._adaptors.push(e)}))}static create(){return new LE}}(kE=NE||(NE={})).COMPONENT="__slideRender__",kE.SCENE="__mainScene__",kE.VIEW="__mainView__";class DE{constructor(e,t){this._engine=e,this._plugin=t,this._slideThumbEngine=new Map,this._ObjectProvider=new LE,this._initialize()}getSlide(){return this._slide}createSlidePages(e,t){if(null!=e&&e.length===t.length){for(let n=0,r=e.length;n<r;n++){const r=e[n].querySelector("div"),s=t[n],{id:o}=s;!this._slideThumbEngine.has(o)&&r&&this._createScene(o,this._slide,t[n])}setTimeout((()=>{for(let n=0,r=e.length;n<r;n++){const r=e[n].querySelector("div"),s=t[n],{id:o}=s;!this._slideThumbEngine.has(o)&&r&&(this._createThumb(r,o),this._thumbSceneRender(o))}}),300),this._activePageId=t[0].id,this._slide.activeFirstPage()}}activePage(e){const t=this._plugin.context.getSlide();let n;if(e)n=t.getPage(e);else{const r=t.getPages(),s=t.getPageOrder();if(null==s||null==r)return;n=r[s[0]],e=n.id}if(null==n)return;const{id:r}=n;this._activePageId=e,this._slide.hasPage(r)?this._slide.changePage(r):this._createScene(r,this._slide,n)}scrollToCenter(){const e=this._scene.getViewport(NE.VIEW);if(!e)return;const{left:t,top:n}=this._getCenterPositionViewPort(),{x:r,y:s}=e.getBarScroll(t,n);e.scrollTo({x:r,y:s})}_initialize(){const e=this._engine,t=new Qh(NE.SCENE,e,{width:2400,height:1800});this._scene=t;const n=new Zh(NE.VIEW,t,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});t.addViewport(n).attachControl(),t.on(Pi.wheel,((e,r)=>{const s=e;if(s.ctrlKey){const e=Math.abs(s.deltaX);let n=e<40?.2:e<80?.4:.2;n*=s.deltaY>0?-1:1,t.scaleX<1&&(n/=2),t.scaleX+n>4?t.scale(4,4):t.scaleX+n<.1?t.scale(.1,.1):(s.deltaY,s.preventDefault())}else n.onMouseWheel(s,r)})),Wa.attachTo(n);const{left:r,top:s}=this._getCenterPositionViewPort(),{x:o,y:i}=n.getBarScroll(r,s);n.scrollTo({x:o,y:i}),this._createSlide(),this.activePage(),e.runRenderLoop((()=>{t.render();const n=document.getElementById("app");n&&(n.innerText=`fps:${Math.round(e.getFps()).toString()}`)}))}_createSlide(){const e=this._plugin.context.getSlide(),t=this._scene,{width:n,height:r}=t,s=e.getPageSize(),{width:o=100,height:i=100}=s,l=new Au(NE.COMPONENT,{left:(n-o)/2,top:(r-i)/2,width:o,height:i,zIndex:10});l.enableNav(),l.enableSelectedClipElement(),this._slide=l,t.addObject(l)}_addBackgroundRect(e,t){const n=this._plugin.context.getSlide().getPageSize(),{width:r=0,height:s=0}=n,o=new Ha("canvas",{left:0,top:0,width:r,height:s,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:kn(t)||"rgba(255,255,255, 1)",zIndex:0,evented:!1});e.addObject(o,0)}_getCenterPositionViewPort(){const{width:e,height:t}=this._scene,n=this._scene.getEngine();return{left:(e-((null==n?void 0:n.width)||0))/2,top:(t-((null==n?void 0:n.height)||0))/2}}_thumbSceneRender(e){const t=this._slideThumbEngine.get(e);if(null==t)return;const{width:n,height:r}=this._slide,{width:s=n,height:o=r}=t,i=t.getCanvas().getContext();this._slide.renderToThumb(i,e,s/n,o/r)}_createThumb(e,t){const n=new xa;n.setContainer(e),this._slideThumbEngine.set(t,n)}_createScene(e,t,n){let{width:r,height:s}=t;const o=new Qh(e,t,{width:r,height:s}),i=new Zh(`PageViewer_${e}`,o,{left:0,top:0,bottom:0,right:0});i.closeClip(),o.addViewport(i);const{pageElements:l,pageBackgroundFill:a}=n,c=this._ObjectProvider.convertToRenderObjects(l,this._scene,this._plugin.context);o.openTransformer(),this._addBackgroundRect(o,a),o.addObjects(c);const h=o.getTransformer();return null==h||h.onChangeEndObservable.add((()=>{this._thumbSceneRender(this._activePageId)})),null==h||h.onClearControlObservable.add((()=>{this._thumbSceneRender(this._activePageId)})),this._slide.addPage(o),o}}const PE={};class BE extends Fo{constructor(e={}){super(Ut.SLIDE),this._config=Object.assign(PE,e)}static create(e){return new BE(e)}installTo(e){e.installPlugin(this)}initialize(e){var t;this.context=e,this.getGlobalContext().getLocale().load({en:EE,zh:SE}),(t=this).pushToObserve("onAfterChangeFontFamilyObservable"),t.pushToObserve("onAfterChangeFontSizeObservable"),t.pushToObserve("onAfterChangeFontWeightObservable"),t.pushToObserve("onAfterChangeFontItalicObservable"),t.pushToObserve("onAfterChangeFontStrikethroughObservable"),t.pushToObserve("onAfterChangeFontUnderlineObservable"),t.pushToObserve("onAfterChangeFontBackgroundObservable"),t.pushToObserve("onAfterChangeFontColorObservable"),t.pushToObserve("onDragAndDropStartObserver"),t.pushToObserve("onDragAndDroppingObserver"),t.pushToObserve("onDragAndDropEndEndObserver"),t.pushToObserve("onFillStartObserver"),t.pushToObserve("onFillingObserver"),t.pushToObserve("onFillEndObserver"),t.pushToObserve("onChangeCurrentSheetObserver"),t.pushToObserve("onToolbarDidMountObservable"),t.pushToObserve("onSheetBarDidMountObservable"),t.pushToObserve("onCountBarDidMountObservable"),t.pushToObserve("onInfoBarDidMountObservable"),t.pushToObserve("onSlideBarDidMountObservable"),t.pushToObserve("onRightMenuDidMountObservable"),t.pushToObserve("onSlideContainerDidMountObservable"),t.pushToObserve("onSpreadsheetKeyDownObservable"),t.pushToObserve("onSpreadsheetKeyUpObservable"),t.pushToObserve("onSpreadsheetKeyCopyObservable"),t.pushToObserve("onSpreadsheetKeyPasteObservable"),t.pushToObserve("onSpreadsheetKeyCutObservable"),t.pushToObserve("onSpreadsheetKeyCompositionStartObservable"),t.pushToObserve("onSpreadsheetKeyCompositionUpdateObservable"),t.pushToObserve("onSpreadsheetKeyCompositionEndObservable"),this.initConfig(),this.initController(),this.initCanvasView(),this.registerExtension()}getConfig(){return this._config}initConfig(){}initController(){}initCanvasView(){const e=this.getGlobalContext().getPluginManager().getRequirePluginByName(Ut.BASE_RENDER).getEngine();this._canvasEngine=e,null==this._canvasView&&(this._canvasView=new DE(e,this))}onMounted(e){this.initialize(e)}onDestroy(){var e;super.onDestroy(),(e=this).deleteObserve("onAfterChangeFontFamilyObservable"),e.deleteObserve("onAfterChangeFontSizeObservable"),e.deleteObserve("onAfterChangeFontWeightObservable"),e.deleteObserve("onAfterChangeFontItalicObservable"),e.deleteObserve("onAfterChangeFontStrikethroughObservable"),e.deleteObserve("onAfterChangeFontUnderlineObservable"),e.deleteObserve("onAfterChangeFontBackgroundObservable"),e.deleteObserve("onAfterChangeFontColorObservable"),e.deleteObserve("onToolbarDidMountObservable"),e.deleteObserve("onSlideBarDidMountObservable"),e.deleteObserve("onChangeCurrentSheetObserver"),e.deleteObserve("onSlideContainerDidMountObservable"),e.deleteObserve("onSpreadsheetKeyDownObservable"),e.deleteObserve("onSpreadsheetKeyUpObservable"),e.deleteObserve("onSpreadsheetKeyCopyObservable"),e.deleteObserve("onSpreadsheetKeyPasteObservable"),e.deleteObserve("onSpreadsheetKeyCutObservable"),e.deleteObserve("onSpreadsheetKeyCompositionStartObservable"),e.deleteObserve("onSpreadsheetKeyCompositionUpdateObservable"),e.deleteObserve("onSpreadsheetKeyCompositionEndObservable")}registerExtension(){}listenEventManager(){}getCanvasEngine(){return this._canvasEngine}getCanvasView(){return this._canvasView}}var HE=Object.freeze(Object.defineProperty({__proto__:null,SlidePlugin:BE,ToolbarController:class{constructor(e){this._plugin=e}listenEventManager(){}},get SLIDE_KEY(){return NE},CanvasView:DE},Symbol.toStringTag,{value:"Module"})),FE={collaboration:{tooltip:"Collaboration",one:"",two:"",three:""}},zE={collaboration:{tooltip:"Collaboration",one:"one",two:"two",three:"three"}};class UE{constructor(e){this._plugin=e,this._initialize()}onMessage(e){const t=JSON.parse(e).content;if(t!==qn&&this.previousMessage!==t){this.previousMessage=t;try{const e=JSON.parse(t);e&&"workbookData"===e.type&&(console.log("refresh"),this.refresh(e.config))}catch(n){console.error(t)}}}onError(e){console.log("Collaboration Error: ",e)}onOpen(e){console.log("Collaboration Open: ",e)}onClose(e){console.log("Collaboration Close: ",e)}onRetry(e){console.log("Collaboration Retry: ",e)}onDestroy(e){console.log("Collaboration Destroy: ",e)}close(){this.socket.close()}refresh(e){const t=this._plugin.getContext();t.refreshWorkbook(e);const n=t.getWorkBook().getActiveSheet();if(n)try{const e=t.getPluginManager().getRequirePluginByName(Ut.SPREADSHEET),r=e.getCanvasView();r&&(r.updateToSheet(n),e.getMainComponent().makeDirty(!0))}catch(r){console.info(r)}}_initialize(){const e=this._plugin.getConfig(),{url:t}=e;""!==t?(this._initSocket(t),this._initObserver()):console.warn("url must be input")}_initSocket(e){this.socket=new Jn({url:e}),this.socket.on(Qn.MESSAGE,(e=>{this.onMessage(e&&e.data)})),this.socket.on(Qn.ERROR,(e=>{this.onError(e&&e.data)})),this.socket.on(Qn.OPEN,(e=>{this.onOpen(e&&e.data)})),this.socket.on(Qn.CLOSE,(e=>{this.onClose(e&&e.data)})),this.socket.on(Qn.RETRY,(e=>{this.onRetry(e&&e.data)})),this.socket.on(Qn.DESTROY,(e=>{this.onDestroy(e&&e.data)})),this.socket.link()}_initObserver(){let e=null;zr.getCommandObservers().add((({actions:t})=>{const n=this._plugin;if(!n)return;if(!t||0===t.length)return;const r=t[0];if(r.getDoActionData().actionName!==be.SET_RANGE_DATA_ACTION)return;const s=n.getUniver().getCurrentUniverSheetInstance().context;if(s.getWorkBook().getUnitId()!==r.getWorkBook().getUnitId())return;if(r.getWorkBook().getActiveSheet())try{e&&(clearTimeout(e),e=null),e=setTimeout((()=>{const e={type:"workbookData",config:s.getWorkBook().getConfig()},t=JSON.stringify(e);this.previousMessage=t,this.socket.send(t)}),100)}catch(o){console.info(o)}}))}}class WE extends Fo{constructor(e){super("collaboration"),this.config=e||{url:""}}static create(e){return new WE(e)}installTo(e){e.installPlugin(this)}initialize(){this.getGlobalContext().getLocale().load({en:zE,zh:FE}),this._collaborationController=new UE(this)}onMounted(){this.initialize()}onDestroy(){}getConfig(){return this.config}getCollaborationController(){return this._collaborationController}}var VE,jE={},YE={};!function(e){e.ADD_FILTER_ACTION="AddFilterAction",e.REMOVE_FILTER_ACTION="RemoveFilterAction",e.ADD_FILTER_CRITERIA_ACTION="AddFilterCriteriaAction",e.REMOVE_FILTER_CRITERIA_ACTION="RemoveFilterCriteriaAction",e.SET_FILTER_CRITERIA_ACTION="setFilterCriteriaAction"}(VE||(VE={}));const GE="ClipboardPlugin";class XE extends class{constructor(e,t,n){this._context=e,this._context.getPluginManager().getPluginByName(Ut.SPREADSHEET);this._context.getUniver().getGlobalContext().getObserverManager().requiredObserver("onKeyCopyObservable","core").add((e=>{this.copy(e)}))}getContext(){return this._context}copy(e){e.preventDefault()}_initRegisterComponent(e){const t=this._context.getUniver().getGlobalContext().getPluginManager().getRequirePluginByName(xd).getAppUIController().getSheetContainerController().getMainSlotController();for(let n=0;n<e.length;n++)t.addSlot(GE+e[n].name,{component:e[n]})}}{constructor(e){super(e,[{locale:"rightClick.copy",onClick:()=>this.copyTo()},{customLabel:{name:dT.name,props:{locale:"rightClick.copyAs"}},children:[{locale:["Json","rightClick.firstLineTitle"],onClick:()=>this.copyJsonHead()},{locale:["Json","rightClick.untitled"],onClick:()=>this.copyJsonNoHead()},{locale:["rightClick.array1"],onClick:()=>this.copyArray1()},{locale:["rightClick.array2"],onClick:()=>this.copyArray2()},{}]}])}async copy(e){const t=this._getCopyContent();t&&Bg.write({data:t},e)}async copyTo(...e){const t=this._getCopyContent();t&&await Bg.write({data:t})}async copyJsonHead(...e){var t,n,r;const s=this._getRangeInfo();if(!s)return;const{range:o,rangeData:i}=s;let l=[];if(1===i.length){let e={};for(let n=0;n<i[0].length;n++){const r=null==(t=o.getValues()[0][n])?void 0:t.v;"string"==typeof r||"number"==typeof r?e[r]="":e[""]=""}l.push(e)}else for(let a=1;a<i.length;a++){let e={};for(let t=0;t<i[0].length;t++){const s=null==(n=o.getValues()[0][t])?void 0:n.v,i=null==(r=o.getValues()[a][t])?void 0:r.v;"string"==typeof s||"number"==typeof s?e[s]=i:e[""]=i}l.push(e)}await Bg.writeText(JSON.stringify(l))}async copyJsonNoHead(...e){var t;const n=this._getRangeInfo();if(!n)return;const{range:r,rangeData:s}=n;let o=[];for(let i=0;i<s.length;i++){let e={};for(let n=0;n<s[0].length;n++){const s=null==(t=r.getValues()[i][n])?void 0:t.v;e[C.chatAtABC(n+r.getRangeData().startColumn)]=s}o.push(e)}await Bg.writeText(JSON.stringify(o))}async copyArray1(...e){var t;const n=this._getRangeInfo();if(!n)return;const{range:r,rangeData:s}=n;let o=[];for(let i=0;i<s.length;i++)for(let e=0;e<s[0].length;e++){const n=null==(t=r.getValues()[i][e])?void 0:t.v;o.push(n)}await Bg.writeText(JSON.stringify(o))}async copyArray2(...e){var t;const n=this._getRangeInfo();if(!n)return;const{range:r,rangeData:s}=n;let o=[];for(let i=0;i<s.length;i++)for(let e=0;e<s[0].length;e++){const n=null==(t=r.getValues()[i][e])?void 0:t.v;o.push(n)}await Bg.writeText(JSON.stringify(o))}async copyArrayMore(e){var t,n,r;if("Enter"!==e.key)return;const s=this._getRangeInfo();if(!s)return;const{range:o,rangeData:i}=s;let l=[];for(let m=0;m<i.length;m++)for(let e=0;e<i[0].length;e++)l.push(i[m][e]);let a="0",c="0";const h=e.target,u=null==(t=null==h?void 0:h.previousSibling)?void 0:t.textContent;if(!u)return;if(u.length>1){a=h.value;c=(null==(n=h.parentNode)?void 0:n.querySelectorAll("input")[1]).value}else{c=h.value;a=(null==(r=h.parentNode)?void 0:r.querySelectorAll("input")[0]).value}if(""===a&&""===c)return void(await Bg.writeText(JSON.stringify(l)));if(a=""===a?"1":`${parseInt(a)}`,c=""===c?"1":`${parseInt(c)}`,+a<1||+c<1)return;let d=l.length,g=0,f=[];for(let m=0;m<+a;m++){let e=[];for(let t=0;t<+c;t++)if(e.push(l[g++]),g>=d)return void(await Bg.writeText(JSON.stringify(f)));f.push(e)}await Bg.writeText(JSON.stringify(f))}_getSheetInfo(){const e=this.getContext().getWorkBook().getActiveSheet(),t=this.getContext().getPluginManager().getPluginByName(Ut.SPREADSHEET),n=null==t?void 0:t.getMainComponent(),r=null==t?void 0:t.getSelectionManager().getCurrentControls();return{sheet:e,spreadsheet:n,selections:null==r?void 0:r.map((e=>{const t=e.model;return{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}))}}_getRangeInfo(){const{sheet:e,selections:t}=this._getSheetInfo();if(!t.length)return;const n=e.getRange(t[0]),r=n.getValues();return r.length?{range:n,rangeData:r}:void 0}_getCopyContent(){const{sheet:e,spreadsheet:t,selections:n}=this._getSheetInfo();if(n.length>1)return;const r=e.getRowManager().getRowData(),s=e.getColumnManager().getColumnData();let o=[],i=[];for(let c=0;c<n.length;c++){let e=n[c],t=e.startRow,l=e.endRow,a=e.startColumn,h=e.endColumn;for(let n=t;n<=l;n++){const e=r.get(n);if(!e||!e.hd){o.includes(n)||o.push(n);for(let e=a;e<=h;e++){const t=s.get(e);t&&t.hd||(i.includes(e)||i.push(e))}}}}let l="",a="<colgroup>";for(let c=0;c<o.length;c++){let n=o[c];l+="<tr>";for(let c=0;c<i.length;c++){let h=i[c],u=e.getRange(n,h).getValue(),d="",g="",f="";if(n===o[0]){const e=s.get(h);e&&e.w?a+=`<col width="${e.w}px"></col>`:a+='<col width="72px"></col>'}const m=r.get(n);if(m&&m.h?g+=`height:${m.h}px;`:g+="height:19px;",u&&u.s){const e=this.getContext().getWorkBook().getStyles().getStyleByCell(u);e&&(g+=Dn(e))}const p=null==t?void 0:t.getCellByIndex(n,h);if((null==p?void 0:p.isMerged)||!(null==p?void 0:p.isMerged)&&(null==p?void 0:p.isMergedMainCell)){if(!p.isMergedMainCell)continue;f=`rowSpan="${p.mergeInfo.endRow-p.mergeInfo.startRow+1}" colSpan="${p.mergeInfo.endColumn-p.mergeInfo.startColumn+1}"`}if(g.includes("data-rotate")){let e=g.split(";").find((e=>e.includes("data-rotate")));const t=null==e?void 0:e.match(/\d+/g);let n=0,r=0;(null==t?void 0:t.length)&&(n=+t[0],r=+t[1]),d+=`<td ${f} ${r?`data-vertical=${r}`:""} style="display:inline-block;transform: rotate(${n}deg);${g}">`}else d=`<td ${f} style="${g}">`;let b;u?u.p?b=Ln(u.p):(b=e.getRange(n,h).getDisplayValue(),null==b&&(b="")):b="",d+=b,d+="</td>",l+=d}l+="</tr>"}return a+="</colgroup>",`<table data-type="universheet_copy_action_table">${a}${l}</table>`}}class $E extends class{constructor(e,t){this._context=e}getContext(){return this._context}paste(e){}}{constructor(e){super(e,[{label:"rightClick.paste",onClick:()=>{}}])}pasteTo(e){const{data:t,colInfo:n,rowInfo:r}=e;if(!t||!t.length)return;const s=this.getContext().getWorkBook().getActiveSheet();if(!s)return;const o=this.getContext().getPluginManager().getPluginByName(Ut.SPREADSHEET);if(!o)return;if(!(null==o?void 0:o.getMainComponent()))return;const i=null==o?void 0:o.getSelectionManager().getCurrentControls(),l=null==i?void 0:i.map((e=>{const t=e.model;return{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}));if(!l.length)return;if(l.length>1)return;const a=l[0];let c=t.length,h=t[0].length,u=a.startRow,d=u+c-1,g=a.startColumn,f=g+h-1;if(s.getMerges().getByRowColumn(u,d,g,f)){const e=this.getContext().getUniver().getGlobalContext().getPluginManager().getRequirePluginByName(xd).getSlot(xd+Gv.name);return e.props.title="info.tooltip",e.props.content="info.notChangeMerge",void e.showModal(!0)}const m=db(t,a),p=m.mergeData;for(let b=0;b<p.length;b++)s.getMerges().add(p[b]);if(s.getRange(u,g,d,f).setRangeDatas(m.data),n&&n.length)for(let b=0;b<n.length;b++)s.setColumnWidth(g+b,n[b]);if(r&&r.length)for(let b=0;b<r.length;b++)s.setRowHeight(u+b,r[b])}paste(e){this.pasteTo(e)}}class QE extends kg{execute(){const e=this._data.html||this._data.plain;let t,n,r;e&&(e.indexOf('xmlns:x="urn:schemas-microsoft-com:office:excel"')>-1?(t=gb(e),n=lb(e),r=cb(e)):e.indexOf("<table")>-1&&e.indexOf("<td")>-1?(t=hb(e),n=lb(e),r=cb(e)):t=ub(e)),this._plugin.getUniverPaste().pasteTo({data:t,colInfo:n,rowInfo:r})}}class KE extends Lg{get zIndex(){return 1}create(e){return new QE(e,this._plugin)}check(e){const t=e.html||e.plain;return!!(t&&t.indexOf("<table")>-1&&t.indexOf("<td")>-1)&&this.create(e)}}class ZE extends kg{execute(){}}class qE extends Lg{get zIndex(){return 2}create(e){return new ZE(e,this._plugin)}check(e){return!1}}class JE extends Fo{constructor(){super(GE),this._copyResolvers=[],this._pasteResolvers=[]}static create(){return new JE}initialize(){this.registerExtension()}registerExtension(){const e=this.getGlobalContext().getPluginManager().getRequirePluginByName(xd).getRegisterManager().getClipboardExtensionManager().getRegister();this._clipboardExtensionFactory=new KE(this),e.add(this._clipboardExtensionFactory),this._clipboardOfficeExtensionFactory=new qE(this),e.add(this._clipboardOfficeExtensionFactory)}installTo(e){e.installPlugin(this)}onDestroy(){const e=this.getContext().getPluginManager().getRequirePluginByName(xd).getRegisterManager().getClipboardExtensionManager().getRegister();e.delete(this._clipboardExtensionFactory),e.delete(this._clipboardOfficeExtensionFactory)}onMounted(e){super.onMounted(e),this.getLocale().load({en:YE,zh:jE}),this._univerPaste=new $E(e),this.installCopyResolver({name:"univerCopy",resolver:new XE(e)}),this.initialize()}getUniverPaste(){return this._univerPaste}installCopyResolver(e){if(this._copyResolvers.findIndex((t=>t.name===e.name))>-1)return!1;this._copyResolvers.push(e)}}var eR={importXlsx:{tooltip:"XLSX",import:""}},tR={importXlsx:{tooltip:"Import XLSX",import:"Import"}};const nR="importXlsx";var rR={exports:{}};
/*!
  
      JSZip v3.10.1 - A JavaScript class for generating and reading zip files
      <http://stuartk.com/jszip>
  
      (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
      Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.
  
      JSZip uses the library pako released under the MIT license :
      https://github.com/nodeca/pako/blob/main/LICENSE
      */!function(e,t){e.exports=function e(t,n,r){function s(i,l){if(!n[i]){if(!t[i]){if(!l&&an)return an(i);if(o)return o(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var c=n[i]={exports:{}};t[i][0].call(c.exports,(function(e){return s(t[i][1][e]||e)}),c,c.exports,e,t,n,r)}return n[i].exports}for(var o=an,i=0;i<r.length;i++)s(r[i]);return s}({1:[function(e,t,n){var r=e("./utils"),s=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,s,i,l,a,c,h=[],u=0,d=e.length,g=d,f="string"!==r.getTypeOf(e);u<e.length;)g=d-u,s=f?(t=e[u++],n=u<d?e[u++]:0,u<d?e[u++]:0):(t=e.charCodeAt(u++),n=u<d?e.charCodeAt(u++):0,u<d?e.charCodeAt(u++):0),i=t>>2,l=(3&t)<<4|n>>4,a=1<g?(15&n)<<2|s>>6:64,c=2<g?63&s:64,h.push(o.charAt(i)+o.charAt(l)+o.charAt(a)+o.charAt(c));return h.join("")},n.decode=function(e){var t,n,r,i,l,a,c=0,h=0,u="data:";if(e.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var d,g=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===o.charAt(64)&&g--,e.charAt(e.length-2)===o.charAt(64)&&g--,g%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=s.uint8array?new Uint8Array(0|g):new Array(0|g);c<e.length;)t=o.indexOf(e.charAt(c++))<<2|(i=o.indexOf(e.charAt(c++)))>>4,n=(15&i)<<4|(l=o.indexOf(e.charAt(c++)))>>2,r=(3&l)<<6|(a=o.indexOf(e.charAt(c++))),d[h++]=t,64!==l&&(d[h++]=n),64!==a&&(d[h++]=r);return d}},{"./support":30,"./utils":32}],2:[function(e,t,n){var r=e("./external"),s=e("./stream/DataWorker"),o=e("./stream/Crc32Probe"),i=e("./stream/DataLengthProbe");function l(e,t,n,r,s){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=s}l.prototype={getContentWorker:function(){var e=new s(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new i("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new s(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},l.createWorkerFrom=function(e,t,n){return e.pipe(new o).pipe(new i("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new i("compressedSize")).withStreamInfo("compression",t)},t.exports=l},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){var r=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){var r=e("./utils"),s=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,n,r){var o=s,i=r+n;e^=-1;for(var l=r;l<i;l++)e=e>>>8^o[255&(e^t[l])];return-1^e}(0|t,e,e.length,0):function(e,t,n,r){var o=s,i=r+n;e^=-1;for(var l=r;l<i;l++)e=e>>>8^o[255&(e^t.charCodeAt(l))];return-1^e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){var r=null;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,n){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,s=e("pako"),o=e("./utils"),i=e("./stream/GenericWorker"),l=r?"uint8array":"array";function a(e,t){i.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",o.inherits(a,i),a.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(l,e.data),!1)},a.prototype.flush=function(){i.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},a.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this._pako=null},a.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new a("Deflate",e)},n.uncompressWorker=function(){return new a("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){function r(e,t){var n,r="";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r}function s(e,t,n,s,i,h){var u,d,g=e.file,f=e.compression,m=h!==l.utf8encode,p=o.transformTo("string",h(g.name)),b=o.transformTo("string",l.utf8encode(g.name)),_=g.comment,v=o.transformTo("string",h(_)),C=o.transformTo("string",l.utf8encode(_)),T=b.length!==g.name.length,w=C.length!==_.length,y="",S="",E="",R=g.dir,I=g.date,A={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(A.crc32=e.crc32,A.compressedSize=e.compressedSize,A.uncompressedSize=e.uncompressedSize);var x=0;t&&(x|=8),m||!T&&!w||(x|=2048);var O,M,N,k=0,L=0;R&&(k|=16),"UNIX"===i?(L=798,k|=(O=g.unixPermissions,M=R,N=O,O||(N=M?16893:33204),(65535&N)<<16)):(L=20,k|=function(e){return 63&(e||0)}(g.dosPermissions)),u=I.getUTCHours(),u<<=6,u|=I.getUTCMinutes(),u<<=5,u|=I.getUTCSeconds()/2,d=I.getUTCFullYear()-1980,d<<=4,d|=I.getUTCMonth()+1,d<<=5,d|=I.getUTCDate(),T&&(S=r(1,1)+r(a(p),4)+b,y+="up"+r(S.length,2)+S),w&&(E=r(1,1)+r(a(v),4)+C,y+="uc"+r(E.length,2)+E);var D="";return D+="\n\0",D+=r(x,2),D+=f.magic,D+=r(u,2),D+=r(d,2),D+=r(A.crc32,4),D+=r(A.compressedSize,4),D+=r(A.uncompressedSize,4),D+=r(p.length,2),D+=r(y.length,2),{fileRecord:c.LOCAL_FILE_HEADER+D+p+y,dirRecord:c.CENTRAL_FILE_HEADER+r(L,2)+D+r(v.length,2)+"\0\0\0\0"+r(k,4)+r(s,4)+p+y+v}}var o=e("../utils"),i=e("../stream/GenericWorker"),l=e("../utf8"),a=e("../crc32"),c=e("../signature");function h(e,t,n,r){i.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(h,i),h.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,i.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},h.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=s(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(e){this.accumulate=!1;var t,n=this.streamFiles&&!e.file.dir,o=s(e,n,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(o.dirRecord),n)this.push({data:(t=e,c.DATA_DESCRIPTOR+r(t.crc32,4)+r(t.compressedSize,4)+r(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:o.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n,s,i,l,a,h,u=this.bytesWritten-e,d=(n=this.dirRecords.length,s=u,i=e,l=this.zipComment,a=this.encodeFileName,h=o.transformTo("string",a(l)),c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(n,2)+r(n,2)+r(s,4)+r(i,4)+r(h.length,2)+h);this.push({data:d,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},h.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(e){var t=this._sources;if(!i.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(r){}return!0},h.prototype.lock=function(){i.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){var r=e("../compressions"),s=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var o=new s(t.streamFiles,n,t.platform,t.encodeFileName),i=0;try{e.forEach((function(e,n){i++;var s=function(e,t){var n=e||t,s=r[n];if(!s)throw new Error(n+" is not a valid compression method !");return s}(n.options.compression,t.compression),l=n.options.compressionOptions||t.compressionOptions||{},a=n.dir,c=n.date;n._compressWorker(s,l).withStreamInfo("file",{name:e,dir:a,date:c,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(o)})),o.entriesCount=i}catch(l){o.error(l)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){var r=e("./utils"),s=e("./external"),o=e("./utf8"),i=e("./zipEntries"),l=e("./stream/Crc32Probe"),a=e("./nodejsUtils");function c(e){return new s.Promise((function(t,n){var r=e.decompressed.getContentWorker().pipe(new l);r.on("error",(function(e){n(e)})).on("end",(function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),a.isNode&&a.isStream(e)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var n=new i(t);return n.load(e),n})).then((function(e){var n=[s.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var o=0;o<r.length;o++)n.push(c(r[o]));return s.Promise.all(n)})).then((function(e){for(var s=e.shift(),o=s.files,i=0;i<o.length;i++){var l=o[i],a=l.fileNameStr,c=r.resolve(l.fileNameStr);n.file(c,l.decompressed,{binary:!0,optimizedBinaryString:!0,date:l.date,dir:l.dir,comment:l.fileCommentStr.length?l.fileCommentStr:null,unixPermissions:l.unixPermissions,dosPermissions:l.dosPermissions,createFolders:t.createFolders}),l.dir||(n.file(c).unsafeOriginalName=a)}return s.zipComment.length&&(n.comment=s.zipComment),n}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){var r=e("../utils"),s=e("../stream/GenericWorker");function o(e,t){s.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(o,s),o.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},o.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){var r=e("readable-stream").Readable;function s(e,t,n){r.call(this,t),this._helper=e;var s=this;e.on("data",(function(e,t){s.push(e)||s._helper.pause(),n&&n(t)})).on("error",(function(e){s.emit("error",e)})).on("end",(function(){s.push(null)}))}e("../utils").inherits(s,r),s.prototype._read=function(){this._helper.resume()},t.exports=s},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){function r(e,t,n){var r,s=o.getTypeOf(t),l=o.extend(n||{},a);l.date=l.date||new Date,null!==l.compression&&(l.compression=l.compression.toUpperCase()),"string"==typeof l.unixPermissions&&(l.unixPermissions=parseInt(l.unixPermissions,8)),l.unixPermissions&&16384&l.unixPermissions&&(l.dir=!0),l.dosPermissions&&16&l.dosPermissions&&(l.dir=!0),l.dir&&(e=m(e)),l.createFolders&&(r=f(e))&&p.call(this,r,!0);var u="string"===s&&!1===l.binary&&!1===l.base64;n&&void 0!==n.binary||(l.binary=!u),(t instanceof c&&0===t.uncompressedSize||l.dir||!t||0===t.length)&&(l.base64=!1,l.binary=!0,t="",l.compression="STORE",s="string");var b=null;b=t instanceof c||t instanceof i?t:d.isNode&&d.isStream(t)?new g(e,t):o.prepareContent(e,t,l.binary,l.optimizedBinaryString,l.base64);var _=new h(e,b,l);this.files[e]=_}var s=e("./utf8"),o=e("./utils"),i=e("./stream/GenericWorker"),l=e("./stream/StreamHelper"),a=e("./defaults"),c=e("./compressedObject"),h=e("./zipObject"),u=e("./generate"),d=e("./nodejsUtils"),g=e("./nodejs/NodejsStreamInputAdapter"),f=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},p=function(e,t){return t=void 0!==t?t:a.createFolders,e=m(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function b(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var _={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach((function(n,r){e(n,r)&&t.push(r)})),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,r.call(this,e,t,n),this;if(b(e)){var s=e;return this.filter((function(e,t){return!t.dir&&s.test(e)}))}var o=this.files[this.root+e];return o&&!o.dir?o:null},folder:function(e){if(!e)return this;if(b(e))return this.filter((function(t,n){return n.dir&&e.test(t)}));var t=this.root+e,n=p.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter((function(t,n){return n.name.slice(0,e.length)===e})),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=o.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");o.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var r=n.comment||this.comment||"";t=u.generateWorker(this,n,r)}catch(a){(t=new i("error")).error(a)}return new l(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=_},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){var r=e("./DataReader");function s(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(s,r),s.prototype.byteAt=function(e){return this.data[this.zero+e]},s.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),s=e.charCodeAt(3),o=this.length-4;0<=o;--o)if(this.data[o]===t&&this.data[o+1]===n&&this.data[o+2]===r&&this.data[o+3]===s)return o-this.zero;return-1},s.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),s=e.charCodeAt(3),o=this.readData(4);return t===o[0]&&n===o[1]&&r===o[2]&&s===o[3]},s.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=s},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){var r=e("../utils");function s(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=s},{"../utils":32}],19:[function(e,t,n){var r=e("./Uint8ArrayReader");function s(e){r.call(this,e)}e("../utils").inherits(s,r),s.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){var r=e("./DataReader");function s(e){r.call(this,e)}e("../utils").inherits(s,r),s.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},s.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},s.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},s.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=s},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){var r=e("./ArrayReader");function s(e){r.call(this,e)}e("../utils").inherits(s,r),s.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){var r=e("../utils"),s=e("../support"),o=e("./ArrayReader"),i=e("./StringReader"),l=e("./NodeBufferReader"),a=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||s.uint8array?"nodebuffer"===t?new l(e):s.uint8array?new a(r.transformTo("uint8array",e)):new o(r.transformTo("array",e)):new i(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,n){var r=e("./GenericWorker"),s=e("../utils");function o(e){r.call(this,"ConvertWorker to "+e),this.destType=e}s.inherits(o,r),o.prototype.processChunk=function(e){this.push({data:s.transformTo(this.destType,e.data),meta:e.meta})},t.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){var r=e("./GenericWorker"),s=e("../crc32");function o(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(o,r),o.prototype.processChunk=function(e){this.streamInfo.crc32=s(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){var r=e("../utils"),s=e("./GenericWorker");function o(e){s.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(o,s),o.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}s.prototype.processChunk.call(this,e)},t.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){var r=e("../utils"),s=e("./GenericWorker");function o(e){s.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}r.inherits(o,s),o.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,n){var r=e("../utils"),s=e("./ConvertWorker"),o=e("./GenericWorker"),i=e("../base64"),l=e("../support"),a=e("../external"),c=null;if(l.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(d){}function h(e,t){return new a.Promise((function(n,s){var o=[],l=e._internalType,a=e._outputType,c=e._mimeType;e.on("data",(function(e,n){o.push(e),t&&t(n)})).on("error",(function(e){o=[],s(e)})).on("end",(function(){try{var e=function(e,t,n){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),n);case"base64":return i.encode(t);default:return r.transformTo(e,t)}}(a,function(e,t){var n,r=0,s=null,o=0;for(n=0;n<t.length;n++)o+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(s=new Uint8Array(o),n=0;n<t.length;n++)s.set(t[n],r),r+=t[n].length;return s;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(l,o),c);n(e)}catch(t){s(t)}o=[]})).resume()}))}function u(e,t,n){var i=t;switch(t){case"blob":case"arraybuffer":i="uint8array";break;case"base64":i="string"}try{this._internalType=i,this._outputType=t,this._mimeType=n,r.checkSupport(i),this._worker=e.pipe(new s(i)),e.lock()}catch(l){this._worker=new o("error"),this._worker.error(l)}}u.prototype={accumulate:function(e){return h(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,(function(e){t.call(n,e.data,e.meta)})):this._worker.on(e,(function(){r.delay(t,arguments,n)})),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=0===new Blob([r],{type:"application/zip"}).size}catch(o){try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(r),n.blob=0===s.getBlob("application/zip").size}catch(i){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(o){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){for(var r=e("./utils"),s=e("./support"),o=e("./nodejsUtils"),i=e("./stream/GenericWorker"),l=new Array(256),a=0;a<256;a++)l[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;function c(){i.call(this,"utf-8 decode"),this.leftOver=null}function h(){i.call(this,"utf-8 encode")}l[254]=l[254]=1,n.utf8encode=function(e){return s.nodebuffer?o.newBufferFrom(e,"utf-8"):function(e){var t,n,r,o,i,l=e.length,a=0;for(o=0;o<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<l&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=s.uint8array?new Uint8Array(a):new Array(a),o=i=0;i<a;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<l&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),n<128?t[i++]=n:(n<2048?t[i++]=192|n>>>6:(n<65536?t[i++]=224|n>>>12:(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63),t[i++]=128|n>>>6&63),t[i++]=128|63&n);return t}(e)},n.utf8decode=function(e){return s.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,s,o,i=e.length,a=new Array(2*i);for(t=n=0;t<i;)if((s=e[t++])<128)a[n++]=s;else if(4<(o=l[s]))a[n++]=65533,t+=o-1;else{for(s&=2===o?31:3===o?15:7;1<o&&t<i;)s=s<<6|63&e[t++],o--;1<o?a[n++]=65533:s<65536?a[n++]=s:(s-=65536,a[n++]=55296|s>>10&1023,a[n++]=56320|1023&s)}return a.length!==n&&(a.subarray?a=a.subarray(0,n):a.length=n),r.applyFromCharCode(a)}(e=r.transformTo(s.uint8array?"uint8array":"array",e))},r.inherits(c,i),c.prototype.processChunk=function(e){var t=r.transformTo(s.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var o=t;(t=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),t.set(o,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var i=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+l[e[n]]>t?n:t}(t),a=t;i!==t.length&&(s.uint8array?(a=t.subarray(0,i),this.leftOver=t.subarray(i,t.length)):(a=t.slice(0,i),this.leftOver=t.slice(i,t.length))),this.push({data:n.utf8decode(a),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,r.inherits(h,i),h.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){var r=e("./support"),s=e("./base64"),o=e("./nodejsUtils"),i=e("./external");function l(e){return e}function a(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(s){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(t)}catch(o){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,n){var r=[],s=0,o=e.length;if(o<=n)return String.fromCharCode.apply(null,e);for(;s<o;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(s,Math.min(s+n,o)))):r.push(String.fromCharCode.apply(null,e.subarray(s,Math.min(s+n,o)))),s+=n;return r.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(e){return!1}}()}};function h(e){var t=65536,r=n.getTypeOf(e),s=!0;if("uint8array"===r?s=c.applyCanBeUsed.uint8array:"nodebuffer"===r&&(s=c.applyCanBeUsed.nodebuffer),s)for(;1<t;)try{return c.stringifyByChunk(e,r,t)}catch(o){t=Math.floor(t/2)}return c.stringifyByChar(e)}function u(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=h;var d={};d.string={string:l,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return d.string.uint8array(e).buffer},uint8array:function(e){return a(e,new Uint8Array(e.length))},nodebuffer:function(e){return a(e,o.allocBuffer(e.length))}},d.array={string:h,array:l,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(e)}},d.arraybuffer={string:function(e){return h(new Uint8Array(e))},array:function(e){return u(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:l,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(new Uint8Array(e))}},d.uint8array={string:h,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:l,nodebuffer:function(e){return o.newBufferFrom(e)}},d.nodebuffer={string:h,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return d.nodebuffer.uint8array(e).buffer},uint8array:function(e){return u(e,new Uint8Array(e.length))},nodebuffer:l},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var r=n.getTypeOf(t);return d[r][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++){var s=t[r];"."===s||""===s&&0!==r&&r!==t.length-1||(".."===s?n.pop():n.push(s))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&o.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},n.delay=function(e,t,n){setImmediate((function(){e.apply(n||null,t||[])}))},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,o,l,c){return i.Promise.resolve(t).then((function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new i.Promise((function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)})):e})).then((function(t){var h,u=n.getTypeOf(t);return u?("arraybuffer"===u?t=n.transformTo("uint8array",t):"string"===u&&(c?t=s.decode(t):o&&!0!==l&&(t=a(h=t,r.uint8array?new Uint8Array(h.length):new Array(h.length)))),t):i.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){var r=e("./reader/readerFor"),s=e("./utils"),o=e("./signature"),i=e("./zipEntry"),l=e("./support");function a(e){this.files=[],this.loadOptions=e}a.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(t)+", expected "+s.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=l.uint8array?"uint8array":"array",n=s.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(e=new i({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(0<r)this.isSignature(t,o.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=a},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){var r=e("./reader/readerFor"),s=e("./utils"),o=e("./compressedObject"),i=e("./crc32"),l=e("./utf8"),a=e("./compressions"),c=e("./support");function h(e,t){this.options=e,this.loadOptions=t}h.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in a)if(Object.prototype.hasOwnProperty.call(a,t)&&a[t].magic===e)return a[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,r,s=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<s;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r};e.setIndex(s)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=s.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var o=s.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||i(this.fileName)!==t.readInt(4)?null:l.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||i(this.fileComment)!==t.readInt(4)?null:l.utf8decode(t.readData(e.length-5))}return null}},t.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){function r(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var s=e("./stream/StreamHelper"),o=e("./stream/DataWorker"),i=e("./utf8"),l=e("./compressedObject"),a=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var o=!this._dataBinary;o&&!r&&(t=t.pipe(new i.Utf8EncodeWorker)),!o&&r&&(t=t.pipe(new i.Utf8DecodeWorker))}catch(l){(t=new a("error")).error(l)}return new s(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof l&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new i.Utf8EncodeWorker)),l.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof a?this._data:new o(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<c.length;u++)r.prototype[c[u]]=h;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){(function(e){var n,r,s=e.MutationObserver||e.WebKitMutationObserver;if(s){var o=0,i=new s(h),l=e.document.createTextNode("");i.observe(l,{characterData:!0}),n=function(){l.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){h(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(h,0)};else{var a=new e.MessageChannel;a.port1.onmessage=h,n=function(){a.port2.postMessage(0)}}var c=[];function h(){var e,t;r=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}r=!1}t.exports=function(e){1!==c.push(e)||r||n()}}).call(this,void 0!==ln?ln:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){var r=e("immediate");function s(){}var o={},i=["REJECTED"],l=["FULFILLED"],a=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=a,this.queue=[],this.outcome=void 0,e!==s&&g(this,e)}function h(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function u(e,t,n){r((function(){var r;try{r=t(n)}catch(s){return o.reject(e,s)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function g(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function s(t){n||(n=!0,o.resolve(e,t))}var i=f((function(){t(s,r)}));"error"===i.status&&r(i.value)}function f(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){throw n}))}))},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===l||"function"!=typeof t&&this.state===i)return this;var n=new this.constructor(s);return this.state!==a?u(n,this.state===l?e:t,this.outcome):this.queue.push(new h(n,e,t)),n},h.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},h.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},h.prototype.callRejected=function(e){o.reject(this.promise,e)},h.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=f(d,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)g(e,r);else{e.state=l,e.outcome=t;for(var s=-1,i=e.queue.length;++s<i;)e.queue[s].callFulfilled(t)}return e},o.reject=function(e,t){e.state=i,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:o.resolve(new this(s),e)},c.reject=function(e){var t=new this(s);return o.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var i=new Array(n),l=0,a=-1,c=new this(s);++a<n;)h(e[a],a);return c;function h(e,s){t.resolve(e).then((function(e){i[s]=e,++l!==n||r||(r=!0,o.resolve(c,i))}),(function(e){r||(r=!0,o.reject(c,e))}))}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var i,l=-1,a=new this(s);++l<n;)i=e[l],t.resolve(i).then((function(e){r||(r=!0,o.resolve(a,e))}),(function(e){r||(r=!0,o.reject(a,e))}));return a}},{immediate:36}],38:[function(e,t,n){var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){var r=e("./zlib/deflate"),s=e("./utils/common"),o=e("./utils/strings"),i=e("./zlib/messages"),l=e("./zlib/zstream"),a=Object.prototype.toString,c=0,h=-1,u=0,d=8;function g(e){if(!(this instanceof g))return new g(e);this.options=s.assign({level:h,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==c)throw new Error(i[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var f;if(f="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===a.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=r.deflateSetDictionary(this.strm,f))!==c)throw new Error(i[n]);this._dict_set=!0}}function f(e,t){var n=new g(t);if(n.push(e,!0),n.err)throw n.msg||i[n.err];return n.result}g.prototype.push=function(e,t){var n,i,l=this.strm,h=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:!0===t?4:0,"string"==typeof e?l.input=o.string2buf(e):"[object ArrayBuffer]"===a.call(e)?l.input=new Uint8Array(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new s.Buf8(h),l.next_out=0,l.avail_out=h),1!==(n=r.deflate(l,i))&&n!==c)return this.onEnd(n),!(this.ended=!0);0!==l.avail_out&&(0!==l.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(o.buf2binstring(s.shrinkBuf(l.output,l.next_out))):this.onData(s.shrinkBuf(l.output,l.next_out)))}while((0<l.avail_in||0===l.avail_out)&&1!==n);return 4===i?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===c):2!==i||(this.onEnd(c),!(l.avail_out=0))},g.prototype.onData=function(e){this.chunks.push(e)},g.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=g,n.deflate=f,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,f(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){var r=e("./zlib/inflate"),s=e("./utils/common"),o=e("./utils/strings"),i=e("./zlib/constants"),l=e("./zlib/messages"),a=e("./zlib/zstream"),c=e("./zlib/gzheader"),h=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==i.Z_OK)throw new Error(l[n]);this.header=new c,r.inflateGetHeader(this.strm,this.header)}function d(e,t){var n=new u(t);if(n.push(e,!0),n.err)throw n.msg||l[n.err];return n.result}u.prototype.push=function(e,t){var n,l,a,c,u,d,g=this.strm,f=this.options.chunkSize,m=this.options.dictionary,p=!1;if(this.ended)return!1;l=t===~~t?t:!0===t?i.Z_FINISH:i.Z_NO_FLUSH,"string"==typeof e?g.input=o.binstring2buf(e):"[object ArrayBuffer]"===h.call(e)?g.input=new Uint8Array(e):g.input=e,g.next_in=0,g.avail_in=g.input.length;do{if(0===g.avail_out&&(g.output=new s.Buf8(f),g.next_out=0,g.avail_out=f),(n=r.inflate(g,i.Z_NO_FLUSH))===i.Z_NEED_DICT&&m&&(d="string"==typeof m?o.string2buf(m):"[object ArrayBuffer]"===h.call(m)?new Uint8Array(m):m,n=r.inflateSetDictionary(this.strm,d)),n===i.Z_BUF_ERROR&&!0===p&&(n=i.Z_OK,p=!1),n!==i.Z_STREAM_END&&n!==i.Z_OK)return this.onEnd(n),!(this.ended=!0);g.next_out&&(0!==g.avail_out&&n!==i.Z_STREAM_END&&(0!==g.avail_in||l!==i.Z_FINISH&&l!==i.Z_SYNC_FLUSH)||("string"===this.options.to?(a=o.utf8border(g.output,g.next_out),c=g.next_out-a,u=o.buf2string(g.output,a),g.next_out=c,g.avail_out=f-c,c&&s.arraySet(g.output,g.output,a,c,0),this.onData(u)):this.onData(s.shrinkBuf(g.output,g.next_out)))),0===g.avail_in&&0===g.avail_out&&(p=!0)}while((0<g.avail_in||0===g.avail_out)&&n!==i.Z_STREAM_END);return n===i.Z_STREAM_END&&(l=i.Z_FINISH),l===i.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===i.Z_OK):l!==i.Z_SYNC_FLUSH||(this.onEnd(i.Z_OK),!(g.avail_out=0))},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===i.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=u,n.inflate=d,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},n.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var s={arraySet:function(e,t,n,r,s){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),s);else for(var o=0;o<r;o++)e[s+o]=t[n+o]},flattenChunks:function(e){var t,n,r,s,o,i;for(t=r=0,n=e.length;t<n;t++)r+=e[t].length;for(i=new Uint8Array(r),t=s=0,n=e.length;t<n;t++)o=e[t],i.set(o,s),s+=o.length;return i}},o={arraySet:function(e,t,n,r,s){for(var o=0;o<r;o++)e[s+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,s)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(r)},{}],42:[function(e,t,n){var r=e("./common"),s=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(c){s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){o=!1}for(var i=new r.Buf8(256),l=0;l<256;l++)i[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function a(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&s))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n}i[254]=i[254]=1,n.string2buf=function(e){var t,n,s,o,i,l=e.length,a=0;for(o=0;o<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<l&&56320==(64512&(s=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(s-56320),o++),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(a),o=i=0;i<a;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<l&&56320==(64512&(s=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(s-56320),o++),n<128?t[i++]=n:(n<2048?t[i++]=192|n>>>6:(n<65536?t[i++]=224|n>>>12:(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63),t[i++]=128|n>>>6&63),t[i++]=128|63&n);return t},n.buf2binstring=function(e){return a(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,s=t.length;n<s;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,s,o,l=t||e.length,c=new Array(2*l);for(n=r=0;n<l;)if((s=e[n++])<128)c[r++]=s;else if(4<(o=i[s]))c[r++]=65533,n+=o-1;else{for(s&=2===o?31:3===o?15:7;1<o&&n<l;)s=s<<6|63&e[n++],o--;1<o?c[r++]=65533:s<65536?c[r++]=s:(s-=65536,c[r++]=55296|s>>10&1023,c[r++]=56320|1023&s)}return a(c,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+i[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){t.exports=function(e,t,n,r){for(var s=65535&e|0,o=e>>>16&65535|0,i=0;0!==n;){for(n-=i=2e3<n?2e3:n;o=o+(s=s+t[r++]|0)|0,--i;);s%=65521,o%=65521}return s|o<<16|0}},{}],44:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,s){var o=r,i=s+n;e^=-1;for(var l=s;l<i;l++)e=e>>>8^o[255&(e^t[l])];return-1^e}},{}],46:[function(e,t,n){var r,s=e("../utils/common"),o=e("./trees"),i=e("./adler32"),l=e("./crc32"),a=e("./messages"),c=0,h=4,u=0,d=-2,g=-1,f=4,m=2,p=8,b=9,_=286,v=30,C=19,T=2*_+1,w=15,y=3,S=258,E=S+y+1,R=42,I=113,A=1,x=2,O=3,M=4;function N(e,t){return e.msg=a[t],t}function k(e){return(e<<1)-(4<e?9:0)}function L(e){for(var t=e.length;0<=--t;)e[t]=0}function D(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(s.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function P(e,t){o._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,D(e.strm)}function B(e,t){e.pending_buf[e.pending++]=t}function H(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function F(e,t){var n,r,s=e.max_chain_length,o=e.strstart,i=e.prev_length,l=e.nice_match,a=e.strstart>e.w_size-E?e.strstart-(e.w_size-E):0,c=e.window,h=e.w_mask,u=e.prev,d=e.strstart+S,g=c[o+i-1],f=c[o+i];e.prev_length>=e.good_match&&(s>>=2),l>e.lookahead&&(l=e.lookahead);do{if(c[(n=t)+i]===f&&c[n+i-1]===g&&c[n]===c[o]&&c[++n]===c[o+1]){o+=2,n++;do{}while(c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&o<d);if(r=S-(d-o),o=d-S,i<r){if(e.match_start=t,l<=(i=r))break;g=c[o+i-1],f=c[o+i]}}}while((t=u[t&h])>a&&0!=--s);return i<=e.lookahead?i:e.lookahead}function z(e){var t,n,r,o,a,c,h,u,d,g,f=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-E)){for(s.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=n=e.hash_size;r=e.head[--t],e.head[t]=f<=r?r-f:0,--n;);for(t=n=f;r=e.prev[--t],e.prev[t]=f<=r?r-f:0,--n;);o+=f}if(0===e.strm.avail_in)break;if(c=e.strm,h=e.window,u=e.strstart+e.lookahead,g=void 0,(d=o)<(g=c.avail_in)&&(g=d),n=0===g?0:(c.avail_in-=g,s.arraySet(h,c.input,c.next_in,g,u),1===c.state.wrap?c.adler=i(c.adler,h,g,u):2===c.state.wrap&&(c.adler=l(c.adler,h,g,u)),c.next_in+=g,c.total_in+=g,g),e.lookahead+=n,e.lookahead+e.insert>=y)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+y-1])&e.hash_mask,e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<y)););}while(e.lookahead<E&&0!==e.strm.avail_in)}function U(e,t){for(var n,r;;){if(e.lookahead<E){if(z(e),e.lookahead<E&&t===c)return A;if(0===e.lookahead)break}if(n=0,e.lookahead>=y&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+y-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-E&&(e.match_length=F(e,n)),e.match_length>=y)if(r=o._tr_tally(e,e.strstart-e.match_start,e.match_length-y),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=y){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+y-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(P(e,!1),0===e.strm.avail_out))return A}return e.insert=e.strstart<y-1?e.strstart:y-1,t===h?(P(e,!0),0===e.strm.avail_out?O:M):e.last_lit&&(P(e,!1),0===e.strm.avail_out)?A:x}function W(e,t){for(var n,r,s;;){if(e.lookahead<E){if(z(e),e.lookahead<E&&t===c)return A;if(0===e.lookahead)break}if(n=0,e.lookahead>=y&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+y-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=y-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-E&&(e.match_length=F(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===y&&4096<e.strstart-e.match_start)&&(e.match_length=y-1)),e.prev_length>=y&&e.match_length<=e.prev_length){for(s=e.strstart+e.lookahead-y,r=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-y),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=s&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+y-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=y-1,e.strstart++,r&&(P(e,!1),0===e.strm.avail_out))return A}else if(e.match_available){if((r=o._tr_tally(e,0,e.window[e.strstart-1]))&&P(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return A}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<y-1?e.strstart:y-1,t===h?(P(e,!0),0===e.strm.avail_out?O:M):e.last_lit&&(P(e,!1),0===e.strm.avail_out)?A:x}function V(e,t,n,r,s){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=s}function j(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=p,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*T),this.dyn_dtree=new s.Buf16(2*(2*v+1)),this.bl_tree=new s.Buf16(2*(2*C+1)),L(this.dyn_ltree),L(this.dyn_dtree),L(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(w+1),this.heap=new s.Buf16(2*_+1),L(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*_+1),L(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Y(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=m,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?R:I,e.adler=2===t.wrap?0:1,t.last_flush=c,o._tr_init(t),u):N(e,d)}function G(e){var t,n=Y(e);return n===u&&((t=e.state).window_size=2*t.w_size,L(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=y-1,t.match_available=0,t.ins_h=0),n}function X(e,t,n,r,o,i){if(!e)return d;var l=1;if(t===g&&(t=6),r<0?(l=0,r=-r):15<r&&(l=2,r-=16),o<1||b<o||n!==p||r<8||15<r||t<0||9<t||i<0||f<i)return N(e,d);8===r&&(r=9);var a=new j;return(e.state=a).strm=e,a.wrap=l,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=o+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+y-1)/y),a.window=new s.Buf8(2*a.w_size),a.head=new s.Buf16(a.hash_size),a.prev=new s.Buf16(a.w_size),a.lit_bufsize=1<<o+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new s.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=i,a.method=n,G(e)}r=[new V(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(z(e),0===e.lookahead&&t===c)return A;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,P(e,!1),0===e.strm.avail_out))return A;if(e.strstart-e.block_start>=e.w_size-E&&(P(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===h?(P(e,!0),0===e.strm.avail_out?O:M):(e.strstart>e.block_start&&(P(e,!1),e.strm.avail_out),A)})),new V(4,4,8,4,U),new V(4,5,16,8,U),new V(4,6,32,32,U),new V(4,4,16,16,W),new V(8,16,32,32,W),new V(8,16,128,128,W),new V(8,32,128,256,W),new V(32,128,258,1024,W),new V(32,258,258,4096,W)],n.deflateInit=function(e,t){return X(e,t,p,15,8,0)},n.deflateInit2=X,n.deflateReset=G,n.deflateResetKeep=Y,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?d:(e.state.gzhead=t,u):d},n.deflate=function(e,t){var n,s,i,a;if(!e||!e.state||5<t||t<0)return e?N(e,d):d;if(s=e.state,!e.output||!e.input&&0!==e.avail_in||666===s.status&&t!==h)return N(e,0===e.avail_out?-5:d);if(s.strm=e,n=s.last_flush,s.last_flush=t,s.status===R)if(2===s.wrap)e.adler=0,B(s,31),B(s,139),B(s,8),s.gzhead?(B(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),B(s,255&s.gzhead.time),B(s,s.gzhead.time>>8&255),B(s,s.gzhead.time>>16&255),B(s,s.gzhead.time>>24&255),B(s,9===s.level?2:2<=s.strategy||s.level<2?4:0),B(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(B(s,255&s.gzhead.extra.length),B(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=l(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(B(s,0),B(s,0),B(s,0),B(s,0),B(s,0),B(s,9===s.level?2:2<=s.strategy||s.level<2?4:0),B(s,3),s.status=I);else{var g=p+(s.w_bits-8<<4)<<8;g|=(2<=s.strategy||s.level<2?0:s.level<6?1:6===s.level?2:3)<<6,0!==s.strstart&&(g|=32),g+=31-g%31,s.status=I,H(s,g),0!==s.strstart&&(H(s,e.adler>>>16),H(s,65535&e.adler)),e.adler=1}if(69===s.status)if(s.gzhead.extra){for(i=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>i&&(e.adler=l(e.adler,s.pending_buf,s.pending-i,i)),D(e),i=s.pending,s.pending!==s.pending_buf_size));)B(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>i&&(e.adler=l(e.adler,s.pending_buf,s.pending-i,i)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(e.adler=l(e.adler,s.pending_buf,s.pending-i,i)),D(e),i=s.pending,s.pending===s.pending_buf_size)){a=1;break}a=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,B(s,a)}while(0!==a);s.gzhead.hcrc&&s.pending>i&&(e.adler=l(e.adler,s.pending_buf,s.pending-i,i)),0===a&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(e.adler=l(e.adler,s.pending_buf,s.pending-i,i)),D(e),i=s.pending,s.pending===s.pending_buf_size)){a=1;break}a=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,B(s,a)}while(0!==a);s.gzhead.hcrc&&s.pending>i&&(e.adler=l(e.adler,s.pending_buf,s.pending-i,i)),0===a&&(s.status=103)}else s.status=103;if(103===s.status&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&D(e),s.pending+2<=s.pending_buf_size&&(B(s,255&e.adler),B(s,e.adler>>8&255),e.adler=0,s.status=I)):s.status=I),0!==s.pending){if(D(e),0===e.avail_out)return s.last_flush=-1,u}else if(0===e.avail_in&&k(t)<=k(n)&&t!==h)return N(e,-5);if(666===s.status&&0!==e.avail_in)return N(e,-5);if(0!==e.avail_in||0!==s.lookahead||t!==c&&666!==s.status){var f=2===s.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(z(e),0===e.lookahead)){if(t===c)return A;break}if(e.match_length=0,n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(P(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===h?(P(e,!0),0===e.strm.avail_out?O:M):e.last_lit&&(P(e,!1),0===e.strm.avail_out)?A:x}(s,t):3===s.strategy?function(e,t){for(var n,r,s,i,l=e.window;;){if(e.lookahead<=S){if(z(e),e.lookahead<=S&&t===c)return A;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=y&&0<e.strstart&&(r=l[s=e.strstart-1])===l[++s]&&r===l[++s]&&r===l[++s]){i=e.strstart+S;do{}while(r===l[++s]&&r===l[++s]&&r===l[++s]&&r===l[++s]&&r===l[++s]&&r===l[++s]&&r===l[++s]&&r===l[++s]&&s<i);e.match_length=S-(i-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=y?(n=o._tr_tally(e,1,e.match_length-y),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(P(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===h?(P(e,!0),0===e.strm.avail_out?O:M):e.last_lit&&(P(e,!1),0===e.strm.avail_out)?A:x}(s,t):r[s.level].func(s,t);if(f!==O&&f!==M||(s.status=666),f===A||f===O)return 0===e.avail_out&&(s.last_flush=-1),u;if(f===x&&(1===t?o._tr_align(s):5!==t&&(o._tr_stored_block(s,0,0,!1),3===t&&(L(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),D(e),0===e.avail_out))return s.last_flush=-1,u}return t!==h?u:s.wrap<=0?1:(2===s.wrap?(B(s,255&e.adler),B(s,e.adler>>8&255),B(s,e.adler>>16&255),B(s,e.adler>>24&255),B(s,255&e.total_in),B(s,e.total_in>>8&255),B(s,e.total_in>>16&255),B(s,e.total_in>>24&255)):(H(s,e.adler>>>16),H(s,65535&e.adler)),D(e),0<s.wrap&&(s.wrap=-s.wrap),0!==s.pending?u:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==R&&69!==t&&73!==t&&91!==t&&103!==t&&t!==I&&666!==t?N(e,d):(e.state=null,t===I?N(e,-3):u):d},n.deflateSetDictionary=function(e,t){var n,r,o,l,a,c,h,g,f=t.length;if(!e||!e.state)return d;if(2===(l=(n=e.state).wrap)||1===l&&n.status!==R||n.lookahead)return d;for(1===l&&(e.adler=i(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===l&&(L(n.head),n.strstart=0,n.block_start=0,n.insert=0),g=new s.Buf8(n.w_size),s.arraySet(g,t,f-n.w_size,n.w_size,0),t=g,f=n.w_size),a=e.avail_in,c=e.next_in,h=e.input,e.avail_in=f,e.next_in=0,e.input=t,z(n);n.lookahead>=y;){for(r=n.strstart,o=n.lookahead-(y-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+y-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--o;);n.strstart=r,n.lookahead=y-1,z(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=y-1,n.match_available=0,e.next_in=c,e.input=h,e.avail_in=a,n.wrap=l,u},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){t.exports=function(e,t){var n,r,s,o,i,l,a,c,h,u,d,g,f,m,p,b,_,v,C,T,w,y,S,E,R;n=e.state,r=e.next_in,E=e.input,s=r+(e.avail_in-5),o=e.next_out,R=e.output,i=o-(t-e.avail_out),l=o+(e.avail_out-257),a=n.dmax,c=n.wsize,h=n.whave,u=n.wnext,d=n.window,g=n.hold,f=n.bits,m=n.lencode,p=n.distcode,b=(1<<n.lenbits)-1,_=(1<<n.distbits)-1;e:do{f<15&&(g+=E[r++]<<f,f+=8,g+=E[r++]<<f,f+=8),v=m[g&b];t:for(;;){if(g>>>=C=v>>>24,f-=C,0==(C=v>>>16&255))R[o++]=65535&v;else{if(!(16&C)){if(0==(64&C)){v=m[(65535&v)+(g&(1<<C)-1)];continue t}if(32&C){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}T=65535&v,(C&=15)&&(f<C&&(g+=E[r++]<<f,f+=8),T+=g&(1<<C)-1,g>>>=C,f-=C),f<15&&(g+=E[r++]<<f,f+=8,g+=E[r++]<<f,f+=8),v=p[g&_];n:for(;;){if(g>>>=C=v>>>24,f-=C,!(16&(C=v>>>16&255))){if(0==(64&C)){v=p[(65535&v)+(g&(1<<C)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(w=65535&v,f<(C&=15)&&(g+=E[r++]<<f,(f+=8)<C&&(g+=E[r++]<<f,f+=8)),a<(w+=g&(1<<C)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(g>>>=C,f-=C,(C=o-i)<w){if(h<(C=w-C)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(S=d,(y=0)===u){if(y+=c-C,C<T){for(T-=C;R[o++]=d[y++],--C;);y=o-w,S=R}}else if(u<C){if(y+=c+u-C,(C-=u)<T){for(T-=C;R[o++]=d[y++],--C;);if(y=0,u<T){for(T-=C=u;R[o++]=d[y++],--C;);y=o-w,S=R}}}else if(y+=u-C,C<T){for(T-=C;R[o++]=d[y++],--C;);y=o-w,S=R}for(;2<T;)R[o++]=S[y++],R[o++]=S[y++],R[o++]=S[y++],T-=3;T&&(R[o++]=S[y++],1<T&&(R[o++]=S[y++]))}else{for(y=o-w;R[o++]=R[y++],R[o++]=R[y++],R[o++]=R[y++],2<(T-=3););T&&(R[o++]=R[y++],1<T&&(R[o++]=R[y++]))}break}}break}}while(r<s&&o<l);r-=T=f>>3,g&=(1<<(f-=T<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<s?s-r+5:5-(r-s),e.avail_out=o<l?l-o+257:257-(o-l),n.hold=g,n.bits=f}},{}],49:[function(e,t,n){var r=e("../utils/common"),s=e("./adler32"),o=e("./crc32"),i=e("./inffast"),l=e("./inftrees"),a=1,c=2,h=0,u=-2,d=1,g=852,f=592;function m(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function p(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=d,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(g),t.distcode=t.distdyn=new r.Buf32(f),t.sane=1,t.back=-1,h):u}function _(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,b(e)):u}function v(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?u:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,_(e))):u}function C(e,t){var n,r;return e?(r=new p,(e.state=r).window=null,(n=v(e,t))!==h&&(e.state=null),n):u}var T,w,y=!0;function S(e){if(y){var t;for(T=new r.Buf32(512),w=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(l(a,e.lens,0,288,T,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;l(c,e.lens,0,32,w,0,e.work,{bits:5}),y=!1}e.lencode=T,e.lenbits=9,e.distcode=w,e.distbits=5}function E(e,t,n,s){var o,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new r.Buf8(i.wsize)),s>=i.wsize?(r.arraySet(i.window,t,n-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):(s<(o=i.wsize-i.wnext)&&(o=s),r.arraySet(i.window,t,n-s,o,i.wnext),(s-=o)?(r.arraySet(i.window,t,n-s,s,0),i.wnext=s,i.whave=i.wsize):(i.wnext+=o,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=o))),0}n.inflateReset=_,n.inflateReset2=v,n.inflateResetKeep=b,n.inflateInit=function(e){return C(e,15)},n.inflateInit2=C,n.inflate=function(e,t){var n,g,f,p,b,_,v,C,T,w,y,R,I,A,x,O,M,N,k,L,D,P,B,H,F=0,z=new r.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return u;12===(n=e.state).mode&&(n.mode=13),b=e.next_out,f=e.output,v=e.avail_out,p=e.next_in,g=e.input,_=e.avail_in,C=n.hold,T=n.bits,w=_,y=v,P=h;e:for(;;)switch(n.mode){case d:if(0===n.wrap){n.mode=13;break}for(;T<16;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}if(2&n.wrap&&35615===C){z[n.check=0]=255&C,z[1]=C>>>8&255,n.check=o(n.check,z,2,0),T=C=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&C)<<8)+(C>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&C)){e.msg="unknown compression method",n.mode=30;break}if(T-=4,D=8+(15&(C>>>=4)),0===n.wbits)n.wbits=D;else if(D>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<D,e.adler=n.check=1,n.mode=512&C?10:12,T=C=0;break;case 2:for(;T<16;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}if(n.flags=C,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=C>>8&1),512&n.flags&&(z[0]=255&C,z[1]=C>>>8&255,n.check=o(n.check,z,2,0)),T=C=0,n.mode=3;case 3:for(;T<32;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}n.head&&(n.head.time=C),512&n.flags&&(z[0]=255&C,z[1]=C>>>8&255,z[2]=C>>>16&255,z[3]=C>>>24&255,n.check=o(n.check,z,4,0)),T=C=0,n.mode=4;case 4:for(;T<16;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}n.head&&(n.head.xflags=255&C,n.head.os=C>>8),512&n.flags&&(z[0]=255&C,z[1]=C>>>8&255,n.check=o(n.check,z,2,0)),T=C=0,n.mode=5;case 5:if(1024&n.flags){for(;T<16;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}n.length=C,n.head&&(n.head.extra_len=C),512&n.flags&&(z[0]=255&C,z[1]=C>>>8&255,n.check=o(n.check,z,2,0)),T=C=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(_<(R=n.length)&&(R=_),R&&(n.head&&(D=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,g,p,R,D)),512&n.flags&&(n.check=o(n.check,g,R,p)),_-=R,p+=R,n.length-=R),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===_)break e;for(R=0;D=g[p+R++],n.head&&D&&n.length<65536&&(n.head.name+=String.fromCharCode(D)),D&&R<_;);if(512&n.flags&&(n.check=o(n.check,g,R,p)),_-=R,p+=R,D)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===_)break e;for(R=0;D=g[p+R++],n.head&&D&&n.length<65536&&(n.head.comment+=String.fromCharCode(D)),D&&R<_;);if(512&n.flags&&(n.check=o(n.check,g,R,p)),_-=R,p+=R,D)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;T<16;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}if(C!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}T=C=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;T<32;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}e.adler=n.check=m(C),T=C=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=b,e.avail_out=v,e.next_in=p,e.avail_in=_,n.hold=C,n.bits=T,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){C>>>=7&T,T-=7&T,n.mode=27;break}for(;T<3;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}switch(n.last=1&C,T-=1,3&(C>>>=1)){case 0:n.mode=14;break;case 1:if(S(n),n.mode=20,6!==t)break;C>>>=2,T-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}C>>>=2,T-=2;break;case 14:for(C>>>=7&T,T-=7&T;T<32;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}if((65535&C)!=(C>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&C,T=C=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(R=n.length){if(_<R&&(R=_),v<R&&(R=v),0===R)break e;r.arraySet(f,g,p,R,b),_-=R,p+=R,v-=R,b+=R,n.length-=R;break}n.mode=12;break;case 17:for(;T<14;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}if(n.nlen=257+(31&C),C>>>=5,T-=5,n.ndist=1+(31&C),C>>>=5,T-=5,n.ncode=4+(15&C),C>>>=4,T-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;T<3;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}n.lens[U[n.have++]]=7&C,C>>>=3,T-=3}for(;n.have<19;)n.lens[U[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,B={bits:n.lenbits},P=l(0,n.lens,0,19,n.lencode,0,n.work,B),n.lenbits=B.bits,P){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;O=(F=n.lencode[C&(1<<n.lenbits)-1])>>>16&255,M=65535&F,!((x=F>>>24)<=T);){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}if(M<16)C>>>=x,T-=x,n.lens[n.have++]=M;else{if(16===M){for(H=x+2;T<H;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}if(C>>>=x,T-=x,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}D=n.lens[n.have-1],R=3+(3&C),C>>>=2,T-=2}else if(17===M){for(H=x+3;T<H;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}T-=x,D=0,R=3+(7&(C>>>=x)),C>>>=3,T-=3}else{for(H=x+7;T<H;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}T-=x,D=0,R=11+(127&(C>>>=x)),C>>>=7,T-=7}if(n.have+R>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;R--;)n.lens[n.have++]=D}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,B={bits:n.lenbits},P=l(a,n.lens,0,n.nlen,n.lencode,0,n.work,B),n.lenbits=B.bits,P){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,B={bits:n.distbits},P=l(c,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,B),n.distbits=B.bits,P){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=_&&258<=v){e.next_out=b,e.avail_out=v,e.next_in=p,e.avail_in=_,n.hold=C,n.bits=T,i(e,y),b=e.next_out,f=e.output,v=e.avail_out,p=e.next_in,g=e.input,_=e.avail_in,C=n.hold,T=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;O=(F=n.lencode[C&(1<<n.lenbits)-1])>>>16&255,M=65535&F,!((x=F>>>24)<=T);){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}if(O&&0==(240&O)){for(N=x,k=O,L=M;O=(F=n.lencode[L+((C&(1<<N+k)-1)>>N)])>>>16&255,M=65535&F,!(N+(x=F>>>24)<=T);){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}C>>>=N,T-=N,n.back+=N}if(C>>>=x,T-=x,n.back+=x,n.length=M,0===O){n.mode=26;break}if(32&O){n.back=-1,n.mode=12;break}if(64&O){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&O,n.mode=22;case 22:if(n.extra){for(H=n.extra;T<H;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}n.length+=C&(1<<n.extra)-1,C>>>=n.extra,T-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;O=(F=n.distcode[C&(1<<n.distbits)-1])>>>16&255,M=65535&F,!((x=F>>>24)<=T);){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}if(0==(240&O)){for(N=x,k=O,L=M;O=(F=n.distcode[L+((C&(1<<N+k)-1)>>N)])>>>16&255,M=65535&F,!(N+(x=F>>>24)<=T);){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}C>>>=N,T-=N,n.back+=N}if(C>>>=x,T-=x,n.back+=x,64&O){e.msg="invalid distance code",n.mode=30;break}n.offset=M,n.extra=15&O,n.mode=24;case 24:if(n.extra){for(H=n.extra;T<H;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}n.offset+=C&(1<<n.extra)-1,C>>>=n.extra,T-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===v)break e;if(R=y-v,n.offset>R){if((R=n.offset-R)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}I=R>n.wnext?(R-=n.wnext,n.wsize-R):n.wnext-R,R>n.length&&(R=n.length),A=n.window}else A=f,I=b-n.offset,R=n.length;for(v<R&&(R=v),v-=R,n.length-=R;f[b++]=A[I++],--R;);0===n.length&&(n.mode=21);break;case 26:if(0===v)break e;f[b++]=n.length,v--,n.mode=21;break;case 27:if(n.wrap){for(;T<32;){if(0===_)break e;_--,C|=g[p++]<<T,T+=8}if(y-=v,e.total_out+=y,n.total+=y,y&&(e.adler=n.check=n.flags?o(n.check,f,y,b-y):s(n.check,f,y,b-y)),y=v,(n.flags?C:m(C))!==n.check){e.msg="incorrect data check",n.mode=30;break}T=C=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;T<32;){if(0===_)break e;_--,C+=g[p++]<<T,T+=8}if(C!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}T=C=0}n.mode=29;case 29:P=1;break e;case 30:P=-3;break e;case 31:return-4;case 32:default:return u}return e.next_out=b,e.avail_out=v,e.next_in=p,e.avail_in=_,n.hold=C,n.bits=T,(n.wsize||y!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&E(e,e.output,e.next_out,y-e.avail_out)?(n.mode=31,-4):(w-=e.avail_in,y-=e.avail_out,e.total_in+=w,e.total_out+=y,n.total+=y,n.wrap&&y&&(e.adler=n.check=n.flags?o(n.check,f,y,e.next_out-y):s(n.check,f,y,e.next_out-y)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==w&&0===y||4===t)&&P===h&&(P=-5),P)},n.inflateEnd=function(e){if(!e||!e.state)return u;var t=e.state;return t.window&&(t.window=null),e.state=null,h},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?u:((n.head=t).done=!1,h):u},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?u:11===n.mode&&s(1,t,r,0)!==n.check?-3:E(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,h):u},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){var r=e("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],i=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,a,c,h,u,d){var g,f,m,p,b,_,v,C,T,w=d.bits,y=0,S=0,E=0,R=0,I=0,A=0,x=0,O=0,M=0,N=0,k=null,L=0,D=new r.Buf16(16),P=new r.Buf16(16),B=null,H=0;for(y=0;y<=15;y++)D[y]=0;for(S=0;S<a;S++)D[t[n+S]]++;for(I=w,R=15;1<=R&&0===D[R];R--);if(R<I&&(I=R),0===R)return c[h++]=20971520,c[h++]=20971520,d.bits=1,0;for(E=1;E<R&&0===D[E];E++);for(I<E&&(I=E),y=O=1;y<=15;y++)if(O<<=1,(O-=D[y])<0)return-1;if(0<O&&(0===e||1!==R))return-1;for(P[1]=0,y=1;y<15;y++)P[y+1]=P[y]+D[y];for(S=0;S<a;S++)0!==t[n+S]&&(u[P[t[n+S]]++]=S);if(_=0===e?(k=B=u,19):1===e?(k=s,L-=257,B=o,H-=257,256):(k=i,B=l,-1),y=E,b=h,x=S=N=0,m=-1,p=(M=1<<(A=I))-1,1===e&&852<M||2===e&&592<M)return 1;for(;;){for(v=y-x,T=u[S]<_?(C=0,u[S]):u[S]>_?(C=B[H+u[S]],k[L+u[S]]):(C=96,0),g=1<<y-x,E=f=1<<A;c[b+(N>>x)+(f-=g)]=v<<24|C<<16|T|0,0!==f;);for(g=1<<y-1;N&g;)g>>=1;if(0!==g?(N&=g-1,N+=g):N=0,S++,0==--D[y]){if(y===R)break;y=t[n+u[S]]}if(I<y&&(N&p)!==m){for(0===x&&(x=I),b+=E,O=1<<(A=y-x);A+x<R&&!((O-=D[A+x])<=0);)A++,O<<=1;if(M+=1<<A,1===e&&852<M||2===e&&592<M)return 1;c[m=N&p]=I<<24|A<<16|b-h|0}}return 0!==N&&(c[b+N]=y-x<<24|64<<16|0),d.bits=I,0}},{"../utils/common":41}],51:[function(e,t,n){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){var r=e("../utils/common"),s=0,o=1;function i(e){for(var t=e.length;0<=--t;)e[t]=0}var l=0,a=29,c=256,h=c+1+a,u=30,d=19,g=2*h+1,f=15,m=16,p=7,b=256,_=16,v=17,C=18,T=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],w=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=new Array(2*(h+2));i(E);var R=new Array(2*u);i(R);var I=new Array(512);i(I);var A=new Array(256);i(A);var x=new Array(a);i(x);var O,M,N,k=new Array(u);function L(e,t,n,r,s){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=s,this.has_stree=e&&e.length}function D(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function P(e){return e<256?I[e]:I[256+(e>>>7)]}function B(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function H(e,t,n){e.bi_valid>m-n?(e.bi_buf|=t<<e.bi_valid&65535,B(e,e.bi_buf),e.bi_buf=t>>m-e.bi_valid,e.bi_valid+=n-m):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function F(e,t,n){H(e,n[2*t],n[2*t+1])}function z(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function U(e,t,n){var r,s,o=new Array(f+1),i=0;for(r=1;r<=f;r++)o[r]=i=i+n[r-1]<<1;for(s=0;s<=t;s++){var l=e[2*s+1];0!==l&&(e[2*s]=z(o[l]++,l))}}function W(e){var t;for(t=0;t<h;t++)e.dyn_ltree[2*t]=0;for(t=0;t<u;t++)e.dyn_dtree[2*t]=0;for(t=0;t<d;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*b]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function V(e){8<e.bi_valid?B(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function j(e,t,n,r){var s=2*t,o=2*n;return e[s]<e[o]||e[s]===e[o]&&r[t]<=r[n]}function Y(e,t,n){for(var r=e.heap[n],s=n<<1;s<=e.heap_len&&(s<e.heap_len&&j(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!j(t,r,e.heap[s],e.depth));)e.heap[n]=e.heap[s],n=s,s<<=1;e.heap[n]=r}function G(e,t,n){var r,s,o,i,l=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],s=e.pending_buf[e.l_buf+l],l++,0===r?F(e,s,t):(F(e,(o=A[s])+c+1,t),0!==(i=T[o])&&H(e,s-=x[o],i),F(e,o=P(--r),n),0!==(i=w[o])&&H(e,r-=k[o],i)),l<e.last_lit;);F(e,b,t)}function X(e,t){var n,r,s,o=t.dyn_tree,i=t.stat_desc.static_tree,l=t.stat_desc.has_stree,a=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=g,n=0;n<a;n++)0!==o[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(s=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[s]=0,e.opt_len--,l&&(e.static_len-=i[2*s+1]);for(t.max_code=c,n=e.heap_len>>1;1<=n;n--)Y(e,o,n);for(s=a;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Y(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*s]=o[2*n]+o[2*r],e.depth[s]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=s,e.heap[1]=s++,Y(e,o,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,s,o,i,l,a=t.dyn_tree,c=t.max_code,h=t.stat_desc.static_tree,u=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,p=t.stat_desc.max_length,b=0;for(o=0;o<=f;o++)e.bl_count[o]=0;for(a[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<g;n++)p<(o=a[2*a[2*(r=e.heap[n])+1]+1]+1)&&(o=p,b++),a[2*r+1]=o,c<r||(e.bl_count[o]++,i=0,m<=r&&(i=d[r-m]),l=a[2*r],e.opt_len+=l*(o+i),u&&(e.static_len+=l*(h[2*r+1]+i)));if(0!==b){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,b-=2}while(0<b);for(o=p;0!==o;o--)for(r=e.bl_count[o];0!==r;)c<(s=e.heap[--n])||(a[2*s+1]!==o&&(e.opt_len+=(o-a[2*s+1])*a[2*s],a[2*s+1]=o),r--)}}(e,t),U(o,c,e.bl_count)}function $(e,t,n){var r,s,o=-1,i=t[1],l=0,a=7,c=4;for(0===i&&(a=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)s=i,i=t[2*(r+1)+1],++l<a&&s===i||(l<c?e.bl_tree[2*s]+=l:0!==s?(s!==o&&e.bl_tree[2*s]++,e.bl_tree[2*_]++):l<=10?e.bl_tree[2*v]++:e.bl_tree[2*C]++,o=s,c=(l=0)===i?(a=138,3):s===i?(a=6,3):(a=7,4))}function Q(e,t,n){var r,s,o=-1,i=t[1],l=0,a=7,c=4;for(0===i&&(a=138,c=3),r=0;r<=n;r++)if(s=i,i=t[2*(r+1)+1],!(++l<a&&s===i)){if(l<c)for(;F(e,s,e.bl_tree),0!=--l;);else 0!==s?(s!==o&&(F(e,s,e.bl_tree),l--),F(e,_,e.bl_tree),H(e,l-3,2)):l<=10?(F(e,v,e.bl_tree),H(e,l-3,3)):(F(e,C,e.bl_tree),H(e,l-11,7));o=s,c=(l=0)===i?(a=138,3):s===i?(a=6,3):(a=7,4)}}i(k);var K=!1;function Z(e,t,n,s){var o,i,a,c;H(e,(l<<1)+(s?1:0),3),i=t,a=n,c=!0,V(o=e),c&&(B(o,a),B(o,~a)),r.arraySet(o.pending_buf,o.window,i,a,o.pending),o.pending+=a}n._tr_init=function(e){K||(function(){var e,t,n,r,s,o=new Array(f+1);for(r=n=0;r<a-1;r++)for(x[r]=n,e=0;e<1<<T[r];e++)A[n++]=r;for(A[n-1]=r,r=s=0;r<16;r++)for(k[r]=s,e=0;e<1<<w[r];e++)I[s++]=r;for(s>>=7;r<u;r++)for(k[r]=s<<7,e=0;e<1<<w[r]-7;e++)I[256+s++]=r;for(t=0;t<=f;t++)o[t]=0;for(e=0;e<=143;)E[2*e+1]=8,e++,o[8]++;for(;e<=255;)E[2*e+1]=9,e++,o[9]++;for(;e<=279;)E[2*e+1]=7,e++,o[7]++;for(;e<=287;)E[2*e+1]=8,e++,o[8]++;for(U(E,h+1,o),e=0;e<u;e++)R[2*e+1]=5,R[2*e]=z(e,5);O=new L(E,T,c+1,h,f),M=new L(R,w,0,u,f),N=new L(new Array(0),y,0,d,p)}(),K=!0),e.l_desc=new D(e.dyn_ltree,O),e.d_desc=new D(e.dyn_dtree,M),e.bl_desc=new D(e.bl_tree,N),e.bi_buf=0,e.bi_valid=0,W(e)},n._tr_stored_block=Z,n._tr_flush_block=function(e,t,n,r){var i,l,a=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return s;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return o;for(t=32;t<c;t++)if(0!==e.dyn_ltree[2*t])return o;return s}(e)),X(e,e.l_desc),X(e,e.d_desc),a=function(e){var t;for($(e,e.dyn_ltree,e.l_desc.max_code),$(e,e.dyn_dtree,e.d_desc.max_code),X(e,e.bl_desc),t=d-1;3<=t&&0===e.bl_tree[2*S[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(l=e.static_len+3+7>>>3)<=i&&(i=l)):i=l=n+5,n+4<=i&&-1!==t?Z(e,t,n,r):4===e.strategy||l===i?(H(e,2+(r?1:0),3),G(e,E,R)):(H(e,4+(r?1:0),3),function(e,t,n,r){var s;for(H(e,t-257,5),H(e,n-1,5),H(e,r-4,4),s=0;s<r;s++)H(e,e.bl_tree[2*S[s]+1],3);Q(e,e.dyn_ltree,t-1),Q(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),G(e,e.dyn_ltree,e.dyn_dtree)),W(e),r&&V(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(A[n]+c+1)]++,e.dyn_dtree[2*P(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){var t;H(e,2,3),F(e,b,E),16===(t=e).bi_valid?(B(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,n){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,n){(function(e){!function(e,t){if(!e.setImmediate){var n,r,s,o,i=1,l={},a=!1,c=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,n="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick((function(){d(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(o="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",g,!1):e.attachEvent("onmessage",g),function(t){e.postMessage(o+t,"*")}):e.MessageChannel?((s=new MessageChannel).port1.onmessage=function(e){d(e.data)},function(e){s.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(r=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){d(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):function(e){setTimeout(d,0,e)},h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var s={callback:e,args:t};return l[i]=s,n(i),i++},h.clearImmediate=u}function u(e){delete l[e]}function d(e){if(a)setTimeout(d,0,e);else{var n=l[e];if(n){a=!0;try{!function(e){var n=e.callback,r=e.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(t,r)}}(n)}finally{u(e),a=!1}}}}function g(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&d(+t.data.slice(o.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==ln?ln:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)}(rR);var sR=rR.exports,oR=function(e,t){return(oR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};
/*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** */function iR(e,t){function n(){this.constructor=e}oR(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var lR=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],aR={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25},cR="docProps/core.xml",hR="docProps/app.xml",uR="xl/styles.xml",dR="s",gR={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@"},fR={0:"00000000",1:"00FFFFFF",2:"00FF0000",3:"0000FF00",4:"000000FF",5:"00FFFF00",6:"00FF00FF",7:"0000FFFF",8:"00000000",9:"00FFFFFF",10:"00FF0000",11:"0000FF00",12:"000000FF",13:"00FFFF00",14:"00FF00FF",15:"0000FFFF",16:"00800000",17:"00008000",18:"00000080",19:"00808000",20:"00800080",21:"00008080",22:"00C0C0C0",23:"00808080",24:"009999FF",25:"00993366",26:"00FFFFCC",27:"00CCFFFF",28:"00660066",29:"00FF8080",30:"000066CC",31:"00CCCCFF",32:"00000080",33:"00FF00FF",34:"00FFFF00",35:"0000FFFF",36:"00800080",37:"00800000",38:"00008080",39:"000000FF",40:"0000CCFF",41:"00CCFFFF",42:"00CCFFCC",43:"00FFFF99",44:"0099CCFF",45:"00FF99CC",46:"00CC99FF",47:"00FFCC99",48:"003366FF",49:"0033CCCC",50:"0099CC00",51:"00FFCC00",52:"00FF9900",53:"00FF6600",54:"00666699",55:"00969696",56:"00003366",57:"00339966",58:"00003300",59:"00333300",60:"00993300",61:"00993366",62:"00333399",63:"00333333",64:null,65:null},mR={none:0,thin:1,hair:2,dotted:3,dashed:4,dashDot:5,dashDotDot:6,double:7,medium:8,mediumDashed:9,mediumDashDot:10,mediumDashDotDot:11,slantDashDot:12,thick:13},pR={0:"defualt",1:"Roman",2:"Swiss",3:"Modern",4:"Script",5:"Decorative"};function bR(e,t,n){void 0===t&&(t={}),void 0===n&&(n="1");var r=e.split("!"),s="",o="",i=-1;if(r.length>1){s=r[0],o=r[1];var l=t[s];i=null==l?parseInt(n):parseInt(l)}else i=parseInt(n),o=r[0];if(-1==o.indexOf(":")){var a=parseInt(o.replace(/[^0-9]/g,""))-1,c=_R(o.replace(/[^A-Za-z]/g,""));return isNaN(a)||isNaN(c)?null:{row:[a,a],column:[c,c],sheetIndex:i}}var h=o.split(":");c=[];return(a=[])[0]=parseInt(h[0].replace(/[^0-9]/g,""))-1,a[1]=parseInt(h[1].replace(/[^0-9]/g,""))-1,a[0]>a[1]?null:(c[0]=_R(h[0].replace(/[^A-Za-z]/g,"")),c[1]=_R(h[1].replace(/[^A-Za-z]/g,"")),c[0]>c[1]?null:{row:a,column:c,sheetIndex:i})}function _R(e){var t=(e=e.toUpperCase()).length;if(0==t)return NaN;for(var n=e.split(""),r=lR.length,s=0,o=t-1;o>=0;o--)s+=o==t-1?aR[n[o]]:Math.pow(r,t-o-1)*(aR[n[o]]+1);return s}function vR(e){var t=lR.length;if(e<t)return lR[e];for(var n=0,r="",s=1,o=0;e>=t/(t-1)*(Math.pow(t,s++)-1);)o=s;n=e-t/(t-1)*(Math.pow(t,o-1)-1)+1;for(var i=o;i>0;i--){var l=n;if(1==i)return 0==(l%=t)&&(l=26),r+lR[l-1];l=Math.ceil(l/Math.pow(t,i-1)),r+=lR[l-1],i>1&&(n-=(l-1)*t)}}function CR(e){return null==e?0:72*(e/914400)/.75}function TR(e,t,n){var r=e[t];return r=null==r?n:r}function wR(e){return Math.round(8*(e-.83)+5)}function yR(e){return Math.round(e/.75)}function SR(e,t){var n=e.substring(e.length-6,e.length),r=function(e){var t=e.toLowerCase(),n=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(t&&n.test(t)){if(4===t.length){for(var r="#",s=1;s<4;s+=1)r+=t.slice(s,s+1).concat(t.slice(s,s+1));t=r}var o=[];for(s=1;s<7;s+=2)o.push(parseInt("0x"+t.slice(s,s+2)));return o}return null}("#"+n),s=function(e,t,n){e/=255,t/=255,n/=255;var r,s,o=Math.max(e,t,n),i=Math.min(e,t,n),l=(o+i)/2;if(o==i)r=s=0;else{var a=o-i;switch(s=l>.5?a/(2-o-i):a/(o+i),o){case e:r=(t-n)/a+(t<n?6:0);break;case t:r=(n-e)/a+2;break;case n:r=(e-t)/a+4}r/=6}return[r,s,l]}(r[0],r[1],r[2]);if(t>0)s[2]=s[2]*(1-t)+t;else{if(!(t<0))return"#"+n;s[2]=s[2]*(1+t)}return function(e){var t=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(/^(rgb|RGB)/.test(e)){for(var n=e.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),r="#",s=0;s<n.length;s++){var o=Number(n[s]).toString(16);o.length<2&&(o="0"+o),r+=o}return 7!==r.length&&(r=e),r}if(t.test(e)){var i=e.replace(/#/,"").split("");if(6===i.length)return e;if(3===i.length){var l="#";for(s=0;s<i.length;s+=1)l+=i[s]+i[s];return l}}return e}("RGB("+function(e,t,n){var r,s,o;if(0==t)r=s=o=n;else{var i=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},l=n<.5?n*(1+t):n+t-n*t,a=2*n-l;r=i(a,l,e+1/3),s=i(a,l,e),o=i(a,l,e-1/3)}return[Math.round(255*r),Math.round(255*s),Math.round(255*o)]}(s[0],s[1],s[2]).join(",")+")")}function ER(e){null==e&&(e="Sheet");for(var t=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),n="",r=0;r<5;r++)n+=t[Math.round(Math.random()*(t.length-1))];return e+"_"+n+"_"+(new Date).getTime()}function RR(e){return null==e||0==e.length?e:e.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&apos;/g,"'").replace(/&iexcl;/g,"").replace(/&cent;/g,"").replace(/&pound;/g,"").replace(/&curren;/g,"").replace(/&yen;/g,"").replace(/&brvbar;/g,"").replace(/&sect;/g,"").replace(/&uml;/g,"").replace(/&copy;/g,"").replace(/&ordf;/g,"").replace(/&laquo;/g,"").replace(/&not;/g,"").replace(/&shy;/g,"").replace(/&reg;/g,"").replace(/&macr;/g,"").replace(/&deg;/g,"").replace(/&plusmn;/g,"").replace(/&sup2;/g,"").replace(/&sup3;/g,"").replace(/&acute;/g,"").replace(/&micro;/g,"").replace(/&para;/g,"").replace(/&middot;/g,"").replace(/&cedil;/g,"").replace(/&sup1;/g,"").replace(/&ordm;/g,"").replace(/&raquo;/g,"").replace(/&frac14;/g,"").replace(/&frac12;/g,"").replace(/&frac34;/g,"").replace(/&iquest;/g,"").replace(/&times;/g,"").replace(/&divide;/g,"").replace(/&Agrave;/g,"").replace(/&Aacute;/g,"").replace(/&Acirc;/g,"").replace(/&Atilde;/g,"").replace(/&Auml;/g,"").replace(/&Aring;/g,"").replace(/&AElig;/g,"").replace(/&Ccedil;/g,"").replace(/&Egrave;/g,"").replace(/&Eacute;/g,"").replace(/&Ecirc;/g,"").replace(/&Euml;/g,"").replace(/&Igrave;/g,"").replace(/&Iacute;/g,"").replace(/&Icirc;/g,"").replace(/&Iuml;/g,"").replace(/&ETH;/g,"").replace(/&Ntilde;/g,"").replace(/&Ograve;/g,"").replace(/&Oacute;/g,"").replace(/&Ocirc;/g,"").replace(/&Otilde;/g,"").replace(/&Ouml;/g,"").replace(/&Oslash;/g,"").replace(/&Ugrave;/g,"").replace(/&Uacute;/g,"").replace(/&Ucirc;/g,"").replace(/&Uuml;/g,"").replace(/&Yacute;/g,"").replace(/&THORN;/g,"").replace(/&szlig;/g,"").replace(/&agrave;/g,"").replace(/&aacute;/g,"").replace(/&acirc;/g,"").replace(/&atilde;/g,"").replace(/&auml;/g,"").replace(/&aring;/g,"").replace(/&aelig;/g,"").replace(/&ccedil;/g,"").replace(/&egrave;/g,"").replace(/&eacute;/g,"").replace(/&ecirc;/g,"").replace(/&euml;/g,"").replace(/&igrave;/g,"").replace(/&iacute;/g,"").replace(/&icirc;/g,"").replace(/&iuml;/g,"").replace(/&eth;/g,"").replace(/&ntilde;/g,"").replace(/&ograve;/g,"").replace(/&oacute;/g,"").replace(/&ocirc;/g,"").replace(/&otilde;/g,"").replace(/&ouml;/g,"").replace(/&oslash;/g,"").replace(/&ugrave;/g,"").replace(/&uacute;/g,"").replace(/&ucirc;/g,"").replace(/&uuml;/g,"").replace(/&yacute;/g,"").replace(/&thorn;/g,"").replace(/&yuml;/g,"")}var IR=function(){function e(){}return e.trim=function(e){return null==e&&(e=""),e.replace(/(^\s*)|(\s*$)/g,"")},e.functionCopy=function(e,t,n){var r=this;if(null==r.operatorjson){for(var s=r.operator.split("|"),o={},i=0;i<s.length;i++)o[s[i].toString()]=1;r.operatorjson=o}null==t&&(t="down"),null==n&&(n=1),"="==e.substr(0,1)&&(e=e.substr(1));for(var l=e.split(""),a=0,c="",h="",u={bracket:0,comma:0,squote:0,dquote:0};a<l.length;){var d=l[a];if("("==d&&0==u.dquote)u.bracket+=1,c.length>0?h+=c+"(":h+="(",c="";else if(")"==d&&0==u.dquote)u.bracket-=1,h+=r.functionCopy(c,t,n)+")",c="";else if('"'==d&&0==u.squote)u.dquote>0?(h+=c+'"',u.dquote-=1,c=""):(u.dquote+=1,c+='"');else if(","==d&&0==u.dquote)h+=r.functionCopy(c,t,n)+",",c="";else if("&"==d&&0==u.dquote)c.length>0?(h+=r.functionCopy(c,t,n)+"&",c=""):h+="&";else if(d in r.operatorjson&&0==u.dquote){var g="";a+1<l.length&&(g=l[a+1]);var f=a-1,m=null;if(f>=0)do{m=l[f--]}while(f>=0&&" "==m);d+g in r.operatorjson?(c.length>0?(h+=r.functionCopy(c,t,n)+d+g,c=""):h+=d+g,a++):/[^0-9]/.test(g)||"-"!=d||"("!=m&&null!=m&&","!=m&&" "!=m&&!(m in r.operatorjson)?c.length>0?(h+=r.functionCopy(c,t,n)+d,c=""):h+=d:c+=d}else c+=d;a==l.length-1&&(r.iscelldata(r.trim(c))?"down"==t?h+=r.downparam(r.trim(c),n):"up"==t?h+=r.upparam(r.trim(c),n):"left"==t?h+=r.leftparam(r.trim(c),n):"right"==t&&(h+=r.rightparam(r.trim(c),n)):h+=r.trim(c)),a++}return h},e.downparam=function(e,t){return this.updateparam("d",e,t)},e.upparam=function(e,t){return this.updateparam("u",e,t)},e.leftparam=function(e,t){return this.updateparam("l",e,t)},e.rightparam=function(e,t){return this.updateparam("r",e,t)},e.updateparam=function(e,t,n){var r,s=this,o=t.split("!"),i="";if(o.length>1?(r=o[1],i=o[0]+"!"):r=o[0],-1==r.indexOf(":")){var l=parseInt(r.replace(/[^0-9]/g,"")),a=_R(r.replace(/[^A-Za-z]/g,"")),c=s.isfreezonFuc(r),h=c[0]?"$":"",u=c[1]?"$":"";return"u"!=e||c[0]?"r"!=e||c[1]?"l"!=e||c[1]?c[0]||(l+=n):a-=n:a+=n:l-=n,l<0||a<0?s.error.r:isNaN(l)||isNaN(a)?isNaN(l)?isNaN(a)?t:i+u+vR(a):i+h+l:i+u+vR(a)+h+l}r=r.split(":");a=[];if((l=[])[0]=parseInt(r[0].replace(/[^0-9]/g,"")),l[1]=parseInt(r[1].replace(/[^0-9]/g,"")),l[0]>l[1])return t;if(a[0]=_R(r[0].replace(/[^A-Za-z]/g,"")),a[1]=_R(r[1].replace(/[^A-Za-z]/g,"")),a[0]>a[1])return t;var d=s.isfreezonFuc(r[0]),g=s.isfreezonFuc(r[1]),f=d[0]?"$":"",m=d[1]?"$":"",p=g[0]?"$":"",b=g[1]?"$":"";return"u"==e?(d[0]||(l[0]-=n),g[0]||(l[1]-=n)):"r"==e?(d[1]||(a[0]+=n),g[1]||(a[1]+=n)):"l"==e?(d[1]||(a[0]-=n),g[1]||(a[1]-=n)):(d[0]||(l[0]+=n),g[0]||(l[1]+=n)),l[0]<0||a[0]<0?s.error.r:isNaN(a[0])&&isNaN(a[1])?i+f+l[0]+":"+p+l[1]:isNaN(l[0])&&isNaN(l[1])?i+m+vR(a[0])+":"+b+vR(a[1]):i+m+vR(a[0])+f+l[0]+":"+b+vR(a[1])+p+l[1]},e.iscelldata=function(e){var t,n=e.split("!"),r=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if(-1==(t=n.length>1?n[1]:n[0]).indexOf(":")){var s=parseInt(t.replace(/[^0-9]/g,""))-1,o=_R(t.replace(/[^A-Za-z]/g,""));return!(isNaN(s)||isNaN(o)||!t.toString().match(/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g))||!!isNaN(s)&&(isNaN(o),!1)}r=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,t=t.split(":");o=[];return(s=[])[0]=parseInt(t[0].replace(/[^0-9]/g,""))-1,s[1]=parseInt(t[1].replace(/[^0-9]/g,""))-1,!(s[0]>s[1])&&(o[0]=_R(t[0].replace(/[^A-Za-z]/g,"")),o[1]=_R(t[1].replace(/[^A-Za-z]/g,"")),!(o[0]>o[1])&&!(!t[0].toString().match(r)||!t[1].toString().match(r)))},e.isfreezonFuc=function(e){var t=e.replace(/[^0-9]/g,""),n=e.replace(/[^A-Za-z]/g,""),r=e.substr(e.indexOf(t)-1,1),s=e.substr(e.indexOf(n)-1,1),o=[!1,!1];return"$"==r&&(o[0]=!0),"$"==s&&(o[1]=!0),o},e.operator="==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",e.error={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},e.operatorjson=null,e}();function AR(e){return!/[^\u0800-\u4e00]/.test(e)}function xR(e,t){var n,r,s;t||(t={});var o=function(){try{return new window.XMLHttpRequest}catch(e){}},i="undefined"!=typeof window&&window.ActiveXObject?function(){return o()||function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}()}:o;"function"==typeof t?(s=t,t={}):"function"==typeof t.callback&&(s=t.callback),n=function(e){s(null,e)},r=function(e){s(e,null)};try{var l=i();l.open("GET",e,!0),"responseType"in l&&(l.responseType="arraybuffer"),l.overrideMimeType&&l.overrideMimeType("text/plain; charset=x-user-defined"),l.onreadystatechange=function(t){if(4===l.readyState)if(200===l.status||0===l.status)try{n((s=l).response||s.responseText)}catch(o){r(new Error(o))}else r(new Error("Ajax error for "+e+" : "+this.status+" "+this.statusText));var s},t.progress&&(l.onprogress=function(n){t.progress({path:e,originalEvent:n,percent:n.loaded/n.total*100,loaded:n.loaded,total:n.total})}),l.send()}catch(a){r(new Error(a))}}var OR=function(){function e(){}return e.prototype.getElementsByOneTag=function(e,t){var n;if(e.indexOf("|")>-1){for(var r=e.split("|"),s="",o=0;o<r.length;o++){var i=r[o];s+="|<"+i+" [^>]+?[^/]>[\\s\\S]*?</"+i+">|<"+i+" [^>]+?/>|<"+i+">[\\s\\S]*?</"+i+">|<"+i+"/>"}s=s.substr(1,s.length),n=new RegExp(s,"g")}else n=new RegExp("<"+e+" [^>]+?[^/]>[\\s\\S]*?</"+e+">|<"+e+" [^>]+?/>|<"+e+">[\\s\\S]*?</"+e+">|<"+e+"/>","g");var l=t.match(n);return null==l?[]:l},e}(),MR=function(e){function t(t){var n=e.call(this)||this;return n.originFile=t,n}return iR(t,e),t.prototype.getElementsByTagName=function(e,t){var n,r=this.getFileByName(t),s=e.split("/");for(var o in s){var i=s[o];if(null==n)n=this.getElementsByOneTag(i,r);else if(n instanceof Array){var l=[];for(var a in n){var c=n[a];l=l.concat(this.getElementsByOneTag(i,c))}n=l}else n=this.getElementsByOneTag(i,n)}for(var h=[],u=0;u<n.length;u++){var d=new NR(n[u]);h.push(d)}return h},t.prototype.getFileByName=function(e){for(var t in this.originFile)if(t.indexOf(e)>-1)return this.originFile[t];return""},t}(OR),NR=function(e){function t(t){var n=e.call(this)||this;n.elementString=t,n.setValue();var r=new RegExp('[a-zA-Z0-9_:]*?=".*?"',"g"),s=n.container.match(r);if(n.attributeList={},null!=s)for(var o in s){var i=s[o];if(0!=i.length){var l=i.substr(0,i.indexOf("=")),a=i.substr(i.indexOf("=")+1);null!=l&&null!=a&&0!=l.length&&0!=a.length&&(n.attributeList[l]=a.substr(1,a.length-2))}}return n}return iR(t,e),t.prototype.get=function(e){return this.attributeList[e]},t.prototype.getInnerElements=function(e){for(var n=this.getElementsByOneTag(e,this.elementString),r=[],s=0;s<n.length;s++){var o=new t(n[s]);r.push(o)}return 0==r.length?null:r},t.prototype.setValue=function(){var e=this.elementString;if("/>"==e.substr(e.length-2,2))this.value="",this.container=e;else{var t=this.getFirstTag(),n=new RegExp("(<"+t+" [^>]+?[^/]>)([\\s\\S]*?)</"+t+">|(<"+t+">)([\\s\\S]*?)</"+t+">","g").exec(e);null!=n&&(null!=n[1]?(this.container=n[1],this.value=n[2]):(this.container=n[3],this.value=n[4]))}},t.prototype.getFirstTag=function(){var e=this.elementString,t=e.substr(0,e.indexOf(" "));return(""==t||t.indexOf(">")>-1)&&(t=e.substr(0,e.indexOf(">"))),t=t.substr(1,t.length)},t}(OR);function kR(e,t,n){var r=e.attributeList,s=t.clrScheme,o=t.indexedColors;t.mruColors;var i,l=function(e,t){var n={};if(null==e||0==e.length)return t;for(var r in t){var s=t[r],o=e[parseInt(r)];if(null==o)n[r]=s;else{var i=o.attributeList.rgb;n[r]=i}}return n}(o,fR),a=r.indexed,c=r.rgb,h=r.theme,u=r.tint;if(null!=a)null!=(i=l[parseInt(a)])&&(i="#"+(i=i.substring(i.length-6,i.length)));else if(null!=c)i="#"+(c=c.substring(c.length-6,c.length));else if(null!=h){var d=parseInt(h);0==d?d=1:1==d?d=0:2==d?d=3:3==d&&(d=2);var g=s[d];if(null!=g){var f=g.getInnerElements("a:sysClr|a:srgbClr");if(null!=f){var m=f[0],p=m.attributeList;m.container.indexOf("sysClr")>-1?null!=p.lastClr?i="#"+p.lastClr:null!=p.val&&(i="#"+p.val):m.container.indexOf("srgbClr")>-1&&(i="#"+p.val)}}}if(null!=u){var b=parseFloat(u);null!=i&&(i=SR(i,b))}return i}function LR(e,t){var n,r=e.getInnerElements(t);if(null!=r&&r.length>0)if("b"==t||"i"==t||"strike"==t)n="1";else if("u"==t){n="double"==(s=r[0].attributeList.val)?"2":"singleAccounting"==s?"3":"doubleAccounting"==s?"4":"1"}else if("vertAlign"==t){var s;"subscript"==(s=r[0].attributeList.val)?n="1":"superscript"==s&&(n="2")}else n=r[0].attributeList.val;return n}var DR=function(){},PR=function(){},BR=function(){},HR=function(){},FR=function(){},zR=function(){},UR=function(){},WR=function(){},VR=function(){},jR=function(){},YR=function(){},GR=function(){},XR=function(){},$R=function(){},QR=function(e){function t(t,n,r,s,o,i){var l=e.call(this)||this;l.cell=t,l.sheetFile=o,l.styles=n,l.sharedStrings=r,l.readXml=i,l.mergeCells=s;var a=t.attributeList,c=a.r,h=a.s,u=a.t,d=bR(c);return l.r=d.row[0],l.c=d.column[0],l.v=l.generateValue(h,u),l}return iR(t,e),t.prototype.generateValue=function(e,t){var n=this,r=this.cell.getInnerElements("v"),s=this.cell.getInnerElements("f");null==r&&(r=this.cell.getInnerElements("t"));var o=this.styles.cellXfs,i=this.styles.cellStyleXfs;this.styles.cellStyles;var l=this.styles.fonts,a=this.styles.fills,c=this.styles.borders,h=this.styles.numfmts,u=this.styles.clrScheme,d=this.sharedStrings,g=new FR;if(null!=s){var f=(z=s[0].attributeList).t,m=z.ref,p=z.si,b=s[0].value;"shared"==f&&(this._fomulaRef=m,this._formulaType=f,this._formulaSi=p),(null!=m||null!=b&&b.length>0)&&(b=RR(b),g.f="="+b)}var _,v,C,T=null;if(null!=e){var w=o[parseInt(e)],y=w.attributeList.xfId,S=void 0,E=void 0,R=void 0,I=void 0,A=void 0,x=void 0,O=void 0,M=void 0;if(null!=y){var N=i[parseInt(y)],k=(z=N.attributeList).applyNumberFormat,L=z.applyFont,D=z.applyFill,P=z.applyBorder,B=z.applyAlignment;if(z.applyProtection,_=z.quotePrefix,"0"!=k&&null!=z.numFmtId&&(S=z.numFmtId),"0"!=L&&null!=z.fontId&&(E=z.fontId),"0"!=D&&null!=z.fillId&&(R=z.fillId),"0"!=P&&null!=z.borderId&&(I=z.borderId),null!=B&&"0"!=B)if(null!=(F=N.getInnerElements("alignment"))){var H=F[0].attributeList;null!=H.horizontal&&(A=H.horizontal),null!=H.vertical&&(x=H.vertical),null!=H.wrapText&&(O=H.wrapText),null!=H.textRotation&&(M=H.textRotation),null!=H.shrinkToFit&&H.shrinkToFit,null!=H.indent&&H.indent}}var F,z,U=w.attributeList.applyNumberFormat,W=w.attributeList.applyFont,V=w.attributeList.applyFill,j=w.attributeList.applyBorder,Y=w.attributeList.applyAlignment;if(null!=w.attributeList.applyProtection&&w.attributeList.applyProtection,null!=w.attributeList.quotePrefix&&(_=w.attributeList.quotePrefix),"0"!=U&&null!=w.attributeList.numFmtId&&(S=w.attributeList.numFmtId),"0"!=W&&(E=w.attributeList.fontId),"0"!=V&&(R=w.attributeList.fillId),"0"!=j&&(I=w.attributeList.borderId),"0"!=Y)if(null!=(F=w.getInnerElements("alignment"))&&F.length>0)null!=(z=F[0].attributeList).horizontal&&(A=z.horizontal),null!=z.vertical&&(x=z.vertical),null!=z.wrapText&&(O=z.wrapText),null!=z.textRotation&&(M=z.textRotation),null!=z.shrinkToFit&&z.shrinkToFit,null!=z.indent&&z.indent;if(null!=S){var G=h[parseInt(S)];(je=new zR).fa=RR(G),je.t=t,g.ct=je}if(null!=R){var X=a[parseInt(R)],$=this.getBackgroundByFill(X,u);null!=$&&(g.bg=$)}if(null!=E){var Q=l[parseInt(E)];if(null!=Q){var K=Q.getInnerElements("sz"),Z=Q.getInnerElements("color"),q=Q.getInnerElements("name"),J=Q.getInnerElements("family");Q.getInnerElements("charset");var ee,te=Q.getInnerElements("b"),ne=Q.getInnerElements("i"),re=Q.getInnerElements("strike"),se=Q.getInnerElements("u");if(null!=K&&K.length>0){var oe=K[0].attributeList.val;null!=oe&&(g.fs=parseInt(oe))}if(null!=Z&&Z.length>0){var ie=kR(Z[0],this.styles);null!=ie&&(g.fc=ie)}if(null!=J&&J.length>0)null!=(ee=J[0].attributeList.val)&&(T=pR[ee]);if(null!=q&&q.length>0)null!=(ee=q[0].attributeList.val)&&(g.ff=ee);if(null!=te&&te.length>0){var le=te[0].attributeList.val;g.bl="0"==le?0:1}if(null!=ne&&ne.length>0){var ae=ne[0].attributeList.val;g.it="0"==ae?0:1}if(null!=re&&re.length>0){var ce=re[0].attributeList.val;g.cl="0"==ce?0:1}if(null!=se&&se.length>0){var he=se[0].attributeList.val;g.un="single"==he?1:"double"==he?2:"singleAccounting"==he?3:"doubleAccounting"==he?4:0}}}if(null!=A&&(g.ht="center"==A||"centerContinuous"==A?0:"left"==A?1:"right"==A?2:"distributed"==A?0:"fill"==A||"general"==A?1:"justify"==A?0:1),null!=x&&(g.vt="bottom"==x?2:"center"==x||"distributed"==x||"justify"==x?0:1),g.tb=null!=O&&"1"==O?2:1,null!=M&&("255"==M?g.tr=3:(g.tr=0,g.rt=parseInt(M))),null!=I){var ue=c[parseInt(I)],de=new VR;de.rangeType="cell";var ge=new jR;ge.row_index=this.r,ge.col_index=this.c;var fe=ue.getInnerElements("left"),me=ue.getInnerElements("right"),pe=ue.getInnerElements("top"),be=ue.getInnerElements("bottom"),_e=ue.getInnerElements("diagonal"),ve=ue.getInnerElements("start"),Ce=ue.getInnerElements("end"),Te=this.getBorderInfo(fe),we=this.getBorderInfo(me),ye=this.getBorderInfo(pe),Se=this.getBorderInfo(be);this.getBorderInfo(_e);var Ee=this.getBorderInfo(ve),Re=this.getBorderInfo(Ce),Ie=!1;null!=Ee&&null!=Ee.color&&(ge.l=Ee,Ie=!0),null!=Re&&null!=Re.color&&(ge.r=Re,Ie=!0),null!=Te&&null!=Te.color&&(ge.l=Te,Ie=!0),null!=we&&null!=we.color&&(ge.r=we,Ie=!0),null!=ye&&null!=ye.color&&(ge.t=ye,Ie=!0),null!=Se&&null!=Se.color&&(ge.b=Se,Ie=!0),Ie&&(de.value=ge,this._borderObject=de)}}else g.tb=1;if(null!=r){var Ae=r[0].value;if(/&#\d+;/.test(Ae)&&(Ae=this.htmlDecode(Ae)),t==dR){var xe=d[parseInt(r[0].value)],Oe=xe.getInnerElements("r");if(null==Oe){var Me=xe.getInnerElements("t");if(null!=Me){var Ne="";if(Me.forEach((function(e){Ne+=e.value})),Ne=RR(Ne),"Roman"==T&&Ne.length>0){var ke=Ne.split(""),Le=null,De="",Pe=null,Be="Times New Roman";null!=g.ff&&(Be=g.ff),null==(je=g.ct)&&(je=new zR),null==je.s&&(je.s=[]);for(var He=0;He<ke.length;He++){var Fe=ke[He],ze=null,Ue=Be;if(/[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/.test(C=Fe)||!/[^\u4e00-\u9fa5]/.test(C)?(ze="c",Ue=""):AR(Fe)?(ze="j",Ue="Yu Gothic"):(v=Fe)>12592&&v<12687||v>=44032&&v<=55203?(ze="k",Ue="Malgun Gothic"):ze="e",ze!=Le&&null!=Le||He==ke.length-1){if((Ve=new UR).ff=Pe,null!=g.fc&&(Ve.fc=g.fc),null!=g.fs&&(Ve.fs=g.fs),null!=g.cl&&(Ve.cl=g.cl),null!=g.un&&(Ve.un=g.un),null!=g.bl&&(Ve.bl=g.bl),null!=g.it&&(Ve.it=g.it),He==ke.length-1){if(ze!=Le){Ve.ff=Pe,Ve.v=De,je.s.push(Ve);var We=new UR;We.ff=Ue,We.v=Fe,null!=g.fc&&(We.fc=g.fc),null!=g.fs&&(We.fs=g.fs),null!=g.cl&&(We.cl=g.cl),null!=g.un&&(We.un=g.un),null!=g.bl&&(We.bl=g.bl),null!=g.it&&(We.it=g.it),je.s.push(We);break}Ve.ff=Ue,Ve.v=De+Fe}else Ve.v=De;je.s.push(Ve),De=Fe}else De+=Fe;Le=ze,Pe=Ue}je.t="inlineStr",g.ct=je}else{var Ve;if((Ne=this.replaceSpecialWrap(Ne)).indexOf("\r\n")>-1||Ne.indexOf("\n")>-1)(Ve=new UR).v=Ne,null==(je=g.ct)&&(je=new zR),null!=g.ff&&(Ve.ff=g.ff),null!=g.fc&&(Ve.fc=g.fc),null!=g.fs&&(Ve.fs=g.fs),null!=g.cl&&(Ve.cl=g.cl),null!=g.un&&(Ve.un=g.un),null!=g.bl&&(Ve.bl=g.bl),null!=g.it&&(Ve.it=g.it),je.t="inlineStr",je.s=[Ve],g.ct=je;else g.v=Ne,_="1"}}}else{var je,Ye=[];Oe.forEach((function(e){var t=e.getInnerElements("t"),r=e.getInnerElements("rPr"),s=new UR;if(null!=t&&t.length>0){var o=t[0].value;o=RR(o=n.replaceSpecialWrap(o)),s.v=o}if(null!=r&&r.length>0){var i=r[0],l=LR(i,"sz"),a=LR(i,"rFont");LR(i,"family"),LR(i,"charset"),LR(i,"scheme");var c=LR(i,"b"),h=LR(i,"i"),u=LR(i,"u"),d=LR(i,"strike"),f=LR(i,"vertAlign"),m=void 0,p=i.getInnerElements("color");null!=p&&p.length>0&&(m=kR(p[0],n.styles));var b=void 0;null!=a&&(b=a),null!=b?s.ff=b:null!=g.ff&&(s.ff=g.ff),null!=m?s.fc=m:null!=g.fc&&(s.fc=g.fc),null!=l?s.fs=parseInt(l):null!=g.fs&&(s.fs=g.fs),null!=d?s.cl=parseInt(d):null!=g.cl&&(s.cl=g.cl),null!=u?s.un=parseInt(u):null!=g.un&&(s.un=g.un),null!=c?s.bl=parseInt(c):null!=g.bl&&(s.bl=g.bl),null!=h?s.it=parseInt(h):null!=g.it&&(s.it=g.it),null!=f&&(s.va=parseInt(f))}else null==s.ff&&null!=g.ff&&(s.ff=g.ff),null==s.fc&&null!=g.fc&&(s.fc=g.fc),null==s.fs&&null!=g.fs&&(s.fs=g.fs),null==s.cl&&null!=g.cl&&(s.cl=g.cl),null==s.un&&null!=g.un&&(s.un=g.un),null==s.bl&&null!=g.bl&&(s.bl=g.bl),null==s.it&&null!=g.it&&(s.it=g.it);Ye.push(s)})),null==(je=g.ct)&&(je=new zR),je.t="inlineStr",je.s=Ye,g.ct=je}}else Ae=RR(Ae),g.v=Ae}return null!=_&&(g.qp=parseInt(_)),g},t.prototype.replaceSpecialWrap=function(e){return e=e.replace(/_x000D_/g,"").replace(/&#13;&#10;/g,"\r\n").replace(/&#13;/g,"\r").replace(/&#10;/g,"\n")},t.prototype.getBackgroundByFill=function(e,t){var n=e.getInnerElements("patternFill");if(null!=n){var r=n[0],s=r.getInnerElements("fgColor"),o=r.getInnerElements("bgColor"),i=void 0,l=void 0;if(null!=s)i=kR(s[0],this.styles);if(null!=o)l=kR(o[0],this.styles);if(null!=i)return i;if(null!=l)return l}else{if(null!=e.getInnerElements("gradientFill"))return null}},t.prototype.getBorderInfo=function(e){if(null==e)return null;var t=e[0],n=t.attributeList;this.styles.clrScheme;var r=n.style;if(null==r||"none"==r)return null;var s=t.getInnerElements("color"),o="#000000";null!=s&&(null==(o=kR(s[0],this.styles))&&(o="#000000"));var i=new YR;return i.style=mR[r],i.color=o,i},t.prototype.htmlDecode=function(e){return e.replace(/&#(x)?([^&]{1,5});?/g,(function(e,t,n){return String.fromCharCode(parseInt(n,t?16:10))}))},t}(HR),KR=function(e){function t(t,n,r,s,o){void 0===s&&(s=!1);var i=e.call(this)||this;i.isInitialCell=s,i.readXml=o.readXml,i.sheetFile=o.sheetFile,i.styles=o.styles,i.sharedStrings=o.sharedStrings,i.calcChainEles=o.calcChain,i.sheetList=o.sheetList,i.imageList=o.imageList,i.name=t,i.index=n,i.order=r.toString(),i.config=new WR,i.celldata=[],i.mergeCells=i.readXml.getElementsByTagName("mergeCells/mergeCell",i.sheetFile),i.styles.clrScheme;var l=i.readXml.getElementsByTagName("sheetViews/sheetView",i.sheetFile),a="1",c="0",h="100";if(l.length>0){a=TR(m=l[0].attributeList,"showGridLines","1"),c=TR(m,"tabSelected","0"),h=TR(m,"zoomScale","100");var u=l[0].getInnerElements("selection");if(null!=u&&u.length>0){var d=bR(TR(u[0].attributeList,"activeCell","A1"),i.sheetList,n);i.luckysheet_select_save=[],i.luckysheet_select_save.push(d)}}i.showGridLines=a,i.status=c,i.zoomRatio=parseInt(h)/100;var g=i.readXml.getElementsByTagName("sheetPr/tabColor",i.sheetFile);if(null!=g&&g.length>0){var f=g[0],m=f.attributeList,p=kR(f,i.styles);i.color=p}var b,_,v=i.readXml.getElementsByTagName("sheetFormatPr",i.sheetFile);v.length>0&&(b=TR(m=v[0].attributeList,"defaultColWidth","9.21"),_=TR(m,"defaultRowHeight","19"));i.defaultColWidth=wR(parseFloat(b)),i.defaultRowHeight=yR(parseFloat(_)),i.generateConfigColumnLenAndHidden();var C=i.generateConfigRowLenAndHiddenAddCell();if(null!=i.formulaRefList)for(var T in i.formulaRefList){var w=i.formulaRefList[T],y=w.mainRef,S=y.cellValue,E=y.fv,R=S.r,I=S.c;for(var A in w)if("mainRef"!=A){var x=w[A].cellValue;if(null!=x){var O=E,M=(D=x.r)-R,N=(L=x.c)-I;M>0?O="="+IR.functionCopy(O,"down",M):M<0&&(O="="+IR.functionCopy(O,"up",Math.abs(M))),N>0?O="="+IR.functionCopy(O,"right",N):N<0&&(O="="+IR.functionCopy(O,"left",Math.abs(N))),x.v.f=O}}}null==i.calcChain&&(i.calcChain=[]);for(var k={},L=0;L<i.calcChainEles.length;L++){if((m=i.calcChainEles[L].attributeList).i==n){var D=m.r,P=m.i;m.l,m.s,m.a,m.t;d=bR(D);(B=new XR).r=d.row[0],B.c=d.column[0],B.index=i.index,i.calcChain.push(B),k["r"+D+"c"+L]=null}}for(var T in C.formulaList)if(!(T in k)){var B,H=C.formulaList[T];(B=new XR).r=H.r,B.c=H.c,B.index=i.index,i.calcChain.push(B)}if(null!=i.mergeCells)for(P=0;P<i.mergeCells.length;P++){var F=(m=i.mergeCells[P].attributeList).ref;if(null!=F){d=bR(F,i.sheetList,n);var z=new GR;z.r=d.row[0],z.c=d.column[0],z.rs=d.row[1]-d.row[0]+1,z.cs=d.column[1]-d.column[0]+1,null==i.config.merge&&(i.config.merge={}),i.config.merge[d.row[0]+"_"+d.column[0]]=z}}var U=o.drawingFile,W=o.drawingRelsFile;if(null!=U&&null!=W){var V=i.readXml.getElementsByTagName("xdr:twoCellAnchor",U);if(null!=V&&V.length>0)for(P=0;P<V.length;P++){var j=V[P],Y=TR(j.attributeList,"editAs","twoCell"),G=j.getInnerElements("xdr:from"),X=j.getInnerElements("xdr:to"),$=j.getInnerElements("a:blip");if(null!=G&&null!=$&&G.length>0&&$.length>0){var Q=G[0],K=X[0],Z=TR($[0].attributeList,"r:embed",null),q=i.getBase64ByRid(Z,W);q.fromCol=i.getXdrValue(Q.getInnerElements("xdr:col")),q.fromColOff=CR(i.getXdrValue(Q.getInnerElements("xdr:colOff"))),q.fromRow=i.getXdrValue(Q.getInnerElements("xdr:row")),q.fromRowOff=CR(i.getXdrValue(Q.getInnerElements("xdr:rowOff"))),q.toCol=i.getXdrValue(K.getInnerElements("xdr:col")),q.toColOff=CR(i.getXdrValue(K.getInnerElements("xdr:colOff"))),q.toRow=i.getXdrValue(K.getInnerElements("xdr:row")),q.toRowOff=CR(i.getXdrValue(K.getInnerElements("xdr:rowOff"))),q.originWidth=0,q.originHeight=0,q.type="absolute"==Y?"3":"oneCell"==Y?"2":"1",q.isFixedPos=!1,q.fixedLeft=0,q.fixedTop=0;q.border={color:"#000",radius:0,style:"solid",width:0};var J={height:0,offsetLeft:0,offsetTop:0,width:0};q.crop=J;var ee={height:0,left:0,top:0,width:0};q.default=ee,null==i.images&&(i.images={}),i.images[ER("image")]=q}}}return i}return iR(t,e),t.prototype.getXdrValue=function(e){return null==e||0==e.length?null:parseInt(e[0].value)},t.prototype.getBase64ByRid=function(e,t){var n=this.readXml.getElementsByTagName("Relationships/Relationship",t);if(null!=n&&n.length>0)for(var r=0;r<n.length;r++){var s=n[r].attributeList,o=TR(s,"Id",null),i=TR(s,"Target",null);if(o==e)return i="xl/"+(i=i.replace(/\.\.\//g,"")),this.imageList.getImageByName(i)}return null},t.prototype.generateConfigColumnLenAndHidden=function(){for(var e=this.readXml.getElementsByTagName("cols/col",this.sheetFile),t=0;t<e.length;t++){var n=e[t].attributeList,r=TR(n,"min",null),s=TR(n,"max",null),o=TR(n,"width",null),i=TR(n,"hidden",null),l=TR(n,"customWidth",null);if(null!=r&&null!=s)for(var a=parseInt(r)-1,c=parseInt(s)-1,h=parseFloat(o),u=a;u<=c;u++)null!=o&&(null==this.config.columnlen&&(this.config.columnlen={}),this.config.columnlen[u]=wR(h)),"1"==i&&(null==this.config.colhidden&&(this.config.colhidden={}),this.config.colhidden[u]=0,this.config.columnlen&&delete this.config.columnlen[u]),null!=l&&(null==this.config.customWidth&&(this.config.customWidth={}),this.config.customWidth[u]=1)}},t.prototype.generateConfigRowLenAndHiddenAddCell=function(){var e=this.readXml.getElementsByTagName("sheetData/row",this.sheetFile),t={};t.formulaList={};for(var n=0;n<e.length;n++){var r=e[n],s=r.attributeList,o=TR(s,"r",null),i=TR(s,"ht",null),l=TR(s,"hidden",null),a=TR(s,"customHeight",null);if(null!=o){var c=parseInt(o)-1;if(null!=i){var h=parseFloat(i);null==this.config.rowlen&&(this.config.rowlen={}),this.config.rowlen[c]=yR(h)}if("1"==l&&(null==this.config.rowhidden&&(this.config.rowhidden={}),this.config.rowhidden[c]=0,this.config.rowlen&&delete this.config.rowlen[c]),null!=a&&(null==this.config.customHeight&&(this.config.customHeight={}),this.config.customHeight[c]=1),this.isInitialCell){var u=r.getInnerElements("c");for(var d in u){var g=u[d],f=new QR(g,this.styles,this.sharedStrings,this.mergeCells,this.sheetFile,this.readXml);if(null!=f._borderObject&&(null==this.config.borderInfo&&(this.config.borderInfo=[]),this.config.borderInfo.push(f._borderObject),delete f._borderObject),"shared"==f._formulaType){null==this.formulaRefList&&(this.formulaRefList={}),null==this.formulaRefList[f._formulaSi]&&(this.formulaRefList[f._formulaSi]={});var m=void 0;null!=f.v&&(m=f.v.f);var p={t:f._formulaType,ref:f._fomulaRef,si:f._formulaSi,fv:m,cellValue:f};null!=f._fomulaRef?this.formulaRefList[f._formulaSi].mainRef=p:this.formulaRefList[f._formulaSi][f.r+"_"+f.c]=p}if(null!=f.v&&null!=f.v.f){var b={r:f.r,c:f.c};t.formulaList["r"+f.r+"c"+f.c]=b}this.celldata.push(f)}}}}return t},t}(PR),ZR={};ZR.G={concat:function(e,t){for(var n=0;n<t.cmds.length;n++)e.cmds.push(t.cmds[n]);for(n=0;n<t.crds.length;n++)e.crds.push(t.crds[n])},getBB:function(e){for(var t=1e99,n=1e99,r=-t,s=-n,o=0;o<e.length;o+=2){var i=e[o],l=e[o+1];i<t?t=i:i>r&&(r=i),l<n?n=l:l>s&&(s=l)}return[t,n,r,s]},rectToPath:function(e){return{cmds:["M","L","L","L","Z"],crds:[e[0],e[1],e[2],e[1],e[2],e[3],e[0],e[3]]}},insideBox:function(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&e[2]<=t[2]&&e[3]<=t[3]},isBox:function(e,t){var n=function(e,t){for(var n=0;n<8;n+=2){for(var r=!0,s=0;s<8;s++)if(Math.abs(t[s]-e[s+n&7])>=2){r=!1;break}if(r)return!0}return!1};if(e.cmds.length>10)return!1;var r=e.cmds.join(""),s=e.crds,o=!1;if("MLLLZ"==r&&8==s.length||"MLLLLZ"==r&&10==s.length){10==s.length&&(s=s.slice(0,8));var i=t[0],l=t[1],a=t[2],c=t[3];o||(o=n(s,[i,l,a,l,a,c,i,c])),o||(o=n(s,[i,c,a,c,a,l,i,l]))}return o},boxArea:function(e){return(e[2]-e[0])*(e[3]-e[1])},newPath:function(e){e.pth={cmds:[],crds:[]}},moveTo:function(e,t,n){var r=ZR.M.multPoint(e.ctm,[t,n]);e.pth.cmds.push("M"),e.pth.crds.push(r[0],r[1]),e.cpos=r},lineTo:function(e,t,n){var r=ZR.M.multPoint(e.ctm,[t,n]);e.cpos[0]==r[0]&&e.cpos[1]==r[1]||(e.pth.cmds.push("L"),e.pth.crds.push(r[0],r[1]),e.cpos=r)},curveTo:function(e,t,n,r,s,o,i){var l;t=(l=ZR.M.multPoint(e.ctm,[t,n]))[0],n=l[1],r=(l=ZR.M.multPoint(e.ctm,[r,s]))[0],s=l[1],o=(l=ZR.M.multPoint(e.ctm,[o,i]))[0],i=l[1],e.cpos=l,e.pth.cmds.push("C"),e.pth.crds.push(t,n,r,s,o,i)},closePath:function(e){e.pth.cmds.push("Z")},arc:function(e,t,n,r,s,o,i){if(i)for(;o>s;)o-=2*Math.PI;else for(;o<s;)o+=2*Math.PI;var l=(o-s)/4,a=Math.cos(l/2),c=-Math.sin(l/2),h=(4-a)/3,u=0==c?c:(1-a)*(3-a)/(3*c),d=h,g=-u,f=a,m=-c,p=[h,u],b=[d,g],_=[f,m],v={cmds:[0==e.pth.cmds.length?"M":"L","C","C","C","C"],crds:[a,c,h,u,d,g,f,m]},C=[1,0,0,1,0,0];ZR.M.rotate(C,-l);for(var T=0;T<3;T++)p=ZR.M.multPoint(C,p),b=ZR.M.multPoint(C,b),_=ZR.M.multPoint(C,_),v.crds.push(p[0],p[1],b[0],b[1],_[0],_[1]);var w=[r,0,0,r,t,n];ZR.M.rotate(C,l/2-s),ZR.M.concat(C,w),ZR.M.multArray(C,v.crds),ZR.M.multArray(e.ctm,v.crds),ZR.G.concat(e.pth,v);n=v.crds.pop();t=v.crds.pop(),e.cpos=[t,n]},toPoly:function(e){if("M"!=e.cmds[0]||"Z"!=e.cmds[e.cmds.length-1])return null;for(var t=1;t<e.cmds.length-1;t++)if("L"!=e.cmds[t])return null;var n=[],r=e.crds.length;e.crds[0]==e.crds[r-2]&&e.crds[1]==e.crds[r-1]&&(r-=2);for(t=0;t<r;t+=2)n.push([e.crds[t],e.crds[t+1]]);return ZR.G.polyArea(e.crds)<0&&n.reverse(),n},fromPoly:function(e){for(var t={cmds:[],crds:[]},n=0;n<e.length;n++)t.crds.push(e[n][0],e[n][1]),t.cmds.push(0==n?"M":"L");return t.cmds.push("Z"),t},polyArea:function(e){if(e.length<6)return 0;for(var t=e.length-2,n=(e[0]-e[t])*(e[t+1]+e[1]),r=0;r<t;r+=2)n+=(e[r+2]-e[r])*(e[r+1]+e[r+3]);return.5*-n},polyClip:function(e,t){var n,r,s=function(e){return(a[0]-n[0])*(e[1]-n[1])>(a[1]-n[1])*(e[0]-n[0])},o=function(){var e=[n[0]-a[0],n[1]-a[1]],t=[r[0]-u[0],r[1]-u[1]],s=n[0]*a[1]-n[1]*a[0],o=r[0]*u[1]-r[1]*u[0],i=1/(e[0]*t[1]-e[1]*t[0]);return[(s*t[0]-o*e[0])*i,(s*t[1]-o*e[1])*i]},i=e;for(var l in n=t[t.length-1],t){var a=t[l],c=i;for(var h in i=[],r=c[c.length-1],c){var u;s(u=c[h])?(s(r)||i.push(o()),i.push(u)):s(r)&&i.push(o()),r=u}n=a}return i}},ZR.M={getScale:function(e){return Math.sqrt(Math.abs(e[0]*e[3]-e[1]*e[2]))},translate:function(e,t,n){ZR.M.concat(e,[1,0,0,1,t,n])},rotate:function(e,t){ZR.M.concat(e,[Math.cos(t),-Math.sin(t),Math.sin(t),Math.cos(t),0,0])},scale:function(e,t,n){ZR.M.concat(e,[t,0,0,n,0,0])},concat:function(e,t){var n=e[0],r=e[1],s=e[2],o=e[3],i=e[4],l=e[5];e[0]=n*t[0]+r*t[2],e[1]=n*t[1]+r*t[3],e[2]=s*t[0]+o*t[2],e[3]=s*t[1]+o*t[3],e[4]=i*t[0]+l*t[2]+t[4],e[5]=i*t[1]+l*t[3]+t[5]},invert:function(e){var t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],i=e[5],l=t*s-n*r;e[0]=s/l,e[1]=-n/l,e[2]=-r/l,e[3]=t/l,e[4]=(r*i-s*o)/l,e[5]=(n*o-t*i)/l},multPoint:function(e,t){var n=t[0],r=t[1];return[n*e[0]+r*e[2]+e[4],n*e[1]+r*e[3]+e[5]]},multArray:function(e,t){for(var n=0;n<t.length;n+=2){var r=t[n],s=t[n+1];t[n]=r*e[0]+s*e[2]+e[4],t[n+1]=r*e[1]+s*e[3]+e[5]}}},ZR.C={srgbGamma:function(e){return e<.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055},cmykToRgb:function(e){var t=e[0],n=e[1],r=e[2],s=e[3],o=255+t*(-4.387332384609988*t+54.48615194189176*n+18.82290502165302*r+212.25662451639585*s-285.2331026137004)+n*(1.7149763477362134*n-5.6096736904047315*r+-17.873870861415444*s-5.497006427196366)+r*(-2.5217340131683033*r-21.248923337353073*s+17.5119270841813)+s*(-21.86122147463605*s-189.48180835922747),i=255+t*(8.841041422036149*t+60.118027045597366*n+6.871425592049007*r+31.159100130055922*s-79.2970844816548)+n*(-15.310361306967817*n+17.575251261109482*r+131.35250912493976*s-190.9453302588951)+r*(4.444339102852739*r+9.8632861493405*s-24.86741582555878)+s*(-20.737325471181034*s-187.80453709719578),l=255+t*(.8842522430003296*t+8.078677503112928*n+30.89978309703729*r-.23883238689178934*s-14.183576799673286)+n*(10.49593273432072*n+63.02378494754052*r+50.606957656360734*s-112.23884253719248)+r*(.03296041114873217*r+115.60384449646641*s-193.58209356861505)+s*(-22.33816807309886*s-180.12613974708367);return[Math.max(0,Math.min(1,o/255)),Math.max(0,Math.min(1,i/255)),Math.max(0,Math.min(1,l/255))]},labToRgb:function(e){for(var t=903.3,n=.008856,r=e[0],s=e[1],o=(r+16)/116,i=o*o*o,l=o-e[2]/200,a=l*l*l,c=s/500+o,h=c*c*c,u=[96.72*(h>n?h:(116*c-16)/t)/100,100*(i>n?i:(116*o-16)/t)/100,81.427*(a>n?a:(116*l-16)/t)/100],d=[3.1338561,-1.6168667,-.4906146,-.9787684,1.9161415,.033454,.0719453,-.2289914,1.4052427],g=[d[0]*u[0]+d[1]*u[1]+d[2]*u[2],d[3]*u[0]+d[4]*u[1]+d[5]*u[2],d[6]*u[0]+d[7]*u[1]+d[8]*u[2]],f=0;f<3;f++)g[f]=Math.max(0,Math.min(1,ZR.C.srgbGamma(g[f])));return g}},ZR.getState=function(e){return{font:ZR.getFont(),dd:{flat:1},space:"/DeviceGray",ca:1,colr:[0,0,0],sspace:"/DeviceGray",CA:1,COLR:[0,0,0],bmode:"/Normal",SA:!1,OPM:0,AIS:!1,OP:!1,op:!1,SMask:"/None",lwidth:1,lcap:0,ljoin:0,mlimit:10,SM:.1,doff:0,dash:[],ctm:[1,0,0,1,0,0],cpos:[0,0],pth:{cmds:[],crds:[]},cpth:e?ZR.G.rectToPath(e):null}},ZR.getFont=function(){return{Tc:0,Tw:0,Th:100,Tl:0,Tf:"Helvetica-Bold",Tfs:1,Tmode:0,Trise:0,Tk:0,Tal:0,Tun:0,Tm:[1,0,0,1,0,0],Tlm:[1,0,0,1,0,0],Trm:[1,0,0,1,0,0]}};var qR=function(){};qR.Parse=function(e,t){e=new Uint8Array(e);for(var n,r=0,s={fill:!1,strk:!1,bb:[0,0,1,1],wbb:[0,0,1,1],fnt:{nam:"Arial",hgh:25,und:!1,orn:0},tclr:[0,0,0],talg:0},o=[],i=[],l=qR.B.readShort,a=qR.B.readUshort,c=qR.B.readInt,h=qR.B.readUint,u=qR.B.readFloat;;){var d=h(e,r);r+=4;var g=qR.K[d],f=h(e,r),m=r+=4,p=null,b=0;if("EOF"==g)break;if("HEADER"==g)s.bb=qR._readBox(e,m),m+=16,t.StartPage(s.bb[0],s.bb[1],s.bb[2],s.bb[3]),n=ZR.getState(s.bb);else if("SAVEDC"==g)i.push(JSON.stringify(n),JSON.stringify(s));else if("RESTOREDC"==g){var _=c(e,m);for(m+=4;_<-1;)i.pop(),i.pop();s=JSON.parse(i.pop()),n=JSON.parse(i.pop())}else if("SELECTCLIPPATH"==g)n.cpth=JSON.parse(JSON.stringify(n.pth));else if(-1!=["SETMAPMODE","SETPOLYFILLMODE","SETBKMODE","SETICMMODE","SETROP2","EXTSELECTCLIPRGN"].indexOf(g));else if("SETMITERLIMIT"==g)n.mlimit=h(e,m);else if("SETTEXTCOLOR"==g)s.tclr=[e[m]/255,e[m+1]/255,e[m+2]/255];else if("SETTEXTALIGN"==g)s.talg=h(e,m);else if("SETVIEWPORTEXTEX"==g||"SETVIEWPORTORGEX"==g){null==s.vbb&&(s.vbb=[]);var v="SETVIEWPORTORGEX"==g?0:2;s.vbb[v]=c(e,m),m+=4,s.vbb[v+1]=c(e,m),m+=4,"SETVIEWPORTEXTEX"==g&&qR._updateCtm(s,n)}else if("SETWINDOWEXTEX"==g||"SETWINDOWORGEX"==g){v="SETWINDOWORGEX"==g?0:2;s.wbb[v]=c(e,m),m+=4,s.wbb[v+1]=c(e,m),m+=4,"SETWINDOWEXTEX"==g&&qR._updateCtm(s,n)}else if("COMMENT"==g)h(e,m),m+=4;else if("SELECTOBJECT"==g){var C=h(e,m);if(m+=4,2147483648==C)s.fill=!0,n.colr=[1,1,1];else if(2147483653==C)s.fill=!1;else if(2147483655==C)s.strk=!0,s.lwidth=1,n.COLR=[0,0,0];else if(2147483656==C)s.strk=!1;else if(2147483661==C);else if(2147483662==C);else{var T=o[C];if("b"==T.t){if(s.fill=1!=T.stl,0==T.stl);else if(1!=T.stl)throw T.stl+" e";n.colr=T.clr}else if("p"==T.t)s.strk=5!=T.stl,n.lwidth=T.wid,n.COLR=T.clr;else{if("f"!=T.t)throw"e";s.fnt=T,n.font.Tf=T.nam,n.font.Tfs=Math.abs(T.hgh),n.font.Tun=T.und}}}else if("DELETEOBJECT"==g){C=h(e,m);if(m+=4,null==o[C])throw"e";o[C]=null}else if("CREATEBRUSHINDIRECT"==g)b=h(e,m),(p={t:"b"}).stl=h(e,m+=4),m+=4,p.clr=[e[m]/255,e[m+1]/255,e[m+2]/255],m+=4,p.htc=h(e,m),m+=4;else if("CREATEPEN"==g||"EXTCREATEPEN"==g)b=h(e,m),m+=4,p={t:"p"},"EXTCREATEPEN"==g?(m+=16,p.stl=h(e,m),m+=4,p.wid=h(e,m),m+=4,m+=4):(p.stl=h(e,m),m+=4,p.wid=h(e,m),m+=4,m+=4),p.clr=[e[m]/255,e[m+1]/255,e[m+2]/255],m+=4;else if("EXTCREATEFONTINDIRECTW"==g){b=h(e,m),(p={t:"f",nam:""}).hgh=c(e,m+=4),m+=4,m+=8,p.orn=c(e,m)/10;var w=h(e,m+=4);for(m+=4,p.und=e[m+1],p.stk=e[m+2],m+=8;0!=a(e,m);)p.nam+=String.fromCharCode(a(e,m)),m+=2;w>500&&(p.nam+="-Bold")}else if("EXTTEXTOUTW"==g){var y=h(e,m+=16);u(e,m+=4),u(e,m+=4);var S=c(e,m+=4),E=c(e,m+=4);m+=4,n.font.Tm=[1,0,0,-1,0,0],ZR.M.rotate(n.font.Tm,s.fnt.orn*Math.PI/180),ZR.M.translate(n.font.Tm,S,E);var R=s.talg;if(6==(6&R))n.font.Tal=2;else{if(0!=(7&R))throw R+" e";n.font.Tal=0}if(24==(24&R));else{if(0!=(24&R))throw"e";ZR.M.translate(n.font.Tm,0,n.font.Tfs)}var I=h(e,m),A=h(e,m+=4);h(e,m+=4),m+=4,h(e,m+=16),m+=4,A+=r-8;for(var x="",O=0;O<I;O++){var M=a(e,A+2*O);x+=String.fromCharCode(M)}var N=n.colr;n.colr=s.tclr,t.PutText(n,x,x.length*n.font.Tfs*.5),n.colr=N}else if("BEGINPATH"==g)ZR.G.newPath(n);else if("ENDPATH"==g);else if("CLOSEFIGURE"==g)ZR.G.closePath(n);else if("MOVETOEX"==g)ZR.G.moveTo(n,c(e,m),c(e,m+4));else if("LINETO"==g){if(0==n.pth.cmds.length){var k=n.ctm.slice(0);ZR.M.invert(k);var L=ZR.M.multPoint(k,n.cpos);ZR.G.moveTo(n,L[0],L[1])}ZR.G.lineTo(n,c(e,m),c(e,m+4))}else if("POLYGON"==g||"POLYGON16"==g||"POLYLINE"==g||"POLYLINE16"==g||"POLYLINETO"==g||"POLYLINETO16"==g){m+=16;var D=g.startsWith("POLYGON"),P=-1!=g.indexOf("TO"),B=h(e,m);m+=4,P||ZR.G.newPath(n),m=qR._drawPoly(e,m,B,n,g.endsWith("16")?2:4,D,P),P||qR._draw(t,n,s,D)}else if("POLYPOLYGON16"==g){m+=16;D=g.startsWith("POLYPOLYGON"),P=-1!=g.indexOf("TO");var H=h(e,m);m+=4;var F=m+=4;m+=4*H,P||ZR.G.newPath(n);for(O=0;O<H;O++){var z=a(e,F+4*O);m=qR._drawPoly(e,m,z,n,g.endsWith("16")?2:4,D,P)}P||qR._draw(t,n,s,D)}else if("POLYBEZIER"==g||"POLYBEZIER16"==g||"POLYBEZIERTO"==g||"POLYBEZIERTO16"==g){m+=16;var U=g.endsWith("16"),W=U?l:c,V=U?2:4;B=h(e,m);for(m+=4,-1==g.indexOf("TO")&&(ZR.G.moveTo(n,W(e,m),W(e,m+V)),m+=2*V,B--);B>0;)ZR.G.curveTo(n,W(e,m),W(e,m+V),W(e,m+2*V),W(e,m+3*V),W(e,m+4*V),W(e,m+5*V)),m+=6*V,B-=3}else if("RECTANGLE"==g||"ELLIPSE"==g){ZR.G.newPath(n);var j=qR._readBox(e,m);if("RECTANGLE"==g)ZR.G.moveTo(n,j[0],j[1]),ZR.G.lineTo(n,j[2],j[1]),ZR.G.lineTo(n,j[2],j[3]),ZR.G.lineTo(n,j[0],j[3]);else{var Y=(j[0]+j[2])/2,G=(j[1]+j[3])/2;ZR.G.arc(n,Y,G,(j[2]-j[0])/2,0,2*Math.PI,!1)}ZR.G.closePath(n),qR._draw(t,n,s,!0)}else if("FILLPATH"==g)t.Fill(n,!1);else if("STROKEPATH"==g)t.Stroke(n);else if("STROKEANDFILLPATH"==g)t.Fill(n,!1),t.Stroke(n);else if("SETWORLDTRANSFORM"==g||"MODIFYWORLDTRANSFORM"==g){var X=[];for(O=0;O<6;O++)X.push(u(e,m+4*O));if(m+=24,"SETWORLDTRANSFORM"==g)n.ctm=X;else{y=h(e,m);if(m+=4,2!=y)throw"e";var $=n.ctm;n.ctm=X,ZR.M.concat(n.ctm,$)}}else if("SETSTRETCHBLTMODE"==g)h(e,m),m+=4;else if("STRETCHDIBITS"==g){j=qR._readBox(e,m);var Q=c(e,m+=16),K=c(e,m+=4);c(e,m+=4),c(e,m+=4);var Z=c(e,m+=4),q=c(e,m+=4),J=h(e,m+=4)+r-8;h(e,m+=4);var ee=h(e,m+=4)+r-8;if(h(e,m+=4),0!=h(e,m+=4))throw"e";h(e,m+=4);var te=c(e,m+=4),ne=c(e,m+=4);m+=4,h(e,J);var re=h(e,J+=4),se=h(e,J+=4);if(re!=Z||se!=q)throw"e";var oe=a(e,J+=4),ie=a(e,J+=2);if(8!=ie&&24!=ie&&32!=ie)throw ie+" e";var le=h(e,J+=2);if(0!=le)throw le+" e";h(e,J+=4),h(e,J+=4),h(e,J+=4),h(e,J+=4),h(e,J+=4),J+=4;var ae=Math.floor((re*oe*ie+31&-32)/8),ce=new Uint8Array(re*se*4);if(8==ie)for(G=0;G<se;G++)for(Y=0;Y<re;Y++){var he=G*re+Y<<2;C=e[ee+(se-1-G)*ae+Y]<<2;ce[he]=e[J+C+2],ce[he+1]=e[J+C+1],ce[he+2]=e[J+C+0],ce[he+3]=255}if(24==ie)for(G=0;G<se;G++)for(Y=0;Y<re;Y++){var ue=ee+(se-1-G)*ae+3*Y;ce[he=G*re+Y<<2]=e[ue+2],ce[he+1]=e[ue+1],ce[he+2]=e[ue+0],ce[he+3]=255}if(32==ie)for(G=0;G<se;G++)for(Y=0;Y<re;Y++){ue=ee+(se-1-G)*ae+4*Y;ce[he=G*re+Y<<2]=e[ue+2],ce[he+1]=e[ue+1],ce[he+2]=e[ue+0],ce[he+3]=e[ue+3]}var de=n.ctm.slice(0);n.ctm=[1,0,0,1,0,0],ZR.M.scale(n.ctm,te,-ne),ZR.M.translate(n.ctm,Q,K+ne),ZR.M.concat(n.ctm,de),t.PutImage(n,ce,re,se),n.ctm=de}else console.log(g,f);null!=p&&(o[b]=p),r+=f-8}t.ShowPage(),t.Done()},qR._readBox=function(e,t){for(var n=[],r=0;r<4;r++)n[r]=qR.B.readInt(e,t+4*r);return n},qR._updateCtm=function(e,t){var n=[1,0,0,1,0,0],r=e.wbb;e.bb;var s=e.vbb&&4==e.vbb.length?e.vbb:e.bb;ZR.M.translate(n,-r[0],-r[1]),ZR.M.scale(n,1/r[2],1/r[3]),ZR.M.scale(n,s[2],s[3]),t.ctm=n},qR._draw=function(e,t,n,r){n.fill&&r&&e.Fill(t,!1),n.strk&&0!=t.lwidth&&e.Stroke(t)},qR._drawPoly=function(e,t,n,r,s,o,i){for(var l=2==s?qR.B.readShort:qR.B.readInt,a=0;a<n;a++){var c=l(e,t),h=l(e,t+=s);t+=s,0!=a||i?ZR.G.lineTo(r,c,h):ZR.G.moveTo(r,c,h)}return o&&ZR.G.closePath(r),t},(qR.B={uint8:new Uint8Array(4),readShort:function(e,t){var n=qR.B.uint8;return n[0]=e[t],n[1]=e[t+1],qR.B.int16[0]},readUshort:function(e,t){var n=qR.B.uint8;return n[0]=e[t],n[1]=e[t+1],qR.B.uint16[0]},readInt:function(e,t){var n=qR.B.uint8;return n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],n[3]=e[t+3],qR.B.int32[0]},readUint:function(e,t){var n=qR.B.uint8;return n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],n[3]=e[t+3],qR.B.uint32[0]},readFloat:function(e,t){var n=qR.B.uint8;return n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],n[3]=e[t+3],qR.B.flot32[0]},readASCII:function(e,t,n){for(var r="",s=0;s<n;s++)r+=String.fromCharCode(e[t+s]);return r}}).int16=new Int16Array(qR.B.uint8.buffer),qR.B.uint16=new Uint16Array(qR.B.uint8.buffer),qR.B.int32=new Int32Array(qR.B.uint8.buffer),qR.B.uint32=new Uint32Array(qR.B.uint8.buffer),qR.B.flot32=new Float32Array(qR.B.uint8.buffer),qR.C={EMR_HEADER:1,EMR_POLYBEZIER:2,EMR_POLYGON:3,EMR_POLYLINE:4,EMR_POLYBEZIERTO:5,EMR_POLYLINETO:6,EMR_POLYPOLYLINE:7,EMR_POLYPOLYGON:8,EMR_SETWINDOWEXTEX:9,EMR_SETWINDOWORGEX:10,EMR_SETVIEWPORTEXTEX:11,EMR_SETVIEWPORTORGEX:12,EMR_SETBRUSHORGEX:13,EMR_EOF:14,EMR_SETPIXELV:15,EMR_SETMAPPERFLAGS:16,EMR_SETMAPMODE:17,EMR_SETBKMODE:18,EMR_SETPOLYFILLMODE:19,EMR_SETROP2:20,EMR_SETSTRETCHBLTMODE:21,EMR_SETTEXTALIGN:22,EMR_SETCOLORADJUSTMENT:23,EMR_SETTEXTCOLOR:24,EMR_SETBKCOLOR:25,EMR_OFFSETCLIPRGN:26,EMR_MOVETOEX:27,EMR_SETMETARGN:28,EMR_EXCLUDECLIPRECT:29,EMR_INTERSECTCLIPRECT:30,EMR_SCALEVIEWPORTEXTEX:31,EMR_SCALEWINDOWEXTEX:32,EMR_SAVEDC:33,EMR_RESTOREDC:34,EMR_SETWORLDTRANSFORM:35,EMR_MODIFYWORLDTRANSFORM:36,EMR_SELECTOBJECT:37,EMR_CREATEPEN:38,EMR_CREATEBRUSHINDIRECT:39,EMR_DELETEOBJECT:40,EMR_ANGLEARC:41,EMR_ELLIPSE:42,EMR_RECTANGLE:43,EMR_ROUNDRECT:44,EMR_ARC:45,EMR_CHORD:46,EMR_PIE:47,EMR_SELECTPALETTE:48,EMR_CREATEPALETTE:49,EMR_SETPALETTEENTRIES:50,EMR_RESIZEPALETTE:51,EMR_REALIZEPALETTE:52,EMR_EXTFLOODFILL:53,EMR_LINETO:54,EMR_ARCTO:55,EMR_POLYDRAW:56,EMR_SETARCDIRECTION:57,EMR_SETMITERLIMIT:58,EMR_BEGINPATH:59,EMR_ENDPATH:60,EMR_CLOSEFIGURE:61,EMR_FILLPATH:62,EMR_STROKEANDFILLPATH:63,EMR_STROKEPATH:64,EMR_FLATTENPATH:65,EMR_WIDENPATH:66,EMR_SELECTCLIPPATH:67,EMR_ABORTPATH:68,EMR_COMMENT:70,EMR_FILLRGN:71,EMR_FRAMERGN:72,EMR_INVERTRGN:73,EMR_PAINTRGN:74,EMR_EXTSELECTCLIPRGN:75,EMR_BITBLT:76,EMR_STRETCHBLT:77,EMR_MASKBLT:78,EMR_PLGBLT:79,EMR_SETDIBITSTODEVICE:80,EMR_STRETCHDIBITS:81,EMR_EXTCREATEFONTINDIRECTW:82,EMR_EXTTEXTOUTA:83,EMR_EXTTEXTOUTW:84,EMR_POLYBEZIER16:85,EMR_POLYGON16:86,EMR_POLYLINE16:87,EMR_POLYBEZIERTO16:88,EMR_POLYLINETO16:89,EMR_POLYPOLYLINE16:90,EMR_POLYPOLYGON16:91,EMR_POLYDRAW16:92,EMR_CREATEMONOBRUSH:93,EMR_CREATEDIBPATTERNBRUSHPT:94,EMR_EXTCREATEPEN:95,EMR_POLYTEXTOUTA:96,EMR_POLYTEXTOUTW:97,EMR_SETICMMODE:98,EMR_CREATECOLORSPACE:99,EMR_SETCOLORSPACE:100,EMR_DELETECOLORSPACE:101,EMR_GLSRECORD:102,EMR_GLSBOUNDEDRECORD:103,EMR_PIXELFORMAT:104,EMR_DRAWESCAPE:105,EMR_EXTESCAPE:106,EMR_SMALLTEXTOUT:108,EMR_FORCEUFIMAPPING:109,EMR_NAMEDESCAPE:110,EMR_COLORCORRECTPALETTE:111,EMR_SETICMPROFILEA:112,EMR_SETICMPROFILEW:113,EMR_ALPHABLEND:114,EMR_SETLAYOUT:115,EMR_TRANSPARENTBLT:116,EMR_GRADIENTFILL:118,EMR_SETLINKEDUFIS:119,EMR_SETTEXTJUSTIFICATION:120,EMR_COLORMATCHTOTARGETW:121,EMR_CREATECOLORSPACEW:122},qR.K=[];var JR=function(e,t){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.bb=null,this.currPage=0,this.needPage=e,this.scale=t};JR.prototype.StartPage=function(e,t,n,r){if(this.currPage==this.needPage){this.bb=[e,t,n,r];var s=this.scale,o=window.devicePixelRatio,i=this.canvas,l=this.ctx;i.width=Math.round(n*s),i.height=Math.round(r*s),l.translate(0,r*s),l.scale(s,-s),i.setAttribute("style","border:1px solid; width:"+i.width/o+"px; height:"+i.height/o+"px")}},JR.prototype.Fill=function(e,t){if(this.currPage==this.needPage){var n=this.ctx;n.beginPath(),this._setStyle(e,n),this._draw(e.pth,n),n.fill()}},JR.prototype.Stroke=function(e){if(this.currPage==this.needPage){var t=this.ctx;t.beginPath(),this._setStyle(e,t),this._draw(e.pth,t),t.stroke()}},JR.prototype.PutText=function(e,t,n){if(this.currPage==this.needPage){this._scale(e.ctm);var r=this.ctx;this._setStyle(e,r),r.save();var s=[1,0,0,-1,0,0];this._concat(s,e.font.Tm),this._concat(s,e.ctm),r.transform(s[0],s[1],s[2],s[3],s[4],s[5]),r.fillText(t,0,0),r.restore()}},JR.prototype.PutImage=function(e,t,n,r,s){if(this.currPage==this.needPage){var o=this.ctx;if(t.length==n*r*4){if(t=t.slice(0),s&&s.length==n*r*4)for(var i=0;i<t.length;i+=4)t[i+3]=s[i+1];var l=document.createElement("canvas"),a=l.getContext("2d");l.width=n,l.height=r;var c=a.createImageData(n,r);for(i=0;i<t.length;i++)c.data[i]=t[i];a.putImageData(c,0,0),o.save();var h=[1,0,0,1,0,0];this._concat(h,[1/n,0,0,-1/r,0,1]),this._concat(h,e.ctm),o.transform(h[0],h[1],h[2],h[3],h[4],h[5]),o.drawImage(l,0,0),o.restore()}}},JR.prototype.ShowPage=function(){this.currPage++},JR.prototype.Done=function(){},JR.prototype._setStyle=function(e,t){var n=this._scale(e.ctm);t.fillStyle=this._getFill(e.colr,e.ca,t),t.strokeStyle=this._getFill(e.COLR,e.CA,t),t.lineCap=["butt","round","square"][e.lcap],t.lineJoin=["miter","round","bevel"][e.ljoin],t.lineWidth=e.lwidth*n;for(var r,s=e.dash.slice(0),o=0;o<s.length;o++)s[o]=(r=s[o]*n,""+parseFloat(r.toFixed(2)));t.setLineDash(s),t.miterLimit=e.mlimit*n;var i=e.font.Tf,l=i.toLowerCase(),a=-1!=l.indexOf("bold")?"bold ":"",c=-1!=l.indexOf("italic")||-1!=l.indexOf("oblique")?"italic ":"";t.font=a+c+e.font.Tfs+'px "'+i+'"'},JR.prototype._getFill=function(e,t,n){if(null==e.typ)return this._colr(e,t);var r,s=e,o=s.crds,i=s.mat,l=this._scale(i);if("lin"==s.typ){var a=this._multPoint(i,o.slice(0,2)),c=this._multPoint(i,o.slice(2));r=n.createLinearGradient(a[0],a[1],c[0],c[1])}else if("rad"==s.typ){a=this._multPoint(i,o.slice(0,2)),c=this._multPoint(i,o.slice(3));r=n.createRadialGradient(a[0],a[1],o[2]*l,c[0],c[1],o[5]*l)}for(var h=0;h<s.grad.length;h++)r.addColorStop(s.grad[h][0],this._colr(s.grad[h][1],t));return r},JR.prototype._colr=function(e,t){return"rgba("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+","+t+")"},JR.prototype._scale=function(e){return Math.sqrt(Math.abs(e[0]*e[3]-e[1]*e[2]))},JR.prototype._concat=function(e,t){var n=e[0],r=e[1],s=e[2],o=e[3],i=e[4],l=e[5];e[0]=n*t[0]+r*t[2],e[1]=n*t[1]+r*t[3],e[2]=s*t[0]+o*t[2],e[3]=s*t[1]+o*t[3],e[4]=i*t[0]+l*t[2]+t[4],e[5]=i*t[1]+l*t[3]+t[5]},JR.prototype._multPoint=function(e,t){var n=t[0],r=t[1];return[n*e[0]+r*e[2]+e[4],n*e[1]+r*e[3]+e[5]]},JR.prototype._draw=function(e,t){for(var n=0,r=e.crds,s=0;s<e.cmds.length;s++){var o=e.cmds[s];"M"==o?(t.moveTo(r[n],r[n+1]),n+=2):"L"==o?(t.lineTo(r[n],r[n+1]),n+=2):"C"==o?(t.bezierCurveTo(r[n],r[n+1],r[n+2],r[n+3],r[n+4],r[n+5]),n+=6):"Q"==o?(t.quadraticCurveTo(r[n],r[n+1],r[n+2],r[n+3]),n+=4):"Z"==o&&t.closePath()}};var eI=function(){function e(e){if(null!=e)for(var t in this.images={},e)if(t.indexOf("xl/media/")>-1){var n=t.split("."),r=n[n.length-1].toLowerCase();if(r in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1,emf:1})if("emf"==r){var s,o,i=new JR(0,1);for(var l in o=qR.K=[],4,s=qR.C)o[s[l]]=l.slice(4);qR.Parse(e[t],i),this.images[t]=i.canvas.toDataURL("image/png")}else this.images[t]=e[t]}}return e.prototype.getImageByName=function(e){if(e in this.images){var t=this.images[e];return new tI(e,t)}return null},e}(),tI=function(e){function t(t,n){var r=e.call(this)||this;return r.src=n,r}return iR(t,e),t.prototype.setDefault=function(){},t}($R),nI=function(e){function t(t,n){var r=e.call(this)||this;r.columnWidthSet=[],r.rowHeightSet=[],r.files=t,r.fileName=n,r.readXml=new MR(t),r.getSheetNameList(),r.sharedStrings=r.readXml.getElementsByTagName("sst/si","xl/sharedStrings.xml"),r.calcChain=r.readXml.getElementsByTagName("calcChain/c","xl/calcChain.xml"),r.styles={},r.styles.cellXfs=r.readXml.getElementsByTagName("cellXfs/xf",uR),r.styles.cellStyleXfs=r.readXml.getElementsByTagName("cellStyleXfs/xf",uR),r.styles.cellStyles=r.readXml.getElementsByTagName("cellStyles/cellStyle",uR),r.styles.fonts=r.readXml.getElementsByTagName("fonts/font",uR),r.styles.fills=r.readXml.getElementsByTagName("fills/fill",uR),r.styles.borders=r.readXml.getElementsByTagName("borders/border",uR),r.styles.clrScheme=r.readXml.getElementsByTagName("a:clrScheme/a:dk1|a:lt1|a:dk2|a:lt2|a:accent1|a:accent2|a:accent3|a:accent4|a:accent5|a:accent6|a:hlink|a:folHlink","xl/theme/theme1.xml"),r.styles.indexedColors=r.readXml.getElementsByTagName("colors/indexedColors/rgbColor",uR),r.styles.mruColors=r.readXml.getElementsByTagName("colors/mruColors/color",uR),r.imageList=new eI(t);for(var s=r.readXml.getElementsByTagName("numFmt/numFmt",uR),o=JSON.parse(JSON.stringify(gR)),i=0;i<s.length;i++){var l=s[i].attributeList,a=TR(l,"numFmtId","49"),c=TR(l,"formatCode","@");a in gR||(o[a]=c)}return r.styles.numfmts=o,r}return iR(t,e),t.prototype.getSheetNameList=function(){var e=this.readXml.getElementsByTagName("Relationships/Relationship","xl/_rels/workbook.xml.rels");if(null!=e){for(var t=new RegExp("worksheets/[^/]*?.xml"),n={},r=0;r<e.length;r++){var s=e[r].attributeList,o=s.Id,i=s.Target;t.test(i)&&(i.startsWith("/xl")?n[o]=i.substr(1):n[o]="xl/"+i)}this.sheetNameList=n}},t.prototype.getSheetFileBysheetId=function(e){return this.sheetNameList[e]},t.prototype.getWorkBookInfo=function(){var e=this.readXml.getElementsByTagName("Company",hR),t=this.readXml.getElementsByTagName("AppVersion",hR),n=this.readXml.getElementsByTagName("dc:creator",cR),r=this.readXml.getElementsByTagName("cp:lastModifiedBy",cR),s=this.readXml.getElementsByTagName("dcterms:created",cR),o=this.readXml.getElementsByTagName("dcterms:modified",cR);this.info=new BR,this.info.name=this.fileName,this.info.creator=n.length>0?n[0].value:"",this.info.lastmodifiedby=r.length>0?r[0].value:"",this.info.createdTime=s.length>0?s[0].value:"",this.info.modifiedTime=o.length>0?o[0].value:"",this.info.company=e.length>0?e[0].value:"",this.info.appversion=t.length>0?t[0].value:""},t.prototype.getSheetsFull=function(e){void 0===e&&(e=!0);var t=this.readXml.getElementsByTagName("sheets/sheet","xl/workbook.xml"),n={};for(var r in t){n[(o=t[r]).attributeList.name]=o.attributeList.sheetId}this.sheets=[];var s=0;for(var r in t){var o,i=(o=t[r]).attributeList.name,l=o.attributeList.sheetId,a=o.attributeList["r:id"],c=this.getSheetFileBysheetId(a),h=this.readXml.getElementsByTagName("worksheet/drawing",c),u=void 0,d=void 0;if(null!=h&&h.length>0){var g=TR(h[0].attributeList,"r:id",null);null!=g&&(u=this.getDrawingFile(g,c),d=this.getDrawingRelsFile(u))}if(null!=c){var f=new KR(i,l,s,e,{sheetFile:c,readXml:this.readXml,sheetList:n,styles:this.styles,sharedStrings:this.sharedStrings,calcChain:this.calcChain,imageList:this.imageList,drawingFile:u,drawingRelsFile:d});this.columnWidthSet=[],this.rowHeightSet=[],this.imagePositionCaculation(f),this.sheets.push(f),s++}}},t.prototype.extendArray=function(e,t,n,r,s){if(!(e<t.length)){var o=t.length,i=e,l=0;o>0&&(l=t[o-1]);for(var a=o;a<=i;a++){var c=n,h=a.toString();h in r?c=0:h in s&&(c=s[h]),l+=Math.round(c+1),t.push(l)}}},t.prototype.imagePositionCaculation=function(e){var t=e.images,n=e.defaultColWidth,r=e.defaultRowHeight,s={};e.config.colhidden&&(s=e.config.colhidden);var o={};e.config.columnlen&&(o=e.config.columnlen);var i={};e.config.rowhidden&&(i=e.config.rowhidden);var l={};for(var a in e.config.rowlen&&(l=e.config.rowlen),t){var c=t[a],h=c.fromCol,u=c.fromColOff,d=c.fromRow,g=c.fromRowOff,f=c.toCol,m=c.toColOff,p=c.toRow,b=c.toRowOff,_=0,v=0,C=0,T=0;h>=this.columnWidthSet.length&&this.extendArray(h,this.columnWidthSet,n,s,o),_=0==h?0:this.columnWidthSet[h-1],_+=u,d>=this.rowHeightSet.length&&this.extendArray(d,this.rowHeightSet,r,i,l),v=0==d?0:this.rowHeightSet[d-1],v+=g,f>=this.columnWidthSet.length&&this.extendArray(f,this.columnWidthSet,n,s,o),C=(C=0==f?0:this.columnWidthSet[f-1])+m-_,p>=this.rowHeightSet.length&&this.extendArray(p,this.rowHeightSet,r,i,l),T=(T=0==p?0:this.rowHeightSet[p-1])+b-v,console.log(n,s,o),console.log(h,this.columnWidthSet[h],u),console.log(f,this.columnWidthSet[f],m,JSON.stringify(this.columnWidthSet)),c.originWidth=C,c.originHeight=T,c.crop.height=T,c.crop.width=C,c.default.height=T,c.default.left=_,c.default.top=v,c.default.width=C}console.log(this.columnWidthSet,this.rowHeightSet)},t.prototype.getDrawingFile=function(e,t){var n=t.split("/"),r="xl/worksheets/_rels/"+n[n.length-1]+".rels",s=this.readXml.getElementsByTagName("Relationships/Relationship",r);if(s.length>0)for(var o=0;o<s.length;o++){var i=s[o].attributeList;if(TR(i,"Id",null)==e){var l=TR(i,"Target",null);if(null!=l)return l.replace(/\.\.\//g,"")}}return null},t.prototype.getDrawingRelsFile=function(e){var t=e.split("/");return"xl/drawings/_rels/"+t[t.length-1]+".rels"},t.prototype.getSheetsWithoutCell=function(){this.getSheetsFull(!1)},t.prototype.Parse=function(){return this.getWorkBookInfo(),this.getSheetsFull(),this.toJsonString(this)},t.prototype.toJsonString=function(e){var t=new DR;return t.info=e.info,t.sheets=[],e.sheets.forEach((function(e){var n=new PR;null!=e.name&&(n.name=e.name),null!=e.color&&(n.color=e.color),null!=e.config&&(n.config=e.config),null!=e.index&&(n.index=e.index),null!=e.status&&(n.status=e.status),null!=e.order&&(n.order=e.order),null!=e.row&&(n.row=e.row),null!=e.column&&(n.column=e.column),null!=e.luckysheet_select_save&&(n.luckysheet_select_save=e.luckysheet_select_save),null!=e.scrollLeft&&(n.scrollLeft=e.scrollLeft),null!=e.scrollTop&&(n.scrollTop=e.scrollTop),null!=e.zoomRatio&&(n.zoomRatio=e.zoomRatio),null!=e.showGridLines&&(n.showGridLines=e.showGridLines),null!=e.defaultColWidth&&(n.defaultColWidth=e.defaultColWidth),null!=e.defaultRowHeight&&(n.defaultRowHeight=e.defaultRowHeight),null!=e.celldata&&(n.celldata=[],e.celldata.forEach((function(e){var t=new HR;t.r=e.r,t.c=e.c,t.v=e.v,n.celldata.push(t)}))),null!=e.chart&&(n.chart=e.chart),null!=e.isPivotTable&&(n.isPivotTable=e.isPivotTable),null!=e.pivotTable&&(n.pivotTable=e.pivotTable),null!=e.luckysheet_conditionformat_save&&(n.luckysheet_conditionformat_save=e.luckysheet_conditionformat_save),null!=e.freezen&&(n.freezen=e.freezen),null!=e.calcChain&&(n.calcChain=e.calcChain),null!=e.images&&(n.images=e.images),t.sheets.push(n)})),JSON.stringify(t)},t}(DR),rI=function(){function e(e){this.uploadFile=e}return e.prototype.unzipFile=function(e,t){sR.loadAsync(this.uploadFile).then((function(t){var n={},r=Object.keys(t.files).length,s=0;t.forEach((function(t,o){var i=o.name.split("."),l=i[i.length-1].toLowerCase(),a="string";l in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1}?a="base64":"emf"==l&&(a="arraybuffer"),o.async(a).then((function(t){"base64"==a&&(t="data:image/"+l+";base64,"+t),n[o.name]=t,r==s+1&&e(n),s++}))}))}),(function(e){t(e)}))},e.prototype.unzipFileByUrl=function(e,t,n){new sR,xR(e,(function(e,r){if(e)throw e;sR.loadAsync(r).then((function(e){var n={},r=Object.keys(e.files).length,s=0;e.forEach((function(e,o){var i=o.name.split("."),l=i[i.length-1].toLowerCase(),a="string";l in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1}?a="base64":"emf"==l&&(a="arraybuffer"),o.async(a).then((function(e){"base64"==a&&(e="data:image/"+l+";base64,"+e),n[o.name]=e,r==s+1&&t(n),s++}))}))}),(function(e){n(e)}))}))},e.prototype.newZipFile=function(){var e=new sR;this.workBook=e},e.prototype.addToZipFile=function(e,t){if(null==this.workBook){var n=new sR;this.workBook=n}this.workBook.file(e,t)},e}(),sI=function(){function e(){}return e.transformExcelToLucky=function(e,t){new rI(e).unzipFile((function(n){var r=new nI(n,e.name).Parse(),s=JSON.parse(r);null!=t&&t(s,r)}),(function(e){console.error(e)}))},e.transformExcelToLuckyByUrl=function(e,t,n){(new rI).unzipFileByUrl(e,(function(e){var r=new nI(e,t).Parse(),s=JSON.parse(r);null!=n&&n(s,r)}),(function(e){console.error(e)}))},e.transformLuckyToExcel=function(e,t){},e}();class oI{constructor(e){this._plugin=e,this._sheetUIPlugin=this._plugin.getGlobalContext().getPluginManager().getRequirePluginByName(xd),this._toolButton={name:nR,toolbarType:1,tooltip:"importXlsx.tooltip",show:!0,labelLocale:"importXlsx.import",onClick:()=>{this.upload()}},this._sheetUIPlugin.addToolButton(this._toolButton)}upload(){const e=document.createElement("input");e.type="file",e.accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",e.addEventListener("change",(e=>{const t=e.currentTarget;this.handleFiles(t.files)})),e.click()}handleFiles(e){if(null==e||0==e.length)return void alert("No files wait for import");let t=e[0].name.split(".");if("xlsx"!==t[t.length-1])return void alert("Currently only supports the import of xlsx files");(0,sI.transformExcelToLucky)(e[0],(e=>{if(null==e.sheets||0==e.sheets.length)return void alert("Failed to read the content of the excel file, currently does not support xls files!");const t=pr({container:"universheet",data:e.sheets,title:e.info.name}).sheets;if(!t)return alert("No content");const n=this._plugin.getContext().getWorkBook(),r=C.deepClone(n.getConfig().sheetOrder);Object.keys(t).forEach((e=>{const r=t[e];n.insertSheet(r)})),r.forEach((e=>{n.removeSheetBySheetId(e)}))}))}}class iI extends Fg{execute(){this._plugin.getImportXlsxController().handleFiles(this._data)}}class lI extends zg{get zIndex(){return 1}create(e){return new iI(e,this._plugin)}check(e){const t=[];return e.forEach((e=>{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type&&t.push(e.file)})),t.length>0&&this.create(t)}}class aI extends Fo{constructor(e){super(nR)}static create(e){return new aI(e)}installTo(e){e.installPlugin(this)}initialize(){this.getGlobalContext().getLocale().load({en:tR,zh:eR}),this._importXlsxController=new oI(this),this.registerExtension()}registerExtension(){const e=this.getGlobalContext().getPluginManager().getRequirePluginByName(xd).getRegisterManager().getDragAndDropExtensionManager().getRegister();this._dragAndDropExtensionFactory=new lI(this),e.add(this._dragAndDropExtensionFactory)}onMounted(){this.initialize()}onDestroy(){this.getGlobalContext().getPluginManager().getRequirePluginByName(xd).getRegisterManager().getDragAndDropExtensionManager().getRegister().delete(this._dragAndDropExtensionFactory)}getImportXlsxController(){return this._importXlsxController}}const cI={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:re.COLUMN,posOffset:100},positionV:{relativeFrom:oe.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:U.WRAP_SQUARE,behindDoc:vt.FALSE,wrapText:F.BOTH_SIDES}},lists:{unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:E.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:21},{bulletAlignment:E.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:42},{bulletAlignment:E.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:E.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:y.ROMAN,hanging:21,indentStart:21},{bulletAlignment:E.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:y.ROMAN,hanging:21,indentStart:42},{bulletAlignment:E.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:y.ROMAN,hanging:21,indentStart:63}]}},body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"1",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},{eId:"shapeTest1",et:B.DRAWING,st:0,ed:0},{eId:"smallSub",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:bt.SUPERSCRIPT}}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"194911209911",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}]}},{blockId:"twoParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:""}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:""}}]}},{blockId:"threeParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"2018"}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"17"}}]}},{blockId:"fourParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:""}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:""}}]}},{blockId:"fiveParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:""}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"3-23"}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},hI={id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"1",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:bt.SUPERSCRIPT}}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"194911209911",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},uI={id:"workbook-01",theme:"default",locale:Qe.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:vt.FALSE,extensions:[],sheetOrder:["sheet-01","sheet-02","sheet-03","sheet-04","sheet-05","sheet-06"],pluginMeta:{},styles:{1:{cl:{rgb:"blue"},fs:16,bd:{t:{s:ye.MEDIUM_DASHED,cl:{rgb:"black"}},l:{s:ye.MEDIUM_DASHED,cl:{rgb:"black"}},r:{s:ye.THICK,cl:{rgb:"black"}},b:{s:ye.THIN,cl:{rgb:"red"}}},ht:3},2:{bg:{rgb:"rgb(200, 2, 0)"},fs:24,ht:lt.RIGHT,vt:ct.TOP},3:{ht:lt.RIGHT,vt:ct.MIDDLE,tb:ut.WRAP,bg:{rgb:"rgb(255, 255, 0)"},tr:{a:45,v:vt.FALSE},bd:{t:{s:ye.THIN,cl:{rgb:"black"}},l:{s:ye.THIN,cl:{rgb:"black"}},r:{s:ye.THIN,cl:{rgb:"black"}},b:{s:ye.THIN,cl:{rgb:"red"}}}},4:{bg:{rgb:"rgb(0, 0, 255)"}},5:{tb:ut.WRAP}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-01":{type:tt.GRID,id:"sheet-01",cellData:{0:{0:{s:"1",v:1,m:"1"},1:{s:"1",v:1,m:"1"},5:{s:"1",v:8,m:"8"},6:{s:"2",v:8,m:"8"}},1:{0:{v:1,m:"1"},1:{v:1,m:"1"},2:{v:80,m:"80",s:"3"},3:{v:"",m:"",s:"2"}},2:{0:{v:1111,m:"1111"},1:{v:1111,m:"1111"},5:{s:"1",v:8,m:"8"},6:{s:"1",v:8,m:"8"},7:{s:"1",v:8,m:"8"},8:{s:"1",v:8,m:"8"}},3:{0:{v:1111,m:"1111"},1:{v:1111,m:"1111"}},10:{9:{v:1111,s:"2",m:"1111"}},13:{9:{v:1111,s:"4",m:"1111"}},17:{3:{v:" MVCMVPMVVM ",s:"3",p:hI}},20:{10:{v:"20141019",s:"3"},12:{s:"4"}},29:{13:{p:C.deepClone(hI),s:"4"}},32:{3:{p:cI,s:"5"}}},name:"sheet1",tabColor:"red",hidden:vt.FALSE,freezeColumn:1,rowCount:1e3,columnCount:20,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:27,mergeData:[{startRow:0,endRow:1,startColumn:0,endColumn:1},{startRow:2,endRow:6,startColumn:5,endColumn:10},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:17,endRow:21,startColumn:3,endColumn:6},{startRow:13,endRow:15,startColumn:9,endColumn:10},{startRow:24,endRow:27,startColumn:9,endColumn:10},{startRow:32,endRow:53,startColumn:3,endColumn:5}],rowData:{3:{h:50,hd:vt.FALSE},4:{h:60,hd:vt.FALSE},29:{h:200,hd:vt.FALSE}},columnData:{5:{w:100,hd:vt.FALSE},6:{w:200,hd:vt.FALSE},13:{w:300,hd:vt.FALSE}},status:1,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A2"],rightToLeft:vt.FALSE,pluginMeta:{}},"sheet-02":{type:tt.GRID,id:"sheet-02",name:"sheet2",cellData:{0:{0:{s:"1",v:1,m:"1"},1:{s:"1",v:1,m:"1"},5:{s:"1",v:8,m:"8"},6:{s:"2",v:8,m:"8"}},20:{0:{v:"sheet2",m:"sheet2"},1:{v:"sheet2 - 2",m:"sheet2 - 2"}}}},"sheet-03":{type:tt.GRID,id:"sheet-03",name:"sheet3"},"sheet-04":{type:tt.GRID,id:"sheet-04",name:"sheet4"},"sheet-05":{type:tt.GRID,id:"sheet-05",name:"sheet5"},"sheet-06":{type:tt.GRID,id:"sheet-06",name:"sheet6"}},namedRanges:[{namedRangeId:"named-range-01",name:"namedRange01",range:{sheetId:"sheet-01",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}},{namedRangeId:"named-range-02",name:"namedRange02",range:{sheetId:"sheet-01",rangeData:{startRow:4,startColumn:2,endRow:5,endColumn:3}}}]},dI={id:"workbook-02",theme:"default",locale:Qe.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:vt.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{cl:{rgb:"green"},fs:16,bd:{t:{s:ye.MEDIUM_DASHED,cl:{rgb:"black"}},l:{s:ye.MEDIUM_DASHED,cl:{rgb:"black"}},r:{s:ye.THICK,cl:{rgb:"black"}},b:{s:ye.THIN,cl:{rgb:"blue"}}},ht:3},2:{bg:{rgb:"rgb(2, 200, 0)"},fs:24},3:{ht:lt.RIGHT,vt:ct.TOP,tb:ut.WRAP,bg:{rgb:"rgb(255, 255, 0)"},tr:{a:45,v:vt.FALSE},bd:{t:{s:ye.THIN,cl:{rgb:"black"}},l:{s:ye.THIN,cl:{rgb:"black"}},r:{s:ye.THIN,cl:{rgb:"black"}},b:{s:ye.THIN,cl:{rgb:"red"}}}},4:{bg:{rgb:"rgb(0, 0, 255)"}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0001":{type:tt.GRID,id:"sheet-0001",cellData:{0:{0:{s:"1",v:2,m:"2"},1:{s:"1",v:1,m:"1"},5:{s:"1",v:8,m:"8"},6:{s:"2",v:8,m:"8"}},1:{0:{v:22,m:"22"},1:{v:22,m:"22"},2:{v:80,m:"80",s:"3"},3:{v:"",m:"",s:"2"}},2:{0:{v:2222,m:"2222"},1:{v:2222,m:"2222"},5:{s:"1",v:8,m:"8"},6:{s:"1",v:8,m:"8"},7:{s:"1",v:8,m:"8"},8:{s:"1",v:8,m:"8"}},3:{0:{v:1111,m:"1111"},1:{v:1111,m:"1111"}},10:{9:{v:1111,s:"2",m:"1111"}},13:{9:{v:1111,s:"4",m:"1111"}},17:{3:{v:" MVCMVPMVVM ",s:"3",p:hI}},20:{10:{v:"20141019",s:"3"},12:{s:"4"}},29:{13:{p:C.deepClone(hI),s:"4"}}},name:"sheet0001",tabColor:"green",hidden:vt.FALSE,freezeColumn:1,rowCount:1e3,columnCount:20,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:27,mergeData:[{startRow:0,endRow:1,startColumn:0,endColumn:1},{startRow:2,endRow:6,startColumn:5,endColumn:10},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:17,endRow:21,startColumn:3,endColumn:6},{startRow:13,endRow:15,startColumn:9,endColumn:10},{startRow:24,endRow:27,startColumn:9,endColumn:10}],rowData:{3:{h:50,hd:vt.FALSE},4:{h:60,hd:vt.FALSE},29:{h:200,hd:vt.FALSE}},columnData:{5:{w:100,hd:vt.FALSE},6:{w:200,hd:vt.FALSE},13:{w:300,hd:vt.FALSE}},status:1,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A2"],rightToLeft:vt.FALSE,pluginMeta:{}},"sheet-0002":{type:tt.GRID,id:"sheet-0002",name:"sheet0003"}},namedRanges:[{namedRangeId:"named-range-0001",name:"namedRange0001",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},gI={unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:E.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:21},{bulletAlignment:E.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:42},{bulletAlignment:E.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:E.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:y.ROMAN,hanging:21,indentStart:21},{bulletAlignment:E.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:y.ROMAN,hanging:21,indentStart:42},{bulletAlignment:E.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:y.ROMAN,hanging:21,indentStart:63}]}},fI={id:"d",lists:gI,body:{blockElements:[{blockId:"p1",st:0,ed:66,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"e1",st:0,ed:66,et:B.TEXT_RUN,tr:{ct:"Whats New in the 2022 Gartner Hype Cycle for Emerging Technologies",ts:{bl:vt.TRUE,fs:16,cl:{rgb:"rgb(255,255,255)"}}}}]}},{blockId:"p2",st:67,ed:251,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:67,ed:251,et:B.TEXT_RUN,tr:{ct:"Emerging technologies for 2022 fit into three main themes: evolving/expanding immersive experiences, accelerated artificial intelligence automation, and optimized technologist delivery.",ts:{fs:12,cl:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p3",st:252,ed:401,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:252,ed:401,et:B.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle identifies 25 must-know emerging technologies designed to help enterprise architecture and technology innovation leaders: ",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}},{blockId:"p4",st:402,ed:429,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:402,ed:429,et:B.TEXT_RUN,tr:{ct:"Expand immersive experiences",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}},{blockId:"p13",st:2048,ed:2278,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"e1",st:2048,ed:2070,et:B.TEXT_RUN,tr:{ct:"Decentralized identity ",ts:{fs:12,bl:vt.TRUE}}}]}},{blockId:"p14",st:2279,ed:2421,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"e1",st:2279,ed:2293,et:B.TEXT_RUN,tr:{ct:"Digital humans ",ts:{fs:12,bl:vt.TRUE}}}]}},{blockId:"p5",st:430,ed:479,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:430,ed:479,et:B.TEXT_RUN,tr:{ct:"Accelerate artificial intelligence (AI) automation",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}},{blockId:"p15",st:2422,ed:2610,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"e1",st:2422,ed:2450,et:B.TEXT_RUN,tr:{ct:"Internal talent marketplaces ",ts:{fs:12,cl:{rgb:"rgb(0, 0, 0)"},bl:vt.TRUE}}}]}},{blockId:"p6",st:480,ed:510,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:480,ed:510,et:B.TEXT_RUN,tr:{ct:"Optimize technologist delivery ",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},mI={id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Instructions:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement",et:B.PAGE_BREAK,st:0,ed:0},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Project division - Fill in the specific division of labor after the project is disassembled:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement1",et:B.PAGE_BREAK,st:0,ed:0},{eId:"threeElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Responsible Person - Enter the responsible person's name here:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement2",et:B.PAGE_BREAK,st:0,ed:0},{eId:"fourElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Date-The specific execution time of the project (detailed to the date of a certain month), and the gray color block marks the planned real-time time of the division of labor of the project (for example,",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement3",et:B.PAGE_BREAK,st:0,ed:0},{eId:"fiveElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"the specific execution time of [regional scene model arrangement and construction] is the 2 days marked in gray. ",ts:{cl:{rgb:"rgb(92,92,92)"}}}}],paragraphStyle:{spaceAbove:10,lineSpacing:1.2}}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},pI={id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"No.",ts:{cl:{rgb:"#000"},fs:20}}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"2824163",ts:{cl:{rgb:"rgb(255,0,0)"},fs:20}}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},bI={id:"workbook-01",theme:"default",locale:Qe.EN,creator:"univer",name:"UniverSheet Demo",skin:"default",socketUrl:"",socketEnable:vt.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{idtqdi:{ht:2},P_LfgH:{ht:2,vt:2},"dTW-2H":{ht:2,vt:2,cl:{rgb:"#fff"}},AZ992T:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}}},"3sU7Wt":{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}}},Z1mNVr:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"#fff"}},mkFqf3:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgb(237,125,49)"}},qFGJGc:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgb(237,125,49)"},fs:20},"9K8lPD":{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgb(237,125,49)"},fs:20,bl:1},KT84dD:{bg:{rgb:"rgb(237,125,49)"}},qDQuhZ:{bg:{rgb:"rgb(237,125,49)"},ht:2},"4C9ySZ":{bg:{rgb:"rgb(237,125,49)"},ht:2,vt:2},"91b7gh":{ht:2,vt:2,tb:3},u5otPe:{bd:{}},lQ8z14:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgb(237,125,49)"},fs:20,bl:1,bd:{t:{s:1,cl:{rgb:"#000"}},l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},bcVHEL:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgb(237,125,49)"},fs:20,bl:1,bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},KrPXyW:{bg:{rgb:"rgb(237,125,49)"},ht:2,vt:2,bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},f9cBiW:{bg:{rgb:"rgb(237,125,49)"},ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},"3_YUYr":{ht:2,vt:2,tb:3,bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},njh8Q5:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},DqvAmw:{bd:{t:{s:1,cl:{rgb:"#000"}},l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},e9siET:{bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},M9lQgx:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},Jc7bxM:{bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},goS_3_:{bd:{t:{s:1,cl:{rgb:"#000"}},l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2},"08dwws":{bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2},"5UPiTC":{bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2},"0oPndb":{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2},F_LZQL:{bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2},hBtso7:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2},c27I5b:{vt:2,ht:2,bd:{t:{s:1,cl:{rgb:"#000"}},l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},bg:{rgb:"rgb(177,166,223)"}},aA37LW:{bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,bg:{rgb:"rgb(177,166,223)"}},AeAego:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,bg:{rgb:"rgb(177,166,223)"}},YYhEgD:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},bg:{rgb:"rgb(177,166,223)"}},qdFDeG:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#999"}},"7J2-B1":{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#999"}},KAKWgT:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#999"},ul:{s:0,cl:{rgb:"#999"}}},IJFGac:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#999"},ul:{s:0,cl:{rgb:"#999"}}},a293m8:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#999"},ul:{s:0,cl:{rgb:"#999"}},st:{s:0,cl:{rgb:"#999"}}},qtPq3K:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#999"},ul:{s:0,cl:{rgb:"#999"}},st:{s:0,cl:{rgb:"#999"}}},RrHp6L:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#999"}},st:{s:0,cl:{rgb:"#999"}}},_ICBZy:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#999"}},st:{s:0,cl:{rgb:"#999"}}},epwOZX:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#999"}}},rpElXw:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#999"}}},"4i0fZ-":{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#ccc"}}},WsPcQD:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#ccc"}}},ltItGP:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"}},baZ2Vp:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}}},EY_PQ9:{bd:{},vt:2},qlUeY8:{bd:{t:{s:5,cl:{rgb:"#fff"}},l:{s:5,cl:{rgb:"#fff"}},r:{s:5,cl:{rgb:"#fff"}},b:{s:5,cl:{rgb:"#fff"}}}},ilOCwO:{bd:{t:{s:5,cl:{rgb:"#fff"}},r:{s:5,cl:{rgb:"#fff"}},b:{s:5,cl:{rgb:"#fff"}}}},oToIA8:{bd:{l:{s:5,cl:{rgb:"#fff"}},r:{s:5,cl:{rgb:"#fff"}},b:{s:5,cl:{rgb:"#fff"}}}},dzzzqn:{bd:{r:{s:5,cl:{rgb:"#fff"}},b:{s:5,cl:{rgb:"#fff"}}}},lxyoad:{bd:{t:{s:1,cl:{rgb:"#fff"}},r:{s:1,cl:{rgb:"#fff"}},b:{s:1,cl:{rgb:"#fff"}}}},eoTO7a:{bd:{l:{s:1,cl:{rgb:"#fff"}},r:{s:1,cl:{rgb:"#fff"}},b:{s:1,cl:{rgb:"#fff"}}}},jbpbgG:{bd:{r:{s:1,cl:{rgb:"#fff"}},b:{s:1,cl:{rgb:"#fff"}}}},uzcHK6:{bd:{t:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,bg:{rgb:"rgb(177,166,223)"}},khtUqL:{ht:2,vt:2,bd:{b:{s:1,cl:{rgb:"#000"}}},bg:{rgb:"rgb(177,166,223)"}},"-4GCh_":{ht:2,vt:2,bd:{b:{s:1,cl:{rgb:"#000"}}}},"7KeeG7":{ht:2,vt:2,bd:{b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#ccc"}}},pPK4L1:{bd:{l:{s:1,cl:{rgb:"#fff"}},b:{s:1,cl:{rgb:"#fff"}}}},1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:ye.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:0},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},56:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#9fc5e8"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},57:{ht:1,vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0006":{name:"sheet-0006",status:1,id:"sheet-0006",type:0,tabColor:"",hidden:0,freezeColumn:-1,rowCount:15,columnCount:9,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:73,defaultRowHeight:25,mergeData:[{startRow:1,startColumn:1,endRow:1,endColumn:7},{startRow:9,startColumn:1,endRow:9,endColumn:7},{startRow:0,startColumn:0,endRow:14,endColumn:0},{startRow:0,startColumn:8,endRow:9,endColumn:8},{startRow:10,startColumn:1,endRow:14,endColumn:8},{startRow:0,startColumn:1,endRow:0,endColumn:7}],hideRow:[],hideColumn:[],cellData:{0:{0:{s:"31"},1:{s:"u5otPe"},2:{s:"u5otPe"},3:{s:"u5otPe"},4:{s:"u5otPe"},5:{s:"u5otPe"},6:{s:"u5otPe"},7:{s:"u5otPe"},8:{s:"31"},9:{s:"u5otPe"}},1:{0:{s:"pPK4L1"},1:{v:"",m:"",s:"c27I5b"},2:{s:"aA37LW"},3:{s:"aA37LW"},4:{s:"aA37LW"},5:{s:"aA37LW"},6:{s:"aA37LW"},7:{s:"aA37LW"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},2:{0:{s:"pPK4L1"},1:{v:"",m:"",s:"AeAego"},2:{v:"",m:"",s:"YYhEgD"},3:{v:"",m:"",s:"YYhEgD"},4:{v:"",m:"",s:"YYhEgD"},5:{v:"",m:"",s:"YYhEgD"},6:{v:"",m:"",s:"YYhEgD"},7:{v:"",m:"",s:"YYhEgD"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},3:{0:{s:"pPK4L1"},1:{v:"27",m:"27",s:"4i0fZ-"},2:{v:"28",m:"28",s:"WsPcQD"},3:{v:"29",m:"29",s:"WsPcQD"},4:{v:"30",m:"30",s:"WsPcQD"},5:{v:"31",m:"31",s:"WsPcQD"},6:{v:"1",m:"1",s:"njh8Q5"},7:{v:"2",m:"2",s:"njh8Q5"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},4:{0:{s:"pPK4L1"},1:{v:"3",m:"3",s:"hBtso7"},2:{v:"4",m:"4",s:"njh8Q5"},3:{v:"5",m:"5",s:"njh8Q5"},4:{v:"6",m:"6",s:"njh8Q5"},5:{v:"7",m:"7",s:"njh8Q5"},6:{v:"8",m:"8",s:"njh8Q5"},7:{v:"9",m:"9",s:"njh8Q5"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},5:{0:{s:"pPK4L1"},1:{v:"10",m:"10",s:"hBtso7"},2:{v:"11",m:"11",s:"njh8Q5"},3:{v:"12",m:"12",s:"njh8Q5"},4:{v:"13",m:"13",s:"njh8Q5"},5:{v:"14",m:"14",s:"njh8Q5"},6:{v:"15",m:"15",s:"njh8Q5"},7:{v:"16",m:"16",s:"njh8Q5"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},6:{0:{s:"pPK4L1"},1:{v:"17",m:"17",s:"hBtso7"},2:{v:"18",m:"18",s:"njh8Q5"},3:{v:"19",m:"19",s:"njh8Q5"},4:{v:"20",m:"20",s:"njh8Q5"},5:{v:"21",m:"21",s:"njh8Q5"},6:{v:"22",m:"22",s:"njh8Q5"},7:{v:"23",m:"23",s:"njh8Q5"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},7:{0:{s:"pPK4L1"},1:{v:"24",m:"24",s:"hBtso7"},2:{v:"25",m:"25",s:"njh8Q5"},3:{v:"26",m:"26",s:"njh8Q5"},4:{v:"27",m:"27",s:"njh8Q5"},5:{v:"28",m:"28",s:"njh8Q5"},6:{v:"29",m:"29",s:"njh8Q5"},7:{v:"30",m:"30",s:"njh8Q5"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},8:{0:{s:"pPK4L1"},1:{v:"31",m:"31",s:"hBtso7"},2:{v:"1",m:"1",s:"WsPcQD"},3:{v:"2",m:"2",s:"WsPcQD"},4:{v:"3",m:"3",s:"WsPcQD"},5:{v:"4",m:"4",s:"WsPcQD"},6:{v:"5",m:"5",s:"WsPcQD"},7:{v:"6",m:"6",s:"WsPcQD"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},9:{0:{s:"eoTO7a"},1:{v:"20",m:"20",s:"EY_PQ9"},2:{v:"",m:"",s:"EY_PQ9"},3:{v:"",m:"",s:"EY_PQ9"},4:{v:"",m:"",s:"EY_PQ9"},5:{v:"",m:"",s:"EY_PQ9"},6:{v:"",m:"",s:"EY_PQ9"},7:{v:"",m:"",s:"EY_PQ9"},8:{s:"eoTO7a"},9:{s:"u5otPe"}},10:{0:{s:"eoTO7a"},1:{s:"lxyoad"},2:{s:"lxyoad"},3:{s:"lxyoad"},4:{s:"lxyoad"},5:{s:"lxyoad"},6:{s:"lxyoad"},7:{s:"lxyoad"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},11:{0:{s:"eoTO7a"},1:{s:"jbpbgG"},2:{s:"jbpbgG"},3:{s:"jbpbgG"},4:{s:"jbpbgG"},5:{s:"jbpbgG"},6:{s:"jbpbgG"},7:{s:"jbpbgG"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},12:{0:{s:"eoTO7a"},1:{s:"jbpbgG"},2:{s:"jbpbgG"},3:{s:"jbpbgG"},4:{s:"jbpbgG"},5:{s:"jbpbgG"},6:{s:"jbpbgG"},7:{s:"jbpbgG"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},13:{0:{s:"eoTO7a"},1:{s:"jbpbgG"},2:{s:"jbpbgG"},3:{s:"jbpbgG"},4:{s:"jbpbgG"},5:{s:"jbpbgG"},6:{s:"jbpbgG"},7:{s:"jbpbgG"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},14:{0:{s:"eoTO7a"},1:{s:"jbpbgG"},2:{s:"jbpbgG"},3:{s:"jbpbgG"},4:{s:"jbpbgG"},5:{s:"jbpbgG"},6:{s:"jbpbgG"},7:{s:"jbpbgG"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},15:{0:{s:"u5otPe"},1:{s:"u5otPe"},2:{s:"u5otPe"},3:{s:"u5otPe"},4:{s:"u5otPe"},5:{s:"u5otPe"},6:{s:"u5otPe"},7:{s:"u5otPe"},8:{s:"u5otPe"}}},rowData:{0:{hd:0,h:15},9:{h:30},22:{hd:0,h:10}},columnData:{0:{w:15,hd:0}},showGridlines:1,rowTitle:{width:46,hidden:0},columnTitle:{height:20,hidden:0},selections:["A1"],rightToLeft:0,pluginMeta:{}},"sheet-0005":{name:"sheet-0005",status:0,id:"sheet-0005",type:0,tabColor:"",hidden:0,freezeColumn:-1,rowCount:1e3,columnCount:100,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:73,defaultRowHeight:25,mergeData:[{startRow:37,endRow:36,startColumn:1,endColumn:2},{startRow:0,startColumn:0,endRow:0,endColumn:7},{startRow:1,startColumn:0,endRow:2,endColumn:0},{startRow:1,startColumn:1,endRow:2,endColumn:1},{startRow:1,startColumn:3,endRow:1,endColumn:4},{startRow:1,startColumn:5,endRow:2,endColumn:6},{startRow:1,startColumn:2,endRow:2,endColumn:2},{startRow:1,startColumn:7,endRow:2,endColumn:7},{startRow:3,startColumn:0,endRow:7,endColumn:0},{startRow:8,startColumn:0,endRow:12,endColumn:0},{startRow:13,startColumn:0,endRow:17,endColumn:0},{startRow:18,startColumn:0,endRow:22,endColumn:0},{startRow:23,startColumn:0,endRow:27,endColumn:0},{startRow:28,startColumn:0,endRow:32,endColumn:0},{startRow:33,startColumn:0,endRow:37,endColumn:0}],hideRow:[],hideColumn:[],cellData:{0:{0:{v:"",m:"",s:"lQ8z14"},1:{s:"bcVHEL"},2:{s:"bcVHEL"},3:{s:"bcVHEL"},4:{s:"bcVHEL"},5:{s:"bcVHEL"},6:{s:"bcVHEL"},7:{s:"bcVHEL"},8:{s:"u5otPe"}},1:{0:{v:"",m:"",s:"KrPXyW"},1:{v:"",m:"",s:"f9cBiW"},2:{v:"",m:"",s:"f9cBiW"},3:{v:"",m:"",s:"f9cBiW"},4:{v:"",m:"",s:"f9cBiW"},5:{v:"",m:"",s:"f9cBiW"},6:{s:"f9cBiW"},7:{v:"",m:"",s:"f9cBiW"},8:{s:"u5otPe"}},2:{0:{v:"",m:"",s:"KrPXyW"},1:{v:"",m:"",s:"f9cBiW"},2:{v:"",m:"",s:"f9cBiW"},3:{v:"",m:"",s:"f9cBiW"},4:{v:"",m:"",s:"f9cBiW"},5:{s:"f9cBiW"},6:{s:"f9cBiW"},7:{s:"f9cBiW"},8:{s:"u5otPe"}},3:{0:{v:"2021-6-1",m:"2021-6-1",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},4:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},5:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},6:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},7:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},8:{0:{v:"2021-6-2",m:"2021-6-2",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},9:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},10:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},11:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},12:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},13:{0:{v:"2021-6-3",m:"2021-6-3",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},14:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},15:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},16:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},17:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},18:{0:{v:"2021-6-4",m:"2021-6-4",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},19:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},20:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},21:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},22:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},23:{0:{v:"2021-6-5",m:"2021-6-5",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},24:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},25:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},26:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},27:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},28:{0:{v:"2021-6-5",m:"2021-6-5",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},29:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},30:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},31:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},32:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},33:{0:{v:"2021-6-5",m:"2021-6-5",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},34:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},35:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},36:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},37:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},38:{0:{s:"u5otPe"},1:{s:"u5otPe"},2:{s:"u5otPe"},3:{s:"u5otPe"},4:{s:"u5otPe"},5:{s:"u5otPe"},6:{s:"u5otPe"},7:{s:"u5otPe"}}},rowData:{0:{hd:0,h:40},44:{hd:0,h:20}},columnData:{2:{w:120}},showGridlines:1,rowTitle:{width:46,hidden:0},columnTitle:{height:20,hidden:0},selections:["A1"],rightToLeft:0,pluginMeta:{}},"sheet-0004":{type:tt.GRID,id:"sheet-0004",name:"sheet0004",cellData:{0:{0:{s:"40"},1:{m:"Travel Declaration Form",s:"40"},8:{p:pI,s:"41"},10:{s:"52"}},1:{1:{m:"Department:",s:"42"},6:{m:"Application Date:",s:"42"}},2:{1:{m:"Business Trip Employee",s:"43"},2:{s:"46"},3:{m:"Position",s:"46"},4:{s:"46"},6:{s:"46",m:"Entourage"},7:{s:"47"},10:{m:"Borrower write-off",s:"53"}},3:{1:{m:"Business Trip Place",s:"44"},2:{m:"                      To                      To                      To",s:"48"}},4:{1:{m:"Amount",s:"44"},2:{m:"(Capital)                                                         ",s:"49"},7:{m:"(Lower) ",s:"48"}},5:{1:{m:"Departure Time",s:"44"},2:{s:"49"},3:{m:"ETR",s:"50"},5:{s:"50"},8:{m:"Days",s:"50"},9:{s:"48"}},6:{1:{m:"Reasons",s:"44"},2:{s:"48"}},7:{1:{m:"Applicant For Travel",s:"44"},2:{s:"50"},3:{m:"Administrator",s:"50"},4:{s:"50"},6:{m:"Financial Manager",s:"50"},7:{s:"50"},9:{m:"Payee",s:"51"}},8:{1:{m:"Department Head",s:"44"},2:{s:"50"},3:{m:"Manager",s:"50"},4:{s:"50"},6:{m:"Cashier",s:"50"},7:{s:"50"},9:{s:"51"}},9:{1:{m:"Record: The loan is used exclusively for travel expenses, and the travel expenses will not be written off without a business trip application.",s:"45"}}},tabColor:"blue",hidden:vt.FALSE,freezeColumn:1,rowCount:13,columnCount:14,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:40,mergeData:[{startRow:0,endRow:1,startColumn:10,endColumn:10},{startRow:0,endRow:9,startColumn:0,endColumn:0},{startRow:0,endRow:0,startColumn:1,endColumn:7},{startRow:0,endRow:0,startColumn:8,endColumn:9},{startRow:1,endRow:1,startColumn:1,endColumn:4},{startRow:1,endRow:1,startColumn:6,endColumn:9},{startRow:2,endRow:2,startColumn:4,endColumn:5},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:3,endRow:3,startColumn:2,endColumn:9},{startRow:4,endRow:4,startColumn:2,endColumn:6},{startRow:4,endRow:4,startColumn:7,endColumn:9},{startRow:5,endRow:5,startColumn:3,endColumn:4},{startRow:5,endRow:5,startColumn:5,endColumn:7},{startRow:6,endRow:6,startColumn:2,endColumn:9},{startRow:7,endRow:7,startColumn:4,endColumn:5},{startRow:8,endRow:8,startColumn:7,endColumn:8},{startRow:8,endRow:8,startColumn:4,endColumn:5},{startRow:7,endRow:7,startColumn:7,endColumn:8},{startRow:9,endRow:9,startColumn:1,endColumn:9},{startRow:2,endRow:9,startColumn:10,endColumn:10}],rowData:{0:{h:50},1:{h:20},6:{h:150},9:{h:30}},columnData:{0:{w:20},1:{w:180},2:{w:120},4:{w:60},5:{w:60},7:{w:30},8:{w:90},10:{w:40}},status:0,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A2"],rightToLeft:vt.FALSE,pluginMeta:{}},"sheet-0003":{type:tt.GRID,id:"sheet-0003",name:"sheet0003",cellData:{0:{1:{m:"Purchase Orders ",s:"56"},4:{s:"31"},5:{m:"Number:",s:"32"},6:{s:"31"},7:{p:fI,s:"57"}},1:{4:{s:"31"}},2:{4:{m:"[Company]:",s:"33"},5:{s:"34"}},3:{4:{m:"[Adress]:",s:"33"},5:{s:"34"}},4:{4:{m:"[TEL]:",s:"33"},5:{s:"34"}},5:{4:{m:"[FAX]:",s:"33"},5:{s:"34"}},6:{1:{s:"32"}},7:{1:{m:"Subscriber:",s:"32"},2:{s:"34"},3:{m:"Order Date:",s:"32"},4:{s:"34"},5:{m:"Telephone:",s:"32"},6:{s:"34"}},8:{1:{m:"Payment:",s:"32"},2:{s:"34"},3:{m:"Delivery:",s:"32"},4:{s:"34"},5:{s:"32"},6:{s:"32"}},9:{1:{s:"32"}},10:{1:{m:"SKU",s:"35"},2:{m:"Product name ",s:"35"},4:{m:"Quantity",s:"35"},5:{m:"Price",s:"35"},6:{m:"Amount",s:"35"}},11:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"1",v:"1"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"10",v:"10"}},12:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"20",v:"20"}},13:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"2",v:"2"},6:{s:"36"}},14:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},15:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},16:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},17:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},18:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},19:{1:{m:"Remark ",s:"37"},2:{m:"If there is any problem, please list the specific reasons in writing and fax to contact the company.",s:"38"},5:{m:"Subtotal",s:"39"},6:{s:"36"}},20:{5:{m:"Tax",s:"39"},6:{s:"36"}},21:{5:{m:"Freight",s:"39"},6:{s:"36"}},22:{5:{m:"Total ",s:"39"},6:{s:"36"}},23:{1:{s:"32"}},24:{1:{m:"Approval of Responsible Person:",s:"55"},2:{s:"34"},3:{m:"Accountant:",s:"55"},4:{s:"34"},5:{m:"Responsible Person:",s:"55"},6:{s:"34"}},25:{1:{m:"Company:",s:"55"},2:{s:"34"},3:{s:"32"},4:{s:"32"},5:{m:"Date:",s:"55"},6:{s:"34"}},26:{1:{s:"54"}}},tabColor:"green",hidden:vt.FALSE,freezeColumn:1,rowCount:100,columnCount:8,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:25,mergeData:[{startRow:0,endRow:5,startColumn:1,endColumn:3},{startRow:1,endRow:1,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:5,endColumn:6},{startRow:3,endRow:3,startColumn:5,endColumn:6},{startRow:4,endRow:4,startColumn:5,endColumn:6},{startRow:5,endRow:5,startColumn:5,endColumn:6},{startRow:6,endRow:6,startColumn:1,endColumn:6},{startRow:9,endRow:9,startColumn:1,endColumn:6},{startRow:10,endRow:10,startColumn:2,endColumn:3},{startRow:11,endRow:11,startColumn:2,endColumn:3},{startRow:12,endRow:12,startColumn:2,endColumn:3},{startRow:13,endRow:13,startColumn:2,endColumn:3},{startRow:14,endRow:14,startColumn:2,endColumn:3},{startRow:15,endRow:15,startColumn:2,endColumn:3},{startRow:16,endRow:16,startColumn:2,endColumn:3},{startRow:17,endRow:17,startColumn:2,endColumn:3},{startRow:18,endRow:18,startColumn:2,endColumn:3},{startRow:19,endRow:22,startColumn:1,endColumn:1},{startRow:19,endRow:22,startColumn:2,endColumn:4},{startRow:23,endRow:23,startColumn:1,endColumn:6},{startRow:0,endRow:26,startColumn:0,endColumn:0},{startRow:0,endRow:26,startColumn:7,endColumn:7},{startRow:26,endRow:26,startColumn:1,endColumn:6}],rowData:{9:{h:10},23:{h:30},24:{h:70}},columnData:{0:{w:30},1:{w:80},2:{w:120},3:{w:80},7:{w:200}},status:0,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A2"],rightToLeft:vt.FALSE,pluginMeta:{}},"sheet-0002":{type:tt.GRID,id:"sheet-0002",name:"sheet0002",cellData:{0:{0:{m:"Annual Work Schedule",s:"11"}},1:{0:{s:"12"},1:{s:"12"},16:{s:"12"}},2:{0:{s:"12"},1:{m:"1/2",s:"13"},4:{m:"3/8",s:"15"},7:{m:"1/4",s:"16"},10:{m:"1/4",s:"17"},13:{m:"1/4",s:"18"},16:{s:"12"}},3:{1:{s:"12"}},4:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{m:"",s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},5:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase  Products",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},6:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},7:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},8:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},9:{1:{s:"12"}},10:{1:{s:"12"},2:{s:"19",m:"January"},3:{s:"12"},4:{s:"12"},5:{s:"20",m:"February"},6:{s:"12"},7:{s:"12"},8:{s:"21",m:"March"},9:{s:"12"},10:{s:"12"},11:{s:"22",m:"April"},12:{s:"12"},13:{s:"12"},14:{s:"23",m:"May"},15:{s:"12"}},11:{1:{s:"12"}},12:{0:{s:"12"},1:{m:"1/3",s:"13"},4:{m:"3/5",s:"15"},7:{m:"1/2",s:"16"},10:{m:"3/4",s:"17"},13:{m:"5/6",s:"18"},16:{s:"12"}},13:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{m:"",s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},14:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase Products",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},15:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},16:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},17:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},18:{0:{s:"12"}},25:{0:{m:"",s:"123"}}},tabColor:"yellow",hidden:vt.FALSE,freezeColumn:1,rowCount:26,columnCount:17,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:16},{startRow:1,endRow:17,startColumn:0,endColumn:0},{startRow:1,endRow:17,startColumn:16,endColumn:16},{startRow:1,endRow:1,startColumn:1,endColumn:15},{startRow:3,endRow:3,startColumn:1,endColumn:15},{startRow:2,endRow:2,startColumn:1,endColumn:3},{startRow:2,endRow:2,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:2,endRow:2,startColumn:10,endColumn:12},{startRow:2,endRow:2,startColumn:13,endColumn:15},{startRow:9,endRow:9,startColumn:1,endColumn:15},{startRow:11,endRow:11,startColumn:1,endColumn:15},{startRow:12,endRow:12,startColumn:1,endColumn:3},{startRow:12,endRow:12,startColumn:4,endColumn:6},{startRow:12,endRow:12,startColumn:7,endColumn:9},{startRow:12,endRow:12,startColumn:10,endColumn:12},{startRow:12,endRow:12,startColumn:13,endColumn:15},{startRow:18,endRow:22,startColumn:0,endColumn:16}],rowData:{0:{h:70},3:{h:20},9:{h:20},10:{h:40},11:{h:20}},columnData:{0:{w:50},1:{w:20},2:{w:150},3:{w:30},4:{w:20},5:{w:150},6:{w:30},7:{w:20},8:{w:150},9:{w:30},10:{w:20},11:{w:150},12:{w:30},13:{w:20},14:{w:150},15:{w:30},16:{w:50}},status:0,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A2"],rightToLeft:vt.FALSE,pluginMeta:{}},"sheet-0001":{type:tt.GRID,id:"sheet-0001",cellData:{0:{0:{s:"1",m:"A Schedule of Items"}},1:{0:{s:"2",m:"Division of Project"},1:{s:"3",m:"Responsible Person"},2:{s:"4",m:"Date"}},2:{0:{m:"General Project Manager",s:"5"},1:{m:"@XXX",s:"6"},2:{m:"March 1",s:"5"},3:{m:"March 2",s:"5"},4:{m:"March 3",s:"5"},5:{m:"March 4",s:"5"},6:{m:"March 5",s:"5"},7:{m:"March 6",s:"5"},8:{m:"March 7",s:"5"},9:{m:"March 8",s:"5"},10:{m:"March 9",s:"5"},11:{m:"March 10",s:"5"},12:{m:"March 11",s:"5"},13:{m:"March 12",s:"5"},14:{m:"March 13",s:"5"}},3:{0:{m:"1Responsible Person of Model Section",s:"7"},1:{m:"@George",s:"8"}},4:{0:{m:"Advertisement Signboard",s:"9"},1:{m:"@Paul",s:"6"},4:{s:"10"},5:{s:"10"},6:{s:"10"},7:{s:"10"},8:{s:"10"},9:{s:"10"},10:{s:"10"}},5:{0:{m:"Transport Ready",s:"9"},1:{m:"@George",s:"6"}},6:{0:{m:"2Head of Special Effects Section",s:"7"},1:{m:"@Paul",s:"8"}},7:{0:{m:"Render Output Parameter Test",s:"9"},1:{m:"@Paul",s:"6"},3:{s:"25"},4:{s:"25"},5:{s:"25"},6:{s:"25"},7:{s:"25"},8:{s:"25"},9:{s:"25"}},8:{0:{m:"Camera Moving Mirror",s:"9"},1:{m:"@Paul",s:"6"}},9:{0:{m:"3Responsible Person of Rendering Section",s:"7"},1:{m:"@Jennifer",s:"8"}},10:{0:{m:"Scene Dynamic Element Design",s:"9"},7:{s:"27"},8:{s:"27"},9:{s:"27"},10:{s:"27"},11:{s:"27"}},11:{0:{m:"Sky Map Selection",s:"9"}},12:{0:{m:"Reference Scenario Data Collection",s:"9"}},13:{0:{m:"Scene Dynamic Element Design",s:"9"},2:{s:"29"},3:{s:"29"},4:{s:"29"},5:{s:"29"},6:{s:"29"},7:{s:"29"}},14:{0:{p:mI}}},name:"sheet0001",tabColor:"red",hidden:vt.FALSE,freezeColumn:1,rowCount:15,columnCount:15,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:14},{startRow:1,endRow:1,startColumn:2,endColumn:14},{startRow:14,endRow:14,startColumn:0,endColumn:14}],rowData:{0:{h:70},2:{h:20},3:{h:20},4:{h:20},5:{h:20},6:{h:20},7:{h:20},8:{h:20},9:{h:20},10:{h:20},11:{h:20},12:{h:20},13:{h:20},14:{h:200}},columnData:{0:{w:250},1:{w:130},2:{w:60},3:{w:60},4:{w:60},5:{w:60},6:{w:60},7:{w:60},8:{w:60},9:{w:60},10:{w:60},11:{w:60},12:{w:60},13:{w:60},14:{w:60}},status:0,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A2"],rightToLeft:vt.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},_I={id:"workbook-01",theme:"default",locale:Qe.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:vt.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:ye.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:1},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},56:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#9fc5e8"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0003":{type:tt.GRID,id:"sheet-0003",name:"sheet0003",cellData:{0:{1:{m:"Purchase Orders ",s:"56"},4:{s:"31"},5:{m:"Number:",s:"32"},6:{s:"31"}},1:{4:{s:"31"}},2:{4:{m:"[Company]:",s:"33"},5:{s:"34"}},3:{4:{m:"[Adress]:",s:"33"},5:{s:"34"}},4:{4:{m:"[TEL]:",s:"33"},5:{s:"34"}},5:{4:{m:"[FAX]:",s:"33"},5:{s:"34"}},6:{1:{s:"32"}},7:{1:{m:"Subscriber:",s:"32"},2:{s:"34"},3:{m:"Order Date:",s:"32"},4:{s:"34"},5:{m:"Telephone:",s:"32"},6:{s:"34"}},8:{1:{m:"Payment:",s:"32"},2:{s:"34"},3:{m:"Delivery:",s:"32"},4:{s:"34"},5:{s:"32"},6:{s:"32"}},9:{1:{s:"32"}},10:{1:{m:"SKU",s:"35"},2:{m:"Product name ",s:"35"},4:{m:"Quantity",s:"35"},5:{m:"Price",s:"35"},6:{m:"Amount",s:"35"}},11:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"1",v:"1"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"10",v:"10"}},12:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"20",v:"20"}},13:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"2",v:"2"},6:{s:"36"}},14:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},15:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},16:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},17:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},18:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},19:{1:{m:"Remark ",s:"37"},2:{m:"If there is any problem, please list the specific reasons in writing and fax to contact the company.",s:"38"},5:{m:"Subtotal",s:"39"},6:{s:"36"}},20:{5:{m:"Tax",s:"39"},6:{s:"36"}},21:{5:{m:"Freight",s:"39"},6:{s:"36"}},22:{5:{m:"Total ",s:"39"},6:{s:"36"}},23:{1:{s:"32"}},24:{1:{m:"Approval of Responsible Person:",s:"55"},2:{s:"34"},3:{m:"Accountant:",s:"55"},4:{s:"34"},5:{m:"Responsible Person:",s:"55"},6:{s:"34"}},25:{1:{m:"Company:",s:"55"},2:{s:"34"},3:{s:"32"},4:{s:"32"},5:{m:"Date:",s:"55"},6:{s:"34"}},26:{1:{s:"54"}}},tabColor:"green",hidden:vt.FALSE,freezeColumn:1,rowCount:27,columnCount:8,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:25,mergeData:[{startRow:0,endRow:5,startColumn:1,endColumn:3},{startRow:1,endRow:1,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:5,endColumn:6},{startRow:3,endRow:3,startColumn:5,endColumn:6},{startRow:4,endRow:4,startColumn:5,endColumn:6},{startRow:5,endRow:5,startColumn:5,endColumn:6},{startRow:6,endRow:6,startColumn:1,endColumn:6},{startRow:9,endRow:9,startColumn:1,endColumn:6},{startRow:10,endRow:10,startColumn:2,endColumn:3},{startRow:11,endRow:11,startColumn:2,endColumn:3},{startRow:12,endRow:12,startColumn:2,endColumn:3},{startRow:13,endRow:13,startColumn:2,endColumn:3},{startRow:14,endRow:14,startColumn:2,endColumn:3},{startRow:15,endRow:15,startColumn:2,endColumn:3},{startRow:16,endRow:16,startColumn:2,endColumn:3},{startRow:17,endRow:17,startColumn:2,endColumn:3},{startRow:18,endRow:18,startColumn:2,endColumn:3},{startRow:19,endRow:22,startColumn:1,endColumn:1},{startRow:19,endRow:22,startColumn:2,endColumn:4},{startRow:23,endRow:23,startColumn:1,endColumn:6},{startRow:0,endRow:26,startColumn:0,endColumn:0},{startRow:0,endRow:26,startColumn:7,endColumn:7},{startRow:26,endRow:26,startColumn:1,endColumn:6}],rowData:{9:{h:10},23:{h:30},24:{h:70}},columnData:{0:{w:30},1:{w:80},2:{w:120},3:{w:80},7:{w:30}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A2"],rightToLeft:vt.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0003",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},vI={id:"workbook-01",theme:"default",locale:Qe.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:vt.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:ye.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:1},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0002":{type:tt.GRID,id:"sheet-0002",name:"sheet0003",cellData:{0:{0:{m:"Annual Work Schedule",s:"11"}},1:{0:{s:"12"},1:{s:"12"},16:{s:"12"}},2:{0:{s:"12"},1:{m:"1/2",s:"13"},4:{m:"3/8",s:"15"},7:{m:"1/4",s:"16"},10:{m:"1/4",s:"17"},13:{m:"1/4",s:"18"},16:{s:"12"}},3:{1:{s:"12"}},4:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{m:"",s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},5:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase  Products",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},6:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},7:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},8:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},9:{1:{s:"12"}},10:{1:{s:"12"},2:{s:"19",m:"January"},3:{s:"12"},4:{s:"12"},5:{s:"20",m:"February"},6:{s:"12"},7:{s:"12"},8:{s:"21",m:"March"},9:{s:"12"},10:{s:"12"},11:{s:"22",m:"April"},12:{s:"12"},13:{s:"12"},14:{s:"23",m:"May"},15:{s:"12"}},11:{1:{s:"12"}},12:{0:{s:"12"},1:{m:"1/3",s:"13"},4:{m:"3/5",s:"15"},7:{m:"1/2",s:"16"},10:{m:"3/4",s:"17"},13:{m:"5/6",s:"18"},16:{s:"12"}},13:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{m:"",s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},14:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase Products",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{m:"",s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{m:"",s:"14"}},15:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{m:"",s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},16:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},17:{0:{s:"12"},1:{s:"12"},2:{m:"",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"",s:"14"},15:{s:"14"}},18:{0:{s:"12"}},25:{0:{m:"",s:"123"}}},tabColor:"yellow",hidden:vt.FALSE,freezeColumn:1,rowCount:26,columnCount:17,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:16},{startRow:1,endRow:17,startColumn:0,endColumn:0},{startRow:1,endRow:17,startColumn:16,endColumn:16},{startRow:1,endRow:1,startColumn:1,endColumn:15},{startRow:3,endRow:3,startColumn:1,endColumn:15},{startRow:2,endRow:2,startColumn:1,endColumn:3},{startRow:2,endRow:2,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:2,endRow:2,startColumn:10,endColumn:12},{startRow:2,endRow:2,startColumn:13,endColumn:15},{startRow:9,endRow:9,startColumn:1,endColumn:15},{startRow:11,endRow:11,startColumn:1,endColumn:15},{startRow:12,endRow:12,startColumn:1,endColumn:3},{startRow:12,endRow:12,startColumn:4,endColumn:6},{startRow:12,endRow:12,startColumn:7,endColumn:9},{startRow:12,endRow:12,startColumn:10,endColumn:12},{startRow:12,endRow:12,startColumn:13,endColumn:15},{startRow:18,endRow:22,startColumn:0,endColumn:16}],rowData:{0:{h:70},3:{h:20},9:{h:20},10:{h:40},11:{h:20}},columnData:{0:{w:50},1:{w:20},2:{w:150},3:{w:30},4:{w:20},5:{w:150},6:{w:30},7:{w:20},8:{w:150},9:{w:30},10:{w:20},11:{w:150},12:{w:30},13:{w:20},14:{w:150},15:{w:30},16:{w:50}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A2"],rightToLeft:vt.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},CI={id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Instructions:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement",et:B.PAGE_BREAK,st:0,ed:0},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Project division - Fill in the specific division of labor after the project is disassembled:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement1",et:B.PAGE_BREAK,st:0,ed:0},{eId:"threeElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Responsible Person - Enter the responsible person's name here:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement2",et:B.PAGE_BREAK,st:0,ed:0},{eId:"fourElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Date-The specific execution time of the project (detailed to the date of a certain month), and the gray color block marks the planned real-time time of the division of labor of the project (for example,",ts:{cl:{rgb:"rgb(92,92,92)"}}}},{eId:"breakElement3",et:B.PAGE_BREAK,st:0,ed:0},{eId:"fiveElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"the specific execution time of [regional scene model arrangement and construction] is the 2 days marked in gray. ",ts:{cl:{rgb:"rgb(92,92,92)"}}}}],paragraphStyle:{spaceAbove:10,lineSpacing:1.2}}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},TI={id:"workbook-01",theme:"default",locale:Qe.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:vt.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:ye.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:1},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0001":{type:tt.GRID,id:"sheet-0001",cellData:{0:{0:{s:"1",m:"A Schedule of Items"}},1:{0:{s:"2",m:"Division of Project"},1:{s:"3",m:"Responsible Person"},2:{s:"4",m:"Date"}},2:{0:{m:"General Project Manager",s:"5"},1:{m:"@XXX",s:"6"},2:{m:"March 1",s:"5"},3:{m:"March 2",s:"5"},4:{m:"March 3",s:"5"},5:{m:"March 4",s:"5"},6:{m:"March 5",s:"5"},7:{m:"March 6",s:"5"},8:{m:"March 7",s:"5"},9:{m:"March 8",s:"5"},10:{m:"March 9",s:"5"},11:{m:"March 10",s:"5"},12:{m:"March 11",s:"5"},13:{m:"March 12",s:"5"},14:{m:"March 13",s:"5"}},3:{0:{m:"1Responsible Person of Model Section",s:"7"},1:{m:"@George",s:"8"}},4:{0:{m:"Advertisement Signboard",s:"9"},1:{m:"@Paul",s:"6"},4:{s:"10"},5:{s:"10"},6:{s:"10"},7:{s:"10"},8:{s:"10"},9:{s:"10"},10:{s:"10"}},5:{0:{m:"Transport Ready",s:"9"},1:{m:"@George",s:"6"}},6:{0:{m:"2Head of Special Effects Section",s:"7"},1:{m:"@Paul",s:"8"}},7:{0:{m:"Render Output Parameter Test",s:"9"},1:{m:"@Paul",s:"6"},3:{s:"25"},4:{s:"25"},5:{s:"25"},6:{s:"25"},7:{s:"25"},8:{s:"25"},9:{s:"25"}},8:{0:{m:"Camera Moving Mirror",s:"9"},1:{m:"@Paul",s:"6"}},9:{0:{m:"3Responsible Person of Rendering Section",s:"7"},1:{m:"@Jennifer",s:"8"}},10:{0:{m:"Scene Dynamic Element Design",s:"9"},7:{s:"27"},8:{s:"27"},9:{s:"27"},10:{s:"27"},11:{s:"27"}},11:{0:{m:"Sky Map Selection",s:"9"}},12:{0:{m:"Reference Scenario Data Collection",s:"9"}},13:{0:{m:"Scene Dynamic Element Design",s:"9"},2:{s:"29"},3:{s:"29"},4:{s:"29"},5:{s:"29"},6:{s:"29"},7:{s:"29"}},14:{0:{p:CI}}},name:"sheet0001",tabColor:"red",hidden:vt.FALSE,freezeColumn:1,rowCount:15,columnCount:15,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:14},{startRow:1,endRow:1,startColumn:2,endColumn:14},{startRow:14,endRow:14,startColumn:0,endColumn:14}],rowData:{0:{h:70},2:{h:20},3:{h:20},4:{h:20},5:{h:20},6:{h:20},7:{h:20},8:{h:20},9:{h:20},10:{h:20},11:{h:20},12:{h:20},13:{h:20},14:{h:200}},columnData:{0:{w:250},1:{w:130},2:{w:60},3:{w:60},4:{w:60},5:{w:60},6:{w:60},7:{w:60},8:{w:60},9:{w:60},10:{w:60},11:{w:60},12:{w:60},13:{w:60},14:{w:60}},status:1,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A2"],rightToLeft:vt.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},wI={id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"No.",ts:{cl:{rgb:"#000"},fs:20}}},{eId:"twoElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"2824163",ts:{cl:{rgb:"rgb(255,0,0)"},fs:20}}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},yI={id:"workbook-01",theme:"default",locale:Qe.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:vt.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:ye.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:1},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0004":{type:tt.GRID,id:"sheet-0004",name:"sheet0004",cellData:{0:{0:{s:"40"},1:{m:"Travel Declaration Form",s:"40"},8:{p:wI,s:"41"},10:{s:"52"}},1:{1:{m:"Department:",s:"42"},6:{m:"Application Date:",s:"42"}},2:{1:{m:"Business Trip Employee",s:"43"},2:{s:"46"},3:{m:"Position",s:"46"},4:{s:"46"},6:{s:"46",m:"Entourage"},7:{s:"47"},10:{m:"Borrower write-off",s:"53"}},3:{1:{m:"Business Trip Place",s:"44"},2:{m:"                      To                      To                      To",s:"48"}},4:{1:{m:"Amount",s:"44"},2:{m:"(Capital)                                                         ",s:"49"},7:{m:"(Lower) ",s:"48"}},5:{1:{m:"Departure Time",s:"44"},2:{s:"49"},3:{m:"ETR",s:"50"},5:{s:"50"},8:{m:"Days",s:"50"},9:{s:"48"}},6:{1:{m:"Reasons",s:"44"},2:{s:"48"}},7:{1:{m:"Applicant For Travel",s:"44"},2:{s:"50"},3:{m:"Administrator",s:"50"},4:{s:"50"},6:{m:"Financial Manager",s:"50"},7:{s:"50"},9:{m:"Payee",s:"51"}},8:{1:{m:"Department Head",s:"44"},2:{s:"50"},3:{m:"Manager",s:"50"},4:{s:"50"},6:{m:"Cashier",s:"50"},7:{s:"50"},9:{s:"51"}},9:{1:{m:"Record: The loan is used exclusively for travel expenses, and the travel expenses will not be written off without a business trip application.",s:"45"}}},tabColor:"blue",hidden:vt.FALSE,freezeColumn:1,rowCount:10,columnCount:11,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:40,mergeData:[{startRow:0,endRow:1,startColumn:10,endColumn:10},{startRow:0,endRow:9,startColumn:0,endColumn:0},{startRow:0,endRow:0,startColumn:1,endColumn:7},{startRow:0,endRow:0,startColumn:8,endColumn:9},{startRow:1,endRow:1,startColumn:1,endColumn:4},{startRow:1,endRow:1,startColumn:6,endColumn:9},{startRow:2,endRow:2,startColumn:4,endColumn:5},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:3,endRow:3,startColumn:2,endColumn:9},{startRow:4,endRow:4,startColumn:2,endColumn:6},{startRow:4,endRow:4,startColumn:7,endColumn:9},{startRow:5,endRow:5,startColumn:3,endColumn:4},{startRow:5,endRow:5,startColumn:5,endColumn:7},{startRow:6,endRow:6,startColumn:2,endColumn:9},{startRow:7,endRow:7,startColumn:4,endColumn:5},{startRow:8,endRow:8,startColumn:7,endColumn:8},{startRow:8,endRow:8,startColumn:4,endColumn:5},{startRow:7,endRow:7,startColumn:7,endColumn:8},{startRow:9,endRow:9,startColumn:1,endColumn:9},{startRow:2,endRow:9,startColumn:10,endColumn:10}],rowData:{0:{h:50},1:{h:20},6:{h:150},9:{h:30}},columnData:{0:{w:20},1:{w:180},2:{w:120},4:{w:60},5:{w:60},7:{w:30},8:{w:90},10:{w:40}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A2"],rightToLeft:vt.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},SI={id:"workbook-01",theme:"default",locale:Qe.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:vt.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{idtqdi:{ht:2},P_LfgH:{ht:2,vt:2},"dTW-2H":{ht:2,vt:2,cl:{rgb:"#fff"}},AZ992T:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}}},"3sU7Wt":{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}}},Z1mNVr:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"#fff"}},mkFqf3:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgba(237,125,49)"}},qFGJGc:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgba(237,125,49)"},fs:20},"9K8lPD":{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgba(237,125,49)"},fs:20,bl:1},KT84dD:{bg:{rgb:"rgba(237,125,49)"}},qDQuhZ:{bg:{rgb:"rgba(237,125,49)"},ht:2},"4C9ySZ":{bg:{rgb:"rgba(237,125,49)"},ht:2,vt:2},"91b7gh":{ht:2,vt:2,tb:3},u5otPe:{bd:{}},lQ8z14:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgba(237,125,49)"},fs:20,bl:1,bd:{t:{s:1,cl:{rgb:"#000"}},l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},bcVHEL:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgba(237,125,49)"},fs:20,bl:1,bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},KrPXyW:{bg:{rgb:"rgba(237,125,49)"},ht:2,vt:2,bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},f9cBiW:{bg:{rgb:"rgba(237,125,49)"},ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},"3_YUYr":{ht:2,vt:2,tb:3,bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},njh8Q5:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},DqvAmw:{bd:{t:{s:1,cl:{rgb:"#000"}},l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},e9siET:{bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},M9lQgx:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},Jc7bxM:{bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},goS_3_:{bd:{t:{s:1,cl:{rgb:"#000"}},l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2},"08dwws":{bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2},"5UPiTC":{bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2},"0oPndb":{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2},F_LZQL:{bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2},hBtso7:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2},c27I5b:{vt:2,ht:2,bd:{t:{s:1,cl:{rgb:"#000"}},l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},bg:{rgb:"rgba(177,166,223)"}},aA37LW:{bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,bg:{rgb:"rgba(177,166,223)"}},AeAego:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,bg:{rgb:"rgba(177,166,223)"}},YYhEgD:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},bg:{rgb:"rgba(177,166,223)"}},qdFDeG:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#999"}},"7J2-B1":{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#999"}},KAKWgT:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#999"},ul:{s:0,cl:{rgb:"#999"}}},IJFGac:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#999"},ul:{s:0,cl:{rgb:"#999"}}},a293m8:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#999"},ul:{s:0,cl:{rgb:"#999"}},st:{s:0,cl:{rgb:"#999"}}},qtPq3K:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#999"},ul:{s:0,cl:{rgb:"#999"}},st:{s:0,cl:{rgb:"#999"}}},RrHp6L:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#999"}},st:{s:0,cl:{rgb:"#999"}}},_ICBZy:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#999"}},st:{s:0,cl:{rgb:"#999"}}},epwOZX:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#999"}}},rpElXw:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#999"}}},"4i0fZ-":{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#ccc"}}},WsPcQD:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#ccc"}}},ltItGP:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"}},baZ2Vp:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}}},EY_PQ9:{bd:{},vt:2},qlUeY8:{bd:{t:{s:5,cl:{rgb:"#fff"}},l:{s:5,cl:{rgb:"#fff"}},r:{s:5,cl:{rgb:"#fff"}},b:{s:5,cl:{rgb:"#fff"}}}},ilOCwO:{bd:{t:{s:5,cl:{rgb:"#fff"}},r:{s:5,cl:{rgb:"#fff"}},b:{s:5,cl:{rgb:"#fff"}}}},oToIA8:{bd:{l:{s:5,cl:{rgb:"#fff"}},r:{s:5,cl:{rgb:"#fff"}},b:{s:5,cl:{rgb:"#fff"}}}},dzzzqn:{bd:{r:{s:5,cl:{rgb:"#fff"}},b:{s:5,cl:{rgb:"#fff"}}}},lxyoad:{bd:{t:{s:1,cl:{rgb:"#fff"}},r:{s:1,cl:{rgb:"#fff"}},b:{s:1,cl:{rgb:"#fff"}}}},eoTO7a:{bd:{l:{s:1,cl:{rgb:"#fff"}},r:{s:1,cl:{rgb:"#fff"}},b:{s:1,cl:{rgb:"#fff"}}}},jbpbgG:{bd:{r:{s:1,cl:{rgb:"#fff"}},b:{s:1,cl:{rgb:"#fff"}}}},uzcHK6:{bd:{t:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,bg:{rgb:"rgba(177,166,223)"}},khtUqL:{ht:2,vt:2,bd:{b:{s:1,cl:{rgb:"#000"}}},bg:{rgb:"rgba(177,166,223)"}},"-4GCh_":{ht:2,vt:2,bd:{b:{s:1,cl:{rgb:"#000"}}}},"7KeeG7":{ht:2,vt:2,bd:{b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#ccc"}}},pPK4L1:{bd:{l:{s:1,cl:{rgb:"#fff"}},b:{s:1,cl:{rgb:"#fff"}}}},1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:ye.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:0},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},56:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#9fc5e8"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},57:{ht:1,vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0005":{name:"sheet-0005",status:1,id:"sheet-0005",type:0,tabColor:"",hidden:0,freezeColumn:-1,rowCount:40,columnCount:9,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:41,defaultRowHeight:25,mergeData:[{startRow:37,endRow:36,startColumn:1,endColumn:2},{startRow:0,startColumn:0,endRow:0,endColumn:7},{startRow:1,startColumn:0,endRow:2,endColumn:0},{startRow:1,startColumn:1,endRow:2,endColumn:1},{startRow:1,startColumn:3,endRow:1,endColumn:4},{startRow:1,startColumn:5,endRow:2,endColumn:6},{startRow:1,startColumn:2,endRow:2,endColumn:2},{startRow:1,startColumn:7,endRow:2,endColumn:7},{startRow:3,startColumn:0,endRow:7,endColumn:0},{startRow:8,startColumn:0,endRow:12,endColumn:0},{startRow:13,startColumn:0,endRow:17,endColumn:0},{startRow:18,startColumn:0,endRow:22,endColumn:0},{startRow:23,startColumn:0,endRow:27,endColumn:0},{startRow:28,startColumn:0,endRow:32,endColumn:0},{startRow:33,startColumn:0,endRow:37,endColumn:0}],hideRow:[],hideColumn:[],cellData:{0:{0:{v:"",m:"",s:"lQ8z14"},1:{s:"bcVHEL"},2:{s:"bcVHEL"},3:{s:"bcVHEL"},4:{s:"bcVHEL"},5:{s:"bcVHEL"},6:{s:"bcVHEL"},7:{s:"bcVHEL"},8:{s:"u5otPe"}},1:{0:{v:"",m:"",s:"KrPXyW"},1:{v:"",m:"",s:"f9cBiW"},2:{v:"",m:"",s:"f9cBiW"},3:{v:"",m:"",s:"f9cBiW"},4:{v:"",m:"",s:"f9cBiW"},5:{v:"",m:"",s:"f9cBiW"},6:{s:"f9cBiW"},7:{v:"",m:"",s:"f9cBiW"},8:{s:"u5otPe"}},2:{0:{v:"",m:"",s:"KrPXyW"},1:{v:"",m:"",s:"f9cBiW"},2:{v:"",m:"",s:"f9cBiW"},3:{v:"",m:"",s:"f9cBiW"},4:{v:"",m:"",s:"f9cBiW"},5:{s:"f9cBiW"},6:{s:"f9cBiW"},7:{s:"f9cBiW"},8:{s:"u5otPe"}},3:{0:{v:"2021-6-1",m:"2021-6-1",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},4:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},5:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},6:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},7:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},8:{0:{v:"2021-6-2",m:"2021-6-2",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},9:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},10:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},11:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},12:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},13:{0:{v:"2021-6-3",m:"2021-6-3",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},14:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},15:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},16:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},17:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},18:{0:{v:"2021-6-4",m:"2021-6-4",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},19:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},20:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},21:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},22:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},23:{0:{v:"2021-6-5",m:"2021-6-5",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},24:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},25:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},26:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},27:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},28:{0:{v:"2021-6-5",m:"2021-6-5",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},29:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},30:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},31:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},32:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},33:{0:{v:"2021-6-5",m:"2021-6-5",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"},9:{v:"",m:""}},34:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},35:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},36:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},37:{0:{v:"",m:"",s:"3_YUYr"},1:{v:"",m:"",s:"njh8Q5"},2:{v:"",m:"",s:"njh8Q5"},3:{s:"njh8Q5"},4:{v:"",m:"",s:"njh8Q5"},5:{v:"",m:"",s:"njh8Q5"},6:{v:"",m:"",s:"njh8Q5"},7:{v:"",m:"",s:"njh8Q5"},8:{v:"",m:"",s:"u5otPe"}},38:{0:{s:"u5otPe"},1:{s:"u5otPe"},2:{s:"u5otPe"},3:{s:"u5otPe"},4:{s:"u5otPe"},5:{s:"u5otPe"},6:{s:"u5otPe"},7:{s:"u5otPe"}}},rowData:{0:{hd:0,h:40},44:{hd:0,h:20}},columnData:{},showGridlines:1,rowTitle:{width:46,hidden:0},columnTitle:{height:20,hidden:0},selections:["A1"],rightToLeft:0,pluginMeta:{}}},namedRanges:[]},EI={id:"workbook-01",theme:"default",locale:Qe.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:vt.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{idtqdi:{ht:2},P_LfgH:{ht:2,vt:2},"dTW-2H":{ht:2,vt:2,cl:{rgb:"#fff"}},AZ992T:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}}},"3sU7Wt":{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}}},Z1mNVr:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"#fff"}},mkFqf3:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgba(237,125,49)"}},qFGJGc:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgba(237,125,49)"},fs:20},"9K8lPD":{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgba(237,125,49)"},fs:20,bl:1},KT84dD:{bg:{rgb:"rgba(237,125,49)"}},qDQuhZ:{bg:{rgb:"rgba(237,125,49)"},ht:2},"4C9ySZ":{bg:{rgb:"rgba(237,125,49)"},ht:2,vt:2},"91b7gh":{ht:2,vt:2,tb:3},u5otPe:{bd:{}},lQ8z14:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgba(237,125,49)"},fs:20,bl:1,bd:{t:{s:1,cl:{rgb:"#000"}},l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},bcVHEL:{ht:2,vt:2,cl:{rgb:"#fff"},ul:{s:0,cl:{rgb:"#fff"}},st:{s:0,cl:{rgb:"#fff"}},bg:{rgb:"rgba(237,125,49)"},fs:20,bl:1,bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},KrPXyW:{bg:{rgb:"rgba(237,125,49)"},ht:2,vt:2,bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},f9cBiW:{bg:{rgb:"rgba(237,125,49)"},ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},"3_YUYr":{ht:2,vt:2,tb:3,bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},njh8Q5:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},DqvAmw:{bd:{t:{s:1,cl:{rgb:"#000"}},l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},e9siET:{bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},M9lQgx:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},Jc7bxM:{bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}}},goS_3_:{bd:{t:{s:1,cl:{rgb:"#000"}},l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2},"08dwws":{bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2},"5UPiTC":{bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2},"0oPndb":{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2},F_LZQL:{bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2},hBtso7:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2},c27I5b:{vt:2,ht:2,bd:{t:{s:1,cl:{rgb:"#000"}},l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},bg:{rgb:"rgba(177,166,223)"}},aA37LW:{bd:{t:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,bg:{rgb:"rgba(177,166,223)"}},AeAego:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,bg:{rgb:"rgba(177,166,223)"}},YYhEgD:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},bg:{rgb:"rgba(177,166,223)"}},qdFDeG:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#999"}},"7J2-B1":{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#999"}},KAKWgT:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#999"},ul:{s:0,cl:{rgb:"#999"}}},IJFGac:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#999"},ul:{s:0,cl:{rgb:"#999"}}},a293m8:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#999"},ul:{s:0,cl:{rgb:"#999"}},st:{s:0,cl:{rgb:"#999"}}},qtPq3K:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#999"},ul:{s:0,cl:{rgb:"#999"}},st:{s:0,cl:{rgb:"#999"}}},RrHp6L:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#999"}},st:{s:0,cl:{rgb:"#999"}}},_ICBZy:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#999"}},st:{s:0,cl:{rgb:"#999"}}},epwOZX:{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#999"}}},rpElXw:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#999"}}},"4i0fZ-":{bd:{l:{s:1,cl:{rgb:"#000"}},r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#ccc"}}},WsPcQD:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#ccc"}}},ltItGP:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"}},baZ2Vp:{ht:2,vt:2,bd:{r:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}}},EY_PQ9:{bd:{},vt:2},qlUeY8:{bd:{t:{s:5,cl:{rgb:"#fff"}},l:{s:5,cl:{rgb:"#fff"}},r:{s:5,cl:{rgb:"#fff"}},b:{s:5,cl:{rgb:"#fff"}}}},ilOCwO:{bd:{t:{s:5,cl:{rgb:"#fff"}},r:{s:5,cl:{rgb:"#fff"}},b:{s:5,cl:{rgb:"#fff"}}}},oToIA8:{bd:{l:{s:5,cl:{rgb:"#fff"}},r:{s:5,cl:{rgb:"#fff"}},b:{s:5,cl:{rgb:"#fff"}}}},dzzzqn:{bd:{r:{s:5,cl:{rgb:"#fff"}},b:{s:5,cl:{rgb:"#fff"}}}},lxyoad:{bd:{t:{s:1,cl:{rgb:"#fff"}},r:{s:1,cl:{rgb:"#fff"}},b:{s:1,cl:{rgb:"#fff"}}}},eoTO7a:{bd:{l:{s:1,cl:{rgb:"#fff"}},r:{s:1,cl:{rgb:"#fff"}},b:{s:1,cl:{rgb:"#fff"}}}},jbpbgG:{bd:{r:{s:1,cl:{rgb:"#fff"}},b:{s:1,cl:{rgb:"#fff"}}}},uzcHK6:{bd:{t:{s:1,cl:{rgb:"#000"}},b:{s:1,cl:{rgb:"#000"}}},ht:2,vt:2,bg:{rgb:"rgba(177,166,223)"}},khtUqL:{ht:2,vt:2,bd:{b:{s:1,cl:{rgb:"#000"}}},bg:{rgb:"rgba(177,166,223)"}},"-4GCh_":{ht:2,vt:2,bd:{b:{s:1,cl:{rgb:"#000"}}}},"7KeeG7":{ht:2,vt:2,bd:{b:{s:1,cl:{rgb:"#000"}}},cl:{rgb:"#ccc"},ul:{s:0,cl:{rgb:"#ccc"}},st:{s:0,cl:{rgb:"#ccc"}}},pPK4L1:{bd:{l:{s:1,cl:{rgb:"#fff"}},b:{s:1,cl:{rgb:"#fff"}}}},1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:ye.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:ye.THIN,cl:{rgb:"#000"}},l:{s:ye.THIN,cl:{rgb:"#000"}},r:{s:ye.THIN,cl:{rgb:"#000"}},b:{s:ye.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:ye.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:ye.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:0},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:ye.THIN,cl:{rgb:"#fff"}},r:{s:ye.THIN,cl:{rgb:"#fff"}},b:{s:ye.THIN,cl:{rgb:"#fff"}}}},56:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#9fc5e8"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},57:{ht:1,vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0006":{name:"sheet-0006",status:1,id:"sheet-0006",type:0,tabColor:"",hidden:0,freezeColumn:-1,rowCount:15,columnCount:9,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:45,defaultRowHeight:20,mergeData:[{startRow:1,startColumn:1,endRow:1,endColumn:7},{startRow:9,startColumn:1,endRow:9,endColumn:7},{startRow:0,startColumn:0,endRow:14,endColumn:0},{startRow:0,startColumn:8,endRow:9,endColumn:8},{startRow:10,startColumn:1,endRow:14,endColumn:8},{startRow:0,startColumn:1,endRow:0,endColumn:7}],hideRow:[],hideColumn:[],cellData:{0:{0:{s:"31"},1:{s:"u5otPe"},2:{s:"u5otPe"},3:{s:"u5otPe"},4:{s:"u5otPe"},5:{s:"u5otPe"},6:{s:"u5otPe"},7:{s:"u5otPe"},8:{s:"31"},9:{s:"u5otPe"}},1:{0:{s:"pPK4L1"},1:{v:"",m:"",s:"c27I5b"},2:{s:"aA37LW"},3:{s:"aA37LW"},4:{s:"aA37LW"},5:{s:"aA37LW"},6:{s:"aA37LW"},7:{s:"aA37LW"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},2:{0:{s:"pPK4L1"},1:{v:"",m:"",s:"AeAego"},2:{v:"",m:"",s:"YYhEgD"},3:{v:"",m:"",s:"YYhEgD"},4:{v:"",m:"",s:"YYhEgD"},5:{v:"",m:"",s:"YYhEgD"},6:{v:"",m:"",s:"YYhEgD"},7:{v:"",m:"",s:"YYhEgD"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},3:{0:{s:"pPK4L1"},1:{v:"27",m:"27",s:"4i0fZ-"},2:{v:"28",m:"28",s:"WsPcQD"},3:{v:"29",m:"29",s:"WsPcQD"},4:{v:"30",m:"30",s:"WsPcQD"},5:{v:"31",m:"31",s:"WsPcQD"},6:{v:"1",m:"1",s:"njh8Q5"},7:{v:"2",m:"2",s:"njh8Q5"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},4:{0:{s:"pPK4L1"},1:{v:"3",m:"3",s:"hBtso7"},2:{v:"4",m:"4",s:"njh8Q5"},3:{v:"5",m:"5",s:"njh8Q5"},4:{v:"6",m:"6",s:"njh8Q5"},5:{v:"7",m:"7",s:"njh8Q5"},6:{v:"8",m:"8",s:"njh8Q5"},7:{v:"9",m:"9",s:"njh8Q5"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},5:{0:{s:"pPK4L1"},1:{v:"10",m:"10",s:"hBtso7"},2:{v:"11",m:"11",s:"njh8Q5"},3:{v:"12",m:"12",s:"njh8Q5"},4:{v:"13",m:"13",s:"njh8Q5"},5:{v:"14",m:"14",s:"njh8Q5"},6:{v:"15",m:"15",s:"njh8Q5"},7:{v:"16",m:"16",s:"njh8Q5"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},6:{0:{s:"pPK4L1"},1:{v:"17",m:"17",s:"hBtso7"},2:{v:"18",m:"18",s:"njh8Q5"},3:{v:"19",m:"19",s:"njh8Q5"},4:{v:"20",m:"20",s:"njh8Q5"},5:{v:"21",m:"21",s:"njh8Q5"},6:{v:"22",m:"22",s:"njh8Q5"},7:{v:"23",m:"23",s:"njh8Q5"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},7:{0:{s:"pPK4L1"},1:{v:"24",m:"24",s:"hBtso7"},2:{v:"25",m:"25",s:"njh8Q5"},3:{v:"26",m:"26",s:"njh8Q5"},4:{v:"27",m:"27",s:"njh8Q5"},5:{v:"28",m:"28",s:"njh8Q5"},6:{v:"29",m:"29",s:"njh8Q5"},7:{v:"30",m:"30",s:"njh8Q5"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},8:{0:{s:"pPK4L1"},1:{v:"31",m:"31",s:"hBtso7"},2:{v:"1",m:"1",s:"WsPcQD"},3:{v:"2",m:"2",s:"WsPcQD"},4:{v:"3",m:"3",s:"WsPcQD"},5:{v:"4",m:"4",s:"WsPcQD"},6:{v:"5",m:"5",s:"WsPcQD"},7:{v:"6",m:"6",s:"WsPcQD"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},9:{0:{s:"eoTO7a"},1:{v:"20",m:"20",s:"EY_PQ9"},2:{v:"",m:"",s:"EY_PQ9"},3:{v:"",m:"",s:"EY_PQ9"},4:{v:"",m:"",s:"EY_PQ9"},5:{v:"",m:"",s:"EY_PQ9"},6:{v:"",m:"",s:"EY_PQ9"},7:{v:"",m:"",s:"EY_PQ9"},8:{s:"eoTO7a"},9:{s:"u5otPe"}},10:{0:{s:"eoTO7a"},1:{s:"lxyoad"},2:{s:"lxyoad"},3:{s:"lxyoad"},4:{s:"lxyoad"},5:{s:"lxyoad"},6:{s:"lxyoad"},7:{s:"lxyoad"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},11:{0:{s:"eoTO7a"},1:{s:"jbpbgG"},2:{s:"jbpbgG"},3:{s:"jbpbgG"},4:{s:"jbpbgG"},5:{s:"jbpbgG"},6:{s:"jbpbgG"},7:{s:"jbpbgG"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},12:{0:{s:"eoTO7a"},1:{s:"jbpbgG"},2:{s:"jbpbgG"},3:{s:"jbpbgG"},4:{s:"jbpbgG"},5:{s:"jbpbgG"},6:{s:"jbpbgG"},7:{s:"jbpbgG"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},13:{0:{s:"eoTO7a"},1:{s:"jbpbgG"},2:{s:"jbpbgG"},3:{s:"jbpbgG"},4:{s:"jbpbgG"},5:{s:"jbpbgG"},6:{s:"jbpbgG"},7:{s:"jbpbgG"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},14:{0:{s:"eoTO7a"},1:{s:"jbpbgG"},2:{s:"jbpbgG"},3:{s:"jbpbgG"},4:{s:"jbpbgG"},5:{s:"jbpbgG"},6:{s:"jbpbgG"},7:{s:"jbpbgG"},8:{s:"jbpbgG"},9:{s:"u5otPe"}},15:{0:{s:"u5otPe"},1:{s:"u5otPe"},2:{s:"u5otPe"},3:{s:"u5otPe"},4:{s:"u5otPe"},5:{s:"u5otPe"},6:{s:"u5otPe"},7:{s:"u5otPe"},8:{s:"u5otPe"}}},rowData:{0:{hd:0,h:8},9:{h:30},22:{hd:0,h:10}},columnData:{0:{w:8,hd:0}},showGridlines:1,rowTitle:{width:46,hidden:0},columnTitle:{height:20,hidden:0},selections:["A1"],rightToLeft:0,pluginMeta:{}}},namedRanges:[]},RI={id:"workbook-01",theme:"default",locale:Qe.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:vt.FALSE,extensions:[],sheetOrder:["sheet-0001"],pluginMeta:{},styles:{1:{vt:2,ht:2,bl:1,fs:14,bg:{rgb:"rgb(105,126,146)"},cl:{rgb:"rgb(255,255,255)"}},2:{vt:2,ht:2,bl:1,fs:20,bg:{rgb:"rgb(244,79,86)"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bg:{rgb:"rgb(105,126,146)"},cl:{rgb:"rgb(255,255,255)"},fs:14,ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{fs:12,vt:2,pd:{l:5},ht:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},5:{ht:2,vt:2,bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}},6:{ht:1,vt:2,tb:3,bg:{rgb:"rgba(244,79,86)"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:ye.THIN,cl:{rgb:"rgb(217,217,217)"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0001":{type:tt.GRID,id:"sheet-0001",name:"sheet-0001",tabColor:"blue",hidden:vt.FALSE,freezeColumn:1,rowCount:12,columnCount:11,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:40,cellData:{1:{1:{v:"Variants",s:"2"},2:{v:"Platform",s:"2"},3:{v:"UGC Buzz volume",s:"2"},9:{p:fI,s:"6"}},2:{3:{v:"Jul'21",s:"1"},4:{v:"Aug'21",s:"1"},5:{v:"Sep'21",s:"1"},6:{v:"Oct'21",s:"1"},7:{v:"Nov'21",s:"1"},8:{v:"Dec'21",s:"1"}},3:{1:{v:"Eleva",s:"3"},2:{v:"Amazon",s:"4"},3:{v:"4",s:"5"},4:{v:"145",s:"5"},5:{v:"44",s:"5"},6:{v:"20",s:"5"},7:{v:"7",s:"5"},8:{v:"12",s:"5"}},4:{2:{v:"Google",s:"4"},3:{v:"2",s:"5"},4:{v:"6",s:"5"},5:{v:"5",s:"5"},6:{v:"6",s:"5"},7:{v:"12",s:"5"},8:{v:"3113",s:"5"}},5:{2:{v:"Amazon",s:"4"},3:{v:"14",s:"5"},4:{v:"13",s:"5"},5:{v:"6",s:"5"},6:{v:"6",s:"5"},7:{v:"11",s:"5"},8:{v:"2",s:"5"}},6:{1:{v:"Similac",s:"3"},2:{v:"SaleForce",s:"4"},3:{v:"451",s:"5"},4:{v:"255",s:"5"},5:{v:"72",s:"5"},6:{v:"23",s:"5"},7:{v:"163",s:"5"},8:{v:"22",s:"5"}},7:{2:{v:"Oracle",s:"4"},3:{v:"0",s:"5"},4:{v:"1",s:"5"},5:{v:"1136",s:"5"},6:{v:"11",s:"5"},7:{v:"2",s:"5"},8:{v:"1",s:"5"}},8:{2:{v:"Apple",s:"4"},3:{v:"7",s:"5"},4:{v:"2",s:"5"},5:{v:"10",s:"5"},6:{v:"5",s:"5"},7:{v:"6",s:"5"},8:{v:"3",s:"5"}},9:{1:{v:"TC",s:"3"},2:{v:"IBM",s:"4"},3:{v:"1",s:"5"},4:{v:"12",s:"5"},5:{v:"2",s:"5"},6:{v:"1",s:"5"},7:{v:"1",s:"5"},8:{v:"1",s:"5"}},10:{2:{v:"Google",s:"4"},3:{v:"26",s:"5"},4:{v:"33",s:"5"},5:{v:"33",s:"5"},6:{v:"6",s:"5"},7:{v:"22",s:"5"},8:{v:"8",s:"5"}}},mergeData:[{startRow:1,endRow:2,startColumn:1,endColumn:1},{startRow:1,endRow:2,startColumn:2,endColumn:2},{startRow:1,endRow:1,startColumn:3,endColumn:8},{startRow:3,endRow:5,startColumn:1,endColumn:1},{startRow:6,endRow:8,startColumn:1,endColumn:1},{startRow:9,endRow:10,startColumn:1,endColumn:1},{startRow:1,endRow:10,startColumn:9,endColumn:10}],rowData:{0:{h:20}},columnData:{0:{w:20},2:{w:120},3:{w:60},4:{w:60},5:{w:60},6:{w:60},7:{w:60},8:{w:60}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:vt.FALSE},columnTitle:{height:20,hidden:vt.FALSE},selections:["A2"],rightToLeft:vt.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},II={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:re.COLUMN,posOffset:100},positionV:{relativeFrom:oe.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:U.WRAP_SQUARE,behindDoc:vt.FALSE,wrapText:F.BOTH_SIDES}},lists:gI,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"1",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},{eId:"shapeTest1",et:B.DRAWING,st:0,ed:0},{eId:"smallSub",st:16,ed:17,et:B.TEXT_RUN,tr:{ct:"",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:bt.SUPERSCRIPT}}},{eId:"twoElement",st:18,ed:59,et:B.TEXT_RUN,tr:{ct:"194911209911",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}]}},{blockId:"twoParagraph",st:60,ed:88,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"oneElement",st:60,ed:74,et:B.TEXT_RUN,tr:{ct:""}},{eId:"twoElement",st:75,ed:88,et:B.TEXT_RUN,tr:{ct:""}}]}},{blockId:"threeParagraph",st:89,ed:230,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:89,ed:138,et:B.TEXT_RUN,tr:{ct:"2018"}},{eId:"twoElement",st:139,ed:230,et:B.TEXT_RUN,tr:{ct:"17"}}]}},{blockId:"fourParagraph",st:231,ed:322,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"oneElement",st:231,ed:286,et:B.TEXT_RUN,tr:{ct:""}},{eId:"twoElement",st:287,ed:322,et:B.TEXT_RUN,tr:{ct:""}}]}},{blockId:"fiveParagraph",st:323,ed:400,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:[{eId:"oneElement",st:323,ed:360,et:B.TEXT_RUN,tr:{ct:""}},{eId:"twoElement",st:361,ed:400,et:B.TEXT_RUN,tr:{ct:"3-23"}}]}},{blockId:"oneSectionBreak",st:0,ed:0,blockType:I.SECTION_BREAK,sectionBreak:{columnProperties:[{width:200,paddingEnd:20}],columnSeparatorType:k.NONE,sectionType:M.SECTION_TYPE_UNSPECIFIED}}]},documentStyle:{pageSize:{width:594.3,height:840.51},marginTop:72,marginBottom:72,marginRight:90,marginLeft:90}},AI={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:222.6,height:129.6},positionH:{relativeFrom:re.COLUMN,posOffset:130},positionV:{relativeFrom:oe.PAGE,posOffset:510},angle:0,imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/gartner-tech-2022.png"}},layoutType:U.WRAP_SQUARE,behindDoc:vt.FALSE,wrapText:F.BOTH_SIDES},shapeTest2:{objectId:"shapeTest2",objectProperties:{title:"test shape",description:"test shape",size:{width:254.8,height:234.3},positionH:{relativeFrom:re.COLUMN,posOffset:130},positionV:{relativeFrom:oe.PAGE,posOffset:200},angle:0,imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/hype-cycle-for-emerging-tech-2022.png"}},layoutType:U.WRAP_SQUARE,behindDoc:vt.FALSE,wrapText:F.BOTH_SIDES}},lists:gI,body:{blockElements:[{blockId:"p1",st:0,ed:66,blockType:I.PARAGRAPH,paragraph:{elements:[{eId:"e1",st:0,ed:66,et:B.TEXT_RUN,tr:{ct:"Whats New in the 2022 Gartner Hype Cycle for Emerging Technologies",ts:{bl:vt.TRUE,fs:24,cl:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p2",st:67,ed:251,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:67,ed:251,et:B.TEXT_RUN,tr:{ct:"Emerging technologies for 2022 fit into three main themes: evolving/expanding immersive experiences, accelerated artificial intelligence automation, and optimized technologist delivery.",ts:{fs:18,cl:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p3",st:252,ed:401,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:252,ed:401,et:B.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle identifies 25 must-know emerging technologies designed to help enterprise architecture and technology innovation leaders: ",ts:{fs:16}}}]}},{blockId:"p4",st:402,ed:429,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:402,ed:429,et:B.TEXT_RUN,tr:{ct:"Expand immersive experiences",ts:{fs:16}}}]}},{blockId:"p5",st:430,ed:479,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:430,ed:479,et:B.TEXT_RUN,tr:{ct:"Accelerate artificial intelligence (AI) automation",ts:{fs:16}}}]}},{blockId:"p6",st:480,ed:510,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:480,ed:510,et:B.TEXT_RUN,tr:{ct:"Optimize technologist delivery ",ts:{fs:16}}}]}},{blockId:"p7",st:511,ed:705,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:511,ed:672,et:B.TEXT_RUN,tr:{ct:"These technologies are expected to greatly impact business and society over the next two to 10 years, but will especially enable CIOs and IT leaders to deliver on",ts:{fs:16}}},{eId:"e2",st:673,ed:705,et:B.TEXT_RUN,tr:{ct:"digital business transformation. ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:vt.TRUE}}}]}},{blockId:"p8",st:706,ed:762,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20},elements:[{eId:"e1",st:706,ed:762,et:B.TEXT_RUN,tr:{ct:"Three Hype Cycle themes to think about in 2022 and beyond",ts:{fs:24,cl:{rgb:"rgb(255,255,255)"},bg:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p9",st:763,ed:1233,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:763,ed:1233,et:B.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle features emerging technologies and distills insights from more than 2,000 technologies into a succinct high-potential set. Most technologies have multiple use cases but enterprise architecture and technology innovation leaders should prioritize those with the greatest potential benefit for their organization. (They will also need to launch a proof-of-concept project to demonstrate the feasibility of a technology for their target use case.)",ts:{fs:16}}},{eId:"shapeTest1",st:0,ed:0,et:B.DRAWING}]}},{blockId:"oneSectionBreak",st:0,ed:0,blockType:I.SECTION_BREAK,sectionBreak:{columnProperties:[],columnSeparatorType:k.NONE,sectionType:M.SECTION_TYPE_UNSPECIFIED}},{blockId:"p10",st:1234,ed:1576,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:1234,ed:1576,et:B.TEXT_RUN,tr:{ct:"The benefit of these technologies is that they provide individuals with more control over their identities and data, and expand their range of experiences into virtual venues and ecosystems that can be integrated with digital currencies. These technologies also provide new ways to reach customers to strengthen or open up new revenue streams.",ts:{fs:16}}}]}},{blockId:"p11",st:1577,ed:1972,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:1577,ed:1972,et:B.TEXT_RUN,tr:{ct:"Digital twin of the customer (DToC) is a dynamic virtual representation of a customer that simulates and learns to emulate and anticipate behavior. It can be used to modify and enhance the customer experience (CX) and support new digitalization efforts, products, services and opportunities. DToC will take five to 10 years until mainstream adoption but will be transformational to organizations.",ts:{fs:16}}}]}},{blockId:"p12",st:1973,ed:2047,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:1973,ed:2047,et:B.TEXT_RUN,tr:{ct:"Other critical technologies in immersive experiences include the following:",ts:{fs:16}}}]}},{blockId:"p13",st:2048,ed:2278,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"e1",st:2048,ed:2070,et:B.TEXT_RUN,tr:{ct:"Decentralized identity ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:vt.TRUE}}},{eId:"e2",st:2071,ed:2278,et:B.TEXT_RUN,tr:{ct:"(DCI) allows an entity (typically a human user) to control their own digital identity by leveraging technologies such as blockchain or other distributed ledger technologies (DLTs), along with digital wallets.",ts:{fs:16}}}]}},{blockId:"p14",st:2279,ed:2421,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"e1",st:2279,ed:2293,et:B.TEXT_RUN,tr:{ct:"Digital humans ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:vt.TRUE}}},{eId:"e2",st:2294,ed:2421,et:B.TEXT_RUN,tr:{ct:"are interactive, AI-driven representations that have some of the characteristics, personality, knowledge and mindset of a human.",ts:{fs:16}}}]}},{blockId:"p15",st:2422,ed:2610,blockType:I.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"e1",st:2422,ed:2450,et:B.TEXT_RUN,tr:{ct:"Internal talent marketplaces ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 0)"},bl:vt.TRUE}}},{eId:"e2",st:2451,ed:2610,et:B.TEXT_RUN,tr:{ct:"match internal employees and, in some cases, a pool of contingent workers, to time-boxed projects and various work opportunities, with no recruiter involvement.",ts:{fs:16}}}]}},{blockId:"twoSectionBreak",st:0,ed:0,blockType:I.SECTION_BREAK,sectionBreak:{columnProperties:[{width:200,paddingEnd:5}],columnSeparatorType:k.NONE,sectionType:M.SECTION_TYPE_UNSPECIFIED}}]},documentStyle:{pageSize:{width:594.3,height:840.51},marginTop:72,marginBottom:72,marginRight:90,marginLeft:90}},xI={id:"cover_1",pageType:Yt.SLIDE,zIndex:1,title:"cover",description:"this is first page, cover",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:2,left:300,top:200,width:400,height:140,title:"mask",description:"",type:Xt.TEXT,richText:{text:"Univer slide",fs:64,cl:{rgb:"rgb(244,79,86)"},bl:1}},centerRect1:{id:"centerRect1",zIndex:1,left:378,top:0,width:204,height:144,title:"mask",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},year1:{id:"year1",zIndex:2,left:430,top:42,width:100,height:40,title:"mask",description:"",type:Xt.TEXT,richText:{text:"2022",fs:48,cl:{rgb:"rgb(255,255,255)"},bl:1}},content1:{id:"content1",zIndex:2,left:80,top:300,width:780,height:140,title:"mask",description:"",type:Xt.TEXT,richText:{text:"The concepts national income and national product have roughly the same value and can be used interchangeably if our interest is in their sum total which is measured as the market value of the total output of goods and services of an economy in a given period, usually a year.",fs:14,cl:{rgb:"rgb(255,255,255)"},bl:1}}}},OI={id:"catalog_1",pageType:Yt.SLIDE,zIndex:2,title:"catalog",description:"this is second page, catalog",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:3,left:180,top:240,width:200,height:40,title:"Catalog",description:"",type:Xt.TEXT,richText:{text:"Catalog",fs:42,cl:{rgb:"rgb(255,255,255)"}}},centerRect1:{id:"centerRect1",zIndex:2,left:140,top:168,width:203,height:203,title:"mask",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},firstRect1:{id:"firstRect1",zIndex:2,left:547,top:115,width:44,height:44,title:"index1",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},secondRect1:{id:"secondRect1",zIndex:2,left:547,top:210,width:44,height:44,title:"index2",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},thirdRect1:{id:"thirdRect1",zIndex:2,left:547,top:304,width:44,height:44,title:"index2",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},forth1:{id:"forth1",zIndex:2,left:547,top:397,width:44,height:44,title:"index2",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},first_index1:{id:"first_index1",zIndex:3,left:557,top:120,width:44,height:44,title:"mask",description:"",type:Xt.TEXT,richText:{text:"01",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},first_title1:{id:"first_title1",zIndex:3,left:610,top:115,width:248,height:39,title:"mask",description:"",type:Xt.TEXT,richText:{text:"Strategic technology trends",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},first_detail1:{id:"first_detail1",zIndex:3,left:610,top:140,width:300,height:39,title:"mask",description:"",type:Xt.TEXT,richText:{text:"How they impact business goals.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},second_index1:{id:"second_index1",zIndex:3,left:557,top:215,width:44,height:44,title:"mask",description:"",type:Xt.TEXT,richText:{text:"02",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},second_title1:{id:"second_title1",zIndex:3,left:610,top:210,width:248,height:39,title:"mask",description:"",type:Xt.TEXT,richText:{text:"Technical profile",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},second_detail1:{id:"second_detail1",zIndex:3,left:610,top:235,width:300,height:39,title:"mask",description:"",type:Xt.TEXT,richText:{text:"What the technologies are and do.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},third_index1:{id:"third_index1",zIndex:3,left:557,top:310,width:44,height:44,title:"mask",description:"",type:Xt.TEXT,richText:{text:"03",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},third_title1:{id:"third_title1",zIndex:3,left:610,top:305,width:248,height:39,title:"mask",description:"",type:Xt.TEXT,richText:{text:"Opportunities",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},third_detail1:{id:"third_detail1",zIndex:3,left:610,top:330,width:300,height:39,title:"mask",description:"",type:Xt.TEXT,richText:{text:"What benefits and outcomes they drive.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},forth_index1:{id:"forth_index1",zIndex:3,left:557,top:405,width:44,height:44,title:"mask",description:"",type:Xt.TEXT,richText:{text:"04",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},forth_title1:{id:"forth_title1",zIndex:3,left:610,top:400,width:248,height:39,title:"mask",description:"",type:Xt.TEXT,richText:{text:"Implementation steps",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},forth_detail1:{id:"forth_detail1",zIndex:3,left:610,top:425,width:300,height:39,title:"mask",description:"",type:Xt.TEXT,richText:{text:"Action plans for implementation.",fs:14,cl:{rgb:"rgb(255,255,255)"}}}}},MI={id:"detailContent1",zIndex:3,left:53,top:363,width:273,height:54,title:"detailContent1",description:"",type:Xt.TEXT,richText:{rich:{id:"d",lists:gI,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Digital Immune System",ts:{fs:12}}}]}},{blockId:"twoParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Applied Observability",ts:{fs:12}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},NI={id:"detailContent2",zIndex:3,left:334,top:363,width:273,height:120,title:"detailContent2",description:"",type:Xt.TEXT,richText:{rich:{id:"d",lists:gI,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"combine SaaS, PaaS and IaaS with tailored",ts:{fs:12}}}]}},{blockId:"twoParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"provides a curated set of tools, capabilities and processes that are packaged for easy consumption by developers and end users",ts:{fs:12}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},kI={id:"detailContent3",zIndex:3,left:652,top:363,width:273,height:130,title:"detailContent3",description:"",type:Xt.TEXT,richText:{rich:{id:"d",lists:gI,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"SuperApps are more than composite applications that aggregate services.",ts:{fs:12}}}]}},{blockId:"twoParagraph",st:0,ed:59,blockType:I.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:B.TEXT_RUN,tr:{ct:"Adaptive AI allows for model behavior change post-deployment by using real-time feedback",ts:{fs:12}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},LI={id:"strategic_1",pageType:Yt.SLIDE,zIndex:1,title:"cover",description:"this is third page, strategic",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:Xt.TEXT,richText:{text:"Strategic technology trends",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:Xt.TEXT,richText:{text:"We expect the 2023 trends to impact enterprise strategies in the coming three years by enabling organizations to address four key priorities:",fs:18,cl:{rgb:"rgb(127,127,127)"}}},chart1:{id:"chart1",zIndex:2,left:53,top:214,width:125,height:58,title:"chart1",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(105,126,146)"}}}},chartTitle1:{id:"chartTitle1",zIndex:3,left:53,top:186,width:84,height:28,title:"chartTitle1",description:"",type:Xt.TEXT,richText:{text:"Optimize",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber1:{id:"chartNumber1",zIndex:3,left:63,top:230,width:61,height:36,title:"chartNumber1",description:"",type:Xt.TEXT,richText:{text:"20%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},chart2:{id:"chart2",zIndex:2,left:178,top:214,width:428,height:58,title:"chart2",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(57,74,87)"}}}},chartTitle2:{id:"chartTitle2",zIndex:3,left:178,top:186,width:59,height:28,title:"chartTitle2",description:"",type:Xt.TEXT,richText:{text:"Scale",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber2:{id:"chartNumber2",zIndex:3,left:188,top:230,width:61,height:36,title:"chartNumber2",description:"",type:Xt.TEXT,richText:{text:"50%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},chart3:{id:"chart3",zIndex:2,left:605,top:214,width:302,height:58,title:"chart3",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},chartTitle3:{id:"chartTitle3",zIndex:3,left:605,top:186,width:74,height:28,title:"chartTitle3",description:"",type:Xt.TEXT,richText:{text:"Scale",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber3:{id:"chartNumber3",zIndex:3,left:615,top:230,width:61,height:36,title:"chartNumber3",description:"",type:Xt.TEXT,richText:{text:"30%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},detailTitle1:{id:"detailTitle1",zIndex:3,left:53,top:326,width:152,height:28,title:"detailTitle1",description:"",type:Xt.TEXT,richText:{text:"Theme 1: Optimize",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent1:MI,detailTitle2:{id:"detailTitle2",zIndex:3,left:334,top:326,width:129,height:28,title:"detailTitle2",description:"",type:Xt.TEXT,richText:{text:"Theme 2: Scale",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent2:NI,detailTitle3:{id:"detailTitle3",zIndex:3,left:652,top:326,width:143,height:28,title:"detailTitle3",description:"",type:Xt.TEXT,richText:{text:"Theme 2: Scale",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent3:kI}},DI=RI.sheets[RI.sheetOrder[0]],PI=RI.styles,BI={id:"business_1",pageType:Yt.SLIDE,zIndex:2,title:"business",description:"this is second page, business",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:Xt.TEXT,richText:{text:"The Business Objectives",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:Xt.TEXT,richText:{text:"What we hope to achieve in the short and long run",fs:18,cl:{rgb:"rgb(127,127,127)"}}},spreadSheet1:{id:"table1",zIndex:3,left:30,top:125,width:900,height:400,title:"table1",description:"",type:Xt.SPREADSHEET,spreadsheet:{worksheet:DI,styles:PI}}}},HI={id:"technology_1",pageType:Yt.SLIDE,zIndex:2,title:"technology",description:"this is second page, technology",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:Xt.TEXT,richText:{text:"Sustainable Technology",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:Xt.TEXT,richText:{text:"Delivering technology alone will not be enough in 2023",fs:18,cl:{rgb:"rgb(127,127,127)"}}},picture1:{id:"picture1",zIndex:2,left:53,top:151,width:258,height:156,title:"title Icon",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/P1.png"}}},picture2:{id:"picture2",zIndex:2,left:315,top:151,width:241,height:156,title:"title Icon",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/P2.png"}}},picture3:{id:"picture3",zIndex:2,left:53,top:310,width:258,height:156,title:"title Icon",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/P3.png"}}},picture4:{id:"picture4",zIndex:2,left:310,top:315,width:241,height:156,title:"title Icon",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/P4.jpg"}}},detailTitle1:{id:"detailTitle1",zIndex:3,left:580,top:138,width:75,height:28,title:"detailTitle1",description:"",type:Xt.TEXT,richText:{text:"In short:",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent1:{id:"detailContent1",zIndex:3,left:580,top:167,width:373,height:81,title:"detailContent1",description:"",type:Xt.TEXT,richText:{text:"Investments in sustainable technology also have the potential to create greater operational resiliency and financial performance, while providing new avenues for growth.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitle1:{id:"listTitle1",zIndex:3,left:580,top:138,width:75,height:28,title:"listTitle1",description:"",type:Xt.TEXT,richText:{text:"In short:",fs:16,cl:{rgb:"rgb(244,79,86)"}}},listTitlePicture1:{id:"listTitlePicture1",zIndex:2,left:572,top:261,width:53,height:53,title:"title Icon",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/icon1.png"}}},listContent1:{id:"listContent1",zIndex:3,left:637,top:265,width:309,height:61,title:"listContent1",description:"",type:Xt.TEXT,richText:{text:"Gartners Top 10 Strategic Technology Trends will help fulfill your business needs to optimize, scale or pioneer.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitlePicture2:{id:"listTitlePicture2",zIndex:2,left:572,top:341,width:53,height:53,title:"title Icon",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/icon2.png"}}},listContent2:{id:"listContent2",zIndex:3,left:637,top:345,width:309,height:61,title:"listContent2",description:"",type:Xt.TEXT,richText:{text:"The trends allow you to align your technology innovation with the future strategic objectives of your enterprise.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitlePicture3:{id:"listTitlePicture3",zIndex:2,left:572,top:421,width:53,height:53,title:"title Icon",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/icon3.png"}}},listContent3:{id:"listContent3",zIndex:3,left:637,top:425,width:309,height:61,title:"listContent3",description:"",type:Xt.TEXT,richText:{text:"Investments in sustainable technology provide operational and financial benefits, and can create growth opportunities.",fs:12,cl:{rgb:"rgb(127,127,127)"}}}}},FI={id:"richText_1",pageType:Yt.SLIDE,zIndex:2,title:"business",description:"this is fix page, rich text",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:Xt.TEXT,richText:{text:"The Work-like Editor",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:Xt.TEXT,richText:{text:"Open source WYSIWYG editor built for the modern web",fs:18,cl:{rgb:"rgb(127,127,127)"}}},document:{id:"table1",zIndex:3,left:30,top:125,width:900,height:400,title:"table1",description:"",type:Xt.DOCUMENT,document:AI}}};function zI(e=1,t){const n={id:"slide_unlimited",title:"UniverSlide",pageSize:{width:960,height:540},body:{pages:{unlimited_1:{id:"unlimited_1",pageType:Yt.SLIDE,zIndex:1,title:"unlimited",description:"this is seven page, unlimited",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:2,left:300,top:200,width:400,height:140,title:"mask",description:"",type:Xt.TEXT,richText:{text:"Univer slide",fs:64,cl:{rgb:"rgb(244,79,86)"},bl:1}},centerRect1:{id:"centerRect1",zIndex:1,left:378,top:0,width:204,height:144,title:"mask",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},year1:{id:"year1",zIndex:2,left:430,top:42,width:100,height:40,title:"mask",description:"",type:Xt.TEXT,richText:{text:"2022",fs:48,cl:{rgb:"rgb(255,255,255)"},bl:1}},content1:{id:"content1",zIndex:2,left:80,top:300,width:780,height:140,title:"mask",description:"",type:Xt.TEXT,richText:{text:"The concepts national income and national product have roughly the same value and can be used interchangeably if our interest is in their sum total which is measured as the market value of the total output of goods and services of an economy in a given period, usually a year.",fs:14,cl:{rgb:"rgb(255,255,255)"},bl:1}}}},catalog_1:OI,strategic_1:LI,technology_1:HI,richText_1:FI,business_1:BI},pageOrder:["unlimited_1","catalog_1","strategic_1","technology_1","richText_1","business_1"]}};return t&&(n.body.pages.unlimited_1.pageElements.slide={id:"slide",zIndex:3,left:960*(1-e)/2,top:540*(1-e)/2,width:960,height:540,scaleX:e,scaleY:e,title:"slide",description:"",type:Xt.SLIDE,slide:t}),n}const UI={id:"unlimited_1",pageType:Yt.SLIDE,zIndex:1,title:"unlimited",description:"this is seven page, unlimited",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:Xt.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:2,left:300,top:200,width:400,height:140,title:"mask",description:"",type:Xt.TEXT,richText:{text:"Univer slide",fs:64,cl:{rgb:"rgb(244,79,86)"},bl:1}},centerRect1:{id:"centerRect1",zIndex:1,left:378,top:0,width:204,height:144,title:"mask",description:"",type:Xt.SHAPE,shape:{shapeType:It.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},year1:{id:"year1",zIndex:2,left:430,top:42,width:100,height:40,title:"mask",description:"",type:Xt.TEXT,richText:{text:"2022",fs:48,cl:{rgb:"rgb(255,255,255)"},bl:1}},content1:{id:"content1",zIndex:2,left:80,top:300,width:780,height:140,title:"mask",description:"",type:Xt.TEXT,richText:{text:"The concepts national income and national product have roughly the same value and can be used interchangeably if our interest is in their sum total which is measured as the market value of the total output of goods and services of an economy in a given period, usually a year.",fs:14,cl:{rgb:"rgb(255,255,255)"},bl:1}},slide1:{id:"slide",zIndex:3,left:960*(1-.9)/2,top:540*(1-.9)/2,width:960,height:540,scaleX:.9,scaleY:.9,title:"slide",description:"",type:Xt.SLIDE,slide:zI(.9,zI(.9,zI(.9,zI(.9,zI(.9,zI(.9,zI(.9,zI(.9,zI(.9)))))))))}}},WI={id:"slide_test",title:"UniverSlide",pageSize:{width:960,height:540},body:{pages:{cover_1:xI,catalog_1:OI,strategic_1:LI,technology_1:HI,richText_1:FI,business_1:BI,unlimited_1:UI},pageOrder:["cover_1","catalog_1","strategic_1","technology_1","richText_1","business_1","unlimited_1"]}};var VI=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_WORKBOOK_DATA:uI,DEFAULT_WORKBOOK_DATA_DOWN:dI,DEFAULT_WORKBOOK_DATA_DEMO:bI,DEFAULT_WORKBOOK_DATA_DEMO1:_I,DEFAULT_WORKBOOK_DATA_DEMO2:vI,DEFAULT_WORKBOOK_DATA_DEMO3:TI,DEFAULT_WORKBOOK_DATA_DEMO4:yI,DEFAULT_WORKBOOK_DATA_DEMO5:SI,DEFAULT_WORKBOOK_DATA_DEMO6:EI,SLIDE_WORKBOOK_DATA:RI,DEFAULT_DOCUMENT_DATA:II,DEFAULT_DOCUMENT_DATA_EN:AI,DEFAULT_SLIDE_DATA:WI},Symbol.toStringTag,{value:"Module"}));class jI{constructor(){}init(e={}){const t=new ii;t.install(new xu);const n=si.newInstance(e.coreConfig);return t.addUniverSheet(n),n.installPlugin(new Id(e.baseSheetsConfig)),t.install(new Jw(e.uiSheetsConfig)),t.install(new WE(e.collaborationConfig)),n.installPlugin(new JE),n.installPlugin(new aI),n}}class YI{constructor(){}init(e={}){const t=new ii;t.install(new xu);const n=ri.newInstance(e.coreConfig);return t.addUniverDoc(n),n.installPlugin(new wE(e.baseDocsConfig)),t.install(new Ky(e.uiDocsConfig)),n}}class GI{constructor(){}init(e={}){const t=new ii;t.install(new xu);const n=oi.newInstance(e.coreConfig);return t.addUniverSlide(n),n.installPlugin(new BE(e.baseSlidesConfig)),t.install(new aE(e.uiSlidesConfig)),n}}return e.BaseComponent=uC,e.BaseDocs=yE,e.BaseRender=Nu,e.BaseSheets=Ad,e.BaseSlides=HE,e.CommonPluginData=VI,e.UIPluginDocs=Zy,e.UIPluginSheets=ey,e.UIPluginSlides=hE,e.UniverCore=Mi,e.univerDocCustom=function(e){return(new YI).init(e)},e.univerSheetCustom=function(e){return(new jI).init(e)},e.univerSlideCustom=function(e){return(new GI).init(e)},Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),e}({});
